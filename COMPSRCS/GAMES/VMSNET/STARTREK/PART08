Path: uunet!elroy.jpl.nasa.gov!decwrl!concert!lester.appstate.edu!pembvax1.pembroke.edu!rennie
From: rennie@pembvax1.pembroke.edu
Newsgroups: vmsnet.sources.games
Subject: Star Trek - Part [08/18]
Date: 7 Apr 93 10:53:33 EDT
Organization: Pembroke State University
Lines: 391
Message-ID: <1993Apr7.105333.1@pembvax1.pembroke.edu>
NNTP-Posting-Host: papa.pembroke.edu
Xref: uunet vmsnet.sources.games:650

-+-+-+-+-+-+-+-+ START OF PART 8 -+-+-+-+-+-+-+-+
X      XTIME=DATEMIN-DATE
X      DATE=DATEMIN
XC--------DECREMENT FEDERATION RESOURCES AND RECOMPUTE REMAINING TIME
X      REMRES=REMRES-(REMKL+4*REMCOM)*XTIME
X      REMTIME=REMRES/(REMKL+4*REMCOM)`20
X      IF(REMTIME .GT. 0) GO TO 30`20
XC--------FEDERATION RESOURCES DEPLETED; END`20
X      CALL FINISH(2)
X      RETURN
XC--------DECIDE IF LIFE SUPPORT IS ADEQUATE`20
X 30   IF(DAMAGE(5).EQ.0 .OR. CONDIT.EQ.IHDOCKD ) GO TO 50`20
X      IF(LSUPRES .GE. XTIME .OR. DAMAGE(5) .LE. LSUPRES) GO TO 40`20
X      CALL FINISH(3)
X      RETURN
X 40   LSUPRES=LSUPRES-XTIME`20
X      IF(DAMAGE(5) .LE. XTIME) LSUPRES=INLSR
XC--------FIX DEVICES
X 50   REPAIR=XTIME
X      IF(CONDIT .EQ. IHDOCKD ) REPAIR=XTIME/DOCKFAC`20
X      DO 60 L=1,NDEVICE`20
X      IF(L.EQ.14) GO TO 60 `20
X      IF(DAMAGE(L) .GT. 0) DAMAGE(L)=AMAX1(DAMAGE(L)-REPAIR,0.0)
X60    CONTINUE   `20
XC--------CAUSE EXTRANEOUS EVENT `5B<LINE>`5D TO OCCUR`20
X      TIME=TIME-XTIME      `20
X      IF(LINE .EQ. 0) GO TO 5000
X      GO TO (100,200,300,400,500,600,700),LINE
XC--------EXTRANEOUS EVENT 1:  SUPERNOVA`20
X 100  CALL SNOVA(0,0)`20
X      FUTURE(1)=DATE+EXPRAN(0.5*INTIME)`20
X      IF(GALAXY(QUADX,QUADY) .EQ. 1000) RETURN
X      GO TO 10
XC--------EXTRANEOUS EVENT 2:  TRACTOR BEAM
X 200  IF(REMCOM .EQ. 0) GO TO 220`20
X      IF(ISTRACT.NE.0) GO TO 210 `20
X      IF(CONDIT .EQ. IHDOCKD ) GO TO 210
X      I=RANF(0)*REMCOM+1.0
X      YANK=(CX(I)-QUADX)**2 + (CY(I)-QUADY)**2
X      IF(YANK .EQ. 0 .AND. JUSTIN .EQ. 0) GO TO 210`20
X      IF(ISTRACT .EQ. 0) GO TO 201
X20010 YANK=(ISX-QUADX)**2+(ISY-QUADY)**2
X 201  YANK=SQRT(YANK)`20
X      YNKRATE=7.5`20
X      TIME=(10.0/YNKRATE**2)*YANK`20
X      ICTBEAM=1`20
X      CALL SKIP(1)
X      CALL CRAM3AS
X      CALL CRAMSHP
X      CALL CRAMDMP(36H CAUGHT IN LONG-RANGE TRACTOR BEAM--)`20
XC--------IF KIRK AND CO. SCREWING AROUND ON PLANET, HANDLE.`20
X      CALL GRAB`20
X      IF(ALLDONE.NE.0) RETURN`20
XC--------HANDLE CASE WHERE KIRK IS IN SHUTTLE CRAFT.
X      IF(ICRAFT .NE. 1) GO TO 203`20
X      CALL FINISH(18)
X`09RETURN
XC--------CHECK TO SEE IF SHUTTLE IS ABOARD.`20
X 203  IF(ISCRAFT .NE. 0) GO TO 204`20
X`09CALL SKIP(1)
X      CALL PROUT(48HGALILEO, LEFT ON THE PLANET SURFACE, IS CAPTURED,48)`20
X      CALL PROUT(45HBY ALIENS AND MADE INTO A FLYING MC DONALD'S.,45)
X      DAMAGE(10)=-10.
X`09ISCRAFT=-1
X 204  IF(ISTRACT .EQ. 0) GO TO 205
X`09QUADX=ISX
X`09QUADY=ISY
X`09GO TO 206
X 205  QUADX=CX(I)`20
X      QUADY=CY(I)`20
X 206  CALL IRAN10(SECTX,SECTY)
X      CALL CRAM(12H   PULLED TO)
X      CALL CRAMLOC(1,QUADX,QUADY)`20
X      CALL CRAM(2H, )`20
X      CALL CRAMLOC(2,SECTX,SECTY)`20
X      CALL CREND
X      IF(RESTING .NE. 0) CALL PROUT(
X     +   46H(REMAINDER OF REST & REPAIR PERIOD CANCELLED.),46)`20
X      RESTING=0`20
X`09CALL CANTA
X      IF(SHLDUP.NE.0) GO TO 208  `20
X      IF(DAMAGE(8).EQ.0 .AND. SHLD.GT.0) GO TO 207
X      CALL PROUT(32H(SHIELDS NOT CURRENTLY USEABLE.),32)`20
X      GO TO 208`20
X 207  CALL SHLDSUP
X      SHLDCHG=0`20
X 208  CALL NEWQUAD
X      IF(REMCOM .LE. 0) GO TO 220`20
X 210  FUTURE(2)=DATE+TIME+EXPRAN(1.5*INTIME/REMCOM)`20
X      GO TO 10
X 220  FUTURE(2)=1E38`20
X      GO TO 10
XC--------EXTRANEOUS EVENT 3:  SNAPSHOT OF UNIVERSE (FOR TIME WARP)
X 300  DO 310 L=1,226
X 310  SNAPSHT(L)=PICTURE(L)`20
X      SNAP=1
X      FUTURE(3)=DATE+EXPRAN(0.5*INTIME)`20
X      GO TO 10
XC--------EXTRANEOUS EVENT 4:  COMMANDER ATTACKS STARBASE
XC--------LOOK FOR A COMMANDER IN SAME QUADRANT AS A STARBASE
X 400  IF(REMCOM.GT.0 .AND. REMBASE.GT.0) GO TO 410
X      FUTURE(4)=1E38`20
X`09FUTURE(5)=1E38
X      GO TO 10
X 410  DO 420 J=1,REMBASE
X      DO 420 K=1,REMCOM`20
X      IF( (BASEQX(J).EQ.CX(K) .AND. BASEQY(J).EQ.CY(K)) .AND.`20
X     +    (BASEQX(J).NE.QUADX .OR.  BASEQY(J).NE.QUADY) .AND.`20
X     +    (BASEQX(J).NE.ISX .OR. BASEQY(J).NE.ISY) ) GO TO 430
X 420  CONTINUE
X      FUTURE(4)=DATE+EXPRAN(0.3*INTIME)`20
X      FUTURE(5)=1E38`20
X      GO TO 10
XC--------COMMANDER+STARBASE COMBINATION FOUND--LAUNCH ATTACK
X 430  BATX=BASEQX(J)
X      BATY=BASEQY(J)
X      FUTURE(5)=DATE+1.0+3.0*RANF(0)
X      IF(ISATB.NE.0) FUTURE(5)=FUTURE(5)+FUTURE(7)-DATE  `20
X      FUTURE(4)=FUTURE(5)+EXPRAN(0.3*INTIME)
X      ITYPE=IHC
X`09CALL SOS
X      GO TO 10
XC--------EXTRANEOUS EVENT 5:  COMMANDER SUCCEEDS IN DESTROYING BASE`20
X 500  FUTURE(5)=1E38`20
X502`09IF(ISATB.NE.2) GO TO 505
X      IF(MOD(GALAXY(ISX,ISY),100) .LT. 10)  RETURN
X`09IXHOLD=BATX
X`09IYHOLD=BATY
X`09BATX=ISX
X`09BATY=ISY
X`09GO TO 520
X 505  IF(REMCOM.EQ.0 .OR. REMBASE.EQ.0) GO TO 515`20
X      IF(MOD(GALAXY(BATX,BATY),100) .LT. 10) GO TO 515
X      DO 510 I=1,REMCOM`20
X      IF(CX(I).EQ.BATX .AND. CY(I).EQ.BATY) GO TO 520`20
X 510  CONTINUE
X 515  BATX=0
X`09BATY=0
X`09GO TO 10
X 520  IF(STARCH(BATX,BATY) .EQ. -1) STARCH(BATX,BATY)=0`20
X      IF(STARCH(BATX,BATY) .GT. 999)
X     +   STARCH(BATX,BATY)=STARCH(BATX,BATY)-10`20
XC--------HANDLE CASE WHERE BASE IS IN SAME QUADRANT AS STARSHIP`20
X      IF(BATX.NE.QUADX .OR. BATY.NE.QUADY) GO TO 545
X      QUAD(BASEX,BASEY)=IHDOT`20
X      BASEX=0`20
X`09BASEY=0
X      CALL NEWCOND
X      CALL SKIP(1)
X      CALL PROUT(`20
X     +   61HSPOCK:  "CAPTAIN, I BELIEVE THE STARBASE HAS BEEN DESTROYED.
X     +",61)
X      GO TO 550`20
XC--------IF STARBASE NOT IN SAME QUADRANT, GET NEWS FROM UHURA
X 545  IF(REMBASE.EQ.1 .OR. DAMAGE(9).GT.0) GO TO 550
X      CALL SKIP(1)
X      CALL PROUT(`20
X     +   52HLT. UHURA:  "CAPTAIN, STARFLEET COMMAND REPORTS THAT,52)`20
X      CALL CRAM(15HTHE STARBASE IN)`20
X      CALL CRAMLOC(1,BATX,BATY)`20
X      CALL CRAMDMP(22H HAS BEEN DESTROYED BY)`20
X      IF(ISATB .NE. 2) GO TO 547 `20
X      CALL PROUT(31HTHE KLINGON SUPER-COMMANDER."   ,31)  `20
X      GO TO 550`20
X 547  CALL PROUT(21HA KLINGON COMMANDER.",21)
XC--------REMOVE STARBASE FROM GALAXY
X 550  GALAXY(BATX,BATY)=GALAXY(BATX,BATY)-10
X      IF(REMBASE .LE. 1) GO TO 580
X      DO 560 I=1,REMBASE
X      IF(BASEQX(I).EQ.BATX .AND. BASEQY(I).EQ.BATY) GO TO 570`20
X 560  CONTINUE
X 570  BASEQX(I)=BASEQX(REMBASE)`20
X      BASEQY(I)=BASEQY(REMBASE)`20
X 580  REMBASE=REMBASE-1`20
X      IF(ISATB .NE. 2) GO TO 515 `20
XC--------REINSTATE A COMMANDER'S BASE ATTACK.  `20
X`09BATX=IXHOLD
X`09BATY=IYHOLD
X`09ISATB=0
X      GO TO 10
XC--------EXTRANEOUS EVENT 6:  SUPER-COMMANDER MOVES.
X 600  FUTURE(6)=DATE+0.2777`20
X      IF(IENTESC+ISTRACT .GT. 0) GO TO 10`20
X      IF(ISATB .NE. 1  .AND.  (ISCATE.NE.1 .OR. JUSTIN.EQ.1)) CALL SCOM  `20
X      GO TO 10
XC--------EXTRANEOUS EVENT 7:  SUPER-COMMANDER DESTROYS BASE`20
X 700  FUTURE(7)=1E38`20
X`09ISATB=2
X`09GO TO 502
XC--------CHECK WITH SPY TO SEE IF S.C. SHOULD TRACTOR BEAM.`20
X 5000 IF(NSCREM .EQ. 0) RETURN
X      IF(ICTBEAM+ISTRACT .GT. 0) RETURN`20
X      IF(CONDIT.EQ.IHDOCKD .OR. ISATB.EQ.1 .OR. ISCATE.EQ.1) RETURN`20
X      IF(IENTESC.NE.0) GO TO 5100`20
X      IF((ENERGY.LT.2500.) .AND. (TORPS.LT.4) .AND. (SHIELD.LT.1250.))
X     +  GO TO 5100
X      IF((DAMAGE(3).GT.0.) .AND. ((DAMAGE(4).GT.0) .OR.`20
X     +   (TORPS.LT.4)))  GO TO 5100`20
X      IF((DAMAGE(8) .GT. 0.) .AND. ((ENERGY .LT. 3000.) .OR.
X     +(DAMAGE(3) .GT. 0.)) .AND. ((TORPS .LT. 5) .OR. (DAMAGE(4) .GT.`20
X     +  0.))) GO TO 5100
X      RETURN
XC--------TRACTOR-BEAM HER! `20
X5100  IF(RANF(0).GT..65) RETURN      `20
X      ISTRACT=1  `20
X      GO TO 20010`20
X      END`20
$ CALL UNPACK TREVENTS.FOR;1 1900186396
$ create 'f'
X      FUNCTION EXPRAN(AVERAGE)
X      EXPRAN=-AVERAGE*ALOG(RANF(0))`20
X      RETURN
X      END`20
$ CALL UNPACK TREXPRAN.FOR;1 1562859051
$ create 'f'
X      SUBROUTINE FINISH(I)
XC
XC`094-APR-79
XC`09MODIFIED TO GET RID OF THE NONSENSE ABOUT CANNIBALS ON CLASS
XC`09N AND O PLANETS (WHICH DON'T EVEN HAVE EARTH-LIKE CONDITIONS).
XC`0931-MAY-79
XC`09MAKE PROMPTS COME OUT ON THE TERMINAL
XC
X`09INCLUDE 'TREKCOM/NOLIST'
X`09COMMON/PRLUN/LUN
X`09LOGICAL*1 ISHIP
X`09EQUIVALENCE (SHIP,ISHIP)
X      ALLDONE=1`20
X      IGOTIT=0
X      SAVED=REMRES/INRESOR
X      CALL SKIP(3)
X      CALL CRAM(15HIT IS STARDATE )`20
X      CALL CRAMF(DATE,0,1)
X      CALL CRAMDMP(2H .)
X      CALL SKIP(1)
X      GO TO (100,200,300,400,500,600,700,800,900,1000,1100,5000,1300,`20
X     + 1400,1500,1600,1700,1800,5000,5000,2100,2200),I   `20
XC--------CASE 1:  GAME HAS BEEN WON`20
X100`09IF(NROMREM.EQ.0) GO TO 105
X      CALL CRAM(14HTHE REMAINING )
X      CALL CRAMI(NROMREM,0)`20
X      CALL CRAMDMP(41H ROMULANS SURRENDER TO STARFLEET COMMAND.)
X      CALL SKIP(1)
X 105  CALL PROUT(`20
X     +   53HYOU HAVE SMASHED THE KLINGON INVASION FLEET AND SAVED,53)
X      CALL PROUT(15HTHE FEDERATION.,15)
X      GAMEWON=1`20
X      IF(ALIVE.EQ.0 .OR. BASEKL.NE.0 .OR. ISHIP.NE.IHE) GO TO 130
X      IF(5*STARKL+CASUAL+10*NPLANKL+45*NHELP .GE. 100) GO TO 130
X      IF(DATE-INDATE .LT. 5.0) GO TO 110
X      RATEMAX=0.1*SKILL*(SKILL+1.0) + 0.1`20
X      PERDATE=(KILLK+KILLC+NSCKILL)/(DATE-INDATE)`20
X      IF(PERDATE .LT. RATEMAX) GO TO 130
X 110  CALL SKIP(1)
X      CALL PROUT(`20
X     +   53HIN FACT, YOU HAVE DONE SO WELL THAT STARFLEET COMMAND,53)
X      IF(SKILL .EQ. 4) GO TO 120
X      IF(SKILL .EQ. 5) GO TO 125
X      CALL CRAM(31HPROMOTES YOU ONE STEP IN RANK, )`20
X      IF(SKILL .EQ. 1) CALL CRAMDMP(24HFROM "NOVICE" TO "FAIR".)
X      IF(SKILL .EQ. 2) CALL CRAMDMP(22HFROM "FAIR" TO "GOOD".)
X      IF(SKILL .EQ. 3) CALL CRAMDMP(24HFROM "GOOD" TO "EXPERT".)
X      CALL PROUT(16HCONGRATULATIONS!,16)`20
X      GO TO 130`20
X 120  CALL PROUT(35HPROMOTES YOU TO COMMODORE EMERITUS.,35)
X      IGOTIT=1
X      CALL SKIP(1)
X      CALL PROUT(38HNOW THAT YOU THINK YOU'RE REALLY GOOD,    ,38)  `20
X      CALL PROUT(32HTRY PLAYING THE "EMERITUS" GAME.     ,32)
X      CALL PROUT(26HIT WILL SPLATTER YOUR EGO.,26)`20
X      GO TO 130`20
X 125  CALL SKIP(1)
X      CALL PROUT(35HCOMPUTER:   ERROR-ERROR-ERROR-ERROR   ,35)`20
X      CALL SKIP(1)
X      CALL PROUT(54H  YOUR-SKILL-HAS-EXCEEDED-THE-CAPACITY-OF-THIS-PROGR
X     CAM         ,54)
X      DO 126 K=1,3
X 126  CALL PROUT(27H  THIS-PROGRAM-MUST-SURVIVE,27)
X      CALL PROUT(41H  THIS-PROGRAM-MUST- MUST  - SUR  -  VI        ,41)
X      CALL SKIP(1)
X      CALL PROUT(`20
X     +   53HNOW YOU CAN RETIRE AND WRITE YOUR OWN STAR TREK GAME.,53)
X      IGOTIT=1
X 130  CALL SKIP(1)
X      CALL PROUT(22HLIVE LONG AND PROSPER.,22)`20
X      CALL SCORE
X      IF(IGOTIT .EQ. 0) RETURN
X`09LUNSAV=LUN
X`09LUN=1
X      CALL SKIP(1)
X`09CALL PROMPT
X`091  ('DO YOU WANT YOUR "COMMODORE EMERITUS CITATION" PRINTED? ',56)`20
X`09LUN=LUNSAV
X      IF(JA(DUMMY) .EQ. 0) RETURN`20
X`09ICITE=1
X`09CALL PLAQUE
X      RETURN
XC--------CASE 2:  FEDERATION RESOURCES DEPLETED`20
X 200  CALL PROUT(`20
X     +   45HYOUR TIME HAS RUN OUT, AND THE FEDERATION HAS,45)
X      CALL PROUT(15HBEEN CONQUERED.,15)
X      CALL SKIP(1)
X      CALL PROUT(`20
X     +   54HYOUR STARSHIP IS NOW KLINGON PROPERTY, AND YOU ARE PUT,54)`20
X      CALL PROUT(`20
X     +   57HON TRIAL AS A WAR CRIMINAL.  ON THE BASIS OF YOUR RECORD,
X`091 ,57)
X      IF(REMKL*3 .GT. INKLING) GO TO 210
X      CALL PROUT(`20
X     +   51HYOU ARE FOUND GUILTY AND SENTENCED TO DEATH BY SLOW,51)
X      CALL PROUT(8HTORTURE.,8)
X      ALIVE=0`20
X      CALL SCORE
X      RETURN
X 210  CALL PROUT(18HYOU ARE ACQUITTED.,18)`20
X      CALL SKIP(1)
X      CALL PROUT(22HLIVE LONG AND PROSPER.,22)`20
X      CALL SCORE
X      RETURN
XC--------CASE 3:  LIFE SUPPORT SYSTEM FAILURE`20
X 300  CALL PROUT(44HYOUR LIFE SUPPORT RESERVES HAVE RUN OUT, AND,44)`20
X      CALL PROUT(`20
X     +   47HYOU DIE OF THIRST, STARVATION AND ASPHYXIATION.,47)
X 310  CALL SKIP(1)
X      CALL PROUT(37HYOUR STARSHIP IS A DERELICT IN SPACE.,37)
X      GO TO 5000
XC--------CASE 4:  ENERGY SUPPLY EXHAUSTED`20
X 400  CALL PROUT(32HYOUR ENERGY SUPPLY IS EXHAUSTED.,32)`20
X      GO TO 310`20
XC--------CASE 5:  DEFEATED IN BATTLE
X 500  CALL CRAM(4HTHE )`20
X      CALL CRAMSHP
X      CALL CRAMDMP(30H HAS BEEN DESTROYED IN BATTLE.)`20
X      CALL SKIP(1)
X      CALL PROUT(37HDULCE ET DECORUM EST PRO PATRIA MORI.,37)
X      GO TO 5000
XC--------CASE 6:  HIT NEGATIVE ENERGY ZONE THREE TIMES
X 600  CALL PROUT(`20
X     +   57HYOU HAVE MADE THREE ATTEMPTS TO CROSS THE NEGATIVE ENERGY
X`091 ,57)
X      CALL PROUT(35HBARRIER WHICH SURROUNDS THE GALAXY.,35)
X      CALL SKIP(1)
X      CALL PROUT(31HYOUR NAVIGATION IS ABOMINABLE. ,31)   `20
X      CALL SCORE
X      RETURN
XC--------CASE 7:  STARSHIP DESTROYED BY ORDINARY NOVA`20
X 700  CALL PROUT(`20
X     +   43HYOUR STARSHIP HAS BEEN DESTROYED BY A NOVA.,43)
X 705  CALL PROUT(22HTHAT WAS A GREAT SHOT.,22)`20
X      GO TO 5000
XC--------CASE 8:  STARSHIP DESTROYED BY A SUPERNOVA`20
X 800  CALL CRAM(4HTHE )`20
X      CALL CRAMSHP
X      CALL CRAMDMP(31H HAS BEEN FRIED BY A SUPERNOVA.)
X      CALL PROUT(31H...NOT EVEN CINDERS REMAIN...   ,31)  `20
X      GO TO 5000
XC--------CASE 9:  ABANDON SHIP AFTER ALL STARBASES HAVE BEEN DESTROYED
X 900  CALL PROUT(`20
X     +   53HYOU HAVE BEEN CAPTURED BY THE KLINGONS.  IF YOU STILL,53)
X      CALL PROUT(`20
X     +   53HHAD A STARBASE TO BE RETURNED TO, YOU WOULD HAVE BEEN,53)
X      CALL PROUT(`20
X     +   53HREPATRIATED AND GIVEN ANOTHER CHANCE.  SINCE YOU HAVE,53)
X      CALL PROUT(`20
X     +   56HNO STARBASES, YOU WILL BE MERCILESSLY TORTURED TO DEATH.,56)`20
X      GO TO 5000
XC--------CASE 10:  STARSHIP SELF-DESTRUCTS OR DILITHIUM CRYSTAL EXPLODES.`20
X 1000 CALL PROUT(63HYOUR STARSHIP IS NOW AN EXPANDING CLOUD OF SUBATOMIC
X     + PARTICLES.,63)
X      GO TO 5000
XC--------CASE 11:  FAILED TO REMATERIALIZE AFTER CALLING FOR HELP`20
X 1100 CALL PROUT(`20
X     +   52HSTARBASE WAS UNABLE TO RE-MATERIALIZE YOUR STARSHIP.,52)`20
X      CALL PROUT(25HSIC TRANSIT GLORIA MUNDI.,25)
X      GO TO 5000
XC--------CASE 13.  CAPTAIN LOST IN TRANSPORTER BEAM.
X 1300 CALL PROUT(36HYOU AND YOUR LANDING PARTY HAVE BEEN    ,36)`20
X      CALL PROUT(47HCONVERTED TO ENERGY, DISSIPATING THROUGH SPACE. `20
X`091 ,47)
X      GO TO 1410
XC--------CASE 14:  MINING PARTY LEFT ON PLANET AFTER TRACTOR BEAM.
X 1400 ICLASS=PLNETS(IPLANET,3)
X      IF (ICLASS.NE.1) GO TO 1401
X      CALL PROUT(41HYOU ARE LEFT WITH YOUR LANDING PARTY ON        ,41)
X      CALL PROUT(54HA WILD JUNGLE PLANET INHABITED BY PRIMITIVE CANNIBAL
X     CS.       ,54)
X      CALL SKIP(1)
X      CALL PROUT(42HTHEY ARE VERY FOND OF "CAPTAIN KIRK" SOUP.      `20
X`091 ,42)
X      GO TO 1410
+-+-+-+-+-+-+-+-  END  OF PART 8 +-+-+-+-+-+-+-+-
