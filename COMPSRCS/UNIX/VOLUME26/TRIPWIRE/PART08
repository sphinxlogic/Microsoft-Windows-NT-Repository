Newsgroups: comp.sources.unix
From: spaf@cs.purdue.edu (Gene Spafford)
Subject: v26i180: tripwire - security integrity monitor, Part08/08
Sender: unix-sources-moderator@vix.com
Approved: paul@vix.com

Submitted-By: spaf@cs.purdue.edu (Gene Spafford)
Posting-Number: Volume 26, Issue 180
Archive-Name: tripwire/part08

#! /bin/sh
# This is a shell archive.  Remove anything before this line, then unpack
# it by saving it into a file and typing "sh file".  To overwrite existing
# files, type "sh file -c".  You can also feed this as standard input via
# unshar, or by typing "sh <file", e.g..  If this archive is complete, you
# will see the following message at the end:
#		"End of archive 8 (of 8)."
# Contents:  tripwire-1.0 tripwire-1.0/databases tripwire-1.0/aux
#   tripwire-1.0/contrib tripwire-1.0/include tripwire-1.0/man
#   tripwire-1.0/sigs tripwire-1.0/sigs/crc tripwire-1.0/sigs/crc32
#   tripwire-1.0/sigs/md2 tripwire-1.0/sigs/md5
#   tripwire-1.0/sigs/snefru tripwire-1.0/src tripwire-1.0/tests
#   tripwire-1.0/src/dbase.update.c tripwire-1.0/include/list.h
#   tripwire-1.0/aux/types.c tripwire-1.0/tests/test1.sh
#   tripwire-1.0/sigs/md2/md2.h tripwire-1.0/configs
#   tripwire-1.0/contrib/README.CheckConfig tripwire-1.0/aux/types.sh
#   tripwire-1.0/configs/conf-mach.h
#   tripwire-1.0/configs/conf-unicos.h tripwire-1.0/sigs/md5/md5.h
#   tripwire-1.0/configs/conf-umaxv.h tripwire-1.0/configs/conf-aux3.h
#   tripwire-1.0/configs/conf-hpux.h tripwire-1.0/src/nullsig.c
#   tripwire-1.0/configs/conf-aix.h tripwire-1.0/configs/conf-xenix.h
#   tripwire-1.0/configs/conf-convex.h
#   tripwire-1.0/configs/conf-riscos.h
#   tripwire-1.0/configs/conf-irix4.h tripwire-1.0/configs/conf-svr3.h
#   tripwire-1.0/configs/conf-osf1.h
#   tripwire-1.0/configs/conf-sunos-4.0.h
#   tripwire-1.0/configs/conf-sunos-4.1.h
#   tripwire-1.0/configs/conf-svr4.h tripwire-1.0/configs/conf-dynix.h
#   tripwire-1.0/configs/conf-bsd.h tripwire-1.0/sigs/md2/global.h
#   tripwire-1.0/configs/conf-epix.h
#   tripwire-1.0/configs/conf-osx-ucb.h tripwire-1.0/man/sigfetch.8
#   tripwire-1.0/configs/conf-osx-att.h tripwire-1.0/aux/ntohl.h
#   tripwire-1.0/aux/byteorder.c tripwire-1.0/contrib/README.chk
#   tripwire-1.0/contrib/CheckConfig tripwire-1.0/include/sigs.h
#   tripwire-1.0/configs/tw.conf.ultrix tripwire-1.0/contrib/TRIPWIRE
#   tripwire-1.0/aux/Makefile tripwire-1.0/TODO
#   tripwire-1.0/contrib/tripwire.chk tripwire-1.0/tests/Makefile
#   tripwire-1.0/sigs/snefru/Makefile tripwire-1.0/sigs/crc32/Makefile
#   tripwire-1.0/sigs/crc/Makefile tripwire-1.0/man/Makefile
# Wrapped by spaf@uther.cs.purdue.edu on Tue Nov  3 16:31:57 1992
PATH=/bin:/usr/bin:/usr/ucb ; export PATH
if test ! -d 'tripwire-1.0' ; then
    echo shar: Creating directory \"'tripwire-1.0'\"
    mkdir 'tripwire-1.0'
fi
if test ! -d 'tripwire-1.0/databases' ; then
    echo shar: Creating directory \"'tripwire-1.0/databases'\"
    mkdir 'tripwire-1.0/databases'
fi
if test ! -d 'tripwire-1.0/aux' ; then
    echo shar: Creating directory \"'tripwire-1.0/aux'\"
    mkdir 'tripwire-1.0/aux'
fi
if test ! -d 'tripwire-1.0/configs' ; then
    echo shar: Creating directory \"'tripwire-1.0/configs'\"
    mkdir 'tripwire-1.0/configs'
fi
if test ! -d 'tripwire-1.0/contrib' ; then
    echo shar: Creating directory \"'tripwire-1.0/contrib'\"
    mkdir 'tripwire-1.0/contrib'
fi
if test ! -d 'tripwire-1.0/include' ; then
    echo shar: Creating directory \"'tripwire-1.0/include'\"
    mkdir 'tripwire-1.0/include'
fi
if test ! -d 'tripwire-1.0/man' ; then
    echo shar: Creating directory \"'tripwire-1.0/man'\"
    mkdir 'tripwire-1.0/man'
fi
if test ! -d 'tripwire-1.0/sigs' ; then
    echo shar: Creating directory \"'tripwire-1.0/sigs'\"
    mkdir 'tripwire-1.0/sigs'
fi
if test ! -d 'tripwire-1.0/sigs/crc' ; then
    echo shar: Creating directory \"'tripwire-1.0/sigs/crc'\"
    mkdir 'tripwire-1.0/sigs/crc'
fi
if test ! -d 'tripwire-1.0/sigs/crc32' ; then
    echo shar: Creating directory \"'tripwire-1.0/sigs/crc32'\"
    mkdir 'tripwire-1.0/sigs/crc32'
fi
if test ! -d 'tripwire-1.0/sigs/md2' ; then
    echo shar: Creating directory \"'tripwire-1.0/sigs/md2'\"
    mkdir 'tripwire-1.0/sigs/md2'
fi
if test ! -d 'tripwire-1.0/sigs/md5' ; then
    echo shar: Creating directory \"'tripwire-1.0/sigs/md5'\"
    mkdir 'tripwire-1.0/sigs/md5'
fi
if test ! -d 'tripwire-1.0/sigs/snefru' ; then
    echo shar: Creating directory \"'tripwire-1.0/sigs/snefru'\"
    mkdir 'tripwire-1.0/sigs/snefru'
fi
if test ! -d 'tripwire-1.0/src' ; then
    echo shar: Creating directory \"'tripwire-1.0/src'\"
    mkdir 'tripwire-1.0/src'
fi
if test ! -d 'tripwire-1.0/tests' ; then
    echo shar: Creating directory \"'tripwire-1.0/tests'\"
    mkdir 'tripwire-1.0/tests'
fi
if test -f 'tripwire-1.0/src/dbase.update.c' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'tripwire-1.0/src/dbase.update.c'\"
else
echo shar: Extracting \"'tripwire-1.0/src/dbase.update.c'\" \(1599 characters\)
sed "s/^X//" >'tripwire-1.0/src/dbase.update.c' <<'END_OF_FILE'
X#ifndef lint
Xstatic char rcsid[] = "$Id: dbase.update.c,v 1.2 92/11/03 02:43:43 genek Exp $";
X#endif
X
X/*
X * dbase.update.c
X *
X *	build the preen.database file with the list of files that
X *	was generated by config.parse.c
X *
X * Gene Kim
X * Purdue University
X */
X
X#include "../include/config.h"
X#include <stdio.h>
X#include <fcntl.h>
X#ifdef STDLIBH
X# include <stdlib.h>
X#endif
X#include <sys/param.h>
X#include <sys/types.h>
X#include <sys/stat.h>
X#ifdef STRINGH
X#include <string.h>
X#else
X#include <strings.h>
X#endif
X#include <errno.h>
X#include "../include/list.h"
X#include "../include/tripwire.h"
X
X/*
X * database_update_markentries (struct list **pp_list, int flagentry)
X *
X *	mark all entries with the given (flagentry) as FLAG_UPDATE.
X */
X
Xvoid
Xdatabase_update_markentries (pp_list, flagentry)
X    struct list **pp_list;
X    int flagentry;
X{
X    struct list_elem *p_fileentry;
X    char trash[1024];
X    int entry;
X    int err;
X
X    /* use pp_list as key */
X    if (list_open(pp_list) < 0) {
X	fputs("database_update: list_open() failed!\n", stderr);
X	exit(1);
X    }
X
X    /* foreach file entry */
X    while ((p_fileentry = list_get(pp_list)) != NULL) {
X	if ((err = sscanf(p_fileentry->varvalue, "%d %s", &entry, trash)) < 2) {
X	    fprintf(stderr, "database_update: sscanf() parse error, returned %d!\n", err);
X	    exit(1);
X	}
X	/* flag if entry number match */
X	if (entry == flagentry) {
X	    list_setflag(p_fileentry->varname, FLAG_UPDATE, pp_list);
X	}
X    }
X
X    /* close up the list */
X    if (list_close(pp_list) < 0) {
X	fputs("database_update: list_close() failed!\n", stderr);
X	exit(1);
X    }
X}
X
END_OF_FILE
if test 1599 -ne `wc -c <'tripwire-1.0/src/dbase.update.c'`; then
    echo shar: \"'tripwire-1.0/src/dbase.update.c'\" unpacked with wrong size!
fi
# end of 'tripwire-1.0/src/dbase.update.c'
fi
if test -f 'tripwire-1.0/include/list.h' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'tripwire-1.0/include/list.h'\"
else
echo shar: Extracting \"'tripwire-1.0/include/list.h'\" \(1541 characters\)
sed "s/^X//" >'tripwire-1.0/include/list.h' <<'END_OF_FILE'
X/* $Id: list.h,v 1.1.1.2 92/11/02 18:19:38 genek Exp $ */
X
X#define LIST_HASHSZ	17011
X
X/* linked list element */
Xstruct list_elem {
X    char 	*varname;
X    char	*varvalue;
X    int		priority;
X    struct list_elem	*next;
X    struct list_elem	*prev;
X    int		flag;
X};
X
X/* hash table structure */
Xstruct list_hash {
X    char	*key;			/* hashed string */
X    int		used;			/* table used or not */
X    struct list_elem	*lptr;		/* pointer to entry on list */
X    struct list_hash	*next;		/* pointer to next entry on chain */
X};
X
X/* linked list pointer, with head and tail */
Xstruct list {
X    struct list_elem	*p_head;
X    struct list_elem	*p_tail;
X    struct list_hash	hashtable[LIST_HASHSZ];
X};
X
X/* prototypes */
X/* Do not remove this line.  Protyping depends on it! */
X#if defined(__STDC__) || defined(__cplusplus)
X#define P_(s) s
X#else
X#define P_(s) ()
X#endif
X
X/* list.c */
Xvoid list_set P_((char *pc_name, char *pc_value, int priority, struct list **pp_list));
Xchar *list_lookup P_((char *pc_name, struct list **pp_list));
Xint list_isthere P_((char *pc_name, struct list **pp_list));
Xvoid list_unset P_((char *pc_name, struct list **pp_list));
Xint list_setflag P_((char *pc_name, int flag, struct list **pp_list));
Xint list_getflag P_((char *pc_name, struct list **pp_list));
Xvoid list_print P_((struct list **pp_list));
Xvoid list_reset P_((struct list **pp_list));
Xint list_init P_((void));
Xint list_open P_((struct list **pp_list));
Xstruct list_elem *list_get P_((struct list **pp_list));
Xint list_close P_((struct list **pp_list));
X
X#undef P_
END_OF_FILE
if test 1541 -ne `wc -c <'tripwire-1.0/include/list.h'`; then
    echo shar: \"'tripwire-1.0/include/list.h'\" unpacked with wrong size!
fi
# end of 'tripwire-1.0/include/list.h'
fi
if test -f 'tripwire-1.0/aux/types.c' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'tripwire-1.0/aux/types.c'\"
else
echo shar: Extracting \"'tripwire-1.0/aux/types.c'\" \(1419 characters\)
sed "s/^X//" >'tripwire-1.0/aux/types.c' <<'END_OF_FILE'
X#ifndef lint
Xstatic char rcsid[] = "$Id: types.c,v 1.2 92/11/03 02:48:33 genek Exp $";
X#endif
X
X#include "../include/config.h"
X#include <stdio.h>
X#include <sys/types.h>
X#include <sys/stat.h>
X#ifdef STDLIBH
X#include <stdlib.h>
X#endif
X
Xstatic void
Xusage()
X{
X    fputs("types: usage: typename\n", stderr);
X    exit(1);
X}
X
Xchar *pc;
Xint isunsigned;
X
Xmain(argc, argv)
X    int argc;
X    char *argv[];
X{
X    struct stat statbuf;
X    int size;
X
X    pc = argv[1];
X
X    if (argc < 2)
X	usage();
X
X    if (strcmp(pc, "mode_t") == 0) {
X	isunsigned = 1;
X	typeis(sizeof(statbuf.st_mode));
X    }
X    else if (strcmp(pc, "ino_t") == 0) {
X	isunsigned = 1;
X	typeis(sizeof(statbuf.st_ino));
X    }
X    else if (strcmp(pc, "nlink_t") == 0) {
X	isunsigned = 1;
X	typeis(sizeof(statbuf.st_nlink));
X    }
X    else if (strcmp(pc, "uid_t") == 0) {
X	isunsigned = 0;
X	typeis(sizeof(statbuf.st_uid));
X    }
X    else if (strcmp(pc, "gid_t") == 0) {
X	isunsigned = 0;
X	typeis(sizeof(statbuf.st_gid));
X    }
X    else if (strcmp(pc, "off_t") == 0) {
X	isunsigned = 1;
X	typeis(sizeof(statbuf.st_size));
X    }
X
X    exit(0);
X
X}
X
Xtypeis(i)
X    int i;
X{
X    int shortlen = sizeof(unsigned short);
X    int longlen = sizeof(unsigned long);
X    char sign[64];
X
X    if (isunsigned)
X	strcpy(sign, "unsigned");
X    else
X	strcpy(sign, "signed");
X
X
X    if (i == shortlen)
X	printf("typedef %s short %s;\n", sign, pc);
X    else
X	printf("typedef %s long %s;\n", sign, pc);
X}
END_OF_FILE
if test 1419 -ne `wc -c <'tripwire-1.0/aux/types.c'`; then
    echo shar: \"'tripwire-1.0/aux/types.c'\" unpacked with wrong size!
fi
# end of 'tripwire-1.0/aux/types.c'
fi
if test -f 'tripwire-1.0/tests/test1.sh' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'tripwire-1.0/tests/test1.sh'\"
else
echo shar: Extracting \"'tripwire-1.0/tests/test1.sh'\" \(1412 characters\)
sed "s/^X//" >'tripwire-1.0/tests/test1.sh' <<'END_OF_FILE'
X#!/bin/sh
X
X# $Id: test1.sh,v 1.4 92/11/03 13:36:36 genek Exp $ 
X
XHOSTNAME=$1
XDIST=$2
X
Xcat << 'GHK'
X
X===
X
X    This shell script tests all the Tripwire signature routines.
XConsequently, this test may take awhile to complete, since even the 
Xslowest signature routines are exercised.  On a Sequent Symmetry
Xrunning 16 Mhz Intel 80386s, this test takes over five minutes to
Xcomplete.
X
X    This same test using only the MD5 routines completes in less
Xthan 30 seconds.
X
X    This test suite will ascertain whether the byte-ordering and 
Xmachine-dependent routines are working correctly.
X
XGHK
X
Xecho "=== test begin ==="
Xecho ''
X
Xecho creating: ./tw.db_TEST.@
Xecho creating: ./@tw.config
X
XHOST=`$HOSTNAME`
XCURRPATH=`pwd`
XCURRPATH=`echo $CURRPATH | sed s,/tests$,,`
X
Xsed s,/tmp/genek/$DIST,$CURRPATH, < ./tw.db_TEST > ./tw.db_TEST.@; 
Xsed s,/tmp/genek/$DIST,$CURRPATH, < ./tw.conf.test > ./@tw.config; 
X
X../src/tripwire -c ./@tw.config -d ./tw.db_TEST.@; 
X
Xecho === test end === ;
Xecho ''
X
Xecho Tripwire should have only reported: 
Xecho "    added:   $CURRPATH/tests/@tw.config" 
Xecho "             $CURRPATH/tests/tw.db_TEST.@... "
Xecho "             $CURRPATH/databases/... "
Xecho "    changed: $CURRPATH/... (maybe some directory sizes...) "
Xecho "             ...and any other files you may have changed!"
Xecho ''
Xecho ''
Xecho removing: ./tests/tw.db_TEST.@
Xecho removing: @tw.config
Xrm ./tw.db_TEST.@
Xrm ./@tw.config
END_OF_FILE
if test 1412 -ne `wc -c <'tripwire-1.0/tests/test1.sh'`; then
    echo shar: \"'tripwire-1.0/tests/test1.sh'\" unpacked with wrong size!
fi
# end of 'tripwire-1.0/tests/test1.sh'
fi
if test -f 'tripwire-1.0/sigs/md2/md2.h' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'tripwire-1.0/sigs/md2/md2.h'\"
else
echo shar: Extracting \"'tripwire-1.0/sigs/md2/md2.h'\" \(1216 characters\)
sed "s/^X//" >'tripwire-1.0/sigs/md2/md2.h' <<'END_OF_FILE'
X/* $Id: md2.h,v 1.1.1.2 92/11/02 18:21:27 genek Exp $ */
X
X/* MD2.H - header file for MD2C.C
X */
X
X/* Copyright (C) 1990-2, RSA Data Security, Inc. Created 1990. All
X   rights reserved.
X
X   License to copy and use this software is granted for
X   non-commercial Internet Privacy-Enhanced Mail provided that it is
X   identified as the "RSA Data Security, Inc. MD2 Message Digest
X   Algorithm" in all material mentioning or referencing this software
X   or this function.
X
X   RSA Data Security, Inc. makes no representations concerning either
X   the merchantability of this software or the suitability of this
X   software for any particular purpose. It is provided "as is"
X   without express or implied warranty of any kind.
X
X   These notices must be retained in any copies of any part of this
X   documentation and/or software.
X */
X
X
X
Xtypedef struct {
X  unsigned char state[16];                                 /* state */
X  unsigned char checksum[16];                           /* checksum */
X  unsigned int count;                 /* number of bytes, modulo 16 */
X  unsigned char buffer[16];                         /* input buffer */
X} MD2_CTX;
X
Xvoid MD2Init ();
Xvoid MD2Update ();
Xvoid MD2Final ();
X
Xint sig_md2_get();
END_OF_FILE
if test 1216 -ne `wc -c <'tripwire-1.0/sigs/md2/md2.h'`; then
    echo shar: \"'tripwire-1.0/sigs/md2/md2.h'\" unpacked with wrong size!
fi
# end of 'tripwire-1.0/sigs/md2/md2.h'
fi
if test -f 'tripwire-1.0/contrib/README.CheckConfig' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'tripwire-1.0/contrib/README.CheckConfig'\"
else
echo shar: Extracting \"'tripwire-1.0/contrib/README.CheckConfig'\" \(1216 characters\)
sed "s/^X//" >'tripwire-1.0/contrib/README.CheckConfig' <<'END_OF_FILE'
XCheckConfig
X
XArguably THE most important step in using tripwire on your system is the
Xcreation of a config file for the host.  The config file for you machine must
Xreflect vendor as well as local file structure conventions.
X
XFor example on suns, /var and /usr are functionally equivelent, except with
Xtripwire which cares that one is a symlink to the other.  Some vendors (NeXT)
Xput network tools such as nslookup in /usr/etc while other vendors (HP) put
Xthem in /usr/bin
X
XOn some installations, the convention is to fill /usr/local with new code, on
Xsome locations /usr/local is full of symlinks which point to new code, some
Xlocations might decide to put new code in /Local.
X
XSince the config file MUST match the flavour of your system, CheckConfig was
Xcreated to parse the tripwire.config file and report anomilies.
X
Xusage::  CheckConfig [-v] file
X
XIn non-verbose mode, CheckConfig reports merely on the existance of symbolic
Xlinks in the file.  This warns you that a symlink instead of a directory
Xhierarchy or file is being monitored by tripwire.
X
XIn verbose mode, CheckConfig also shouts about non-existant files and lists
Xall other entries as either directories or files.
X
XLance Bailey <lrb@ctrg.rri.uwo.ca>
X
END_OF_FILE
if test 1216 -ne `wc -c <'tripwire-1.0/contrib/README.CheckConfig'`; then
    echo shar: \"'tripwire-1.0/contrib/README.CheckConfig'\" unpacked with wrong size!
fi
# end of 'tripwire-1.0/contrib/README.CheckConfig'
fi
if test -f 'tripwire-1.0/aux/types.sh' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'tripwire-1.0/aux/types.sh'\"
else
echo shar: Extracting \"'tripwire-1.0/aux/types.sh'\" \(1153 characters\)
sed "s/^X//" >'tripwire-1.0/aux/types.sh' <<'END_OF_FILE'
X#!/bin/sh
X
X# $Id: types.sh,v 1.1.1.1 92/11/02 17:45:16 genek Exp $
X
X# types.sh
X#
X# glean any missing struct stat typedefs.
X#
X# Gene Kim
X# Purdue University
X# October 18, 1992
X
Xif test ! -x ./types
Xthen
X    echo "You must do 'make' first!"
X    exit 1
Xfi
X
XCPP=${1?"Run from the makefile!"}
X
XTYPES=./ourtypes.h
X
X# build our own local copy of types.h
X
Xcat > gettypes.c << 'GHK'
X#include <sys/stat.h>
X#include <sys/types.h>
XGHK
X$CPP gettypes.c > $TYPES
Xrm -f gettypes.c
X
X# print out banner for inode.h
X
Xcat << 'GHK'
X/*
X * inode.h
X *
X * 	Do not modify this file.  This file was automatically 
X * 	generated by the Tripwire makefile.
X *
X */
X
XGHK
X
X# now start finding the missing typedefs
X
Xgrep mode_t $TYPES > /dev/null 
Xif [ $? -ne 0 ]
Xthen
X    ./types mode_t;
Xfi
X
Xgrep ino_t $TYPES > /dev/null
Xif [ $? -ne 0 ]
Xthen
X    ./types ino_t; 
Xfi
X
Xgrep nlink_t $TYPES > /dev/null
Xif [ $? -ne 0 ]
Xthen
X    ./types nlink_t;
Xfi
X
Xgrep uid_t $TYPES > /dev/null
Xif [ $? -ne 0 ]
Xthen
X    ./types uid_t;
Xfi
X
Xgrep gid_t $TYPES > /dev/null
Xif [ $? -ne 0 ]
Xthen
X    ./types gid_t;
Xfi
X
Xgrep off_t $TYPES > /dev/null
Xif [ $? -ne 0 ]
Xthen
X    ./types off_t;
Xfi
X
Xrm $TYPES
X
Xexit 0;
END_OF_FILE
if test 1153 -ne `wc -c <'tripwire-1.0/aux/types.sh'`; then
    echo shar: \"'tripwire-1.0/aux/types.sh'\" unpacked with wrong size!
fi
chmod +x 'tripwire-1.0/aux/types.sh'
# end of 'tripwire-1.0/aux/types.sh'
fi
if test -f 'tripwire-1.0/configs/conf-mach.h' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'tripwire-1.0/configs/conf-mach.h'\"
else
echo shar: Extracting \"'tripwire-1.0/configs/conf-mach.h'\" \(1119 characters\)
sed "s/^X//" >'tripwire-1.0/configs/conf-mach.h' <<'END_OF_FILE'
X/* $Id: conf-mach.h,v 1.1.1.3 92/11/03 15:38:03 genek Exp $ */
X
X/*
X * conf-mach.h
X *
X *	Tripwire configuration file
X *
X * Peter Shipley
X * TFS (TRW Financial Systems)
X */
X
X/***
X *** Operating System specifics
X ***	
X ***	If the answer to a question in the comment is "Yes", then
X ***	change the corresponding "#undef" to a "#define"
X ***/
X
X/*
X * is your OS a System V derivitive?  if so, what version?
X *			(e.g., define SYSV 4)
X */
X
X#undef SYSV
X
X/* 
X * does your system have a <malloc.h> like System V? 
X */
X
X#undef MALLOCH 	
X
X/* 
X * does your system have a <stdlib.h> like POSIX says you should? 
X */
X
X#undef STDLIBH
X
X/*
X * does your system use readdir(3) that returns (struct dirent *)?
X */
X
X/* MACH has readdir(3) but no include file <dirent.h> */
X#undef DIRENT
X
X/*
X * is #include <string.h> ok?  (as opposed to <strings.h>)
X */
X
X#define STRINGH
X
X/* 
X * does your system have gethostname(2) (instead of uname(2))?
X */
X
X#define GETHOSTNAME
X
X
X/*
X * miscellaneous stuff
X */
X
X#define MACH 1
X
X/* MACH seems to be missing the define for S_IFIFO [but is had S_ISFIFO() ] */
X#ifndef S_IFIFO
X#define S_IFIFO 0010000
X#endif
X
X
END_OF_FILE
if test 1119 -ne `wc -c <'tripwire-1.0/configs/conf-mach.h'`; then
    echo shar: \"'tripwire-1.0/configs/conf-mach.h'\" unpacked with wrong size!
fi
# end of 'tripwire-1.0/configs/conf-mach.h'
fi
if test -f 'tripwire-1.0/configs/conf-unicos.h' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'tripwire-1.0/configs/conf-unicos.h'\"
else
echo shar: Extracting \"'tripwire-1.0/configs/conf-unicos.h'\" \(1034 characters\)
sed "s/^X//" >'tripwire-1.0/configs/conf-unicos.h' <<'END_OF_FILE'
X/* $Id: conf-unicos.h,v 1.1.1.3 92/11/03 15:39:37 genek Exp $ */
X
X/*
X * conf-unicos.h
X *
X *	Tripwire configuration file
X *
X * Gene Kim
X * Purdue University
X *
X * Unicos port by:
X *	Michael Barnett <rxxmnb@argolis.osf.rmit.OZ.AU>
X */
X
X/***
X *** Operating System specifics
X ***	
X ***	If the answer to a question in the comment is "Yes", then
X ***	change the corresponding "#undef" to a "#define"
X ***/
X
X/*
X * is your OS a System V derivitive?  if so, what version?
X *			(e.g., define SYSV 4)
X */
X
X#define SYSV 3
X
X/* 
X * does your system have a <malloc.h> like System V? 
X */
X
X#define MALLOCH 	
X
X/* 
X * does your system have a <stdlib.h> like POSIX says you should? 
X */
X
X#define STDLIBH
X
X/*
X * does your system use readdir(3) that returns (struct dirent *)?
X */
X
X#define DIRENT
X
X/*
X * is #include <string.h> ok?  (as opposed to <strings.h>)
X */
X
X#define STRINGH
X 
X/* 
X * does your system have gethostname(2) (instead of uname(2))?
X */
X
X#undef GETHOSTNAME
X
X/*
X * miscallaneous stuff -mnb 
X */
X
X#define UNICOS
X#define MAXPATHLEN PATH_MAX
END_OF_FILE
if test 1034 -ne `wc -c <'tripwire-1.0/configs/conf-unicos.h'`; then
    echo shar: \"'tripwire-1.0/configs/conf-unicos.h'\" unpacked with wrong size!
fi
# end of 'tripwire-1.0/configs/conf-unicos.h'
fi
if test -f 'tripwire-1.0/sigs/md5/md5.h' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'tripwire-1.0/sigs/md5/md5.h'\"
else
echo shar: Extracting \"'tripwire-1.0/sigs/md5/md5.h'\" \(1019 characters\)
sed "s/^X//" >'tripwire-1.0/sigs/md5/md5.h' <<'END_OF_FILE'
X/***********************************************************************
X ** md5.h -- header file for implementation of MD5                    **
X ** RSA Data Security, Inc. MD5 Message-Digest Algorithm              **
X ** Created: 2/17/90 RLR                                              **
X ** Revised: 12/27/90 SRD,AJ,BSK,JT Reference C version               **
X ** Revised (for MD5): RLR 4/27/91                                    **
X **********************************************************************/
X/* typedef a 32-bit type */
Xtypedef unsigned long int UINT4;
X
X/* Data structure for MD5 (Message-Digest) computation */
Xtypedef struct {
X  UINT4 i[2];                   /* number of _bits_ handled mod 2^64 */
X  UINT4 buf[4];                                    /* scratch buffer */
X  unsigned char in[64];                              /* input buffer */
X  unsigned char digest[16];     /* actual digest after MD5Final call */
X} MD5_CTX;
X
Xvoid MD5Init();
Xvoid MD5Update();
Xvoid MD5Final();
X
Xint sig_md5_get();
END_OF_FILE
if test 1019 -ne `wc -c <'tripwire-1.0/sigs/md5/md5.h'`; then
    echo shar: \"'tripwire-1.0/sigs/md5/md5.h'\" unpacked with wrong size!
fi
# end of 'tripwire-1.0/sigs/md5/md5.h'
fi
if test -f 'tripwire-1.0/configs/conf-umaxv.h' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'tripwire-1.0/configs/conf-umaxv.h'\"
else
echo shar: Extracting \"'tripwire-1.0/configs/conf-umaxv.h'\" \(1019 characters\)
sed "s/^X//" >'tripwire-1.0/configs/conf-umaxv.h' <<'END_OF_FILE'
X/* $Id: conf-umaxv.h,v 1.1.1.3 92/11/03 15:39:28 genek Exp $ */
X
X/*
X * conf-umaxv.h
X *
X *	Tripwire configuration file
X *
X * Gene Kim
X * Purdue University
X *
X * Modified by Michael Barnett (mikeb@rmit.edu.au) for UMAX V R2.4.1.
X *
X */
X
X/***
X *** Operating System specifics
X ***	
X ***	If the answer to a question in the comment is "Yes", then
X ***	change the corresponding "#undef" to a "#define"
X ***/
X
X/*
X * is your OS a System V derivitive?  if so, what version?
X *			(e.g., define SYSV 4)
X */
X
X#define SYSV 2
X
X/* 
X * does your system have a <malloc.h> like System V? 
X */
X
X#define MALLOCH 	
X
X/* 
X * does your system have a <stdlib.h> like POSIX says you should? 
X */
X
X#undef STDLIBH
X
X/*
X * does your system use readdir(3) that returns (struct dirent *)?
X */
X
X#define DIRENT
X
X/*
X * is #include <string.h> ok?  (as opposed to <strings.h>)
X */
X
X#define STRINGH
X 
X/* 
X * does your system have gethostname(2) (instead of uname(2))?
X */
X
X#undef GETHOSTNAME
X
X/*
X * miscellaneous stuff - mnb
X */
X
X#define MAXPATHLEN PATH_MAX
END_OF_FILE
if test 1019 -ne `wc -c <'tripwire-1.0/configs/conf-umaxv.h'`; then
    echo shar: \"'tripwire-1.0/configs/conf-umaxv.h'\" unpacked with wrong size!
fi
# end of 'tripwire-1.0/configs/conf-umaxv.h'
fi
if test -f 'tripwire-1.0/configs/conf-aux3.h' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'tripwire-1.0/configs/conf-aux3.h'\"
else
echo shar: Extracting \"'tripwire-1.0/configs/conf-aux3.h'\" \(1014 characters\)
sed "s/^X//" >'tripwire-1.0/configs/conf-aux3.h' <<'END_OF_FILE'
X/* $Id: conf-aux3.h,v 1.1.1.3 92/11/03 15:37:27 genek Exp $ */
X
X/*
X * conf-aux3.h
X *
X *	Tripwire configuration file
X *
X * Gene Kim
X * Purdue University
X *
X * A/UX port provided by:
X *	Phillip Porch (root@raidernet.com)
X */
X
X/***
X *** Operating System specifics
X ***	
X ***	If the answer to a question in the comment is "Yes", then
X ***	change the corresponding "#undef" to a "#define"
X ***/
X
X/*
X * is your OS a System V derivitive?  if so, what version?
X *			(e.g., define SYSV 4)
X */
X
X#define SYSV 2
X
X/* 
X * does your system have a <malloc.h> like System V? 
X */
X
X#define MALLOCH 	
X
X/* 
X * does your system have a <stdlib.h> like POSIX says you should? 
X */
X
X/* #define STDLIBH */
X
X/*
X * does your system use readdir(3) that returns (struct dirent *)?
X */
X
X#define DIRENT
X
X/*
X * is #include <string.h> ok?  (as opposed to <strings.h>)
X */
X
X#define STRINGH 
X 
X/* 
X * does your system have gethostname(2) (instead of uname(2))?
X */
X
X#undef GETHOSTNAME
X
X/*
X * missing defines 
X */
X
X/* #define MAXPATHLEN PATH_MAX */
X
END_OF_FILE
if test 1014 -ne `wc -c <'tripwire-1.0/configs/conf-aux3.h'`; then
    echo shar: \"'tripwire-1.0/configs/conf-aux3.h'\" unpacked with wrong size!
fi
# end of 'tripwire-1.0/configs/conf-aux3.h'
fi
if test -f 'tripwire-1.0/configs/conf-hpux.h' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'tripwire-1.0/configs/conf-hpux.h'\"
else
echo shar: Extracting \"'tripwire-1.0/configs/conf-hpux.h'\" \(995 characters\)
sed "s/^X//" >'tripwire-1.0/configs/conf-hpux.h' <<'END_OF_FILE'
X/* $Id: conf-hpux.h,v 1.1.1.3 92/11/03 15:37:52 genek Exp $ */
X
X/*
X * conf-hpux.h
X *
X *      Tripwire configuration file
X *
X * Gene Kim
X * Purdue University
X *
X * HP/UX port by:
X * 	Lance Bailey <lrb@ctrg.rri.uwo.ca>
X */
X
X#define _HPUX_SOURCE
X
X/***
X *** Operating System specifics
X ***    
X ***    If the answer to a question in the comment is "Yes", then
X ***    change the corresponding "#undef" to a "#define"
X ***/
X
X/*
X * is your OS a System V derivitive?  if so, what version?
X *                      (e.g., define SYSV 4)
X */
X
X#undef SYSV
X
X/* 
X * does your system have a <malloc.h> like System V? 
X */
X
X#define MALLOCH         
X
X/* 
X * does your system have a <stdlib.h> like POSIX says you should? 
X */
X
X#define STDLIBH
X
X/*
X * does your system use readdir(3) that returns (struct dirent *)?
X */
X
X#define DIRENT
X
X/*
X * is #include <string.h> ok?  (as opposed to <strings.h>)
X */
X
X#define STRINGH
X
X/* 
X * does your system have gethostname(2) (instead of uname(2))?
X */
X
X#define GETHOSTNAME
END_OF_FILE
if test 995 -ne `wc -c <'tripwire-1.0/configs/conf-hpux.h'`; then
    echo shar: \"'tripwire-1.0/configs/conf-hpux.h'\" unpacked with wrong size!
fi
# end of 'tripwire-1.0/configs/conf-hpux.h'
fi
if test -f 'tripwire-1.0/src/nullsig.c' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'tripwire-1.0/src/nullsig.c'\"
else
echo shar: Extracting \"'tripwire-1.0/src/nullsig.c'\" \(992 characters\)
sed "s/^X//" >'tripwire-1.0/src/nullsig.c' <<'END_OF_FILE'
X#ifndef lint
Xstatic char rcsid[] = "$Id: nullsig.c,v 1.2 92/11/03 02:43:55 genek Exp $";
X#endif
X
X/*
X * nullsig.c
X *
X *	hook for null signature
X *
X * Gene Kim
X * Purdue University
X */
X
X#include "../include/config.h"
X#include <stdio.h>
X#ifdef STDLIBH
X#include <stdlib.h>
X#include <unistd.h>
X#endif
X#include <sys/types.h>
X#include <sys/stat.h>
X#include "../include/tripwire.h"
X#include "../include/sigs.h"
X
X/*
X * int
X * pf_signature(int fd_in, char *ps_signature, int siglen)
X *
X *	fd_in: 		pointer to input file descriptor
X *	ps_signature: 	pointer to array where signature will be stored
X *	siglen: 	length of the signature array (for overflow checking)
X */
X
Xint
Xsig_null_get (fd_in, ps_signature, siglen)
X    int fd_in;
X    char *ps_signature;
X    int siglen;
X{
X    /* rewind the file descriptor */
X    if (lseek(fd_in, 0, SEEK_SET) < 0) {
X	die_with_err("sig_null_get: lseek()", (char *) NULL);
X    }
X
X    /* lint pacifier */
X    siglen += 0;
X
X    sprintf(ps_signature, "0");
X    return 0;
X}
END_OF_FILE
if test 992 -ne `wc -c <'tripwire-1.0/src/nullsig.c'`; then
    echo shar: \"'tripwire-1.0/src/nullsig.c'\" unpacked with wrong size!
fi
# end of 'tripwire-1.0/src/nullsig.c'
fi
if test -f 'tripwire-1.0/configs/conf-aix.h' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'tripwire-1.0/configs/conf-aix.h'\"
else
echo shar: Extracting \"'tripwire-1.0/configs/conf-aix.h'\" \(985 characters\)
sed "s/^X//" >'tripwire-1.0/configs/conf-aix.h' <<'END_OF_FILE'
X/* $Id: conf-aix.h,v 1.1.1.3 92/11/03 15:37:20 genek Exp $ */
X
X/*
X * conf-aix.h
X *
X *	Tripwire configuration file
X *
X * Gene Kim
X * Purdue University
X */
X
X/***
X *** Operating System specifics
X ***	
X ***	If the answer to a question in the comment is "Yes", then
X ***	change the corresponding "#undef" to a "#define"
X ***/
X
X/*
X * is your OS a System V derivitive?  if so, what version?
X *			(e.g., define SYSV 4)
X */
X
X#undef SYSV
X
X/* 
X * does your system have a <malloc.h> like System V? 
X */
X
X#undef MALLOCH 	
X
X/* 
X * does your system have a <stdlib.h> like POSIX says you should? 
X */
X
X#undef STDLIBH
X
X/* 
X * does your system have gethostname(2) (instead of uname(2))?
X */
X
X#define GETHOSTNAME
X
X/*
X * does your system use readdir(3) that returns (struct dirent *)?
X */
X
X#define DIRENT
X
X/*
X * is #include <string.h> ok?  (as opposed to <strings.h>)
X */
X
X#define STRINGH
X 
X/* 
X * miscellaneous stuff
X *
X *	AIX redefines much of <sys/types> typedefs as unsigned longs.
X */
X
X#define AIX		
END_OF_FILE
if test 985 -ne `wc -c <'tripwire-1.0/configs/conf-aix.h'`; then
    echo shar: \"'tripwire-1.0/configs/conf-aix.h'\" unpacked with wrong size!
fi
# end of 'tripwire-1.0/configs/conf-aix.h'
fi
if test -f 'tripwire-1.0/configs/conf-xenix.h' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'tripwire-1.0/configs/conf-xenix.h'\"
else
echo shar: Extracting \"'tripwire-1.0/configs/conf-xenix.h'\" \(977 characters\)
sed "s/^X//" >'tripwire-1.0/configs/conf-xenix.h' <<'END_OF_FILE'
X/* $Id: conf-xenix.h,v 1.1.1.3 92/11/03 15:39:45 genek Exp $ */
X
X/*
X * conf-xenix.h
X *
X *	Tripwire configuration file
X *
X * Gene Kim
X * Purdue University
X *
X * Xenix port by:
X *	Daniel Ray <norstar@tnl.com>
X */
X
X/***
X *** Operating System specifics
X ***	
X ***	If the answer to a question in the comment is "Yes", then
X ***	change the corresponding "#undef" to a "#define"
X ***/
X
X/*
X * is your OS a System V derivitive?  if so, what version?
X *			(e.g., define SYSV 4)
X */
X
X#define SYSV 3
X
X/* 
X * does your system have a <malloc.h> like System V? 
X */
X
X#define MALLOCH 	
X
X/* 
X * does your system have a <stdlib.h> like POSIX says you should? 
X */
X
X#define STDLIBH
X
X/*
X * does your system use readdir(3) that returns (struct dirent *)?
X */
X
X#undef DIRENT
X
X/*
X * is #include <string.h> ok?  (as opposed to <strings.h>)
X */
X
X#define STRINGH
X 
X/* 
X * does your system have gethostname(2) (instead of uname(2))?
X */
X
X#undef GETHOSTNAME
X
X/*
X * miscallaneous stuff 
X */
X
X#define XENIX
END_OF_FILE
if test 977 -ne `wc -c <'tripwire-1.0/configs/conf-xenix.h'`; then
    echo shar: \"'tripwire-1.0/configs/conf-xenix.h'\" unpacked with wrong size!
fi
# end of 'tripwire-1.0/configs/conf-xenix.h'
fi
if test -f 'tripwire-1.0/configs/conf-convex.h' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'tripwire-1.0/configs/conf-convex.h'\"
else
echo shar: Extracting \"'tripwire-1.0/configs/conf-convex.h'\" \(961 characters\)
sed "s/^X//" >'tripwire-1.0/configs/conf-convex.h' <<'END_OF_FILE'
X/* $Id: conf-convex.h,v 1.1.1.3 92/11/03 15:37:36 genek Exp $ */
X
X/*
X * conf-convex.h
X *
X *	Tripwire configuration file
X *
X * Gene Kim
X * Purdue University
X * 
X * Ported to COnvexos 9.1 
X *	by Adrian P van Bloois at ACCU <adrian@cc.ruu.nl>
X */
X
X/***
X *** Operating System specifics
X ***	
X ***	If the answer to a question in the comment is "Yes", then
X ***	change the corresponding "#undef" to a "#define"
X ***/
X
X/*
X * is your OS a System V derivitive?  if so, what version?
X *			(e.g., define SYSV 4)
X */
X
X#undef SYSV
X
X/* 
X * does your system have a <malloc.h> like System V? 
X */
X
X#undef MALLOCH 	
X
X/* 
X * does your system have a <stdlib.h> like POSIX says you should? 
X */
X
X#define STDLIBH
X
X/*
X * does your system use readdir(3) that returns (struct dirent *)?
X */
X
X#define DIRENT
X
X/*
X * is #include <string.h> ok?  (as opposed to <strings.h>)
X */
X
X#define STRINGH
X 
X/* 
X * does your system have gethostname(2) (instead of uname(2))?
X */
X
X#define GETHOSTNAME
END_OF_FILE
if test 961 -ne `wc -c <'tripwire-1.0/configs/conf-convex.h'`; then
    echo shar: \"'tripwire-1.0/configs/conf-convex.h'\" unpacked with wrong size!
fi
# end of 'tripwire-1.0/configs/conf-convex.h'
fi
if test -f 'tripwire-1.0/configs/conf-riscos.h' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'tripwire-1.0/configs/conf-riscos.h'\"
else
echo shar: Extracting \"'tripwire-1.0/configs/conf-riscos.h'\" \(960 characters\)
sed "s/^X//" >'tripwire-1.0/configs/conf-riscos.h' <<'END_OF_FILE'
X/* $Id: conf-riscos.h,v 1.1.1.3 92/11/03 15:38:43 genek Exp $ */
X
X/*
X * conf-riscos4.h (for SYSTYPE_BSD43)
X *
X *	Tripwire configuration file
X *
X * Gene Kim
X * Purdue University
X *
X * Ported to RiscOS 
X *	Harlan Stenn <harlan@mumps.pfcs.com>
X */
X
X/***
X *** Operating System specifics
X ***	
X ***	If the answer to a question in the comment is "Yes", then
X ***	change the corresponding "#undef" to a "#define"
X ***/
X
X/*
X * is your OS a System V derivitive?  if so, what version?
X *			(e.g., define SYSV 4)
X */
X
X#undef SYSV
X
X/* 
X * does your system have a <malloc.h> like System V? 
X */
X
X#undef MALLOCH 	
X
X/* 
X * does your system have a <stdlib.h> like POSIX says you should? 
X */
X
X#undef STDLIBH
X
X/*
X * does your system use readdir(3) that returns (struct dirent *)?
X */
X
X#undef DIRENT
X
X/*
X * is #include <string.h> ok?  (as opposed to <strings.h>)
X */
X
X#define STRINGH
X 
X/* 
X * does your system have gethostname(2) (instead of uname(2))?
X */
X
X#define GETHOSTNAME
END_OF_FILE
if test 960 -ne `wc -c <'tripwire-1.0/configs/conf-riscos.h'`; then
    echo shar: \"'tripwire-1.0/configs/conf-riscos.h'\" unpacked with wrong size!
fi
# end of 'tripwire-1.0/configs/conf-riscos.h'
fi
if test -f 'tripwire-1.0/configs/conf-irix4.h' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'tripwire-1.0/configs/conf-irix4.h'\"
else
echo shar: Extracting \"'tripwire-1.0/configs/conf-irix4.h'\" \(951 characters\)
sed "s/^X//" >'tripwire-1.0/configs/conf-irix4.h' <<'END_OF_FILE'
X/* $Id: conf-irix4.h,v 1.1.1.3 92/11/03 15:37:56 genek Exp $ */
X
X/*
X * conf-irix4.h
X *
X *	Tripwire configuration file
X *
X * Gene Kim
X * Purdue University
X *
X * IRIX4 port by:
X * 	Simon Leinen <simon@lia.di.epfl.ch>
X * 	Ecole Polytechnique Federale de Lausanne
X */
X
X/***
X *** Operating System specifics
X ***	
X ***	If the answer to a question in the comment is "Yes", then
X ***	change the corresponding "#undef" to a "#define"
X ***/
X
X/*
X * is your OS a System V derivitive?  if so, what version?
X *			(e.g., define SYSV 4)
X */
X
X#define SYSV 3
X
X/* 
X * does your system have a <malloc.h> like System V? 
X */
X
X#define MALLOCH 	
X
X/* 
X * does your system have a <stdlib.h> like POSIX says you should? 
X */
X
X#define STDLIBH
X
X/*
X * does your system use readdir(3) that returns (struct dirent *)?
X */
X
X#define DIRENT
X
X/*
X * does your system have lstat()
X */
X#define HAVE_LSTAT
X
X/*
X * is #include <string.h> ok?  (as opposed to <strings.h>)
X */
X
X#define STRINGH
END_OF_FILE
if test 951 -ne `wc -c <'tripwire-1.0/configs/conf-irix4.h'`; then
    echo shar: \"'tripwire-1.0/configs/conf-irix4.h'\" unpacked with wrong size!
fi
# end of 'tripwire-1.0/configs/conf-irix4.h'
fi
if test -f 'tripwire-1.0/configs/conf-svr3.h' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'tripwire-1.0/configs/conf-svr3.h'\"
else
echo shar: Extracting \"'tripwire-1.0/configs/conf-svr3.h'\" \(936 characters\)
sed "s/^X//" >'tripwire-1.0/configs/conf-svr3.h' <<'END_OF_FILE'
X/* $Id: conf-svr3.h,v 1.1.1.3 92/11/03 15:39:10 genek Exp $ */
X
X/*
X * conf-svr3.h
X *
X *	Tripwire configuration file
X *
X * Gene Kim
X * Purdue University
X *
X */
X
X/***
X *** Operating System specifics
X ***	
X ***	If the answer to a question in the comment is "Yes", then
X ***	change the corresponding "#undef" to a "#define"
X ***/
X
X/*
X * is your OS a System V derivitive?  if so, what version?
X *			(e.g., define SYSV 4)
X */
X
X#define SYSV 3
X
X/* 
X * does your system have a <malloc.h> like System V? 
X */
X
X#define MALLOCH 	
X
X/* 
X * does your system have a <stdlib.h> like POSIX says you should? 
X */
X
X#define STDLIBH
X
X/*
X * does your system use readdir(3) that returns (struct dirent *)?
X */
X
X#define DIRENT
X
X/*
X * is #include <string.h> ok?  (as opposed to <strings.h>)
X */
X
X#define STRINGH
X 
X/* 
X * does your system have gethostname(2) (instead of uname(2))?
X */
X
X#undef GETHOSTNAME
X
X/*
X * missing defines 
X */
X
X#define MAXPATHLEN PATH_MAX
END_OF_FILE
if test 936 -ne `wc -c <'tripwire-1.0/configs/conf-svr3.h'`; then
    echo shar: \"'tripwire-1.0/configs/conf-svr3.h'\" unpacked with wrong size!
fi
# end of 'tripwire-1.0/configs/conf-svr3.h'
fi
if test -f 'tripwire-1.0/configs/conf-osf1.h' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'tripwire-1.0/configs/conf-osf1.h'\"
else
echo shar: Extracting \"'tripwire-1.0/configs/conf-osf1.h'\" \(921 characters\)
sed "s/^X//" >'tripwire-1.0/configs/conf-osf1.h' <<'END_OF_FILE'
X/* $Id: conf-osf1.h,v 1.1.1.3 92/11/03 15:38:10 genek Exp $ */
X
X/*
X * conf-osf1.h
X *
X *	Tripwire configuration file
X *
X * Gene Kim
X * Purdue University
X *
X * OSF/1 port by:
X *	Rich Salz <rsalz@osf.org>
X */
X
X/***
X *** Operating System specifics
X ***	
X ***	If the answer to a question in the comment is "Yes", then
X ***	change the corresponding "#undef" to a "#define"
X ***/
X
X/*
X * is your OS a System V derivitive?  if so, what version?
X *			(e.g., define SYSV 4)
X */
X
X#undef SYSV
X
X/* 
X * does your system have a <malloc.h> like System V? 
X */
X
X#undef MALLOCH 	
X
X/* 
X * does your system have a <stdlib.h> like POSIX says you should? 
X */
X
X#undef STDLIBH
X
X/* 
X * does your system have gethostname(2) (instead of uname(2))?
X */
X
X#define GETHOSTNAME
X
X/*
X * does your system use readdir(3) that returns (struct dirent *)?
X */
X
X#define DIRENT
X
X/*
X * is #include <string.h> ok?  (as opposed to <strings.h>)
X */
X
X#define STRINGH
END_OF_FILE
if test 921 -ne `wc -c <'tripwire-1.0/configs/conf-osf1.h'`; then
    echo shar: \"'tripwire-1.0/configs/conf-osf1.h'\" unpacked with wrong size!
fi
# end of 'tripwire-1.0/configs/conf-osf1.h'
fi
if test -f 'tripwire-1.0/configs/conf-sunos-4.0.h' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'tripwire-1.0/configs/conf-sunos-4.0.h'\"
else
echo shar: Extracting \"'tripwire-1.0/configs/conf-sunos-4.0.h'\" \(914 characters\)
sed "s/^X//" >'tripwire-1.0/configs/conf-sunos-4.0.h' <<'END_OF_FILE'
X/* $Id: conf-sunos-4.0.h,v 1.1.1.3 92/11/03 15:38:57 genek Exp $ */
X
X/*
X * conf-sunos-4.0.h  (SunOS versions prior to 4.1)
X *
X *	Tripwire configuration file
X *
X * Gene Kim
X * Purdue University
X */
X
X/***
X *** Operating System specifics
X ***	
X ***	If the answer to a question in the comment is "Yes", then
X ***	change the corresponding "#undef" to a "#define"
X ***/
X
X/*
X * is your OS a System V derivitive?  if so, what version?
X *			(e.g., define SYSV 4)
X */
X
X#undef SYSV
X
X/* 
X * does your system have a <malloc.h> like System V? 
X */
X
X#define MALLOCH 	
X
X/* 
X * does your system have a <stdlib.h> like POSIX says you should? 
X */
X
X#undef STDLIBH
X
X/*
X * does your system use readdir(3) that returns (struct dirent *)?
X */
X
X#define DIRENT
X
X/*
X * is #include <string.h> ok?  (as opposed to <strings.h>)
X */
X
X#define STRINGH
X 
X/* 
X * does your system have gethostname(2) (instead of uname(2))?
X */
X
X#define GETHOSTNAME
END_OF_FILE
if test 914 -ne `wc -c <'tripwire-1.0/configs/conf-sunos-4.0.h'`; then
    echo shar: \"'tripwire-1.0/configs/conf-sunos-4.0.h'\" unpacked with wrong size!
fi
# end of 'tripwire-1.0/configs/conf-sunos-4.0.h'
fi
if test -f 'tripwire-1.0/configs/conf-sunos-4.1.h' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'tripwire-1.0/configs/conf-sunos-4.1.h'\"
else
echo shar: Extracting \"'tripwire-1.0/configs/conf-sunos-4.1.h'\" \(909 characters\)
sed "s/^X//" >'tripwire-1.0/configs/conf-sunos-4.1.h' <<'END_OF_FILE'
X/* $Id: conf-sunos-4.1.h,v 1.1.1.3 92/11/03 15:39:03 genek Exp $ */
X
X/*
X * conf-sunos-4.1.h  (SunOS versions >= 4.1)
X *
X *	Tripwire configuration file
X *
X * Gene Kim
X * Purdue University
X */
X
X/***
X *** Operating System specifics
X ***	
X ***	If the answer to a question in the comment is "Yes", then
X ***	change the corresponding "#undef" to a "#define"
X ***/
X
X/*
X * is your OS a System V derivitive?  if so, what version?
X *			(e.g., define SYSV 4)
X */
X
X#undef SYSV
X
X/* 
X * does your system have a <malloc.h> like System V? 
X */
X
X#define MALLOCH 	
X
X/* 
X * does your system have a <stdlib.h> like POSIX says you should? 
X */
X
X#define STDLIBH
X
X/*
X * does your system use readdir(3) that returns (struct dirent *)?
X */
X
X#define DIRENT
X
X/*
X * is #include <string.h> ok?  (as opposed to <strings.h>)
X */
X
X#define STRINGH
X 
X/* 
X * does your system have gethostname(2) (instead of uname(2))?
X */
X
X#define GETHOSTNAME
END_OF_FILE
if test 909 -ne `wc -c <'tripwire-1.0/configs/conf-sunos-4.1.h'`; then
    echo shar: \"'tripwire-1.0/configs/conf-sunos-4.1.h'\" unpacked with wrong size!
fi
# end of 'tripwire-1.0/configs/conf-sunos-4.1.h'
fi
if test -f 'tripwire-1.0/configs/conf-svr4.h' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'tripwire-1.0/configs/conf-svr4.h'\"
else
echo shar: Extracting \"'tripwire-1.0/configs/conf-svr4.h'\" \(876 characters\)
sed "s/^X//" >'tripwire-1.0/configs/conf-svr4.h' <<'END_OF_FILE'
X/* $Id: conf-svr4.h,v 1.1.1.3 92/11/03 15:39:18 genek Exp $ */
X
X/*
X * conf-svr4.h
X *
X *	Tripwire configuration file
X *
X * Gene Kim
X * Purdue University
X */
X
X/***
X *** Operating System specifics
X ***	
X ***	If the answer to a question in the comment is "Yes", then
X ***	change the corresponding "#undef" to a "#define"
X ***/
X
X/*
X * is your OS a System V derivitive?  if so, what version?
X *			(e.g., define SYSV 4)
X */
X
X#define SYSV 4
X
X/* 
X * does your system have a <malloc.h> like System V? 
X */
X
X#define MALLOCH 	
X
X/* 
X * does your system have a <stdlib.h> like POSIX says you should? 
X */
X
X#define STDLIBH
X
X/*
X * does your system use readdir(3) that returns (struct dirent *)?
X */
X
X#define DIRENT
X
X/*
X * is #include <string.h> ok?  (as opposed to <strings.h>)
X */
X
X#define STRINGH
X 
X/* 
X * does your system have gethostname(2) (instead of uname(2))?
X */
X
X#undef GETHOSTNAME
END_OF_FILE
if test 876 -ne `wc -c <'tripwire-1.0/configs/conf-svr4.h'`; then
    echo shar: \"'tripwire-1.0/configs/conf-svr4.h'\" unpacked with wrong size!
fi
# end of 'tripwire-1.0/configs/conf-svr4.h'
fi
if test -f 'tripwire-1.0/configs/conf-dynix.h' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'tripwire-1.0/configs/conf-dynix.h'\"
else
echo shar: Extracting \"'tripwire-1.0/configs/conf-dynix.h'\" \(873 characters\)
sed "s/^X//" >'tripwire-1.0/configs/conf-dynix.h' <<'END_OF_FILE'
X/* $Id: conf-dynix.h,v 1.1.1.3 92/11/03 15:37:43 genek Exp $ */
X
X/*
X * conf-dynix.h
X *
X *	Tripwire configuration file
X *
X * Gene Kim
X * Purdue University
X */
X
X/***
X *** Operating System specifics
X ***	
X ***	If the answer to a question in the comment is "Yes", then
X ***	change the corresponding "#undef" to a "#define"
X ***/
X
X/*
X * is your OS a System V derivitive?  if so, what version?
X *			(e.g., define SYSV 4)
X */
X
X#undef SYSV
X
X/* 
X * does your system have a <malloc.h> like System V? 
X */
X
X#undef MALLOCH 	
X
X/* 
X * does your system have a <stdlib.h> like POSIX says you should? 
X */
X
X#undef STDLIBH
X
X/*
X * does your system use readdir(3) that returns (struct dirent *)?
X */
X
X#undef DIRENT
X
X/*
X * is #include <string.h> ok?  (as opposed to <strings.h>)
X */
X
X#define STRINGH
X 
X/* 
X * does your system have gethostname(2) (instead of uname(2))?
X */
X
X#define GETHOSTNAME
END_OF_FILE
if test 873 -ne `wc -c <'tripwire-1.0/configs/conf-dynix.h'`; then
    echo shar: \"'tripwire-1.0/configs/conf-dynix.h'\" unpacked with wrong size!
fi
# end of 'tripwire-1.0/configs/conf-dynix.h'
fi
if test -f 'tripwire-1.0/configs/conf-bsd.h' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'tripwire-1.0/configs/conf-bsd.h'\"
else
echo shar: Extracting \"'tripwire-1.0/configs/conf-bsd.h'\" \(869 characters\)
sed "s/^X//" >'tripwire-1.0/configs/conf-bsd.h' <<'END_OF_FILE'
X/* $Id: conf-bsd.h,v 1.1.1.3 92/11/03 15:37:31 genek Exp $ */
X
X/*
X * conf-bsd.h
X *
X *	Tripwire configuration file
X *
X * Gene Kim
X * Purdue University
X */
X
X/***
X *** Operating System specifics
X ***	
X ***	If the answer to a question in the comment is "Yes", then
X ***	change the corresponding "#undef" to a "#define"
X ***/
X
X/*
X * is your OS a System V derivitive?  if so, what version?
X *			(e.g., define SYSV 4)
X */
X
X#undef SYSV
X
X/* 
X * does your system have a <malloc.h> like System V? 
X */
X
X#undef MALLOCH 	
X
X/* 
X * does your system have a <stdlib.h> like POSIX says you should? 
X */
X
X#undef STDLIBH
X
X/*
X * does your system use readdir(3) that returns (struct dirent *)?
X */
X
X#undef DIRENT
X
X/*
X * is #include <string.h> ok?  (as opposed to <strings.h>)
X */
X
X#define STRINGH
X 
X/* 
X * does your system have gethostname(2) (instead of uname(2))?
X */
X
X#define GETHOSTNAME
END_OF_FILE
if test 869 -ne `wc -c <'tripwire-1.0/configs/conf-bsd.h'`; then
    echo shar: \"'tripwire-1.0/configs/conf-bsd.h'\" unpacked with wrong size!
fi
# end of 'tripwire-1.0/configs/conf-bsd.h'
fi
if test -f 'tripwire-1.0/sigs/md2/global.h' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'tripwire-1.0/sigs/md2/global.h'\"
else
echo shar: Extracting \"'tripwire-1.0/sigs/md2/global.h'\" \(858 characters\)
sed "s/^X//" >'tripwire-1.0/sigs/md2/global.h' <<'END_OF_FILE'
X/* $Id: global.h,v 1.1.1.2 92/11/02 18:21:18 genek Exp $ */
X
X/* GLOBAL.H - RSAREF types and constants
X */
X
X/* PROTOTYPES should be set to one if and only if the compiler supports
X     function argument prototyping.
X   The following makes PROTOTYPES default to 0 if it has not already
X     been defined with C compiler flags.
X */
X
X#ifndef PROTOTYPES
X#define PROTOTYPES 0
X#endif
X
X/* POINTER defines a generic pointer type */
Xtypedef unsigned char *POINTER;
X
X/* UINT2 defines a two byte word */
Xtypedef unsigned short int UINT2;
X
X/* UINT4 defines a four byte word */
Xtypedef unsigned long int UINT4;
X
X/* PROTO_LIST is defined depending on how PROTOTYPES is defined above.
X   If using PROTOTYPES, then PROTO_LIST returns the list, otherwise it
X     returns an empty list.
X */
X#if PROTOTYPES
X#define PROTO_LIST(list) list
X#else
X#define PROTO_LIST(list) ()
X#endif
END_OF_FILE
if test 858 -ne `wc -c <'tripwire-1.0/sigs/md2/global.h'`; then
    echo shar: \"'tripwire-1.0/sigs/md2/global.h'\" unpacked with wrong size!
fi
# end of 'tripwire-1.0/sigs/md2/global.h'
fi
if test -f 'tripwire-1.0/configs/conf-epix.h' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'tripwire-1.0/configs/conf-epix.h'\"
else
echo shar: Extracting \"'tripwire-1.0/configs/conf-epix.h'\" \(844 characters\)
sed "s/^X//" >'tripwire-1.0/configs/conf-epix.h' <<'END_OF_FILE'
X/* $Id: conf-epix.h,v 1.1.1.3 92/11/03 15:37:47 genek Exp $ */
X
X/*
X * conf-umips.h
X *
X *	Tripwire configuration file
X *
X */
X
X/***
X *** Operating System specifics
X ***	
X ***	If the answer to a question in the comment is "Yes", then
X ***	change the corresponding "#undef" to a "#define"
X ***/
X
X/*
X * is your OS a System V derivitive?  if so, what version?
X *			(e.g., define SYSV 4)
X */
X
X#define SYSV 4
X
X/* 
X * does your system have a <malloc.h> like System V? 
X */
X
X#define MALLOCH 	
X
X/* 
X * does your system have a <stdlib.h> like POSIX says you should? 
X */
X
X#undef STDLIBH
X
X/*
X * does your system use readdir(3) that returns (struct dirent *)?
X */
X
X#define DIRENT
X
X/*
X * is #include <string.h> ok?  (as opposed to <strings.h>)
X */
X
X#define STRINGH
X
X/* 
X * does your system have gethostname(2) (instead of uname(2))?
X */
X
X#define GETHOSTNAME
X
END_OF_FILE
if test 844 -ne `wc -c <'tripwire-1.0/configs/conf-epix.h'`; then
    echo shar: \"'tripwire-1.0/configs/conf-epix.h'\" unpacked with wrong size!
fi
# end of 'tripwire-1.0/configs/conf-epix.h'
fi
if test -f 'tripwire-1.0/configs/conf-osx-ucb.h' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'tripwire-1.0/configs/conf-osx-ucb.h'\"
else
echo shar: Extracting \"'tripwire-1.0/configs/conf-osx-ucb.h'\" \(806 characters\)
sed "s/^X//" >'tripwire-1.0/configs/conf-osx-ucb.h' <<'END_OF_FILE'
X/* $Id: conf-osx-ucb.h,v 1.1.1.3 92/11/03 15:38:36 genek Exp $ */
X
X/*
X * conf-osx-ucb.h
X *
X *	Tripwire configuration file for Pyramid's OSx and ucb universe
X *
X * Ken McDonell
X * Pyramid Technology
X *
X */
X
X/*
X * is your OS a System V derivitive?  if so, what version?
X *			(e.g., define SYSV 4)
X */
X
X#undef SYSV
X
X/* 
X * does your system have a <malloc.h> like System V? 
X */
X
X#undef MALLOCH 	
X
X/* 
X * does your system have a <stdlib.h> like POSIX says you should? 
X */
X
X#undef STDLIBH
X
X/*
X * does your system use readdir(3) that returns (struct dirent *)?
X * -- yes, but we do not have a <dirent.h> to #include
X */
X
X#undef DIRENT
X
X/*
X * is #include <string.h> ok?  (as opposed to <strings.h>)
X */
X
X#undef STRINGH
X
X/* 
X * does your system have gethostname(2) (instead of uname(2))?
X */
X
X#define GETHOSTNAME
END_OF_FILE
if test 806 -ne `wc -c <'tripwire-1.0/configs/conf-osx-ucb.h'`; then
    echo shar: \"'tripwire-1.0/configs/conf-osx-ucb.h'\" unpacked with wrong size!
fi
# end of 'tripwire-1.0/configs/conf-osx-ucb.h'
fi
if test -f 'tripwire-1.0/man/sigfetch.8' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'tripwire-1.0/man/sigfetch.8'\"
else
echo shar: Extracting \"'tripwire-1.0/man/sigfetch.8'\" \(761 characters\)
sed "s/^X//" >'tripwire-1.0/man/sigfetch.8' <<'END_OF_FILE'
X.\" $Id: sigfetch.8,v 1.1.1.2 92/11/02 18:20:10 genek Exp $
X.\"
X.TH SIGFETCH 8 "October 14, 1992"
X.SH NAME
Xsigfetch \- signature gathering routine for Tripwire
X.SH SYNOPSIS
X.B sigfetch
Xsigfetch [-0123456789aqv] [ 
X.I file 
X\&... ]
X.SH DESCRIPTION
X.LP
X\fIsigfetch\fP is a utility that fetches signatures used by Tripwire.
X.SH OPTIONS
X.LP
XWhen run without any arguments, \fIsigfetch\fP collects all the signatures
Xon the specified files in a verbose manner.
X.TP 
X.B \-a
XCollect all signatures.
X.TP
X.B \-q
XQuiet mode.  Prints out all signatures in one line with no extraneous
Xinformation.
X.TP
X.B \-v
XVerbose mode.  (default)
X.TP
X.B \-[0-9]
XSeletively collects specified signature number.
X.SH AUTHORS
X.nf
XGene Kim
XPurdue University
Xgenek@mentor.cc.purdue.edu
X.fi
X
X
END_OF_FILE
if test 761 -ne `wc -c <'tripwire-1.0/man/sigfetch.8'`; then
    echo shar: \"'tripwire-1.0/man/sigfetch.8'\" unpacked with wrong size!
fi
# end of 'tripwire-1.0/man/sigfetch.8'
fi
if test -f 'tripwire-1.0/configs/conf-osx-att.h' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'tripwire-1.0/configs/conf-osx-att.h'\"
else
echo shar: Extracting \"'tripwire-1.0/configs/conf-osx-att.h'\" \(755 characters\)
sed "s/^X//" >'tripwire-1.0/configs/conf-osx-att.h' <<'END_OF_FILE'
X/* $Id: conf-osx-att.h,v 1.1.1.3 92/11/03 15:38:22 genek Exp $ */
X
X/*
X * conf-osx-att.h
X *
X *	Tripwire configuration file for Pyramid's OSx and att universe
X *
X * Ken McDonell
X * Pyramid Technology
X *
X */
X
X/*
X * is your OS a System V derivitive?  if so, what version?
X *			(e.g., define SYSV 4)
X */
X
X#define SYSV 3
X
X/* 
X * does your system have a <malloc.h> like System V? 
X */
X
X#define MALLOCH 	
X
X/* 
X * does your system have a <stdlib.h> like POSIX says you should? 
X */
X
X#undef STDLIBH
X
X/*
X * does your system use readdir(3) that returns (struct dirent *)?
X */
X
X#define DIRENT
X
X/*
X * is #include <string.h> ok?  (as opposed to <strings.h>)
X */
X
X#undef STRINGH
X
X/* 
X * does your system have gethostname(2) (instead of uname(2))?
X */
X
X#undef GETHOSTNAME
END_OF_FILE
if test 755 -ne `wc -c <'tripwire-1.0/configs/conf-osx-att.h'`; then
    echo shar: \"'tripwire-1.0/configs/conf-osx-att.h'\" unpacked with wrong size!
fi
# end of 'tripwire-1.0/configs/conf-osx-att.h'
fi
if test -f 'tripwire-1.0/aux/ntohl.h' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'tripwire-1.0/aux/ntohl.h'\"
else
echo shar: Extracting \"'tripwire-1.0/aux/ntohl.h'\" \(741 characters\)
sed "s/^X//" >'tripwire-1.0/aux/ntohl.h' <<'END_OF_FILE'
X#if BYTEORDER == 0x4321
X
X#define ntohl(x)
X#define htonl(x)
X#else
X#if ((BYTEORDER - 0x1111) & 0x444) || !(BYTEORDER & 0xf)
X#define ntohl(x)    fatal("Unknown BYTEORDER\n")
X#define htonl(x)    fatal("Unknown BYTEORDER\n")
X#else
X#define BYTEREVERSE(x)  {register unsigned char __t, \
X		*__c = (unsigned char *) &(x); \
X	__t = __c[3]; __c[3] = *__c; *__c++ = __t; \
X	__t = *__c; *__c = __c[1]; *++__c = __t; }
X#define ntohl(x) BYTEREVERSE(x)
X#define htonl(x) BYTEREVERSE(x)
X#endif
X#endif
X
X
X/* $Id: ntohl.h,v 1.2 92/11/03 02:48:31 genek Exp $
X
XThen, wherever you use the value, replace:
X
Xi = ntohl(j);
X -with-
Xi = j;
Xntohl(i);
X
XThe resulting code will be faster that using a subroutine,
X especially if these routines are called often.
X
X--spaf
X*/
END_OF_FILE
if test 741 -ne `wc -c <'tripwire-1.0/aux/ntohl.h'`; then
    echo shar: \"'tripwire-1.0/aux/ntohl.h'\" unpacked with wrong size!
fi
# end of 'tripwire-1.0/aux/ntohl.h'
fi
if test -f 'tripwire-1.0/aux/byteorder.c' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'tripwire-1.0/aux/byteorder.c'\"
else
echo shar: Extracting \"'tripwire-1.0/aux/byteorder.c'\" \(687 characters\)
sed "s/^X//" >'tripwire-1.0/aux/byteorder.c' <<'END_OF_FILE'
X#ifndef lint
Xstatic char rcsid[] = "$Id: byteorder.c,v 1.1.1.2 92/11/02 18:16:38 genek Exp $";
X#endif
X
X#include "../include/config.h"
X#include <stdio.h>
X#ifdef STDLIBH
X#include <stdlib.h>
X#endif
X
X/*
X * byteorder.c
X *
X *	lifted and hacked from Larry Wall's Configure program.
X *
X * Gene Kim
X * Purdue University
X * October 14, 1992
X */
X
Xmain()
X{
X    int i;
X    union {
X	unsigned long l;
X	char c[sizeof(long)];
X    } u;
X
X    if (sizeof(long) > 4)
X	u.l = (0x08070605L << 32) | 0x04030201L;
X    else
X	u.l = 0x04030201L;
X
X    (void)printf("#define BYTEORDER 0x");
X    for (i=0; i < sizeof(long); i++)
X	(void)printf("%c",u.c[i]+'0');
X    (void)printf("\n");
X
X    exit(0);
X    /*NOTREACHED*/
X}
END_OF_FILE
if test 687 -ne `wc -c <'tripwire-1.0/aux/byteorder.c'`; then
    echo shar: \"'tripwire-1.0/aux/byteorder.c'\" unpacked with wrong size!
fi
# end of 'tripwire-1.0/aux/byteorder.c'
fi
if test -f 'tripwire-1.0/contrib/README.chk' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'tripwire-1.0/contrib/README.chk'\"
else
echo shar: Extracting \"'tripwire-1.0/contrib/README.chk'\" \(622 characters\)
sed "s/^X//" >'tripwire-1.0/contrib/README.chk' <<'END_OF_FILE'
X# $Id: README.chk,v 1.1.1.2 92/11/02 18:19:03 genek Exp $ 
X
XFrom shabby Sun Sep 27 18:48:33 1992
XReceived: from localhost by mentor.cc.purdue.edu (5.61/Purdue_CC)
X	id AA10476; Sun, 27 Sep 92 18:48:32 -0500
XMessage-Id: <9209272348.AA10476@mentor.cc.purdue.edu>
XTo: genek
XSubject: README for tripwire.chk
XDate: Sun, 27 Sep 92 18:48:31 -0500
XFrom: shabby
XStatus: OR
X
X
X"tripwire.chk" is a COPS-style driver for tripwire.  It's laughably
Xsimple but I happened to write it, so I thought I would save anyone else
Xthe trouble.  It should work with the "reconfig" script that COPS uses.
X
X-Shabbir J. Safdar (shabby@cc.purdue.edu)
X
END_OF_FILE
if test 622 -ne `wc -c <'tripwire-1.0/contrib/README.chk'`; then
    echo shar: \"'tripwire-1.0/contrib/README.chk'\" unpacked with wrong size!
fi
# end of 'tripwire-1.0/contrib/README.chk'
fi
if test -f 'tripwire-1.0/contrib/CheckConfig' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'tripwire-1.0/contrib/CheckConfig'\"
else
echo shar: Extracting \"'tripwire-1.0/contrib/CheckConfig'\" \(618 characters\)
sed "s/^X//" >'tripwire-1.0/contrib/CheckConfig' <<'END_OF_FILE'
X#!/bin/sh
X# "analyze" a config file 
X#
X# Lance Bailey <lrb@ctrg.rri.uwo.ca>
X#
X
Xif [ ".$1" = ".-v" ];then verbose="yes";shift
Xelse verbose="";fi
X
Xfile="$1"
X
Xsed -e "s/#.*//" \
X    -e "/^$/d" \
X    -e "s=[^/]*\(/[^ 	]*\).*=\1=" \
X    $file |
X    while read line
X    do if [ ! -s $line ];then
X           if [ $verbose ];then echo ${line}:	not found;fi
X           continue
X       fi
X    
X       case `ls -ld $line` in
X           d*) if [ $verbose ];then echo "${line}:	directory";fi ;;
X           l*) echo "${line}:	symlink";;
X           *)  if [ $verbose ];then echo "${line}:	file";fi ;;
X       esac
X    done
X
X#
X# EOF
X#
END_OF_FILE
if test 618 -ne `wc -c <'tripwire-1.0/contrib/CheckConfig'`; then
    echo shar: \"'tripwire-1.0/contrib/CheckConfig'\" unpacked with wrong size!
fi
chmod +x 'tripwire-1.0/contrib/CheckConfig'
# end of 'tripwire-1.0/contrib/CheckConfig'
fi
if test -f 'tripwire-1.0/include/sigs.h' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'tripwire-1.0/include/sigs.h'\"
else
echo shar: Extracting \"'tripwire-1.0/include/sigs.h'\" \(613 characters\)
sed "s/^X//" >'tripwire-1.0/include/sigs.h' <<'END_OF_FILE'
X/* $Id: sigs.h,v 1.1.1.2 92/11/02 18:19:47 genek Exp $ */
X
X/*
X * sigs.h
X *
X *	common header definitions for signature wrappers.
X *
X * Gene Kim
X * Purdue University
X * October 12, 1992
X */
X
X#include <stdio.h>
X#include <fcntl.h>
X#if !defined(SYSV) || (SYSV > 3)
X# include <sys/file.h>
X#else
X# include <unistd.h>
X#endif 	/* SYSV */
X#if (defined(SYSV) && (SYSV < 3))
X# include <limits.h>
X# include <unistd.h>
X#endif	/* SVR2 */
X
X#ifndef SEEK_SET
X# define SEEK_SET L_SET
X#endif
X
Xchar *ltob64();
Xextern int printhex;
X
X/* prototypes */
X#ifdef __STDC__
Xint sig_null_get(int, char *, int);
X#else
Xint sig_null_get();
X#endif
END_OF_FILE
if test 613 -ne `wc -c <'tripwire-1.0/include/sigs.h'`; then
    echo shar: \"'tripwire-1.0/include/sigs.h'\" unpacked with wrong size!
fi
# end of 'tripwire-1.0/include/sigs.h'
fi
if test -f 'tripwire-1.0/configs/tw.conf.ultrix' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'tripwire-1.0/configs/tw.conf.ultrix'\"
else
echo shar: Extracting \"'tripwire-1.0/configs/tw.conf.ultrix'\" \(592 characters\)
sed "s/^X//" >'tripwire-1.0/configs/tw.conf.ultrix' <<'END_OF_FILE'
X# 
X# Ultrix tw.config file
X# John Wagner <JIW2@PSUVM.PSU.EDU>
X#
X
X/etc/crontab
X/etc/disktab
X/etc/exports
X/etc/fstab
X/etc/gettytab
X/etc/hosts
X/etc/hosts.equiv
X/etc/hosts.lpd
X/etc/inetd.conf
X### Protect these two files if you are
X### running ntp:
X/etc/ntp.conf
X/usr/etc/ntpd
X###
X/etc/printcap
X/etc/rc
X/etc/rc.local
X/etc/resolv.conf
X/etc/sendmail.cf
X/etc/services
X/etc/svc.conf
X/etc/ttys
X/usr/etc/fingerd
X/usr/etc/mountd
X/usr/etc/ftpd
X### These files should be protected if you
X### have Ultrix Upgraded or Enhanced security
X### installed.
X/etc/sec/audit_events
X/etc/sec/auditd
X/etc/sec/auditmask
END_OF_FILE
if test 592 -ne `wc -c <'tripwire-1.0/configs/tw.conf.ultrix'`; then
    echo shar: \"'tripwire-1.0/configs/tw.conf.ultrix'\" unpacked with wrong size!
fi
# end of 'tripwire-1.0/configs/tw.conf.ultrix'
fi
if test -f 'tripwire-1.0/contrib/TRIPWIRE' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'tripwire-1.0/contrib/TRIPWIRE'\"
else
echo shar: Extracting \"'tripwire-1.0/contrib/TRIPWIRE'\" \(569 characters\)
sed "s/^X//" >'tripwire-1.0/contrib/TRIPWIRE' <<'END_OF_FILE'
X#!/bin/sh
X# run tripwire from safe sources
X# 
X# Lance Bailey <lrb@ctrg.rri.uwo.ca>
X#
X
Xumask 077
XHOSTNAME=`hostname`
XEXE=tripwires/${HOSTNAME}
XDB=Databases/tripwire.database_${HOSTNAME}
XSRC=/usr/local/adm/tcheck
XWRK=/tmp 
X
Xcd ${WRK}
Xrm -rf ./tcheck.run; mkdir tcheck.run; cd tcheck.run;mkdir Databases
X
Xif [ ! -s ${SRC}/${EXE} ];then echo cannot access ${SRC}/${EXE}; exit-127; fi
X
Xuncompress <${SRC}/${EXE} > ./tripwire; chmod +x tripwire
Xuncompress <${SRC}/${DB} > ./Databases/`basename ${DB}`
X
X./tripwire $* 2>&1 | mail root
Xcd ${WRK} # ;rm -rf tcheck.run
X
X#
X# EOF
X#
END_OF_FILE
if test 569 -ne `wc -c <'tripwire-1.0/contrib/TRIPWIRE'`; then
    echo shar: \"'tripwire-1.0/contrib/TRIPWIRE'\" unpacked with wrong size!
fi
chmod +x 'tripwire-1.0/contrib/TRIPWIRE'
# end of 'tripwire-1.0/contrib/TRIPWIRE'
fi
if test -f 'tripwire-1.0/aux/Makefile' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'tripwire-1.0/aux/Makefile'\"
else
echo shar: Extracting \"'tripwire-1.0/aux/Makefile'\" \(492 characters\)
sed "s/^X//" >'tripwire-1.0/aux/Makefile' <<'END_OF_FILE'
X# $Id: Makefile,v 1.1.1.2 92/11/02 18:16:34 genek Exp $
X#
X# 	Tripwire aux program build
X#
X
XBORDER	= ../include/byteorder.h
XINODE	= ../include/inode.h
X
Xall:	$(BORDER) $(INODE)
X
X$(BORDER): byteorder.c ntohl.h
X	$(CC) $(CFLAGS) $(LDFLAGS) byteorder.c -o byteorder
X	(./byteorder; cat ./ntohl.h) > $(BORDER)
X
X$(INODE): types.sh types.c types
X	$(SHELL) ./types.sh "$(CPP)" > $(INODE)
X
Xtypes:	types.c
X	$(CC) $(CFLAGS) $(LDFLAGS) types.c -o types
X	
Xclean:	
X	rm -f types byteorder *.o core ourtypes.h
X
END_OF_FILE
if test 492 -ne `wc -c <'tripwire-1.0/aux/Makefile'`; then
    echo shar: \"'tripwire-1.0/aux/Makefile'\" unpacked with wrong size!
fi
# end of 'tripwire-1.0/aux/Makefile'
fi
if test -f 'tripwire-1.0/TODO' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'tripwire-1.0/TODO'\"
else
echo shar: Extracting \"'tripwire-1.0/TODO'\" \(485 characters\)
sed "s/^X//" >'tripwire-1.0/TODO' <<'END_OF_FILE'
X# $Id: TODO,v 1.4 92/11/03 13:34:56 genek Exp $
X
Xfirst net release
Xv1.0:				 Tue Nov  3 04:37:39 EST 1992
X
X    fix byte "mangling" on MD2, MD4 and Snefru for Cray machines
X    fix lurking bug that surfaces in ETA-10 versions
X    find out why malloc() sometimes fails in Cray versions
X
X    regular expression handling in tw.config file
X    hook for tar and cpio file parsing
X    inclusion of complete and authorative documentation
X    add "information mode" that explains inode fields
X
END_OF_FILE
if test 485 -ne `wc -c <'tripwire-1.0/TODO'`; then
    echo shar: \"'tripwire-1.0/TODO'\" unpacked with wrong size!
fi
# end of 'tripwire-1.0/TODO'
fi
if test -f 'tripwire-1.0/contrib/tripwire.chk' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'tripwire-1.0/contrib/tripwire.chk'\"
else
echo shar: Extracting \"'tripwire-1.0/contrib/tripwire.chk'\" \(458 characters\)
sed "s/^X//" >'tripwire-1.0/contrib/tripwire.chk' <<'END_OF_FILE'
X# $Id: tripwire.chk,v 1.1.1.2 92/11/02 18:19:12 genek Exp $
X#
X# tripwire.chk - S.J. Safdar (shabby@cc.purdue.edu)
X# Provide a cops-style interface to tripwire.
X#
Xumask 077
X
XTEST=/bin/test
XECHO=/bin/echo
X
Xif $TEST ! -f ./tripwire ; then
X	$ECHO "Tripwire not compiled here, exiting.";
Xfi
X
Xif $TEST ! -d ./Databases ; then
X	mkdir ./Databases
X	./tripwire -initialize
X	exit 0
Xfi
X
Xif $TEST ! -f ./Databases/tw.* ; then
X	./tripwire -initialize
Xelse
X	./tripwire
Xfi
X
END_OF_FILE
if test 458 -ne `wc -c <'tripwire-1.0/contrib/tripwire.chk'`; then
    echo shar: \"'tripwire-1.0/contrib/tripwire.chk'\" unpacked with wrong size!
fi
chmod +x 'tripwire-1.0/contrib/tripwire.chk'
# end of 'tripwire-1.0/contrib/tripwire.chk'
fi
if test -f 'tripwire-1.0/tests/Makefile' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'tripwire-1.0/tests/Makefile'\"
else
echo shar: Extracting \"'tripwire-1.0/tests/Makefile'\" \(280 characters\)
sed "s/^X//" >'tripwire-1.0/tests/Makefile' <<'END_OF_FILE'
X# $Id: Makefile,v 1.1.1.2 92/11/02 18:23:47 genek Exp $
X#
X# 	Tripwire test
X
XDIST=tripwire-0.92
X
Xall:	../src/tripwire
X	@HOST=`echo $(HOSTNAME)`; \
X	CURRPATH=`pwd`;	\
X	$(SHELL) test1.sh $(HOSTNAME) $(DIST)
X
X../src/tripwire:
X	(cd ..; make all)
X
Xclean:
X	rm -f tw.db_TEST.@ @tw.config
END_OF_FILE
if test 280 -ne `wc -c <'tripwire-1.0/tests/Makefile'`; then
    echo shar: \"'tripwire-1.0/tests/Makefile'\" unpacked with wrong size!
fi
# end of 'tripwire-1.0/tests/Makefile'
fi
if test -f 'tripwire-1.0/sigs/snefru/Makefile' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'tripwire-1.0/sigs/snefru/Makefile'\"
else
echo shar: Extracting \"'tripwire-1.0/sigs/snefru/Makefile'\" \(246 characters\)
sed "s/^X//" >'tripwire-1.0/sigs/snefru/Makefile' <<'END_OF_FILE'
X# $Id: Makefile,v 1.1.1.2 92/11/02 18:22:37 genek Exp $
X#
X# Makefile for snefru wrapper
X#
X# Gene Kim
X# Purdue University
X# October 18, 1992
X#
X
Xall:	snefru.o
X
X.c.o:
X	$(CC) $(CFLAGS) -c $<
X	
Xclean:
X	-rm -rf *.o
X
Xsnefru.o: ../../include/byteorder.h
END_OF_FILE
if test 246 -ne `wc -c <'tripwire-1.0/sigs/snefru/Makefile'`; then
    echo shar: \"'tripwire-1.0/sigs/snefru/Makefile'\" unpacked with wrong size!
fi
# end of 'tripwire-1.0/sigs/snefru/Makefile'
fi
if test -f 'tripwire-1.0/sigs/crc32/Makefile' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'tripwire-1.0/sigs/crc32/Makefile'\"
else
echo shar: Extracting \"'tripwire-1.0/sigs/crc32/Makefile'\" \(238 characters\)
sed "s/^X//" >'tripwire-1.0/sigs/crc32/Makefile' <<'END_OF_FILE'
X# $Id: Makefile,v 1.1.1.2 92/11/02 18:20:54 genek Exp $
X#
X# Makefile for crc32 wrapper
X#
X# Gene Kim
X# Purdue University
X# October 18, 1992
X#
X
Xall:	crc32.o
X
X.c.o:
X	$(CC) $(CFLAGS) -c $<
X
Xclean:
X	-rm *.o
X
Xcrc32.o: ../../include/byteorder.h
END_OF_FILE
if test 238 -ne `wc -c <'tripwire-1.0/sigs/crc32/Makefile'`; then
    echo shar: \"'tripwire-1.0/sigs/crc32/Makefile'\" unpacked with wrong size!
fi
# end of 'tripwire-1.0/sigs/crc32/Makefile'
fi
if test -f 'tripwire-1.0/sigs/crc/Makefile' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'tripwire-1.0/sigs/crc/Makefile'\"
else
echo shar: Extracting \"'tripwire-1.0/sigs/crc/Makefile'\" \(238 characters\)
sed "s/^X//" >'tripwire-1.0/sigs/crc/Makefile' <<'END_OF_FILE'
X# $Id: Makefile,v 1.1.1.2 92/11/02 18:20:32 genek Exp $
X#
X# Makefile for crc32 wrapper
X#
X# Gene Kim
X# Purdue University
X# October 18, 1992
X#
X
Xall:	crc.o
X
X.c.o:
X	$(CC) $(CFLAGS) -c $<
X
Xclean:
X	-rm -rf *.o
X
Xcrc.o: ../../include/byteorder.h
END_OF_FILE
if test 238 -ne `wc -c <'tripwire-1.0/sigs/crc/Makefile'`; then
    echo shar: \"'tripwire-1.0/sigs/crc/Makefile'\" unpacked with wrong size!
fi
# end of 'tripwire-1.0/sigs/crc/Makefile'
fi
if test -f 'tripwire-1.0/man/Makefile' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'tripwire-1.0/man/Makefile'\"
else
echo shar: Extracting \"'tripwire-1.0/man/Makefile'\" \(176 characters\)
sed "s/^X//" >'tripwire-1.0/man/Makefile' <<'END_OF_FILE'
X# Makefile for man pages
X
Xall:
X	$(INSTALL) -m 644 sigfetch.8 $(MANDIR)/man8
X	$(INSTALL) -m 644 tripwire.8 $(MANDIR)/man8
X	$(INSTALL) -m 644 tw.config.5 $(MANDIR)/man5
X
Xclean:
X
END_OF_FILE
if test 176 -ne `wc -c <'tripwire-1.0/man/Makefile'`; then
    echo shar: \"'tripwire-1.0/man/Makefile'\" unpacked with wrong size!
fi
# end of 'tripwire-1.0/man/Makefile'
fi
echo shar: End of archive 8 \(of 8\).
cp /dev/null ark8isdone
MISSING=""
for I in 1 2 3 4 5 6 7 8 ; do
    if test ! -f ark${I}isdone ; then
	MISSING="${MISSING} ${I}"
    fi
done
if test "${MISSING}" = "" ; then
    echo You have unpacked all 8 archives.
    echo "Now read the README file"
    rm -f ark[1-9]isdone
else
    echo You still need to unpack the following archives:
    echo "        " ${MISSING}
fi
##  End of shell archive.
exit 0
-- 
Gene Spafford
Software Engineering Research Center & Dept. of Computer Sciences
Purdue University, W. Lafayette IN 47907-1398
Internet:  spaf@cs.purdue.edu	phone:  (317) 494-7825
