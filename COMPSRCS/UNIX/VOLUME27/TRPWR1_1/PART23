Newsgroups: comp.sources.unix
From: spaf@cs.purdue.edu (Gene Spafford)
Subject: v27i169: tripwire-1.1 - security integrity monitor, V1.1, Part23/26
References: <1.756157401.21864@gw.home.vix.com>
Sender: unix-sources-moderator@gw.home.vix.com
Approved: vixie@gw.home.vix.com

Submitted-By: spaf@cs.purdue.edu (Gene Spafford)
Posting-Number: Volume 27, Issue 169
Archive-Name: tripwire-1.1/part23

#! /bin/sh
# This is a shell archive.  Remove anything before this line, then unpack
# it by saving it into a file and typing "sh file".  To overwrite existing
# files, type "sh file -c".  You can also feed this as standard input via
# unshar, or by typing "sh <file", e.g..  If this archive is complete, you
# will see the following message at the end:
#		"End of archive 23 (of 25)."
# Contents:  tripwire-1.1 tripwire-1.1/configs tripwire-1.1/include
#   tripwire-1.1/lib tripwire-1.1/src
#   tripwire-1.1/configs/tw.conf.sunos5
#   tripwire-1.1/configs/tw.conf.s5 tripwire-1.1/include/config.h
#   tripwire-1.1/src/twconvert.c tripwire-1.1/src/siggen.c
#   tripwire-1.1/configs/tw.conf.sun tripwire-1.1/lib/tw.config
#   tripwire-1.1/configs/conf-ptx2.h
# Wrapped by spaf@uther.cs.purdue.edu on Thu Dec 16 11:42:48 1993
PATH=/bin:/usr/bin:/usr/ucb ; export PATH
if test ! -d 'tripwire-1.1' ; then
    echo shar: Creating directory \"'tripwire-1.1'\"
    mkdir 'tripwire-1.1'
fi
if test ! -d 'tripwire-1.1/configs' ; then
    echo shar: Creating directory \"'tripwire-1.1/configs'\"
    mkdir 'tripwire-1.1/configs'
fi
if test ! -d 'tripwire-1.1/include' ; then
    echo shar: Creating directory \"'tripwire-1.1/include'\"
    mkdir 'tripwire-1.1/include'
fi
if test ! -d 'tripwire-1.1/lib' ; then
    echo shar: Creating directory \"'tripwire-1.1/lib'\"
    mkdir 'tripwire-1.1/lib'
fi
if test ! -d 'tripwire-1.1/src' ; then
    echo shar: Creating directory \"'tripwire-1.1/src'\"
    mkdir 'tripwire-1.1/src'
fi
if test -f 'tripwire-1.1/configs/tw.conf.sunos5' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'tripwire-1.1/configs/tw.conf.sunos5'\"
else
echo shar: Extracting \"'tripwire-1.1/configs/tw.conf.sunos5'\" \(5151 characters\)
sed "s/^X//" >'tripwire-1.1/configs/tw.conf.sunos5' <<'END_OF_FILE'
X#
X# tripwire.config
X# Generic version for SunOS 5.x (i.e, Solaris2.*)
X# Preliminary version by Bob Cunningham (bob@soest.hawaii.edu) 24June1993
X# Will need editing...see comments below
X#
X# This file contains a list of files and directories that System 
X# Preener will scan.  Information collected from these files will be 
X# stored in the tripwire.database file.
X#
X# Format: 			[!|=] entry [ignore-flags]
X#
X# where:	 '!' signifies the entry is to be pruned (inclusive) from
X#				the list of files to be scanned.
X#		 '=' signifies the entry is to be added, but if it is
X#				a directory, then all its contents are pruned
X#				(useful for /tmp).
X#
X# where:	entry is the absolute pathname of a file or a directory
X#
X# where ignore-flags are in the format:
X#		[template][ [+|-][pinugsam12] ... ]
X#
X# 	- :  ignore the following atributes
X#	+ :  do not ignore the following attributes
X#
X#	p :  permission and file mode bits 	a: access timestamp
X#	i :  inode number			m: modification timestamp
X#	n :  number of links (ref count)	c: inode creation timestamp
X#	u :  user id of owner			1: signature 1
X#	g :  group id of owner			2: signature 2
X#	s :  size of file
X#
X#
X# Ex:   The following entry will scan all the files in /etc, and report
X#	any changes in mode bits, inode number, reference count, uid,
X#	gid, modification and creation timestamp, and the signatures.
X#	However, it will ignore any changes in the access timestamp.
X#
X#	/etc	+pinugsm12-a
X#
X# The following templates have been pre-defined to make these long ignore
X# mask descriptions unecessary.
X#
X# Templates: 	(default)	R :  [R]ead-only (+pinugsm12-a)
X#				L :  [L]og file (+pinug-sam12)
X#				N :  ignore [N]othing (+pinusgsamc12)
X#				E :  ignore [E]verything (-pinusgsamc12)
X#
X# By default, Tripwire uses the R template -- it ignores
X# only the access timestamp.
X#
X# You can use templates with modifiers, like:
X#	Ex:  /etc/lp	E+ug
X#
X#	Example configuration file:
X#		/etc		R	# all system files
X#		!/etc/lp	R	# ...but not those logs
X#		=/tmp		N	# just the directory, not its files
X#
X# Note the difference between pruning (via "!") and ignoring everything
X# (via "E" template):  Ignoring everything in a directory still monitors
X# for added and deleted files.  Pruning a directory will prevent Tripwire
X# from even looking in the specified directory.
X#
X#
X# Tripwire running slowly?  Modify your tripwire.config entries to
X# ignore the (signature 2) attribute when this computationally-exorbitant 
X# protection is not needed.  (See README and design document for further
X# details.)
X#
X
X#  First, root's "home"
X
X=/			L
X/.rhosts		R	# may not exist
X/.profile		R	# may not exist
X/.cshrc			R	# may not exist
X/.login			R	# may not exist
X#/.exrc			R	# may not exist
X/.logout		R	# may not exist
X#/.emacs		R	# may not exist
X/.forward		R	# may not exist
X/.netrc			R	# may not exist
X#/.mailrc		R	# may not exist
X
X# Unix itself
X
X/kernel/unix		R
X
X# Now, some critical directories and files
X#  Some exceptions are noted further down
X
X/dev			L
X/devices		L
X=/devices/pseudo	L
X
X/etc			R
X/etc/default		R
X/etc/dfs/dfstab		R
X/etc/dfs/sharetab	R
X/etc/dumpdates		L
X/etc/group		R	# changes should be infrequent
X/etc/hosts.equiv	R
X/etc/inet/inetd.conf	R
X/etc/inet/protocols	R
X/etc/inet/services	R
X/etc/init.d		R
X/etc/motd		L
X#/etc/named.boot	R	# may not exist
X/etc/opt		R
X/etc/passwd		L
X/etc/profile		R
X/etc/remote		R
X/etc/rmtab		L
X/etc/rpc		R
X=/etc/saf		L
X/etc/shadow		L
X/etc/system		R
X/etc/ttydefs		L
X/etc/ttysrch		R
X
X/hsfsboot		R
X
X/kernel			R
X
X/opt			R
X
X/sbin			R
X
X/ufsboot		R
X
X/usr/sbin		R
X
X=/var			L
X=/var/adm		L
X/var/adm/utmp		L
X/var/adm/wtmp		L
X/var/adm/wtmpx		L
X/var/adm/sulog		L
X=/var/adm/sa		L
X=/var/spool		L
X
X# Checksumming the following is not so critical.  However,
X#  setuid/setgid files are special-cased further down.
X
X=/usr			L
X/usr/aset		R-2
X/usr/bin		R-2
X/usr/ccs		R-2
X/usr/kernel		R-2
X/usr/lib		R-2
X/usr/ucb		R-2
X/usr/openwin/bin	R-2
X
X# You may or may not have the following
X#/usr/ftp		L
X#/usr/ftp/bin		R
X#/usr/ftp/etc		R
X
X# put entries in for /var/yp if you need it
X# put entries for uucp if you need them
X# put entries for /var/adm if you need it
X
X=/tmp			L
X=/var/tmp		L
X=/proc			L
X
X#  Here are entries for setuid/setgid files.  On these, we use
X#  both signatures just to be sure.
X#
X#  You may want/need to edit this list.  Batteries not inc.
X
X/usr/bin/at			R
X/usr/bin/atq			R
X/usr/bin/atrm			R
X/usr/bin/chkey			R
X/usr/bin/crontab		R
X/usr/bin/ct			R
X/usr/bin/cu			R
X/usr/bin/eject			R
X/usr/bin/login			R
X/usr/bin/mail			R
X/usr/bin/mailx			R
X/usr/bin/netstat		R
X/usr/bin/newgrp			R
X/usr/bin/nfsstat		R
X/usr/bin/passwd			R
X/usr/bin/ps			R
X/usr/bin/rcp			R
X/usr/bin/rsh			R
X/usr/bin/rdist			R
X/usr/bin/rlogin			R
X/usr/bin/su			R
X/usr/bin/tip			R
X/usr/bin/uucp			R
X/usr/bin/uuglist		R
X/usr/bin/uuname			R
X/usr/bin/uustat			R
X/usr/bin/uux			R
X/usr/bin/volcheck		R
X/usr/bin/w			R
X/usr/bin/write			R
X/usr/bin/yppasswd		R
X/usr/ucb/ps			R
X
X# Some other /usr/bin programs you may also wish to check
X/usr/bin/csh			R
X/usr/bin/jsh			R
X/usr/bin/kdestroy		R
X/usr/bin/keylogin		R
X/usr/bin/keylogout		R
X/usr/bin/kinit			R
X/usr/bin/klist			R
X/usr/bin/ksh			R
X/usr/bin/ksrvtgt		R
X/usr/bin/rksh			R
X/usr/bin/sh			R
X
X
END_OF_FILE
if test 5151 -ne `wc -c <'tripwire-1.1/configs/tw.conf.sunos5'`; then
    echo shar: \"'tripwire-1.1/configs/tw.conf.sunos5'\" unpacked with wrong size!
fi
# end of 'tripwire-1.1/configs/tw.conf.sunos5'
fi
if test -f 'tripwire-1.1/configs/tw.conf.s5' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'tripwire-1.1/configs/tw.conf.s5'\"
else
echo shar: Extracting \"'tripwire-1.1/configs/tw.conf.s5'\" \(4787 characters\)
sed "s/^X//" >'tripwire-1.1/configs/tw.conf.s5' <<'END_OF_FILE'
X# $Id: tw.conf.s5,v 1.3 1993/08/19 05:27:14 genek Exp $
X#
X#
X# tripwire.config
X# Generic version for:
X#
X# SystemV/386 R3.2 configuration by W. Purvis <W.Purvis@daresbury.ac.uk>
X#
X# This file contains a list of files and directories that System 
X# Preener will scan.  Information collected from these files will be 
X# stored in the tripwire.database file.
X#
X# Format: 			[!|=] entry [ignore-flags]
X#
X# where:	 '!' signifies the entry is to be pruned (inclusive) from
X#				the list of files to be scanned.
X#		 '=' signifies the entry is to be added, but if it is
X#				a directory, then all its contents are pruned
X#				(useful for /tmp).
X#
X# where:	entry is the absolute pathname of a file or a directory
X#
X# where ignore-flags are in the format:
X#		[template][ [+|-][pinugsam12] ... ]
X#
X# 	- :  ignore the following atributes
X#	+ :  do not ignore the following attributes
X#
X#	p :  permission and file mode bits 	a: access timestamp
X#	i :  inode number			m: modification timestamp
X#	n :  number of links (ref count)	c: inode creation timestamp
X#	u :  user id of owner			1: signature 1
X#	g :  group id of owner			2: signature 2
X#	s :  size of file
X#
X#
X# Ex:   The following entry will scan all the files in /etc, and report
X#	any changes in mode bits, inode number, reference count, uid,
X#	gid, modification and creation timestamp, and the signatures.
X#	However, it will ignore any changes in the access timestamp.
X#
X#	/etc	+pinugsm12-a
X#
X# The following templates have been pre-defined to make these long ignore
X# mask descriptions unecessary.
X#
X# Templates: 	(default)	R :  [R]ead-only (+pinugsm12-a)
X#				L :  [L]og file (+pinug-sam12)
X#				N :  ignore [N]othing (+pinusgsamc12)
X#				E :  ignore [E]verything (-pinusgsamc12)
X#
X# By default, Tripwire uses the R template -- it ignores
X# only the access timestamp.
X#
X# You can use templates with modifiers, like:
X#	Ex:  /etc/lp	E+ug
X#
X#	Example configuration file:
X#		/etc		R	# all system files
X#		!/etc/lp	R	# ...but not those logs
X#		=/tmp		N	# just the directory, not its files
X#
X# Note the difference between pruning (via "!") and ignoring everything
X# (via "E" template):  Ignoring everything in a directory still monitors
X# for added and deleted files.  Pruning a directory will prevent Tripwire
X# from even looking in the specified directory.
X#
X#
X# Tripwire running slowly?  Modify your tripwire.config entries to
X# ignore the (signature 2) attribute when this computationally-exorbitant 
X# protection is not needed.  (See README and design document for further
X# details.)
X#
X
X#  First, root's "home"
X=/		L
X/.rhosts	R	# may not exist
X/.profile	R	# may not exist
X/.cshrc		R	# may not exist
X/.login		R	# may not exist
X#/.exrc		R	# may not exist
X
X# Unix itself
X/unix		R
X
X# Now, some critical directories and files
X#  Some exceptions are noted further down
X/etc		R
X/etc/inetd.conf	R
X/etc/rc		R
X/etc/rc.boot	R
X/etc/rc.local	R
X/etc/rc.single	R
X/etc/rc.ip	R
X/etc/ttytab	R
X/etc/exports	R
X/etc/ttys	L
X/etc/dumpdates	L
X/etc/mtab	L
X/etc/motd	L
X/etc/rmtab	L
X/etc/utmp	L
X/etc/group	R	# changes should be infrequent
X#  The next line may need to be replaced with /etc/security
X#   if C2 is enabled
X/etc/passwd	L
X
X!/dev
X
X/usr/etc	R
X/usr/local	R
X/usr/local/log	L
X
X# Checksumming the following is not so critical.  However,
X#  setuid/setgid files are special-cased further down.
X
X/lib				R-2
X
X/bin				R-2
X
X/usr/bin			R-2
X
X/usr/ucb			R-2
X
X/usr/lib			R-2
X
X/usr/local/lib/nqs/logfile	L
X=/usr				L
X=/usr/spool			L
X/usr/spool/cron			L
X/usr/spool/mqueue		L
X/usr/spool/mail			L
X=/usr/spool/nqs/private
X=/usr/spool/nqs/times
X
X# You may or may not have the following
X#/usr/ftp	L
X#/usr/ftp/bin	R
X#/usr/ftp/etc	R
X
X# put entries in for /var/yp if you need it
X# put entries for uucp if you need them
X# put entries for /var/adm if you need it
X
X=/tmp
X
X#  Here are entries for setuid/setgid files.  On these, we use
X#  both signatures just to be sure.
X#
X#  You may want/need to edit this list.  Batteries not inc.
X
X/bin/at			R
X/bin/atq		R
X/bin/atrm		R
X/bin/cancel		R
X/bin/chfn		R
X/bin/chsh		R
X/bin/crontab		R
X/bin/cu			R
X/bin/df			R
X/bin/iostat		R
X/bin/ipcs		R
X/bin/login		R
X/bin/lpstat		R
X/bin/mail		R
X/bin/newgrp		R
X/bin/passwd		R
X/bin/su			R
X/bin/tip		R
X#/bin/uucp		R
X#/bin/uuname		R
X#/bin/uustat		R
X#/bin/uux		R
X/bin/wall		R
X/bin/write		R
X/bin/ypchfn		R
X/bin/ypchsh		R
X/bin/yppasswd		R
X/usr/bin/at		R
X/usr/bin/atq		R
X/usr/bin/atrm		R
X/usr/bin/cancel		R
X/usr/bin/chfn		R
X/usr/bin/chsh		R
X/usr/bin/crontab	R
X/usr/bin/cu		R
X/usr/bin/df		R
X/usr/bin/iostat		R
X/usr/bin/ipcs		R
X/usr/bin/login		R
X/usr/bin/lpstat		R
X/usr/bin/mail		R
X/usr/bin/newgrp		R
X/usr/bin/passwd		R
X/usr/bin/su		R
X/usr/bin/tip		R
X#/usr/bin/uucp		R
X#/usr/bin/uuname		R
X#/usr/bin/uustat		R
X#/usr/bin/uux		R
X/usr/bin/wall		R
X/usr/bin/write		R
X/usr/bin/ypchfn		R
X/usr/bin/ypchsh		R
X/usr/bin/yppasswd	R
END_OF_FILE
if test 4787 -ne `wc -c <'tripwire-1.1/configs/tw.conf.s5'`; then
    echo shar: \"'tripwire-1.1/configs/tw.conf.s5'\" unpacked with wrong size!
fi
# end of 'tripwire-1.1/configs/tw.conf.s5'
fi
if test -f 'tripwire-1.1/include/config.h' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'tripwire-1.1/include/config.h'\"
else
echo shar: Extracting \"'tripwire-1.1/include/config.h'\" \(4696 characters\)
sed "s/^X//" >'tripwire-1.1/include/config.h' <<'END_OF_FILE'
X/* $Id: config.h,v 1.3 1993/08/19 05:27:26 genek Exp $ */
X
X/*
X * config.h
X *
X *	Tripwire configuration file
X *
X * Gene Kim
X * Purdue University
X */
X
X
X/***
X *** Operating System specifics
X ***	
X ***	Look in the .,/configs directory, and include appropriate header
X ***	file that corresponds with your operating system.
X ***/
X
X#include "../configs/conf-dynix.h"
X
X
X/***
X *** SYSTEM SPECIFIC Tripwire Configuration
X ***/
X
X/******* signature functions *****************************************
X *
X * Choose among these:
X *
X *	sig_md5_get		: MD5 function
X *				  (the RSA Data Security, Inc. MD5 Message-
X *				   Digesting Algorithm)
X *	sig_snefru_get		: Snefru function
X *				  (the Xerox Secure Hash Function)
X *	sig_null_get		: null function (returns 0 for all)
X *
X *  By default, Tripwire uses
X *		int (pf_signature0)() = sig_null_get;
X *		int (pf_signature1)() = sig_md5_get;
X *		int (pf_signature2)() = sig_snefru_get;
X *
X *  However, since Snefru is comparatively computationally expensive, you
X *  might consider using only MD5.  This can be done in the configuration,
X *  however, and should not be done by defining away the signature here.
X *
X *  You can replace one of the signature algorithms with another of your
X *  own choice by adding it to the build procedure, and putting it in
X *  here in place of one of these standard routines.  See the design
X *  document for hints on this.
X *
X *  To do this, just set one of the signature function pointers to
X *  your own function.
X *
X *********************************************************************/
X
X#define SIG0FUNC	sig_null_get
X#define SIG1FUNC	sig_md5_get
X#define SIG2FUNC	sig_snefru_get
X#define SIG3FUNC	sig_crc32_get
X#define SIG4FUNC	sig_crc_get
X#define SIG5FUNC	sig_md4_get
X#define SIG6FUNC	sig_md2_get
X#define SIG7FUNC	sig_sha_get
X#define SIG8FUNC	sig_null_get
X#define SIG9FUNC	sig_null_get
X
X#define SIG0NAME	"nullsig"
X#define SIG1NAME	"md5"
X#define SIG2NAME	"snefru"
X#define SIG3NAME	"crc32"
X#define SIG4NAME	"crc16"
X#define SIG5NAME	"md4"
X#define SIG6NAME	"md2"
X#define SIG7NAME	"sha"
X#define SIG8NAME	"nullsig"
X#define SIG9NAME	"nullsig"
X
X/******* path to Tripwire files **************************************
X *
X *	Ideally, CONFIG_PATH and DATABASE_PATH should be pointing to
X *	some read-only media, or some filesystem mounted remotely
X *	from a "secure-server".  (See design document for details.)
X *
X *	Note:  No trailing '/' in the paths!
X *
X *********************************************************************/
X
X/*
X#if !defined(SYSV) || (defined(SYSV) && (SYSV > 2))
X# define CONFIG_PATH     "/usr/adm/tcheck"
X# define DATABASE_PATH   "/usr/adm/tcheck/databases"
X#else
X# define CONFIG_PATH     "/usr/local/adm/tcheck"
X# define DATABASE_PATH   "/usr/local/adm/tcheck/databases"
X#endif
X*/
X
X#define CONFIG_PATH     "/tmp/genek"
X#define DATABASE_PATH   "/tmp/genek"
X
X/******* name of Tripwire files **************************************
X *
X *	Static filenames are nice, but we allow run-time binding to
X *	support multiple hosts sharing the same directory (without
X *	having to recompile.
X *
X *	Use the '@' character to represent the hostname of the machine
X *	running Tripwire.
X *
X *	For example "tripwire.database_@" would expand to:
X *		
X *		tripwire.database_mentor.cc.purdue.edu
X *
X *********************************************************************/
X
X#define CONFIG_FILE 	"tw.config"
X#define DATABASE_FILE	"tw.db_@"
X
X/******* Default ignore mask ****************************************
X *
X *	Usually, the only thing you want to ignore is the access time
X *	stamp.  But there may be applications where you want to know
X *	about any accesses, too.
X *
X *	Similarly, there may be some environments where you can have a much
X * 	more forgiving ignore mask.
X *
X *	By default, Tripwire uses:
X *		"R" --  read-only files, where only the access time
X *			stamp can change.
X *      Alternatively, you might want to make the default be "R-2"
X *      This would be faster than simply "R", at some small loss
X *	(perhaps) of protection.
X *
X *********************************************************************/
X
X#define DEFAULTIGNORE	"R-3456789"
X
X/******* Temporary file template ************************************
X *
X *	Usually, temporary files are stored in /tmp.  You may want
X *	to use a different directory if your system does not support
X *	the BSD "sticky" bit on directories.  (i.e., only owner or root
X *	can rename or delete files.)
X *
X *	Make sure that there are at least 6 X's in the template.
X *	Each consecutive X signifies a number that mktemp() can
X *	fill in with a random number.
X *
X *********************************************************************/
X
X#define TEMPFILE_TEMPLATE "/tmp/twzXXXXXX"
X
X
X
END_OF_FILE
if test 4696 -ne `wc -c <'tripwire-1.1/include/config.h'`; then
    echo shar: \"'tripwire-1.1/include/config.h'\" unpacked with wrong size!
fi
# end of 'tripwire-1.1/include/config.h'
fi
if test -f 'tripwire-1.1/src/twconvert.c' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'tripwire-1.1/src/twconvert.c'\"
else
echo shar: Extracting \"'tripwire-1.1/src/twconvert.c'\" \(4541 characters\)
sed "s/^X//" >'tripwire-1.1/src/twconvert.c' <<'END_OF_FILE'
X#include "../include/config.h"
X#include <stdio.h>
X#include <fcntl.h>
X#ifdef STDLIBH
X# include <stdlib.h>
X#endif
X#include <sys/param.h>
X#include <sys/types.h>
X#include <sys/stat.h>
X#ifndef XENIX
X# include <sys/time.h>
X#else
X# include <time.h>
X#endif 	/* XENIX */
X#ifdef DIRENT
X# include <dirent.h>
X#else
X# ifndef XENIX
X#  include <sys/dir.h>
X# else		/* XENIX */
X#  include <sys/ndir.h>
X# endif		/* XENIX */
X#endif	/* DIRENT */
X#if (defined(SYSV) && (SYSV < 3))
X# include <limits.h>
X#endif	/* SVR2 */
X#ifdef STRINGH
X#include <string.h>
X#else
X#include <strings.h>
X#endif
X#include "../include/list.h"
X#include "../include/tripwire.h"
X
X/* 
X * twconvert
X *
X *	convert v1.0 Tripwire databases to v1.1
X *
X * Gene Kim
X * $Id: twconvert.c,v 1.2 1993/12/15 18:28:09 genek Exp $
X */
X
X
Xvoid b64_convert();
Xint dbaseformat = 1;
Xint debuglevel = 0;
X
X#define NVEC 14
Xint
Xmain(argc, argv)
X    int argc;
X    char *argv[];
X{
X
X/* filename: (entrynumber, ignorevec, st_mode, st_ino, st_nlink,
X *		st_uid, st_gid, st_size,
X *		ltob64(statbuf->st_atime, vec64_a),
X *		ltob64(statbuf->st_mtime, vec64_m),
X *		ltob64(statbuf->st_ctime, vec64_c), sig0, sig1, ..., sig9
X */
X
X    char s[2048], t[2048];
X    char filename[1024], entrynum[128], st_mode[128], 
X		st_ino[128], 
X		st_nlink[128],
X 		st_uid[128], st_gid[128], st_size[128],
X		vec64[NVEC][128];
X    int err, i, ver;
X    int linenumber = 0;
X    char *pc;
X
X    while (fgets(s, sizeof(s), stdin) != NULL) {
X	linenumber++;
X	if (strncmp(s, "@@dbaseversion", strlen("@@dbaseversion")) == 0) {
X	    int ver;
X	    char trash[1024];
X	    sscanf(s, "%s %d", trash, &ver); 
X	    if (ver != 1 && ver != 2) {
X		fprintf(stderr, "unknown version %d!\n", ver);
X		exit(1);
X	    }
X	    fprintf(stderr, "Converting from dbaseformat %d to %d\n", ver,
X		DB_VERSION_NUM);
X	    {
X#ifndef NOGETTIMEOFDAY
X		    struct timezone tzone;
X		    struct timeval tval;
X#else
X		    long tval;
X#endif	/* XENIX */
X		char timestring[30];
X
X#ifndef NOGETTIMEOFDAY
X    if (gettimeofday(&tval, &tzone) < 0)
X        die_with_err("gettimeofday()", (char *) NULL);
X#else
X    tval = time((long *) 0);
X#endif	/* XENIX */
X		strncpy(timestring, ctime((time_t *)&tval), 26);
X		printf("# Converted by twconvert, release version %s on %s",
X					    VERSION_NUM, timestring);
X		printf("@@dbaseversion %d\n", DB_VERSION_NUM);
X	    }
X	    dbaseformat = ver;
X	    continue;
X	}
X	if (s[0] == '#' || s[0] == '@') {
X	    fputs(s, stdout);
X	    continue;
X	}
X	if ((err = sscanf(s, "%s %s %s %s %s %s %s %s %s %s %s %s %s %s %s %s %s %s %s %s %s %s", 
X		    filename, entrynum, vec64[13], st_mode, st_ino, 
X		    st_nlink,
X		    st_uid, st_gid, st_size,
X		    vec64[0],
X		    vec64[1],
X		    vec64[2],
X		    vec64[3],
X		    vec64[4],
X		    vec64[5],
X		    vec64[6],
X		    vec64[7],
X		    vec64[8],
X		    vec64[9],
X		    vec64[10],
X		    vec64[11],
X		    vec64[12])) != 22) {
X	    fputs(s, stdout);
X	    continue;
X	}
X
X	/* convert */
X	for (i = 0; i < NVEC; i++) {
X	    if (dbaseformat == 1)
X		b64_convert(vec64[i]);
X	    /* now pack it */
X	    b64_pack(vec64[i]);
X	}
X	sprintf(t, "%s %s %s %s %s %s %s %s %s %s %s %s %s %s %s %s %s %s %s %s %s %s \n", 
X		    filename, entrynum, vec64[13], st_mode, st_ino, 
X		    st_nlink,
X		    st_uid, st_gid, st_size,
X		    vec64[0],
X		    vec64[1],
X		    vec64[2],
X		    vec64[3],
X		    vec64[4],
X		    vec64[5],
X		    vec64[6],
X		    vec64[7],
X		    vec64[8],
X		    vec64[9],
X		    vec64[10],
X		    vec64[11],
X		    vec64[12]);
X	fputs(t, stdout);
X    }
X    exit(0);
X}
X
Xstatic char new64vec[] =
X  "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz:.";
Xstatic char old64vec[] =
X  "./0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";
X
Xvoid
Xb64_convert(s)
X    char *s;
X{
X    int i;
X    char *pc;
X    char tmp[64];
X
X    if (strcmp(s, "0") == 0) {
X	return;
X    }
X
X    strcpy(tmp, s);
X
X    for (pc = s; *pc; pc++) {
X	/* search old vector */
X	for (i = 0; i < 64; i++) {
X	    if (old64vec[i] == *pc) {
X		*pc = new64vec[i];
X		break;
X	    }
X	}
X    }
X
X    /*
X    fprintf(stderr, "(%s) --> (%s)\n", tmp, s);
X    */
X}
X
X
Xb64_pack(s)
X    char *s;
X{
X    /* get group of 6 chars, convert into long, then pack the whole
X     * thing into one vec
X     */
X
X    char new[1024], *pc;
X    int i, numl = 0;
X    long larray[100];
X
X    if (strcmp(s, "0") == 0)
X	return;
X
X    pc = s;
X    while (*pc) {
X	strncpy(new, pc, 6);
X	larray[numl++] = b64tol(s);
X	pc += 6;
X    }
X    pltob64((unsigned long *) larray, (char *) new, numl);
X    /*
X    if (strcmp(s, new) != 0)
X	fprintf(stderr, "%s <---> %s\n", s, new);
X    */
X    strcpy(s, new);
X}
END_OF_FILE
if test 4541 -ne `wc -c <'tripwire-1.1/src/twconvert.c'`; then
    echo shar: \"'tripwire-1.1/src/twconvert.c'\" unpacked with wrong size!
fi
# end of 'tripwire-1.1/src/twconvert.c'
fi
if test -f 'tripwire-1.1/src/siggen.c' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'tripwire-1.1/src/siggen.c'\"
else
echo shar: Extracting \"'tripwire-1.1/src/siggen.c'\" \(4495 characters\)
sed "s/^X//" >'tripwire-1.1/src/siggen.c' <<'END_OF_FILE'
X#ifndef lint
Xstatic char rcsid[] = "$Id: siggen.c,v 1.9 1993/12/15 17:35:31 genek Exp $";
X#endif
X
X/*
X * siggen.c
X *
X *	generate signatures for a given file.
X *
X * Gene Kim
X * Purdue University
X * October 14, 1992
X */
X
X#include "../include/config.h"
X#include <stdio.h>
X#include <fcntl.h>
X#ifdef STDLIBH
X# include <stdlib.h>
X#endif
X#include <sys/param.h>
X#include <sys/types.h>
X#include <sys/stat.h>
X#ifndef XENIX
X# include <sys/time.h>
X#else
X# include <time.h>
X#endif 	/* XENIX */
X#ifdef DIRENT
X# include <dirent.h>
X#else
X# ifndef XENIX
X#  include <sys/dir.h>
X# else		/* XENIX */
X#  include <sys/ndir.h>
X# endif		/* XENIX */
X#endif	/* DIRENT */
X#if (defined(SYSV) && (SYSV < 3))
X# include <limits.h>
X#endif	/* SVR2 */
X#ifdef STRINGH
X#include <string.h>
X#else
X#include <strings.h>
X#endif
X#include "../include/list.h"
X#include "../include/tripwire.h"
X
X#ifndef L_tmpnam
X# define L_tmpnam (unsigned int) MAXPATHLEN
X#endif
X
Xextern int optind;
Xint debuglevel = 0;
Xchar *mktemp();
X
Xint (*pf_signatures [NUM_SIGS]) () = {
X					SIG0FUNC,
X					SIG1FUNC,
X					SIG2FUNC,
X					SIG3FUNC,
X					SIG4FUNC,
X					SIG5FUNC,
X					SIG6FUNC,
X					SIG7FUNC,
X					SIG8FUNC,
X					SIG9FUNC
X				      };
X
Xint printhex = 0;
Xint sigallget = 1;
Xint sigvector[NUM_SIGS] = { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
Xchar *signames[NUM_SIGS] = {
X					SIG0NAME,
X					SIG1NAME,
X					SIG2NAME,
X					SIG3NAME,
X					SIG4NAME,
X					SIG5NAME,
X					SIG6NAME,
X					SIG7NAME,
X					SIG8NAME,
X					SIG9NAME,
X			   };
Xint verbosity = 0;
Xint quietmode = 0;
Xchar *tmpfilename = NULL;
Xint readstdin = 0;
X
X
Xchar *progname;
X
Xvoid
Xusage()
X{
X    int i;
X
X    fprintf(stderr, "siggen: usage: [-0123456789qv] [-h|-hex] [ file ... ]\n");
X    for (i = 0; i < sizeof(signames)/sizeof(char *); i++) {
X	fprintf(stderr, "\tsig %d: %s\n", i, signames[i]);
X    }
X
X    exit(1);
X}
X
Xmain(argc, argv)
X    int argc;
X    char *argv[];
X{
X    int i, c;
X    int fd;
X    int errors = 0;
X    int numfiles = 0;
X
X    progname = argv[0];
X
X    optind = 1;
X    while ((c = getopt(argc, argv, "0123456789aqvh")) != -1) {
X	switch(c) {
X	case '0':		sigallget = 0; sigvector[0] = 1; break;
X	case '1':		sigallget = 0; sigvector[1] = 1; break;
X	case '2':		sigallget = 0; sigvector[2] = 1; break;
X	case '3':		sigallget = 0; sigvector[3] = 1; break;
X	case '4':		sigallget = 0; sigvector[4] = 1; break;
X	case '5':		sigallget = 0; sigvector[5] = 1; break;
X	case '6':		sigallget = 0; sigvector[6] = 1; break;
X	case '7':		sigallget = 0; sigvector[7] = 1; break;
X	case '8':		sigallget = 0; sigvector[8] = 1; break;
X	case '9':		sigallget = 0; sigvector[9] = 1; break;
X	case 'a':		sigallget = 1; break;
X	case 'v':		verbosity = 1; break;
X	case 'q':		quietmode = 1; break;
X	case 'h':		printhex = 1; break;
X	case '?':
X	default:
X	    usage();
X	    exit(1);
X	}
X    }
X
X    argc -= optind;
X    argv += optind;
X
X    if (argc == 0)
X	readstdin = 1;
X    for (i = 0; i < argc; i++) {
X	if (strcmp(argv[i], "-") == 0) {
X	    readstdin = 1;
X	    continue;
X	}
X	else if ((fd = open(argv[i], O_RDONLY, 0)) < 0) {
X	    warn_with_err("siggen: skipping '%s'", argv[i]);
X	    errors++;
X	    continue;
X	}
X	if (argc > 1)
X	    printf("*** %s ***\n", argv[i]);
X	if (siggen(fd) < 0)
X	    errors++;
X
X	if (fd)
X	    close(fd);
X    }
X
X    if (readstdin) {
X	FILE *fpout;
X	/* generate temporary file name */
X	if ((tmpfilename = (char *) malloc(L_tmpnam)) == NULL) {
X	    perror("main: malloc()");
X	    exit(1);
X	};
X	(void) strcpy(tmpfilename, "/tmp/twzXXXXXX");
X
X	if ((char *) mktemp(tmpfilename) == NULL) {
X	    perror("siggen: mktemp()");
X	    exit(1);
X	}
X
X	/*  output */
X	if (!(fpout = fopen(tmpfilename, "w"))) {
X	    char err[1024];
X	    sprintf(err, "main: fopen(%s)", tmpfilename);
X	    perror(err);
X	    exit(1);
X	}
X	/*  copy */
X	while ((c = getc(stdin)) != EOF)
X	    putc(c, fpout);
X	fclose(fpout);
X	if ((fd = open(tmpfilename, O_RDONLY)) < 0) {
X	    perror("siggen: open");
X	    exit(1);
X	}
X	if (siggen(fd) < 0)
X	    errors++;
X
X	if (fd)
X	    close(fd);
X	unlink(tmpfilename);
X    }
X
X    if (errors) 
X	exit(1);
X
X
X    exit(0);
X}
X
Xint
Xsiggen(fd)
X    int fd;
X{
X    char 	sigs[NUM_SIGS][SIG_MAX_LEN];
X    char	sigs_concat[1024];
X    int 	i;
X
X    /* collect signatures */
X    for (i = 0; i < NUM_SIGS; i++) {
X	char *pc = sigs[i];
X
X	if (sigallget || sigvector[i]) {
X
X	    if ((*pf_signatures[i])(fd, pc, SIG_MAX_LEN) < 0) {
X	        return -1;
X	    }
X	    if (!quietmode)
X		printf("sig%d: %-9s: %s\n", i, signames[i], sigs[i]);
X	    else
X		printf("%s ", sigs[i]);
X
X	}
X    }
X
X    if (quietmode)
X        printf("\n");
X
X    return 0;
X}
END_OF_FILE
if test 4495 -ne `wc -c <'tripwire-1.1/src/siggen.c'`; then
    echo shar: \"'tripwire-1.1/src/siggen.c'\" unpacked with wrong size!
fi
# end of 'tripwire-1.1/src/siggen.c'
fi
if test -f 'tripwire-1.1/configs/tw.conf.sun' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'tripwire-1.1/configs/tw.conf.sun'\"
else
echo shar: Extracting \"'tripwire-1.1/configs/tw.conf.sun'\" \(4483 characters\)
sed "s/^X//" >'tripwire-1.1/configs/tw.conf.sun' <<'END_OF_FILE'
X# $Id: tw.conf.sun,v 1.6 1993/12/13 16:38:26 genek Exp $
X#
X# tripwire.config
X# Generic version for SunOS 4.x
X#  Will need editing...see comments below
X# Modified by Rik Farrow, 11/28/93. 
X#	(You may want to disable signature 2 and enable signature 5 for
X#	better performance.)
X#
X
X#  First, root's "home"
X=/		L
X/.rhosts	R	# may not exist
X/.profile	R	# may not exist
X/.cshrc		R	# may not exist
X/.login		R	# may not exist
X/.exrc		R	# may not exist
X/.logout	R	# may not exist
X/.emacs		R	# may not exist
X/.forward	R	# may not exist
X/.netrc		R	# may not exist
X
X# GENE:  A root user may have an .openwin-init, which is a shell script
X/.openwin-init	L	# this file is updated from a menu option
X
X# Unix itself
X/vmunix		R
X
X# GENE:  Other critical Sun files: boot, the boot program, and kadb
X
X/boot		R
X/kadb		R
X
X# Now, some critical directories and files
X#  Some exceptions are noted further down
X/etc		R
X/etc/inetd.conf	R
X/etc/rc		R
X/etc/rc.boot	R
X/etc/rc.local	R
X/etc/rc.single	R
X/etc/rc.ip	R
X/etc/ttytab	R
X/etc/exports	R
X/etc/ttys	L
X/etc/dumpdates	L
X/etc/mtab	L
X/etc/motd	L
X/etc/rmtab	L
X/etc/utmp	L
X/etc/group	R	# changes should be infrequent
X#  The next line may need to be replaced with /etc/security
X#   if C2 is enabled
X/etc/passwd	L
X
X/var		L
X
X/dev		L
X
X/usr/etc	R
X
X# GENE:  /sbin contains binaries critical when in single user mode
X/sbin		R
X
X# Checksumming the following is not so critical.  However,
X#  setuid/setgid files are special-cased further down.
X
X#/lib		R-2   GENE:  This is a symbolic link in 4.1.x
X
X#/bin		R-2   GENE:  This is a symbolic link in 4.1.x
X
X/usr/bin	R
X
X/usr/ucb	R
X
X# GENE:  Other SunOS directories, including 5bin, which may be in PATH
X/usr/5bin	R
X
X/usr/5lib	R
X
X/usr/diag	R
X
X/usr/kvm	R
X
X/usr/lddrv	R
X
X/usr/openwin/bin	R
X
X/usr/openwin/lib	R
X
X!/usr/openwin/lib/fonts
X
X/usr/xpg2bin	R
X
X# GENE: End additions
X
X/usr/lib	R
X
X# GENE: get rid of the fonts directories; perhaps could look only at dir perms
X!/usr/lib/fonts
X!/usr/lib/font
X!/usr/lib/fontinfo
X!/usr/lib/xglfonts
X!/usr/lib/vfont
X
X
X=/usr		L
X=/usr/spool	L
X
X# GENE:  the real spool directory on Suns ...
X=/var/spool	L
X/var/spool/cron		L
X/var/spool/mqueue	L
X/var/spool/mail		L
X
X# GENE:  additional spool directories in SunOS ...
X/var/spool/secretmail		L
X=/var/spool/uucp		L
X=/var/spool/lpd		L
X
X# You may or may not have the following
X#/usr/ftp	L
X#/usr/ftp/bin	R
X#/usr/ftp/etc	R
X
X# put entries in for /var/yp if you need it
X# put entries for uucp if you need them
X# put entries for /var/adm if you need it
X
X=/tmp
X=/var/tmp
X
X#  Here are entries for setuid/setgid files.  On these, we use
X#  both signatures just to be sure.
X#
X#  You may want/need to edit this list.  Batteries not inc.
X# GENE:  I replaced your list with a locally generated one.  Your list
X# included files in /bin--which is a symbolic link to /usr/bin.  Note
X# duplication of commmands in /bin and commands in /usr/bin in your original.
X# Also, you had missed any files in the optional Sys V compatibility
X# directories.
X
X/usr/5bin/su	R
X/usr/bin/at	R
X/usr/bin/atq	R
X/usr/bin/atrm	R
X/usr/bin/cancel	R
X/usr/bin/chfn	R
X/usr/bin/chsh	R
X/usr/bin/crontab	R
X/usr/bin/cu	R
X/usr/bin/df	R
X/usr/bin/fusage	R
X/usr/bin/iostat	R
X/usr/bin/ipcs	R
X/usr/bin/login	R
X/usr/bin/lpstat	R
X/usr/bin/mail	R
X/usr/bin/newgrp	R
X/usr/bin/nsquery	R
X/usr/bin/passwd	R
X/usr/bin/su	R
X/usr/bin/sunview1/sv_acquire	R
X/usr/bin/sunview1/sv_release	R
X/usr/bin/sunview1/toolplaces	R
X/usr/bin/tip	R
X/usr/bin/uucp	R
X/usr/bin/uuname	R
X/usr/bin/uustat	R
X/usr/bin/uux	R
X/usr/bin/wall	R
X/usr/bin/write	R
X/usr/bin/ypchfn	R
X/usr/bin/ypchsh	R
X/usr/bin/yppasswd	R
X/usr/etc/arp	R
X/usr/etc/auditd	R
X/usr/etc/chill	R
X/usr/etc/devinfo	R
X/usr/etc/dkinfo	R
X/usr/etc/dmesg	R
X/usr/etc/dump	R
X/usr/etc/dumpfs	R
X/usr/etc/keyenvoy	R
X/usr/etc/kgmon	R
X/usr/etc/lpc	R
X/usr/etc/nfsstat	R
X/usr/etc/ping	R
X/usr/etc/rfsetup	R
X/usr/etc/shutdown	R
X/usr/etc/trpt	R
X/usr/games/chesstool	R
X/usr/games/fortune	R
X/usr/games/hack	R
X/usr/games/robots	R
X/usr/games/snake	R
X/usr/kvm/getcons	R
X/usr/kvm/ps	R
X/usr/kvm/pstat	R
X/usr/kvm/w	R
X/usr/lib/acct/accton	R
X/usr/lib/expreserve	R
X/usr/lib/exrecover	R
X/usr/lib/lpd	R
X/usr/lib/sendmail	R
X/usr/lib/sendmail.mx	R
X/usr/lib/uucp/remote.unknown	R
X/usr/lib/uucp/uucico	R
X/usr/lib/uucp/uusched	R
X/usr/lib/uucp/uuxqt	R
X/usr/openwin/bin/loadmodule	R
X/usr/openwin/bin/xload	R
X/usr/openwin/lib/mkcookie	R
X/usr/ucb/lpq	R
X/usr/ucb/lpr	R
X/usr/ucb/lprm	R
X/usr/ucb/netstat	R
X/usr/ucb/quota	R
X/usr/ucb/rcp	R
X/usr/ucb/rdist	R
X/usr/ucb/rlogin	R
X/usr/ucb/rsh	R
X/usr/ucb/talk	R
X/usr/ucb/vmstat	R
X
X
END_OF_FILE
if test 4483 -ne `wc -c <'tripwire-1.1/configs/tw.conf.sun'`; then
    echo shar: \"'tripwire-1.1/configs/tw.conf.sun'\" unpacked with wrong size!
fi
# end of 'tripwire-1.1/configs/tw.conf.sun'
fi
if test -f 'tripwire-1.1/lib/tw.config' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'tripwire-1.1/lib/tw.config'\"
else
echo shar: Extracting \"'tripwire-1.1/lib/tw.config'\" \(4232 characters\)
sed "s/^X//" >'tripwire-1.1/lib/tw.config' <<'END_OF_FILE'
X# $Id: tw.config,v 1.4 1993/11/22 06:38:06 genek Exp $
X#
X# tw.config
X#
X# This file contains a list of files and directories that System 
X# Preener will scan.  Information collected from these files will be 
X# stored in the tw.database file.
X#
X# Format: 			[!|=] entry [ignore-flags]
X#
X# where:	 '!' signifies the entry is to be pruned (inclusive) from
X#				the list of files to be scanned.
X#		 '=' signifies the entry is to be added, but if it is
X#				a directory, then all its contents are pruned
X#				(useful for /tmp).
X#
X# where:	entry is the absolute pathname of a file or a directory
X#
X# where ignore-flags are in the format:
X#		[template][ [+|-][pinugsam12] ... ]
X#
X# 	- :  ignore the following atributes
X#	+ :  do not ignore the following attributes
X#
X#	p :  permission and file mode bits 	a: access timestamp
X#	i :  inode number			m: modification timestamp
X#	n :  number of links (ref count)	c: inode creation timestamp
X#	u :  user id of owner			1: signature 1
X#	g :  group id of owner			2: signature 2
X#	s :  size of file
X#
X#
X# Ex:   The following entry will scan all the files in /etc, and report
X#	any changes in mode bits, inode number, reference count, uid,
X#	gid, modification and creation timestamp, and the signatures.
X#	However, it will ignore any changes in the access timestamp.
X#
X#	/etc	+pinugsm12-a
X#
X# The following templates have been pre-defined to make these long ignore
X# mask descriptions unecessary.
X#
X# Templates: 	(default)	R :  [R]ead-only (+pinugsm12-a)
X#				L :  [L]og file (+pinug-sam12)
X#				N :  ignore [N]othing (+pinusgsamc12)
X#				E :  ignore [E]verything (-pinusgsamc12)
X#				> :  like [L], but ignore growing files
X#
X# By default, Tripwire uses the R template -- it ignores
X# only the access timestamp.
X#
X# You can use templates with modifiers, like:
X#	Ex:  /etc/lp	E+ug
X#
X#	Example configuration file:
X#		/etc		R	# all system files
X#		!/etc/lp	R	# ...but not those logs
X#		=/tmp		N	# just the directory, not its files
X#
X# ====
X#
X# Preprocessor directives:
X#
X#	The following directives provide C-preprocessor and m4-like
X#	functionality:
X#
X#		@@ifhost hostname	:	included if (hostname) matches
X#		@@ifhost hostname	:	included if (hostname) doesn't
X#						match.
X#						(both need matching @@endif)
X#
X#		@@define x		: 	defines (x)
X#		@@undef x		: 	undefines (x)
X#
X#		@@ifdef x		: 	included if (x) is defined.
X#		@@ifndef x		: 	included if (x) is not defined.
X#						(both need matching @@endif)
X#
X#		@@endif			: 	closes up @@ifhost, @@ifdef,
X#						and @@ifndef.
X#
X#	Example:
X#	A host-dependent inclusion can be specified many ways so tw.config
X#	files can be shared among multiple machines.  So, if the machine 
X#	"mentor.cc.purdue.edu" is the only machine that has a certain file,
X#	you could use:
X#
X#		@@ifhost mentor.cc.purdue.edu
X#		/etc/tw.log.mentor	R
X#		@@endif
X#
X
X/tmp/genek/tripwire-1.0				R+0123456789-ugpmci
X/tmp/genek/tripwire-1.0/tests 			E
X/tmp/genek/tripwire-1.0/tw.config	 	E
X/tmp/genek/tripwire-1.0/databases 		E
X
X/tmp/genek/tripwire-1.0/src/config.parse.o
X/tmp/genek/tripwire-1.0/src/main.o
X/tmp/genek/tripwire-1.0/src/list.o
X/tmp/genek/tripwire-1.0/src/ignorevec.o
X/tmp/genek/tripwire-1.0/src/dbase.build.o
X/tmp/genek/tripwire-1.0/src/utils.o
X/tmp/genek/tripwire-1.0/src/preen.o
X/tmp/genek/tripwire-1.0/src/preen.interp.o
X/tmp/genek/tripwire-1.0/src/preen.report.o
X/tmp/genek/tripwire-1.0/src/nullsig.o
X/tmp/genek/tripwire-1.0/src/config.prim.o
X/tmp/genek/tripwire-1.0/src/dbase.update.o
X/tmp/genek/tripwire-1.0/src/sigfetch.o
X/tmp/genek/tripwire-1.0/src/config.pre.o
X/tmp/genek/tripwire-1.0/sigs/crc/crc.o
X/tmp/genek/tripwire-1.0/sigs/crc32/crc32.o
X/tmp/genek/tripwire-1.0/sigs/md2/md2wrapper.o
X/tmp/genek/tripwire-1.0/sigs/md2/md2.o
X/tmp/genek/tripwire-1.0/sigs/md4/md4.o
X/tmp/genek/tripwire-1.0/sigs/md4/md4wrapper.o
X/tmp/genek/tripwire-1.0/sigs/md5/md5.o
X/tmp/genek/tripwire-1.0/sigs/md5/md5wrapper.o
X/tmp/genek/tripwire-1.0/sigs/snefru/snefru.o
X
X!/tmp/genek/tripwire-1.0/aux/types
X!/tmp/genek/tripwire-1.0/aux/byteorder
X
X!/tmp/genek/tripwire-1.0/src/config.lex.c
X!/tmp/genek/tripwire-1.0/src/config.pre.c
X!/tmp/genek/tripwire-1.0/Makefile
X!/tmp/genek/tripwire-1.0/include/config.h
X!/tmp/genek/tripwire-1.0/include/byteorder.h
X!/tmp/genek/tripwire-1.0/include/inode.h
END_OF_FILE
if test 4232 -ne `wc -c <'tripwire-1.1/lib/tw.config'`; then
    echo shar: \"'tripwire-1.1/lib/tw.config'\" unpacked with wrong size!
fi
# end of 'tripwire-1.1/lib/tw.config'
fi
if test -f 'tripwire-1.1/configs/conf-ptx2.h' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'tripwire-1.1/configs/conf-ptx2.h'\"
else
echo shar: Extracting \"'tripwire-1.1/configs/conf-ptx2.h'\" \(2419 characters\)
sed "s/^X//" >'tripwire-1.1/configs/conf-ptx2.h' <<'END_OF_FILE'
XFrom a4mp@loki.cc.pdx.edu Wed Oct  6 18:12:34 1993
XReturn-Path: <a4mp@loki.cc.pdx.edu>
XReceived: from arthur.cs.purdue.edu by barnum.cs.purdue.edu (5.65c/PURDUE_CS-1.2)
X	id <AA13001@barnum.cs.purdue.edu>; Wed, 6 Oct 1993 18:12:33 -0500
XReceived: from pdxgate.cs.pdx.edu by arthur.cs.purdue.edu (5.65c/PURDUE_CS-1.2)
X	id <AA01430@arthur.cs.purdue.edu>; Wed, 6 Oct 1993 18:12:28 -0500
XReceived:  from loki.cc.pdx.edu by pdxgate.cs.pdx.edu (4.1/pdx-gateway-evision: 1.30 
X	id AA25253; Wed, 6 Oct 93 16:12:21 PDT
XReceived:  from loki.cc.pdx.edu
X	by loki.cc.pdx.edu (5.65/pdx-client-evision: 1.19F 
X	id AA14453; Wed, 6 Oct 93 23:12:09 GMT
XFrom: a4mp@loki.cc.pdx.edu (Michael Perrone)
XMessage-Id:  <9310062312.AA14453@loki.cc.pdx.edu>
XSubject: Re: Ptx 2.0 files for tripwire 1.0.4
XTo: spaf (Gene Spafford)
XDate: Wed, 6 Oct 93 16:12:07 PDT
XCc: gkim
XIn-Reply-To: <199310040639.AA24668@uther.cs.purdue.edu>; from "Gene Spafford" at Oct 4, 93 1:39 am
XX-Mailer: ELM [version 2.3 PL11]
XStatus: ORr
X
XGene Spafford writes:
X> 
X> Please send the files to us -- we'd love to have them in the next
X> release!
X> 
X> --spaf
X> 
X
XOkay, what follows is "conf-ptx2.h"
XI'll let you know if this file works under ptx 2.1 in a week or two.
X
X -- Michael Perrone --
X
X
X
X
X-------- CUT HERE -------------
X/* conf-ptx2.h 
X *
X *	Tripwire configuration file
X *
X * Michael Perrone -- a4mp@loki.cc.pdx.edu 
X * Portland State University                 
X */
X
X/* include file for bsd types such as u_long */
X
X#include <netinet/in_systm.h>
X
X
X/***
X *** Operating System specifics
X ***	
X ***	If the answer to a question in the comment is "Yes", then
X ***	change the corresponding "#undef" to a "#define"
X ***/
X
X/*
X * Even though ptx 2 is based on SVR4, there is some stuff
X * missing that tripwire expects for SYSV = 4
X */
X
X#define SYSV 3
X
X/*
X * ptx has never had this - use system call "time"
X */
X
X#define NOGETTIMEOFDAY
X
X/* 
X * does your system have a <malloc.h> like System V? 
X * ptx does
X */
X
X#define MALLOCH 	
X
X/* 
X * does your system have a <stdlib.h> like POSIX says you should? 
X * ptx has stdlib.h
X */
X
X#define STDLIBH
X
X/*
X * does your system use readdir(3) that returns (struct dirent *)?
X * ptx does
X */
X
X#define DIRENT
X
X/*
X * is #include <string.h> ok?  (as opposed to <strings.h>)
X * ptx uses <strings.h>
X */
X
X#define STRINGH
X 
X/* 
X * does your system have gethostname(2) (instead of uname(2))?
X * ptx provides both calls.
X */
X
X#undef GETHOSTNAME
X
END_OF_FILE
if test 2419 -ne `wc -c <'tripwire-1.1/configs/conf-ptx2.h'`; then
    echo shar: \"'tripwire-1.1/configs/conf-ptx2.h'\" unpacked with wrong size!
fi
# end of 'tripwire-1.1/configs/conf-ptx2.h'
fi
echo shar: End of archive 23 \(of 25\).
cp /dev/null ark23isdone
MISSING=""
for I in 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 ; do
    if test ! -f ark${I}isdone ; then
	MISSING="${MISSING} ${I}"
    fi
done
if test "${MISSING}" = "" ; then
    echo You have unpacked all 25 archives.
    echo "Now read tripwire-1.1/README.kits"
    rm -f ark[1-9]isdone ark[1-9][0-9]isdone
else
    echo You still need to unpack the following archives:
    echo "        " ${MISSING}
fi
##  End of shell archive.
exit 0
