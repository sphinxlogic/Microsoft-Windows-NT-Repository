Newsgroups: comp.sources.unix
From: spaf@cs.purdue.edu (Gene Spafford)
Subject: v27i167: tripwire-1.1 - security integrity monitor, V1.1, Part21/26
References: <1.756157401.21864@gw.home.vix.com>
Sender: unix-sources-moderator@gw.home.vix.com
Approved: vixie@gw.home.vix.com

Submitted-By: spaf@cs.purdue.edu (Gene Spafford)
Posting-Number: Volume 27, Issue 167
Archive-Name: tripwire-1.1/part21

#! /bin/sh
# This is a shell archive.  Remove anything before this line, then unpack
# it by saving it into a file and typing "sh file".  To overwrite existing
# files, type "sh file -c".  You can also feed this as standard input via
# unshar, or by typing "sh <file", e.g..  If this archive is complete, you
# will see the following message at the end:
#		"End of archive 21 (of 25)."
# Contents:  tripwire-1.1 tripwire-1.1/configs tripwire-1.1/include
#   tripwire-1.1/sigs tripwire-1.1/sigs/snefru tripwire-1.1/tests
#   tripwire-1.1/tests/test.update.sh tripwire-1.1/Ported
#   tripwire-1.1/sigs/snefru/README.snefru
#   tripwire-1.1/include/tripwire.h tripwire-1.1/configs/conf-osf1.h
# Wrapped by spaf@uther.cs.purdue.edu on Thu Dec 16 11:42:47 1993
PATH=/bin:/usr/bin:/usr/ucb ; export PATH
if test ! -d 'tripwire-1.1' ; then
    echo shar: Creating directory \"'tripwire-1.1'\"
    mkdir 'tripwire-1.1'
fi
if test ! -d 'tripwire-1.1/configs' ; then
    echo shar: Creating directory \"'tripwire-1.1/configs'\"
    mkdir 'tripwire-1.1/configs'
fi
if test ! -d 'tripwire-1.1/include' ; then
    echo shar: Creating directory \"'tripwire-1.1/include'\"
    mkdir 'tripwire-1.1/include'
fi
if test ! -d 'tripwire-1.1/sigs' ; then
    echo shar: Creating directory \"'tripwire-1.1/sigs'\"
    mkdir 'tripwire-1.1/sigs'
fi
if test ! -d 'tripwire-1.1/sigs/snefru' ; then
    echo shar: Creating directory \"'tripwire-1.1/sigs/snefru'\"
    mkdir 'tripwire-1.1/sigs/snefru'
fi
if test ! -d 'tripwire-1.1/tests' ; then
    echo shar: Creating directory \"'tripwire-1.1/tests'\"
    mkdir 'tripwire-1.1/tests'
fi
if test -f 'tripwire-1.1/tests/test.update.sh' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'tripwire-1.1/tests/test.update.sh'\"
else
echo shar: Extracting \"'tripwire-1.1/tests/test.update.sh'\" \(8790 characters\)
sed "s/^X//" >'tripwire-1.1/tests/test.update.sh' <<'END_OF_FILE'
X#!/bin/sh
X
X# $Id: test.update.sh,v 1.5 1993/12/13 16:38:36 genek Exp $
X#
X#	Rigorous Tripwire functionality test suite
X#
X# Gene Kim
X# Purdue University
X#
X
XME=$0
XTMPDIR=/tmp/twtest
XTWCONFIG=$TMPDIR/tw.config
XTWDB=$TMPDIR/tw.db
XTRIPWIRE="../src/tripwire -loosedir -c $TWCONFIG -d $TWDB -i all "
XNEWFILE="$TMPDIR/d1/@@NEWFILE"
XOLDFILE="$TMPDIR/@@OLDFILE"
XGROWFILE="$TMPDIR/grow"
XSTATFILE="/tmp/twstat";
X
XSAVETWDB=/tmp/twXXX
XLOGFILE=/tmp/TWLOG
X
XSTATUSADD=2			# exit status of Tripwire
XSTATUSDEL=4
XSTATUSCHA=8
X
XMYRUN=/tmp/twrun.sh
XMYCHECK=/tmp/twcheck.sh
XMYCREATE=/tmp/twcreate.sh
XMYINIT=/tmp/twinit.sh
XMYCREATETWCONF=/tmp/twctwconf.sh
X
Xcat << GHK
X=== $ME: DESCRIPTION
X
X    This shell script exercises all the Tripwire integrity checking
Xand database update functionalities.
X
XGHK
X
Xecho "=== $ME: Setting up auxiliary scripts ==="
X
X# build run()
Xcat << 'EOF' > $MYRUN
X    sleep 1		# agh!  Bug in SunOS tmpfs!!!
X    echo running Tripwire
X    echo $*
X    $*
X    laststatus=$?
X    echo $laststatus > $STATFILE
XEOF
X
X# build checkstat()
Xcat << 'EOF' > $MYCHECK
X    DESIRED=$1
X    laststatus=`cat $STATFILE`
X    if [ $laststatus -ne $DESIRED ]
X    then
X	echo "=== $ME: test FAILED! (expecting $DESIRED, got $laststatus) ==="
X	echo "=== ($LOGFILE contains output from test script and Tripwire) ==="
X	exit 1
X    fi
XEOF
X
X####
X
XTMPFILES="f1 f2 f3 f4 f5"
XTMPDIRS="d1 d2"
X
X
Xcat << 'EOF' > $MYCREATE
X    #echo "=== $ME:    creating test environment ==="
X
X	rm -rf $TMPDIR
X	mkdir $TMPDIR
X	for f in $TMPFILES; do
X	    touch $TMPDIR/$f
X	done
X	for d in $TMPDIRS; do
X	    mkdir $TMPDIR/$d
X	    for f in $TMPFILES; do
X		touch $TMPDIR/$d/$f
X	    done
X	done
X	touch $OLDFILE
X	touch $GROWFILE
XEOF
X
Xcat << 'EOF' > $MYINIT
X    #echo "=== $ME:    initializing the database ==="
X
X	touch $TWCONFIG $TWDB $OLDFILE
X	rm -f databases/*
X	set _ $TRIPWIRE -initialize -q; shift
X	( . $MYRUN ; ) > $LOGFILE 
X	set _ 0; shift
X	. $MYCHECK
X
X	# move database
X	rm -f databases/*.old
X	cp databases/tw.db* $TWDB
X
X	# save a copy
X	cp ./databases/* $SAVETWDB
XEOF
X
Xcat << 'EOF' > $MYCREATETWCONF
X    #echo "=== $ME:    creating tw.config file ==="
X
X	cat << GHK > $TWCONFIG
X#
X$TMPDIR		R
X$TMPDIR/d1	R
X$TMPDIR/d2	R
X$TWCONFIG
X$TMPDIR/grow	L>
X$TWDB	E
X#
XGHK
X
XEOF
X
X# create the tw.config file
X# initialize the database
X# test update functionality
X#	case i.		updated entry
X#	case ii.	updated file
X#	case iii.	deleted file
X#	case iv.	added file
X#
X
Xecho === $ME: BEGIN ===
X	echo $TRIPWIRE
X
X    . $MYCREATE
X    . $MYCREATETWCONF
X    . $MYINIT
X
Xecho "=== $ME: testing GROWING (safe) files ==="
X    cp $TWCONFIG $GROWFILE
X    set _ $TRIPWIRE -q; shift
X    ( . $MYRUN ; ) > $LOGFILE ;
X    set _ 0; shift;
X    . $MYCHECK
X    touch $OLDFILE
X
X    . $MYINIT
Xecho "=== $ME: testing GROWING (unsafe) files ==="
X    rm -f $GROWFILE
X    touch $GROWFILE
X    set _ $TRIPWIRE -q; shift
X    ( . $MYRUN ; ) > $LOGFILE;
X    set _ $STATUSCHA; shift
X    . $MYCHECK 
X
X    . $MYINIT
Xecho "=== $ME: testing ADDED files ==="
X    touch $NEWFILE
X    set _ $TRIPWIRE -q; shift
X    ( . $MYRUN ; ) > $LOGFILE ; 
X    rm -f $NEWFILE
X    set _ $STATUSADD; shift
X    . $MYCHECK 
X
Xecho "=== $ME: testing DELETED files ==="
X    rm -f $OLDFILE
X    set _ $TRIPWIRE -q; shift
X    ( . $MYRUN ; )  > $LOGFILE ; 
X    set _ $STATUSDEL; shift
X    . $MYCHECK 
X    touch $OLDFILE
X
Xecho "=== $ME: testing CHANGED files ==="
X    set _ $TRIPWIRE -q; shift
X    ( . $MYRUN ; )  > $LOGFILE ;
X    set _ $STATUSCHA; shift
X    . $MYCHECK 
X
Xecho "=== $ME: testing input schemes ==="
X    . $MYCREATE
X    . $MYCREATETWCONF
X    . $MYINIT
X
Xecho "=== $ME:  tw.config from stdin"
X    set _ $TRIPWIRE -q -c - -d $TWDB; shift
X    ( . $MYRUN ; ) > $LOGFILE < $TWCONFIG ; 
X    set _ 0; shift
X    . $MYCHECK 
X
Xecho "=== $ME:  database from stdin"
X    set _ $TRIPWIRE -q -c $TWCONFIG -d - ; shift
X    ( . $MYRUN ; ) > $LOGFILE < $TWDB ; 
X    set _ 0; shift
X    . $MYCHECK 
X
X
Xecho "=== $ME: testing complex UPDATE cases"
X    . $MYCREATE
X    . $MYCREATETWCONF
X    . $MYINIT
X
Xecho "=== $ME:  changed ignore-mask (UPDATE file)"
X    touch $TMPDIR/d1/f1
X    set _ $TRIPWIRE -q ; shift
X    ( . $MYRUN ; ) > $LOGFILE; 
X    set _ $STATUSCHA; shift
X    . $MYCHECK 
X
X    # change the ignore mask
X    sed "s,$TMPDIR/d1	R,$TMPDIR/d1	L," < $TWCONFIG > /tmp/twx
X    mv /tmp/twx $TWCONFIG
X    set _ $TRIPWIRE -d $TWDB -q -update $TMPDIR/d1/f1; shift
X    ( . $MYRUN ; ) >> $LOGFILE; 
X    set _ 0; shift
X    . $MYCHECK 
X
X    # check to that ignore-masks are different
X    grep "$TMPDIR/d1/f1" ./databases/* | awk '{ print $3; }' > /tmp/tw1
X    grep "$TMPDIR/d1/f1" $TWDB | awk '{ print $3; }' > /tmp/tw2
X    echo "diffing" >> $LOGFILE
X    diff /tmp/tw1 /tmp/tw2 >> $LOGFILE
X    if [ $? -ne 1 ]; then
X	echo "=== $ME: test diff FAILED! (expecting 1, got $?) ==="
X	echo "=== ($LOGFILE contains output from test script and Tripwire) ==="
X	exit 1
X    fi
X
Xecho "=== $ME:  changed ignore-mask (UPDATE entry)"
X    touch $TMPDIR/d1/f1
X    set _ $TRIPWIRE -q ; shift
X    ( . $MYRUN ; ) > $LOGFILE; 
X    set _ $STATUSCHA; shift
X    . $MYCHECK 
X
X    # change the ignore mask
X    sed "s,$TMPDIR/d1	R,$TMPDIR/d1	L," < $TWCONFIG > /tmp/twx
X    mv /tmp/twx $TWCONFIG
X    set _ $TRIPWIRE -d $TWDB -q -update $TMPDIR/d1; shift
X    ( . $MYRUN ; ) >> $LOGFILE; 
X    set _ 0; shift
X    . $MYCHECK 
X
X    # check to that ignore-masks are different
X    grep "$TMPDIR/d1/f1" ./databases/* | awk '{ print $3; }' > /tmp/tw1
X    grep "$TMPDIR/d1/f1" $TWDB | awk '{ print $3; }' > /tmp/tw2
X    echo "diffing" >> $LOGFILE
X    diff /tmp/tw1 /tmp/tw2 >> $LOGFILE
X    if [ $? -ne 1 ]; then
X	echo "=== $ME: test diff FAILED! (expecting 1, got $?) ==="
X	echo "=== ($LOGFILE contains output from test script and Tripwire) ==="
X	exit 1
X    fi
X
Xecho "=== $ME: testing UPDATED files (6 cases)"
X    . $MYCREATE
X    . $MYCREATETWCONF
X    . $MYINIT
X
Xecho "=== $ME:  case 1: update: add new file ==="
X    cp $SAVETWDB ./databases
X    touch $NEWFILE
X    set _ $TRIPWIRE -q ; shift
X    ( . $MYRUN ; ) > $LOGFILE; 
X    set _ $STATUSADD; shift
X    . $MYCHECK 
X    set _ $TRIPWIRE -d $TWDB -q -update $NEWFILE; shift
X    ( . $MYRUN ; ) >> $LOGFILE; 
X    set _ 0; shift
X    . $MYCHECK 
X
X    # move database
X    rm -f databases/*.old
X    cp databases/tw.db* $TWDB
X
X    set _ $TRIPWIRE -q; shift
X    ( . $MYRUN ; ) >> $LOGFILE; 
X    set _ 0; shift
X    . $MYCHECK 
X
Xecho "=== $ME:  case 2: update: delete file ==="
X    rm -f $OLDFILE
X    set _ $TRIPWIRE -q; shift
X    ( . $MYRUN ; ) > $LOGFILE; 
X    set _ $STATUSDEL; shift
X    . $MYCHECK 
X    set _ $TRIPWIRE -d $TWDB -q -update $OLDFILE; shift
X    ( . $MYRUN ; ) >> $LOGFILE; 
X    set _ 0; shift
X    . $MYCHECK 
X    
X    # move database
X    rm -f databases/*.old
X    cp databases/tw.db* $TWDB
X
X    set _ $TRIPWIRE -q; shift
X    ( . $MYRUN ; ) >> $LOGFILE; 
X    set _ 0; shift
X    . $MYCHECK 
X
XCFILE=$TMPDIR/d1/f1
XCDIR=$TMPDIR/d1
X
Xecho "=== $ME:  case 3: update: update file ==="
X    touch $CFILE
X    set _ $TRIPWIRE -q; shift
X    ( . $MYRUN ; ) > $LOGFILE; 
X    set _ $STATUSCHA; shift
X    . $MYCHECK 
X    set _ $TRIPWIRE -d $TWDB -q -update $CFILE; shift
X    ( . $MYRUN ; ) >> $LOGFILE; 
X    set _ 0; shift
X    . $MYCHECK 
X
X    # move database
X    rm -f databases/*.old
X    cp databases/tw.db* $TWDB
X
X    set _ $TRIPWIRE -q; shift
X    ( . $MYRUN ; ) >> $LOGFILE; 
X    set _ 0; shift
X    . $MYCHECK 
X
Xecho "=== $ME:  case 4: nonsense case (skipping) ==="
X
Xecho "=== $ME:  case 6: update: delete entry ==="
X    rm -rf $CDIR
X    set _ $TRIPWIRE -q; shift
X    ( . $MYRUN ; ) > $LOGFILE; 
X    set _ $STATUSDEL; shift
X    . $MYCHECK 
X    set _ $TRIPWIRE -d $TWDB -q -update $CDIR; shift
X    ( . $MYRUN ; ) >> $LOGFILE; 
X    set _ 0; shift
X    . $MYCHECK 
X
X    # move database
X    rm -f databases/*.old
X    cp databases/tw.db* $TWDB
X
X    set _ $TRIPWIRE -q; shift
X    ( . $MYRUN ; ) >> $LOGFILE; 
X    set _ 0; shift
X    . $MYCHECK 
X
Xecho "=== $ME:  case 5: update: add entry ==="
X    mkdir $CDIR
X    set _ $TRIPWIRE -q ; shift
X    ( . $MYRUN ; ) > $LOGFILE; 
X    set _ $STATUSADD; shift
X    . $MYCHECK 
X    set _ $TRIPWIRE -d $TWDB -q -update $CDIR; shift
X    ( . $MYRUN ; ) >> $LOGFILE; 
X    set _ 0; shift
X    . $MYCHECK 
X
X    # move database
X    rm -f databases/*.old
X    cp databases/tw.db* $TWDB
X
X    set _ $TRIPWIRE -q; shift
X    ( . $MYRUN ; ) >> $LOGFILE; 
X    set _ 0; shift
X    . $MYCHECK 
X
XCFILE=$TMPDIR/d2/f1
XCDIR=$TMPDIR/d2
X
Xecho "=== $ME:  case 7: update: update entry ==="
X    touch $CFILE
X    set _ $TRIPWIRE -q; shift
X    ( . $MYRUN ; ) > $LOGFILE; 
X    set _ $STATUSCHA; shift
X    . $MYCHECK 
X    set _ $TRIPWIRE -d $TWDB -q -update $CDIR; shift
X    ( . $MYRUN ; ) >> $LOGFILE; 
X    set _ 0; shift
X    . $MYCHECK 
X
X    # move database
X    rm -f databases/*.old
X    cp databases/tw.db* $TWDB
X
X    set _ $TRIPWIRE -q; shift
X    ( . $MYRUN ; ) >> $LOGFILE ; 
X    set _ 0; shift
X    . $MYCHECK 
X
Xecho "=== $ME: PASS ==="
X
X
Xecho 
Xecho
END_OF_FILE
if test 8790 -ne `wc -c <'tripwire-1.1/tests/test.update.sh'`; then
    echo shar: \"'tripwire-1.1/tests/test.update.sh'\" unpacked with wrong size!
fi
chmod +x 'tripwire-1.1/tests/test.update.sh'
# end of 'tripwire-1.1/tests/test.update.sh'
fi
if test -f 'tripwire-1.1/Ported' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'tripwire-1.1/Ported'\"
else
echo shar: Extracting \"'tripwire-1.1/Ported'\" \(8584 characters\)
sed "s/^X//" >'tripwire-1.1/Ported' <<'END_OF_FILE'
X## $Id: Ported,v 1.8 1993/12/15 23:03:37 genek Exp $ 
X
X##  Following is an information list of machines to which
X##  Tripwire has been ported.  This lists the OS environment,
X##  special flags, skeleton config file, and other info
X##  to enable you to get up and running.  It is *not* quite
X##  complete because not every filesystem configuration will
X##  be represented in this list.
X##
X##  Also, we credit (and thank again!) our beta testers who
X##  provided this information for the release.
X
Xvendor:         several (486/66 PC)
Xos:             386BSD
Xos version:     0.1 patchlevel 0.2.4
Xcompiler:       gcc and cc both work
Xcflags:         -O
Xldflags:
Xlibs:
Xconf.h:         conf_bsd.h
Xtw.config:	tw.conf.386bsd
Xnotes:
Xcontributor:    Cor Bosman <cor@hacktic.nl>
X
Xvendor:         Apple 
Xos:             A/UX
Xos version:     3.x
Xcompiler:       cc
Xcflags:         -O
Xldflags:        
Xlibs:          
Xconf.h:         conf-aux3.h
Xtw.config:
Xcontributor:    Phillip Porch (root@raidernet.com)
X
Xvendor:         AT&T
Xos:             System V
Xos version:     Release 3.2.3
Xcompiler:       cc
Xcflags:         -O
Xldflags:        none
Xconf.h:         conf-3b2g.h
Xtw.config:      Working on one
Xnotes:          Had to modify some source
Xcontributor:    Joe Sirrianni <sirrianni@dockmaster.ncsc.mil>
X
Xvendor:         AT&T
Xos:             System V
Xos version:     Release 4.0.3
Xcompiler:       cc
Xcflags:         -O
Xldflags:        none
Xconf.h:         conf-3b2gr.h
Xtw.config:      Working on one
Xnotes:          
Xcontributor:    Joe Sirrianni <sirrianni@dockmaster.ncsc.mil>
X
Xvendor:         Carnegie-Mellon University
Xos:             Mach
Xos version:     2.x
Xcompiler:       cc
Xcflags:         -O
Xldflags:        none
Xlibs:           none
Xconf.h:         conf-mach.h
Xtw.config:      not available
Xcontributor:    Peter Shipley <shipley@tfs.com>
X
Xvendor:		Convex
Xos:		ConvexOS
Xos version:	9.1
Xcompiler:	cc
Xcflags:		-O
Xldflags:	none
Xlibs:		none
Xconf.h:		conf-convex.h
Xnotes:
Xcontributor:	Adrian P. van Bloois <adrian@cc.ruu.nl>
X
Xvendor:		Cray Research
Xos:		Unicos
Xos version:	6.1.6
Xcompiler:	cc
Xcflags:		-g
Xldflags:	none
Xlibs:		none
Xconf.h:		conf-unicos.h
Xnotes:
Xcontributor:	Michael Barnett <rxxmnb@argolis.osf.rmit.OZ.AU>
Xcontributor:	cristy@eplrx7.es.duPont.com (John Cristy)
Xcontributor:	John Sutton <jggs@acl.lanl.gov>
X
Xvendor:		DEC
Xos:		Ultrix 
Xos version:	4.x
Xcompiler:	cc
Xcflags:		-g
Xldflags:	none
Xlibs:		none
Xconf.h:		conf-bsd.h
Xnotes:
Xcontributor:	Shabbir Safdar <shabby@mentor.cc.purdue.edu>
Xcontributor:	John Sutton <jggs@acl.lanl.gov>
Xcontributor:    Michaela Harlander <harmic@physik.tu-muenchen.de>
Xcontributor:	Edward DeHart <ecd@cert.org>
X
Xvendor:		Encore (Multimax)
Xos:		Umax V
Xos version:	2.4.1.P3
Xcompiler:	cc
Xcflags:		-O
Xldflags:
Xlibs:		-lgnumalloc
Xconf.h:		conf-umaxv.h
Xnotes:		*** there is a bug in the Encore malloc() library ***
Xnotes:		*** please see ./contribs/encore.malloc for a workaround ***
Xnotes:		*** thanks George Tomazi ***
Xcontributor:	Michael Barnett <rxxmnb@argolis.osf.rmit.OZ.AU>
Xcontributor:	Georges Tomazi <tomazi@kralizec.zeta.org.au>
X
Xvendor:		FPS
Xos:		FPX
Xos version:	4.3.3
Xcompiler:	cc
Xcflags:		-g
Xldflags:	none
Xlibs:		none
Xconf.h:		conf-bsd.h
Xtw.config:	
Xnotes:		
Xcontributor:	John Sutton <jggs@acl.lanl.gov>
X
Xvendor:		HP
Xos:		HP/UX
Xos version:	8.x, 9.x
Xcompiler:	cc
Xcflags:		-O -Aa -N		(ansi)
Xcflags:		-O -Ak -N		(k&r)
Xcflags:		-O -Wl,-a,archive -O -Ac (ensure archived, NO shared libraries)
Xldflags:	
Xlibs:		
Xconf.h:		conf-hpux.h
Xnotes:		from Lance Bailey:
Xnotes:			-Aa                   ansi
Xnotes:			-Ac                   K&R
Xnotes:			-Wl,-a,archive        ensure archived and NOT shared libraries on linking
Xnotes:			-O                    optimizer
Xnotes:			-g                    debugger
Xnotes: some versions of the HP C compiler optimizer breaks snefru.c!  
Xnotes:		consider recompiling this file seperately without optimization
Xnotes:		(-spaf and genek)
Xcontributor:	Lance Bailey <lrb@ctrg.rri.uwo.ca>
Xcontributor:	Joe Polcari <jpolcari@galaxy.prime.com>
Xcontributor:    Michaela Harlander <harmic@physik.tu-muenchen.de>
X
Xvendor:		IBM
Xos:		AIX
Xos version:	3.x
Xcompiler:	cc
Xcflags:		-g
Xldflags:	none
Xlibs:		none
Xconf.h:		conf-aix.h
Xcontributor:	Shabbir Safdar <shabby@mentor.cc.purdue.edu>
Xcontributor:	John Sutton <jggs@acl.lanl.gov>
X
Xvendor:         IBM/Intel box
Xos:             BSDI
Xos version:     beta
Xcompiler:       gcc
Xcflags:         -O
Xldflags:        none
Xlibs:           none
Xconf.h:         conf-bsd.h
Xtw.config:
Xnotes:
Xcontributor:    Michaela Harlander <harmic@physik.tu-muenchen.de>
Xcontributor:    Gene Kim <genek@mentor.cc.purdue.edu>
X
Xvendor:		MIPS Computer Systems 
Xos:		EP/IX
Xos version:	1.4.3
Xcompiler:	cc
Xcflags:		-O -systype sysv -I/usr/include/bsd -I/usr/include/sysv
Xldflags:	none
Xlibs:		-lbsd
Xconf.h:		conf-epix.h
Xtw.config:	(Gosh, I haven't submitted one yet)
Xnotes:		
Xcontributor:	Shabbir J. Safdar <shabby@cc.purdue.edu>
Xcontributor:    Michaela Harlander <harmic@physik.tu-muenchen.de>
X
Xvendor:		NeXT 
Xos:		Mach (NeXTstep)
Xos version:	2.x, 3.x
Xcompiler:	cc
Xcflags:		-O (2.x), -O2 (3.0)
Xldflags:	-Bstatic
Xlibs:		none
Xconf.h:		conf-mach.h
Xtw.config:	(Gosh, I haven't submitted one yet)
Xnotes:		
Xcontributor:	Joe Polcari <jpolcari@galaxy.prime.com>
X
Xvendor:		OSF
Xos:		OSF/1
Xos version:	1.0.4
Xcompiler:	cc
Xcflags:		-O
Xlibs:		-lsun -lc_s
Xldflags:	-non_shared
Xconf.h:		conf-osf1.h
Xnotes:
Xcontributor:	Dean Brock <brock@cs.unca.edu>
X
Xvendor:		OSF
Xos:		OSF/1
Xos version:	1.0.4
Xcompiler:	gcc
Xcflags:		-O -g
Xlibs:	
Xldflags:
Xconf.h:		conf-osf1.h
Xnotes:
Xcontributor:	Rich Salz <rsalz@osf.org>
X
Xvendor:         Pyramid
Xos:             DC/OSx (SVR4)
Xos version:     1.1 [all releases]
Xcompiler:       cc
Xcflags:         -O -Kold
Xldflags:        -dn
Xlibs:           none
Xconf.h:         conf-svr4.h
Xtw.config:      
Xcontributor:    Ken McDonell <kenj@pyramid.com>
X
Xvendor:         Pyramid
Xos:             OSx (att universe)
Xos version:     5.1 [all releases]
Xcompiler:       cc
Xcflags:         -OG
Xldflags:        none
Xlibs:           none
Xconf.h:         conf-osx-att.h
Xtw.config:      
Xcontributor:    Ken McDonell <kenj@pyramid.com>
X
Xvendor:         Pyramid
Xos:             OSx (ucb universe)
Xos version:     5.1 [all releases]
Xcompiler:       cc
Xcflags:         -OG
Xldflags:        none
Xlibs:           none
Xconf.h:         conf-osx-ucb.h
Xtw.config:      
Xcontributor:    Ken McDonell <kenj@pyramid.com>
X
Xvendor:		Sequent
Xos:		Dynix
Xos version:	3.x
Xcompiler:	cc
Xcflags:		-O
Xldflags:
Xlibs:		
Xconf.h:		conf-dynix.h
Xnotes:
Xcontributor:	Gene Kim <genek@mentor.cc.purdue.edu>
X
Xvendor:         Sequent
Xos:             dynix/PTX
Xos version:     2.0.x
Xcompiler:       cc
Xcflags:         -O
Xldflags:        none
Xlibs:           none
Xconf.h:         conf-ptx2.h
Xtw.config:
Xnotes:  	Don't confuse dynix/PTX with dynix. Dynix is
Xnotes:  	BSD and dynix/PTX is SYSV
Xcontributor:    Michael Perrone <a4mp@loki.cc.pdx.edu>
X
Xvendor:         Sun
Xos:             SunOS
Xos version:     4.0.3
Xcompiler:       gcc, cc
Xcflags:         -O
Xldflags:        -Bstatic
Xlibs:           none
Xconf.h:         conf-bsd.h
Xtw.config:      I have submitted one
Xnotes:		if you run ARM/ASET, see ./contrib/README.ASET
Xcontributor:    Joe Polcari <jpolcari@galaxy.prime.com>
Xcontributor:	John Sutton <jggs@acl.lanl.gov>
Xcontributor:	Brad Powell <Brad.Powell@Corp.Sun.COM>
X
Xvendor:		Sun Microsystems, Inc.
Xos:		SunOS 
Xos version:	5.x (Solaris 2.x)
Xcompiler:	cc
Xcflags:		-O
Xldflags:
Xlibs:		
Xconf.h:		conf-svr4.h
Xtw.config:	tw.conf.sunos5
Xnotes:
Xcontributor:	Brad Powell <Brad.Powell@Corp.Sun.COM>
Xcontributor:    Michaela Harlander <harmic@physik.tu-muenchen.de>
Xcontributor:    Bob Cunningham <bob@kahala.soest.hawaii.edu>
X
Xvendor:		SCO, Tandy
Xos:		Xenix
Xos version:	03.02.00, 2.2.4
Xcompiler:	cc
Xcflags:		
Xldflags:
Xlibs:		-lx
Xconf.h:		conf-xenix.h
Xnotes:
Xcontributor:	Daniel Ray <norstar@tnl.com>
X
X
Xvendor:         Santa Cruz Operation
Xos:             XENIX System V 386
Xos version:     2.2.6
Xcompiler:       Microsoft C 5.1
Xcflags:         -O
Xldflags:        -s -lx
Xlibs:           none
Xconf.h:         conf-sysv4.h  [modified for xenix to support MAXNAMLEN]
Xtw.config: 
Xnotes:          see all my email to you
Xcontributor:    Daniel Ray <norstar@tnl.com>
X
Xvendor:		SGI
Xos:		IRIX
Xos version:	4.x
Xcompiler:	cc
Xcflags:		-O -cckr
Xlibs:		none
Xldflags:	none
Xconf.h:		conf-svr4.h
Xnotes:
Xcontributor:	Bill Henderson <billh@bike.hampton.sgi.com>
Xcontributor:	John G. Sutton <jggs@acl.lanl.gov>
X
Xvendor:		SGI
Xos:		IRIX
Xos version:	4.0.5
Xcompiler:	cc
Xcflags:	
Xldflags:
Xlibs:		-lsun -lc_s
Xconf.h:		conf-irix4.h
Xnotes:
Xcontributor:	Simon Leinen <simon@lia.di.epfl.ch>
END_OF_FILE
if test 8584 -ne `wc -c <'tripwire-1.1/Ported'`; then
    echo shar: \"'tripwire-1.1/Ported'\" unpacked with wrong size!
fi
# end of 'tripwire-1.1/Ported'
fi
if test -f 'tripwire-1.1/sigs/snefru/README.snefru' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'tripwire-1.1/sigs/snefru/README.snefru'\"
else
echo shar: Extracting \"'tripwire-1.1/sigs/snefru/README.snefru'\" \(8500 characters\)
sed "s/^X//" >'tripwire-1.1/sigs/snefru/README.snefru' <<'END_OF_FILE'
X# $Id: README.snefru,v 1.2 1993/08/19 05:28:12 genek Exp $ 
X
X    The Snefru one-way hash function package is copyrighted by
XXerox Corporation.  The following disclaimer can be found in the
XSnefru C code:  (Comments on changes made to accomodate its use
Xwithin Tripwire follow the disclaimer.)
X
X==================
X
X/*
X  This is an implementation of Snefru. Snefru is a one-way hash
X  function that provides authentication. It does not provide secrecy.
X  
X  Snefru is named after a Pharaoh of ancient Egypt.
X  
X  Copyright (c) Xerox Corporation 1989. All rights reserved.
X  
X  License to copy and use this software is granted provided that it is
X  identified as the "Xerox Secure Hash Function" in all material mentioning
X  or referencing this software or this hash function.
X  
X  License is also granted to make and use derivative works provided that such
X  works are identified as "derived from the Xerox Secure Hash Function" in
X  all material mentioning or referencing the derived work.
X  
X  Xerox Corporation makes no representations concerning either the
X  merchantability of this software or the suitability of this software for
X  any particular purpose.  It is provided "as is" without express or implied
X  warranty of any kind.
X  
X  These notices must be retained in any copies of any part of this software.
X  
X  Updated information about Snefru is available from arisia.xerox.com in
X  directory /pub/hash by anonymous FTP.  The README file provides a quick
X  introduction.
X
X  This is version 2.5a, November 29, 1990.
X  Version 2.5a provides a reasonably understandable and efficient
X	implementation of Snefru.  Further, this version provides
X	8 passes.  While 4 pass Snefru has not been broken, the use
X	of 4 pass Snefru for production use is not recommended at
X	this time.  Further study of the security of Snefru is
X	required before production use is advisable.
X  
X  This program reads from the standard input until EOF is reached (the first
X  "read" that returns 0 bytes).  The data on the standard input is "hashed"
X  with a cryptographically secure one-way hash function (also known as a
X  "message digest", "fingerprint", "Manipulation Detection Code" or "MDC").
X  The hash is then printed on the standard output.
X  
X  The input can be of any size.  The output is 128 bits printed as 32
X  characters in hex.  The output size can be changed to 256 bits be setting
X  the parameter OUTPUT_BLOCK_SIZE to 8.  (The 8 indicates the number of
X  32-bit words in the output).
X  
X  The primary use of one-way hash functions is to determine if there have been
X  any unauthorized, malicious, or accidental changes made to a file.  For
X  example, if an executable program file produces the hash "209884c4
X  2e89d967 5456ac0e 61269550", then any change to that program file will
X  cause the hash to be changed.  Thus, the tampering can be detected by
X  comparing the current output value with the previously computed (and
X  presumably correct) output value.
X  
X  Hash512 is the centrol routine in this program.  It is used in this program in
X  a linear fashion -- i.e., a sequential file is hashed down by repeated
X  applications of Hash512.  Changing a single bit in the file would then
X  require completely re-computing the hash from the point of change onward.
X  
X  Hash512 can be used in a tree-structured fashion to authenticate a large table
X  of data. This would imply that changing a single bit would not force a
X  complete re-computation of the hash value, but would instead require only
X  log n re-computations of Hash512 to "patch up" the changes along the path
X  from the root to the changed leaf entry. A tree-structured application
X  also has the advantage that any single entry in the table can subsequently
X  be authenticated by someone who knows only the "authentication path" from
X  the root of the tree to the leaf entry.  These concepts are discussed more
X  thoroughly in "Secrecy, Authentication, and Public Key Systems" by Ralph
X  C. Merkle, UMI Research Press, 1982 (see particularly Chapter 2, "One Way
X  Hash Functions").  The use of a tree-structured pattern of applications of
X  a one-way hash function is covered by U.S. Patent #4,309,569, "Method of
X  Providing Digital Signatures" (contact Stanford University, Office of
X  Technology Licensing).
X  
X  
X  At the present time (November 29, 1990) the author knows of no method for
X  "breaking" this one-way function, (i.e., finding two input files that
X  produce the same output value).
X  
X  We recommend against the use of output sizes smaller than 128 bits, and
X  against the use of an input that is less than 2 (two) words larger than
X  the size of the output.  When the input size equals the output size,
X  Snefru suffers a serious degradation in security (an observation due to
X  Coppersmith).
X
X  Further study and validation of the security of Snefru is required prior
X  to production use.
X  
X  If anyone using this program finds two different inputs that produce the same
X  output, please contact Ralph C. Merkle via E-mail (merkle@xerox.com) or
X  via normal mail at: Xerox PARC 3333 Coyote Hill Road Palo Alto, CA 94304
X  (415) 494-4000
X  
X  
X  See the paper "A Fast Software One Way Hash Function" by Ralph C. Merkle,
X  to appear in The Journal of Cryptology, for a more detailed explanation.
X  
X  The following test cases were taken directly from a terminal, and can be used
X  to verify the correct functioning of an implementation of Snefru.  The
X  first input is simply a carriage return followed by control-d.  The second
X  input is "1" followed by carriage return followed by control-d, the third
X  input is "12" followed by carriage return followed by control-d, etc.
X  (In some cases, two control-d's will be required).
X
XNote that the test cases given are from 8-pass Snefru (e.g., SECURITY_LEVEL=8)
X
X% ./snefru
X
X d9fcb317 1c097fbb a8c8f12a a0906bad
X% ./snefru
X1
X 44ec420c e99c1f62 feb66c53 c24ae453
X% ./snefru
X12
X 7182051a a852ef6f ba4b6c9c 9b79b317
X% ./snefru
X123
X bc3a50af 82bf56d6 a64732bc 7b050a93
X% ./snefru
X1234
X c5b8a049 85a8eadf b4331a89 88752b77
X% ./snefru
X12345
X d559a2b6 2f6f4411 1324f852 08723707
X% ./snefru
X123456
X 6cfb5e8f 1da02bd1 67b01e48 16686c30
X% ./snefru
X1234567
X 29aa4832 5f275a8a 7a01ba15 43c54ba5
X% ./snefru
X12345678
X be862a6b 68b7df88 7ebe0031 9cbc4a47
X% ./snefru
X123456789
X 6103721c cd8ad565 d68e90b0 f8906163
X% 
X
X
XThe following outputs were obtained after the program was
Xcompiled with OUTPUT_BLOCK_SIZE set to 8.  This can be done
Xby using the -D option on cc, as:
Xcc -o snefru256 -DOUTPUT_BLOCK_SIZE=8 snefru.c
X
XNote that the test cases given are from 8-pass Snefru (e.g., SECURITY_LEVEL=8)
X
X% ./snefru256
X
X 2e02687f 0d45d5b9 b50cb68c 3f33e684 3d618a1a ca2d0689 3d3eb4e3 026b5732
X% ./snefru256
X1
X bfea4a05 a2a2ef15 c736d114 598a20b9 d9bd4d66 b661e6b0 5ecf6a77 37bdc58c
X% ./snefru256
X12
X ac677d69 761ade3f 189c7aef 106d5fe7 392d324e 19cc76d5 db4a2c05 f2cc2cc5
X% ./snefru256
X123
X 061c76aa 1db4a22c 0e42945e 26c48499 b5400162 e08c640b e05d3c00 7c44793d
X% ./snefru256
X1234
X 1e87fe1d 9c927e9e 24be85e3 cc733598 73541640 a6261793 ce5a9749 53113f5e
X% ./snefru256
X12345
X 1b59927d 85a9349a 87796620 fe2ff401 a06a7ba4 8794498e bab978ef c3a68912
X% ./snefru256
X123456
X 28e9d9bc 35032b68 faeda881 01ecb252 4317e9da 111b0e3e 70941072 12d9cf72
X% ./snefru256
X1234567
X f7fff4ee 74fd1b8d 6b3267f8 4e47e007 f029d13b 8af7e37e 34d13b46 9b8f248f
X% ./snefru256
X12345678
X ee7d64b0 102b2205 e9892661 3b200185 559d08be 6ad787da 717c9687 44e11af3
X% ./snefru256
X123456789
X 4ca72639 e40e9ab9 c0c3f523 c4449b39 11632d37 4c124d77 02192ec2 e4e0b7a3
X% 
X
X  Note that "word32" MUST be 32 bits
X  
X  Implementor:  Ralph C. Merkle
X  
X */
X
X==================
X
X    The Snefru one-way hash function package is copyrighted by
XXerox Corporation.  The disclaimer from the C code has been
Xretained, and is shown above.
X
X    All big-endian/little-endian specific code in snefru.c has
Xbeen replaced by code that can resolve this automatically at
Xcompile-time.  Tripwire specific code is also in snefru.c to
Xto minimize the amount of overhead in collecting signatures from
Xwithin Tripwire.  (We certainly don't want to fork() for every
Xfile we need to scan!)
X
X    Because of this, snefru.c is no longer identical to the
Xvirgin Snefru distribution.  I have sent my changes to the
Xauthor, but I am not aware of any buybacks at this time.
X
X    The original Snefru code can be obtained via anonymous FTP
Xfrom arisia.xerox.com.  The original README file has been
Xretained in the Tripwire distribution.
X
X
X
XGene Kim
XSeptember 7, 1992
END_OF_FILE
if test 8500 -ne `wc -c <'tripwire-1.1/sigs/snefru/README.snefru'`; then
    echo shar: \"'tripwire-1.1/sigs/snefru/README.snefru'\" unpacked with wrong size!
fi
# end of 'tripwire-1.1/sigs/snefru/README.snefru'
fi
if test -f 'tripwire-1.1/include/tripwire.h' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'tripwire-1.1/include/tripwire.h'\"
else
echo shar: Extracting \"'tripwire-1.1/include/tripwire.h'\" \(8202 characters\)
sed "s/^X//" >'tripwire-1.1/include/tripwire.h' <<'END_OF_FILE'
X/* $Id: tripwire.h,v 1.23 1993/12/15 16:58:24 genek Exp $ */
X
X/************************************************************************
X *
X *   All files in the distribution of Tripwire are Copyright 1992, 1993 by 
X *   the Purdue Research Foundation of Purdue University.  All rights
X *   reserved.  Some individual files in this distribution may be covered
X *   by other copyrights, as noted in their embedded comments.
X *
X *   Redistribution and use in source and binary forms are permitted
X *   provided that this entire copyright notice is duplicated in all such
X *   copies, and that any documentation, announcements, and other
X *   materials related to such distribution and use acknowledge that the
X *   software was developed at Purdue University, W. Lafayette, IN by
X *   Gene Kim and Eugene Spafford.  No charge, other than an "at-cost"
X *   distribution fee, may be charged for copies, derivations, or
X *   distributions of this material without the express written consent
X *   of the copyright holder.  Neither the name of the University nor the
X *   names of the authors may be used to endorse or promote products
X *   derived from this material without specific prior written
X *   permission.  THIS SOFTWARE IS PROVIDED ``AS IS'' AND WITHOUT ANY
X *   EXPRESS OR IMPLIED WARRANTIES, INCLUDING, WITHOUT LIMITATION, THE
X *   IMPLIED WARRANTIES OF MERCHANTIBILITY AND FITNESS FOR ANY PARTICULAR
X *   PURPOSE.
X *
X ************************************************************************/
X
X/*
X * tripwire.h
X *
X *	common definitions for Tripwire
X *
X * Gene Kim
X * Purdue University
X * October 18, 1992
X */
X
X/* version information */
X
X#define VERSION_NUM 	"1.1"
X#define DB_VERSION_NUM	3
X
X/* For signature routines prototypes: */
X
X#include "../sigs/snefru/snefru.h"
X#include "../sigs/md5/md5.h"
X#include "../sigs/crc32/crc32.h"
X#include "../sigs/crc/crc.h"
X#include "../sigs/md2/md2.h"
X#include "../sigs/md4/md4.h"
X#include "../sigs/sha/sha.h"
X
X/* essential includes common to all sources files */
X
X#include <errno.h>
X
X
X/* get any missing inode typedefs */
X
X#include "../include/inode.h"
X
X/* database record format */
X/* filename: (entrynumber, ignorevec, st_mode, st_ino, st_nlink,
X *		st_uid, st_gid, st_size,
X *		ltob64(statbuf->st_atime, vec64_a),
X *		ltob64(statbuf->st_mtime, vec64_m),
X *		ltob64(statbuf->st_ctime, vec64_c), sig0, sig1, ..., sig9
X */
X
X# define DB_RECORD_FORMAT "%ld %s %lo %lu %lu %lu %lu %lu %s %s %s %s %s %s %s %s %s %s %s %s %s\n"
X#define DB_RECORD_FIELDS 21
X
X/* system defaults */
X
Xextern int db_version_num;
Xextern char *config_file;	
Xextern char *config_path;	
Xextern char *database_file;	
Xextern char *database_path;	
Xextern char tempdatabase_file[];
Xextern FILE *fptempdbase;
Xextern int debuglevel, verbosity, quietmode, printpreprocess;
Xextern int test_interactive;
Xextern char *specified_dbasefile, *specified_configfile;
Xextern int specified_configfd, specified_dbasefd;
Xextern char *progname;
Xextern char *defaultignore;
Xextern char *db_record_format;
Xextern struct list *olddbase_list;
Xextern struct list *toc_list;
Xextern char *version_num;
X/*
Xextern struct list *entry_list;
X*/
Xextern char backupfile[];
Xextern int printhex;
Xextern int runtimeignore;
Xextern int loosedir;
X
X/* debugging verbosity */
X
X#define SPDEBUG(x) if (debuglevel >= (x))
X
X#define TRUE 1
X#define FALSE 0
X
X#define SIG_MAX_LEN 200
X
X/* ignore vector flags */
X/*	note:  as an optimization, IGNORE_0 .. IGNORE_9 are ordered.
X *	do not change the ordering of these vectors!
X */
X
X#define IGNORE_P	0x1
X#define IGNORE_I	0x2
X#define IGNORE_N	0x4
X#define IGNORE_U	0x8
X#define IGNORE_G	0x10
X#define IGNORE_S	0x20
X#define IGNORE_A	0x40
X#define IGNORE_M	0x80
X#define IGNORE_C	0x100
X#define IGNORE_0	0x200
X#define IGNORE_1	0x400
X#define IGNORE_2	0x800
X#define IGNORE_3	0x1000
X#define IGNORE_4	0x2000
X#define IGNORE_5	0x4000
X#define IGNORE_6	0x8000
X#define IGNORE_7	0x10000
X#define IGNORE_8	0x20000
X#define IGNORE_9	0x40000
X#define IGNORE_0_9	(IGNORE_0|IGNORE_1|IGNORE_2|IGNORE_3|IGNORE_4|IGNORE_5|IGNORE_6|IGNORE_7|IGNORE_8|IGNORE_9)
X#define IGNORE_GROW	0x80000		/* growing log files */
X
X/* filelist flags */
X#define FLAG_CHANGED 	1
X#define FLAG_NOOPEN	2
X#define FLAG_SYMLINK	4
X#define FLAG_SEEN	8
X#define FLAG_UPDATE	16
X#define FLAG_UNCHANGE	32
X#define FLAG_DELETE	64
X
X/* prunelist flags */
X#define PRUNE_ALL	1
X#define PRUNE_ONE	2
X
X/* database_build() modes */
X
X#define DBASE_PERMANENT		0
X#define DBASE_TEMPORARY 	1
X#define DBASE_UPDATE 		2
X
X/* database update modes */
X
X#define UPDATE_INVALID		0
X#define UPDATE_ADDFILE		1
X#define UPDATE_DELETEFILE	2
X#define UPDATE_UPDATEFILE	3
X#define UPDATE_NOTFOUND		4
X#define UPDATE_ADDENTRY		5
X#define UPDATE_DELETEENTRY	6
X#define UPDATE_UPDATEENTRY	7
X
X
X/* diff lists */
Xextern struct list *diff_added_list,
X		   *diff_deleted_list,
X		   *diff_changed_list;
Xextern int 	diff_added_num,
X    		diff_changed_num,
X		diff_deleted_num,
X		diff_unignored_num;
Xextern int	files_scanned_num;
X
X/* diff parsing */
X
Xstruct diff_bucket {
X    int 	arg1, arg2, arg3, arg4;
X    int		diffmode;
X};
X
X/* diff_parsing() types */
X#define DIFF_SAME 	0
X#define DIFF_CHANGED	1
X#define DIFF_ADDED	2
X#define DIFF_DELETED	3
X
X/* signature functions */
X#define NUM_SIGS	10
Xextern int (*pf_signatures[NUM_SIGS]) ();
Xextern char *signames[NUM_SIGS];
X
X/* prototypes */
X
X/*** Do not remove this line.  Protyping depends on it! ***/
X#if defined(__STDC__) || defined(__cplusplus)
X#define P_(s) s
X#else
X#define P_(s) ()
X#endif
X
X/* config.parse.c */
Xvoid configfile_read P_((struct list **pp_list, struct list **pp_entry_list));
X/* main.c */
Xint main P_((int argc, char *argv[]));
X/* list.c */
Xvoid list_set P_((char *pc_name, char *pc_value, int priority, struct list **pp_list));
Xchar *list_lookup P_((char *pc_name, struct list **pp_list));
Xint list_isthere P_((char *pc_name, struct list **pp_list));
Xvoid list_unset P_((char *pc_name, struct list **pp_list));
Xint list_setflag P_((char *pc_name, int flag, struct list **pp_list));
Xint list_getflag P_((char *pc_name, struct list **pp_list));
Xvoid list_print P_((struct list **pp_list));
Xvoid list_reset P_((struct list **pp_list));
Xint list_init P_((void));
Xint list_open P_((struct list **pp_list));
Xstruct list_elem *list_get P_((struct list **pp_list));
Xint list_close P_((struct list **pp_list));
X/* ignorevec.c */
Xint ignore_vec_to_scalar P_((char *s));
Xvoid ignore_configvec_to_dvec P_((char *s));
X/* dbase.build.c */
Xvoid database_build P_((struct list **pp_list, int mode, struct list **pp_entry_list));
X/* utils.c */
Xvoid warn_with_err P_((char *format, char *name));
Xvoid die_with_err P_((char *format, char *name));
Xvoid filename_hostname_expand P_((char **ps));
Xint slash_count P_((char *pathname));
Xint string_split_space P_((char *string, char *s, char *t));
Xint string_split_ch P_((char *string, char *s, char *t, int ch));
Xvoid chop P_((char *s));
Xvoid filename_escape_expand P_((char *filename));
Xchar *filename_escape P_((char *filename));
X/* char *ltob64 P_((register unsigned long num, char *vec64)); */
Xlong b64tol P_((char *vec));
Xvoid direntry_print P_((char *name, struct stat statbuf, int mode));
Xchar *pltob64 P_((unsigned long *pl, char *pcout, int numlongs));
Xchar *btob64 P_((unsigned char *pcbitvec, char *pcout, int numbits));
X/* preen.c */
Xvoid update_gather P_((int interactive, char ***ppp_updateentries));
Xvoid update_mark P_((char **ppentry, int num));
Xvoid dbase_entry_howclose P_((char *filename, struct list **ppentrylist, char *pentryname, int *pentrynum));
X/* preen.interp.c */
Xvoid preen_interp P_((FILE *fpin));
X/* preen.report.c */
Xvoid preen_report P_((int interactive, char ***ppp_updateentries));
X/* nullsig.c */
Xint sig_null_get P_((int fd_in, char *ps_signature, int siglen));
X/* config.prim.c */
Xvoid tw_mac_define P_((char *varname, char *varvalue));
Xchar *tw_mac_dereference P_((char *varname));
Xvoid tw_mac_undef P_((char *varname));
Xint tw_mac_ifdef P_((char *varname));
Xint tw_mac_ifhost P_((char *hostname));
X/* dbase.update.c */
Xvoid dbase_entry_flag P_((struct list **pp_list, int flagentry, int orflag, char *ignore));
X/* config.pre.c */
Xvoid tw_macro_parse P_((char *filename, FILE *fpin, FILE *fpout, struct list **pp_entry_list));
X/* help.c */
Xvoid tw_help_print P_((FILE *fpout));
END_OF_FILE
if test 8202 -ne `wc -c <'tripwire-1.1/include/tripwire.h'`; then
    echo shar: \"'tripwire-1.1/include/tripwire.h'\" unpacked with wrong size!
fi
# end of 'tripwire-1.1/include/tripwire.h'
fi
if test -f 'tripwire-1.1/configs/conf-osf1.h' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'tripwire-1.1/configs/conf-osf1.h'\"
else
echo shar: Extracting \"'tripwire-1.1/configs/conf-osf1.h'\" \(919 characters\)
sed "s/^X//" >'tripwire-1.1/configs/conf-osf1.h' <<'END_OF_FILE'
X/* $Id: conf-osf1.h,v 1.2 1993/08/19 05:26:59 genek Exp $ */
X
X/*
X * conf-osf1.h
X *
X *	Tripwire configuration file
X *
X * Gene Kim
X * Purdue University
X *
X * OSF/1 port by:
X *	Rich Salz <rsalz@osf.org>
X */
X
X/***
X *** Operating System specifics
X ***	
X ***	If the answer to a question in the comment is "Yes", then
X ***	change the corresponding "#undef" to a "#define"
X ***/
X
X/*
X * is your OS a System V derivitive?  if so, what version?
X *			(e.g., define SYSV 4)
X */
X
X#undef SYSV
X
X/* 
X * does your system have a <malloc.h> like System V? 
X */
X
X#undef MALLOCH 	
X
X/* 
X * does your system have a <stdlib.h> like POSIX says you should? 
X */
X
X#undef STDLIBH
X
X/* 
X * does your system have gethostname(2) (instead of uname(2))?
X */
X
X#define GETHOSTNAME
X
X/*
X * does your system use readdir(3) that returns (struct dirent *)?
X */
X
X#define DIRENT
X
X/*
X * is #include <string.h> ok?  (as opposed to <strings.h>)
X */
X
X#define STRINGH
END_OF_FILE
if test 919 -ne `wc -c <'tripwire-1.1/configs/conf-osf1.h'`; then
    echo shar: \"'tripwire-1.1/configs/conf-osf1.h'\" unpacked with wrong size!
fi
# end of 'tripwire-1.1/configs/conf-osf1.h'
fi
echo shar: End of archive 21 \(of 25\).
cp /dev/null ark21isdone
MISSING=""
for I in 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 ; do
    if test ! -f ark${I}isdone ; then
	MISSING="${MISSING} ${I}"
    fi
done
if test "${MISSING}" = "" ; then
    echo You have unpacked all 25 archives.
    echo "Now read tripwire-1.1/README.kits"
    rm -f ark[1-9]isdone ark[1-9][0-9]isdone
else
    echo You still need to unpack the following archives:
    echo "        " ${MISSING}
fi
##  End of shell archive.
exit 0
