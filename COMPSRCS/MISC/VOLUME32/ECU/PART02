Newsgroups: comp.sources.misc
From: wht@n4hgf.Mt-Park.GA.US (Warren Tucker)
Subject:  v32i037:  ecu - ECU Asynchronous Communications v3.20, Part02/40
Message-ID: <1992Sep11.191456.4991@sparky.imd.sterling.com>
X-Md4-Signature: 3aecc09cb929a281980593a0efa44358
Date: Fri, 11 Sep 1992 19:14:56 GMT
Approved: kent@sparky.imd.sterling.com

Submitted-by: wht@n4hgf.Mt-Park.GA.US (Warren Tucker)
Posting-number: Volume 32, Issue 37
Archive-name: ecu/part02
Environment: SCO,XENIX,ISC,SUNOS,SYSVR4,HDB,Curses
Supersedes: ecu: Volume 21, Issue 53-89

---- Cut Here and feed the following to sh ----
#!/bin/sh
# this is ecu320.02 (part 2 of ecu320)
# do not concatenate these parts, unpack them in order with /bin/sh
# file README.Q-and-A continued
#
if test ! -r _shar_seq_.tmp; then
	echo 'Please unpack part 1 first!'
	exit 1
fi
(read Scheck
 if test "$Scheck" != 2; then
	echo Please unpack part "$Scheck" next!
	exit 1
 else
	exit 0
 fi
) < _shar_seq_.tmp || exit 1
if test ! -f _shar_wnt_.tmp; then
	echo 'x - still skipping README.Q-and-A'
else
echo 'x - continuing file README.Q-and-A'
sed 's/^X//' << 'SHAR_EOF' >> 'README.Q-and-A' &&
X> with kbdtest3 for each, but I can't get them to intersect enough to have
X> them be one common entry.  (I haven't fiddled with the .Xdefaults.)  I
X> would like to be able to store the keymaps in funckeymap as "xterm-sunc"
X> and "xterm-dec" and have either a command-line switch or environment
X> variable such as ECUKEYS select which one I want, since the TERM
X> variable just isn't sufficient to choose in this case.
X> 
X> $TERM is marvelously adequate for doing all the curses stuff.  Nothing
X> need be changed there.
X> -- 
X> Clayton Haapala	(clayh@network.com)	
X> Network Systems Corp.			"...and the alligators are on FIRE."
X> 7625 Boone Ave N MS10				-- S.E.K.
X> Minneapolis, MN 55428-1099
X
XThe answer within the current framework is to use xmodmap and/or
Xoverride translations to make the keys generate the same
Xsequences on both systems.
X
XThe ultimate answer is, as you suggest, to do something "better."
XI just haven't come up with anything yet.
X
XIf you are networked so that ~/.ecu becomes the same directory
Xeven on two different machines/xterm implementations, my pitiful
Xattempts break down.  I have always suggested forcing xterms to
Xhave a consistent keyboard, but this is not always possible.
XIt is what I do for a SunOS MIT server and a SCO UNIX Roell X386
X1.1b.  If I got really motivated, I'd change the Roell code
Xto match the Sun server.  But then, I wouldn't be able to
Xmake accurate code and recommendations for other Roell users.
X
XThis is, in fact, partly a specification deficit and partly a
Xproblem of incomplete porting.  Anyone who has ever ported X
Xwould be very happy when they get down to these small matters
Xand if they never use the Home or Shift Tab, they'll never know.
X
XLemme think on this one.
SHAR_EOF
echo 'File README.Q-and-A is complete' &&
chmod 0644 README.Q-and-A ||
echo 'restore of README.Q-and-A failed'
Wc_c="`wc -c < 'README.Q-and-A'`"
test 2046 -eq "$Wc_c" ||
	echo 'README.Q-and-A: original size 2046, current size' "$Wc_c"
rm -f _shar_wnt_.tmp
fi
# ============= README.RTSCTS ==============
if test -f 'README.RTSCTS' -a X"$1" != X"-c"; then
	echo 'x - skipping README.RTSCTS (File already exists)'
	rm -f _shar_wnt_.tmp
else
> _shar_wnt_.tmp
echo 'x - extracting README.RTSCTS (Text)'
sed 's/^X//' << 'SHAR_EOF' > 'README.RTSCTS' &&
XFull duplex hardware flow control is correctly handled by only
Xone UNIX entity I know of: the FAS public domain async driver for
Xvarious 386 unixes.
X
XI have not seen what SVR4 has to offer.
X
XSunOs has partial support.
X
XSCO UNIX and XENIX has a completely useless method based on the
Xclassical synchronous modem model: the DTE raises RTS when it
Xwishes to send and waits for CTS from the modem.  Modems at slave
Xlocations on master-slave multidrop lines leave their carrier off
Xexcept when the DTE is transmitting.  The DTE says "RTS", the
Xmodem turns on its carrier and raises its CTS line after the
Xmodem carrier is stable enough to support data transmission.
X
XPerhaps, some modems are smart enough to detect another modem
X"using" the path.  In such cases, the modem remains quiet and
Xdeny RTS to the DTE until the path is quiet.
X
XThis is great for synchronous applications, but asynchronous
Xcommunications requires (greatly benefits from) bidirectional
Xflow control where the RTS line becomes, in fact, a "DTE CTS".
XRTS is true when the DCE may transmit to the DCE and false
Xwhen it may not.
X
XThis de facto reassignment has never become a standard and
Xfew UNIX vendors support it.  The Telebits and other
Xfast modems do support this mechanism.
X
XSigh, one day, maybe UNIX will generally embrace such use.
X
XUpdate!  Thanks Ronald:
X
XFrom n4hgf!kd4nc!emory!wupost!usc!sdd.hp.com!nigel.msen.com!hela.iti.org!widener!eff!ibmpcug!pipex!demon!gate.demon.co.uk!ronald Wed Jul 22 21:09:23 1992
XPath: n4hgf!kd4nc!emory!wupost!usc!sdd.hp.com!nigel.msen.com!hela.iti.org!widener!eff!ibmpcug!pipex!demon!gate.demon.co.uk!ronald
XFrom: ronald@gate.demon.co.uk (Ronald Khoo)
XNewsgroups: comp.unix.sysv386
XSubject: Re: SCO Unix 3.2v4, RTSFLOW, CTSFLOW and CRTSFL
XMessage-ID: <9207192054.aa26742@gate.demon.co.uk>
XDate: 19 Jul 92 19:55:04 GMT
XReferences: <JOCHEN.92Jul12064058@busybit.mrz.lm.sub.org> <2A6326A2.6C61@tct.com>
XSender: usenet@gate.demon.co.uk
XOrganization: Demon Internet Services.
XLines: 48
XX-Mailer: Mail User's Shell (7.2.4 2/2/92)
X
Xchip@tct.com (Chip Salzenberg) wrote:
X
X> Does anyone out there understand:
X> 
X>    1.  What RTSFLOW and CTSFLOW do, singly and in combination,
X>          under (A) 3.2v2 and (B) 3.2v4?
X
XSupposedly no change.  They are intended for true half-duplex modem-style
Xline-control, i.e. the REAL meaning of RTS/CTS.  I think it's possible
Xto use CTSFLOW only for printer flow control, but don't hold me to that :-)
X
XSome vendors, e.g. Specialix, specifically interpret the flags as being
Xfor full duplex flow control, not line control, since that's essentially
Xuseless for the kind of applications which their markets want, and
XCRTSFL was not available prior to 3.2v4
X
X>    2.  What CRTSFL does, compared to 1(A) and 1(B)?
X
XCRTSFL is new with 3.2v4 and does mean full duplex flow control,
Xwhat EIA-232 calls RFR/CTS flow control.  RFR "Ready for receive" is
Xactually a different circuit number according to the spec, but is
Xthe same pin on a V.24 25-way D connector.
X
XConfused ?  You will be.
X
XThe problem is that if you use a current Specialix card on a 3.2v4 system,
Xand want RFR/CTS flow control, you still have to use the wrong flags,
Xie CTSFLOW|RTSFLOW  rather than CRTSFL because the drivers were written
Xfor 3.2v2.  Hence I had to ask Morning Star Technologies who supply
XPPP for this site to give me two different option flags so that
Xif the line is the standard /dev/tty1A I use CRTSFL to get the flow control
XI want, but if I'm in via the Specialix multiport then I use CTSFLOW|RTSFLOW.
X
XIf you want full duplex flow control on /dev/tty1A, you have to either
Xupgrade to 3.2v4 or else install FAS (which uses minor numbers rather
Xthan termio flags to indicate flow control).
X
XUnravelling this has taken a lot of effort, but at the end of the day
Xwe have a service running with flow control working correctly on a rackfull
Xof modems on different ports.   case "`tty`" in foo) ;; bar) ;; esac
Xrules OK :-(
X
XUgh.  You are in a twisty maze of termio flags, all different.
X
X
X-- 
XRonald Khoo <ronald@demon.co.uk> <ronald@ibmpcug.co.uk> <ronald@robobar.co.uk>
XBTNet: +44 71 229 7741                    | Brambles are the order of the day.
X
SHAR_EOF
chmod 0644 README.RTSCTS ||
echo 'restore of README.RTSCTS failed'
Wc_c="`wc -c < 'README.RTSCTS'`"
test 4167 -eq "$Wc_c" ||
	echo 'README.RTSCTS: original size 4167, current size' "$Wc_c"
rm -f _shar_wnt_.tmp
fi
# ============= README.SCOTTY ==============
if test -f 'README.SCOTTY' -a X"$1" != X"-c"; then
	echo 'x - skipping README.SCOTTY (File already exists)'
	rm -f _shar_wnt_.tmp
else
> _shar_wnt_.tmp
echo 'x - extracting README.SCOTTY (Text)'
sed 's/^X//' << 'SHAR_EOF' > 'README.SCOTTY' &&
X
XOn SCO, TTY devices must be named in the style of:
X
X     /dev/tty#N
X             ^^
X             ||
X             |`------ uppercase letter for modem control
X             |        lowercase for non-modem control
X             `--------digit (1-4)
X
X
XIf you are using FAS or other third-party driver, you may use ecu
Xwith ports not normally named in the /dev/tty#N style in one of two
Xways under UNIX and one way under XENIX:
X
X     1.  Under XENIX or UNIX, create a link to the port
X         with a compatible name:
X
X               ln /dev/ttyF00 /dev/tty1a
X               ln /dev/ttyFM00 /dev/tty1A
X
X     2.  Under UNIX, add additional lines to the
X         /etc/conf/node.d file and rebuild the kernel
X         environment (this is the recommended approach
X         for UNIX, as documented in FAS 2.08 and 2.09):
X
X     fas ttyF00  c   48
X     fas tty1a   c   48
X     fas ttyF01  c   49
X     fas tty1b   c   49
X     fas ttyFM00 c   208
X     fas tty1A   c   208
X     fas ttyFM01 c   209
X     fas tty1B   c   209
X
SHAR_EOF
chmod 0644 README.SCOTTY ||
echo 'restore of README.SCOTTY failed'
Wc_c="`wc -c < 'README.SCOTTY'`"
test 1010 -eq "$Wc_c" ||
	echo 'README.SCOTTY: original size 1010, current size' "$Wc_c"
rm -f _shar_wnt_.tmp
fi
# ============= README.SEAlink ==============
if test -f 'README.SEAlink' -a X"$1" != X"-c"; then
	echo 'x - skipping README.SEAlink (File already exists)'
	rm -f _shar_wnt_.tmp
else
> _shar_wnt_.tmp
echo 'x - extracting README.SEAlink (Text)'
sed 's/^X//' << 'SHAR_EOF' > 'README.SEAlink' &&
X
XECU implements the SEAlink protocol (by System Enhancement Associates)
Xby means of a modified source provided by SEA.  I got the original source 
Xfrom an early distribution of the fine XBBS by alphacm!sandy.
X
XNOTE: SEAlink is provided as-is. I haven't used it since I
Xtested it in 1989.  It is still reported to work.
X
SHAR_EOF
chmod 0644 README.SEAlink ||
echo 'restore of README.SEAlink failed'
Wc_c="`wc -c < 'README.SEAlink'`"
test 320 -eq "$Wc_c" ||
	echo 'README.SEAlink: original size 320, current size' "$Wc_c"
rm -f _shar_wnt_.tmp
fi
# ============= README.WY60 ==============
if test -f 'README.WY60' -a X"$1" != X"-c"; then
	echo 'x - skipping README.WY60 (File already exists)'
	rm -f _shar_wnt_.tmp
else
> _shar_wnt_.tmp
echo 'x - extracting README.WY60 (Text)'
sed 's/^X//' << 'SHAR_EOF' > 'README.WY60' &&
X
XThis is a hurriedly composed note to let you know what I know
Xabout Wyse 60 support (not much :-)).  I really cannot help
Xwith Wyse 60s any more than this.  Please ask me no questtions,
Xbut please, if you can and wish, provide me a robust explanation
Xof where I am wrong and I'll put in into the mill with profuse
Xthanks and credit.
X
X1. The Wyse 60 comes in several flavors of keytops and who knows
Xwhat quantity of ROM versions.  The one I have is an early "Native"
Xor "Non-PC-Keytop" version.
X
X2. The choice of keycodes (emitted character sequences) for the cursor
Xkeys are quite, quite stupid, though they seem to have had SOME form of
Xthinking behind them.  The arrow down key is a NEWLINE!  The cursor
Xleft is a BACKSPACE.
X
X3. You can redefine the keycodes emitted by keys.  I lost my Wyse
X60 manual several years ago, but with luck, you still have yours
Xand can follow in my feeble steps to finish the job I have started
Xand try to explain below.
X
X4. There are IS entries in the models/funckeymap file entry for the
Xwyse60.  They are undocumented anywhere else.  These entries are
Xused by ECU only to spit initialization strings at the terminal in
Xthe order they appear in the file.
X
XIf you really don't want this stuff to happen, comment out or remove
Xthe IS strings, comment the ANSI-fied definitions and uncomment
Xthe un-ANSI-fied ones.  I omitted the braindead CUL and CUD entries, but
Xif you want them:
X
X#   CUL:CUL:        bs            # not useful (for reference only)
X#   CU5:CU5:                      # nyet
X    CUR:CUR:        ff
X    CUD:CUD:        nl # use only if you NEVER need to send a line feed
X
X5.  The strings I emit with the supplied IS strings are the same as
Xthe SCO 'wyse60ak' termcap entry 'ti' string.
X
X6.  You should really use the wyse60ak termcap entry, not the wyse60.
X
X7.  If you are not on SCO you probably don't have 'wyse60ak'.  I
Xhope the time-honored tradition of sharing termcap entries amongst
Xthe UNIX brethren will not bring writs and suits and "suits" against
Xme.  Here it is:
X
X#    Wyse 60
X#    Clearing of arrow keys useful in 'is' in case this entry is
X#    used after wy60ak entry was used.
X#
Xw7|wy60|wyse60|Wyse WY-60 with 80 column/24 line screen in wy60 mode:\
X	:is=\E`\072\Ee(\EO\Ee6\Ec41\E~4\Ec21\Ed/\EZ1+\177\EZ1,\177\EZ1-\177\EZ1.\177\EZ1\\\177\EZ1q\177\Ec72:\
X	:if=/usr/lib/tabset/std:pt:\
X	:CF=\E`0:CO=\E`1:\
X	:G1=3:G2=2:G3=1:G4=5:\
X	:GC=8:GD=0:GE=\EH^C:GF=7:GG#0:GH=\072:\
X	:GU==:GV=6:GR=4:GS=\EH^B:GL=9:\
X	:PU=\EJ:PD=\EK:mb=\EG2:me=\EG0:\
X	:al=4\EE:am:bs:bt=\EI:cd=100\EY:ce=\ET:cl=100\E+:\
X	:cm=\Ea%i%dR%dC:co#80:dc=11\EW:dl=5\ER:ei=\Er:im=\Eq:k0=^AI\r:\
X	:k1=^A@\r:k2=^AA\r:k3=^AB\r:k4=^AC\r:k5=^AD\r:k6=^AE\r:k7=^AF\r:\
X	:k8=^AG\r:k9=^AH\r:kd=^J:kh=^~:kl=^H:kr=^L:ku=^K:\
X	:li#24:mi:nd=^L:se=\EG0:so=\EG4:ug#0:ue=\EG0:ul:up=^K:us=\EG8:\
X	:PN=\Ed#:PS=^T:hs:ts=\Ez(:fs=^M:
X#
X# Wy60ak:
X# Arrow keys are programmed to emit ANSI standard sequences.  Allows 
X# applications to distinguish between destructive Back Space and
X# non-destructive Left Arrow Key.  END and INS keys also emit
X# ANSI standard sequences.
X# Held out `te' string so that `is' will remain in effect
X# throughout login session.
X# On the Enhanced PC Keyboard, only the Cursor Keypad between the Main
X# Keypad and the Numeric Keypad is programmable.  These arrow keys
X# and special cursor motion keys will function as labeled when using
X# wy60ak with applications supporting the wy60ak entry. The Numeric
X# Keypad cursor motion keys will continue to emit their default values.
X#
XWA|wy60ak|wyse60ak|Wyse 60 in wy60 mode with ANSI arrow keys +:\
X	:is=\E`\072\Ee(\EO\Ee6\Ec41\E~4\Ec21\Ed/\EZ1+\E[A\177\EZ1,\E[B\177\EZ1-\E[D\177\EZ1.\E[C\177\EZ1\\\E[F\177\EZ1q\E[L\177\Ec72:\
X	:ti=\EZ1+\E[A\177\EZ1,\E[B\177\EZ1-\E[D\177\EZ1.\E[C\177\EZ1\\\E[F\177\EZ1q\E[L\177:\
X	:kd=\E[B:kl=\E[D:kr=\E[C:ku=\E[A:\
X	:EN=\E[F:\
X	:tc=wy60:
X
X8.  The ECU interactive command "kbdtest" may be of some assistance
Xin analyzing and debugging this type of problem.
SHAR_EOF
chmod 0644 README.WY60 ||
echo 'restore of README.WY60 failed'
Wc_c="`wc -c < 'README.WY60'`"
test 3965 -eq "$Wc_c" ||
	echo 'README.WY60: original size 3965, current size' "$Wc_c"
rm -f _shar_wnt_.tmp
fi
# ============= HISTORY ==============
if test -f 'HISTORY' -a X"$1" != X"-c"; then
	echo 'x - skipping HISTORY (File already exists)'
	rm -f _shar_wnt_.tmp
else
> _shar_wnt_.tmp
echo 'x - extracting HISTORY (Text)'
sed 's/^X//' << 'SHAR_EOF' > 'HISTORY' &&
X============= Changes for ECU 3.20 =======================================
Xlast revised Sat Aug 22 15:29:11 EDT 1992
X
X"But in our enthusiasm, we could not resist a radical overhaul of
Xthe system, in which all of its major weaknesses have been
Xexposed, analyzed, and replaced with new weaknesses."  -- Bruce
XLeverett 'Register Allocation in Optimizing Compilers'
X
X1. new commands (procedure and interactive)
X   a.  autorz
X   b.  dcdwatch
X
X2. dial command reworked
X   a. new sub menu for entry add/edit
X   b. phone number size increased from 25 to 40 characters
X      (some modems limit input string size to 40 characters total
X      excluding AT and trailing CR)
X   c. Trailing dollar sign '$' appends ~/.ecu/.credit to dialled number:
X      .credit has:
X          ,,,167167002
X      Home dial 1234 sends to modem
X          1234,,,167167002
X
X3. help cmd improved: you can stay in a category and ask
X   for help with multiple commands and use F1 to return to
X   category menu.
X
X4. Major rework inside to reduce but not eliminate the likelihood
Xthe chances ecu will abnormally terminate when the dial command
Xneeds to change to a new line and the new line is not available.
XIf the new line is busy (in use by another dialout or login),
Xthe request to change is rejected and the old line is retained,
Xthe program survives.  If the new line is unavailable because
Xof other reasons (read/write denied [chmod] for instance), ecu still
Xdies. hopefuly this will all be handled by the time of release.
X
X5. jhpb@sarto.budd-lake.nj.us added preliminary support for ESIX SVR4
Xand I added the necessary switches to config.c.  Now, -DISCSVR4
Xis used for ISCSVR4, -DESIXSVR4 for ESIX and -DSVR4 for "any" SVR4.
X
X6. The "kbdtest" interactive command has been cleaned up enough
Xfor general use.  I hacked it in for debugging early on.
XNow it is documented well enough for general use in funckeymap debugging.
X
X7. -P command line switch added for selecting a phone directory other
Xthan the default ~/.ecu/phone.  Use -P fullpath.
X
X8. Any usage error (bad command args) resulted in the death of ecu's
Xprocess group.  This provided great incentive to invoke the program
Xproperly, but in this modern day, you are not allowed to discipline
Xthe students :-).
X
X9. An experimental feature has been added to ecuungetty.
XIf it is compiled with -DECUUNGETTY_CHOWN, it will perform
Xchown and chmod operations on the line.
X
XWhen the line is acquired, its ownership is set to the real uid
Xof the ecu user, its group id to the group id of the process, and
Xits mode to 622.  This is what happens to xterm ptys.
X
XWhen the line is released, its ownership is set to uucp
Xof the ecu user, its group id to uucp, and its mode to 640.
XThis is what SCO uugetty does when it starts on a line.
X
XYou can experiment with this feature by 
X    a. placing the line
X       LOCAL_CFLAGS = -DECUUNGETTY_CHOWN
X       in the file `config.local' in the distribution base directory.
X    b. Configure or ./config
X    c. remake and reinstall
X
X*You* must decide if this is appropriate for you.  The tradeoff
Xis between having 666 ttys and having a program which a diligent
Xhacker could use to change any file in the system to his
Xownership. You really should look at bamboozle.c and judge
Xwhat level of protection you want to use.  If you are on
Xa sensitive installation (like you .gov or .mil guys),
Xyou might not want to do it.  Any suggestions for improvement
Xor additional security.  I thought about pathname checking,
Xst_dev and st_rdev checking and the like, but nothing simple
Xand portable has come to mind.
X
X10. From 31840 patch 5,
XBy the time ECU actually attempts an line open, enough previous
Xcontext has been lost that the program cannot recover if the open
Xfails.  I have always made several checks to try and eliminate
Xsuch occurrences.  Now, at least for SCO lines in utmp, the
Xchances of failure are virtually eliminated.
X
XThis patch goes with patch 4 to extend the benefits of ecuungetty
Xchown.  If ecuungetty chown is enabled and this patch is
Xinstalled, we get reduced likelihood of ecu terminating
Xabnormally when switching comm lines or when selecting the first
Xline of the session.
X
X   Line access is checked if it is not found in utmp to see if
X   an open would fail.
X
X   SCO uugetty does not always put anything in the ut_line field
X   of its utmp entry.  However, a de facto convention exists for
X   making an inittab id field with the last two characters
X   matching the last two characters (the only unique characters)
X   of SCO-style comm line names.  This patch causes such a check
X   to be made, increasing the likelihood of getting a utmp match
X
XTwo new files have been added to this distribution:
X   dutmp.c   cc -o dutmp dutmp.c    dumps the utmp; a cheap who -a
X   README.3.2v4         a brief blurb related to EAFS file names
X
Xecu 3.19.00 patch 1 - notes 11-15
X
X11. The maximum screen geometry is now 85x80 instead of 43x80.
XColumns must be 80.  Lines must be > 20.  Lines
Xin excess of 85 will be accepted, but ECU will be unable to
Xmaintain a correct screen display if any scrolling occurs.
X
X12. A Nap() bug (used by the procedure nap command as well as
Xinternal functions) could cause the program to hang if napping
Xwas to occur when a receiver or child process terminated.  This
Xonly occurred on systems with -DWORKING_SELECT: SunOS, the SVR4s,
XISC 2.2, for instance.
X
X13.  Remaining program identifiers containing the string "nonansi.*key"
Xwere renamed to use "funckeymap".
X
X14.  On systems with reliable predefines in their native compiler,
X(SCO -DM_SYSV, SunOS -Dsun),  Configure guesses at a default answer
Xfor the first question.
X
X15. The End key may now be used to finish adding or editing
Xa dialing directory entry.
X
Xecu 3.19.00 patch 2 - notes 16 - 18
X
X16. Yet more work on the ecuungetty scheme.  ungetty acquisition
Xnot attempted early enough for "enabled but idle" lines
X
X17. A few patches back, I forgot to note %conn will now return
X-1 if no line is open.  Previously it returned 0 in this case.
XNow -1 means no line open, 0 means line open but no connection,
X>0 is the line file descriptor for the line in an active
Xconnection.
X
X18. The Nap() fixes of the last patch prevented ecurz/ecusz/ecusea
Xfrom compiling.  Sorry.
X
XFrom full release 3.19.05
X
X19.  A preliminary T3000 dialer has been added to the gendial
Xpackage.  This modem's future is plastic and the dialer, like
Xall gendial programs, is just a starting point.  Gendial is
Xprovided and I don't have a lot of time to support the zillions
Xof conflicting idiosyncratic options folks want.  With that
Xspew spewed, most of them work fairly well.  Documentation :-) ?
X
X20.  A side effect of getting the T3000 was that *I* got to play
Xwith ECU on a Sun.  This is quite fortunate, since ECU was purportedly
Xported many CPU cycles ago.  The Nap() problem has finally been
Xput to bed... (he said).
X
XFrom 3.19.05 patch 1 (making 3.19.06) notes 21-24
X
X21. The lCLOCAL() code and its users form the chassis upon
Xwhich the DCD watcher is based.  It appeared to work on the
XSCO box, but caused problems on SunOS that were difficult to
Xfind.  Thanks to Mark Ashton, n4hgf!ifsbd!cma, this problem
Xis history.  Many mysterious "hangs" came from a trap
Xyou could fall into on *any* implimentation other than SCO UNIX.
XCLOCAL doesn't appear to work the same on SCO 3.2.? as XENIX
Xand SunOS.  I think tbetz@upaya.panix.com will be happy
Xwith this news.
X
X22. cma also discovered that if you have multiple Devices entries
Xfor a line to pick up specific Dialers scripts or dialer programs,
Xsay:
X
XACU ttya - 2400 t3000-2400
XACU ttya - 9600 t3000-v32
X
XECU would always pick the first one (disregarding baud rate).
XThis is fixed now.
X
XNow, if you dial with a directory entry using a /Devices-type or
X=devices-type specification for tty, then *that specific* Devices
Xentry is used to choose the dialer program or Dialers script.  If
Xno directory entry is involved or the directory entry specifies
X"Any" or a specific line, then Devices is searched for the first
Xentry matching both the current line and the current baud rate.
X
XA note aside: SCO Devices entries appear to me to have a syntax
Xextension not found in all HDB systems.  The baud rate
Xfield allows a range of baud rates, like:
X
XACU tty1A - 110-2400 /usr/lib/uucp/dialgHA24
X
XECU supports this syntax, but your uucico may not.
X
X23. models/funckeymap updated with my dual-purpose Sun/SCO
Xfunckeymap/.Xdefaults configuration.
X
X24. cmostime4 has been included for SCO users (and many hackers)
X
XFrom 3.19.05 patch 2 (making 3.19.07) notes 25
X25.  Dialing directory subform data entry formerly had two
Xinput schemes: on input, you were cajoled into going through
Xfields one at a time until you reached the end of the form, whereupon
XECU would take away the input form.  On the other hand, when editing
Xan entry, you were free to cycle through the fields "a la modulo"
Xin either direction.
X
XNow, both input modes allow liberal cycling.  Pressing the END key
Xsignals your acceptance of the entry.  Pressing ESCape in input
Xmode aborts the new entry process.  Pressing ESCape in edit mode
Xbehaves exactly like the END key except that any edits made since
Xthe cursor entered the current field are discarded..
X
XFrom 3.19.10 - notes 26-27
X
X26. more internal cleanup
X
X27. robertle@sco.com (Robert Lewis) noted that putting the phone number
Xon log files and screen dumps is a security risk.  Why protect
X~/.ecu when the phone numbers are plastered everywhere.  No
Xmore banners.
X
XFrom 3.19.11 - whoops didn't keep track
X
X28. ecuungetty chown fixes and miscellaneous cleanup
X
XFrom 3.19.12 - notes 29
X
X29. Added use of ECUFUNCKEY environment variable to override TERM
Xwhen loading funckeymap.
X
X3.19.13 internal rev (just superstitious :->)
X
X3.19.14 - notes 30
X
X30. Made changes for SCO 3.2v4/ODT 2.0:
X    a. pids are now shorts
X    b. getty sets "DIALOUT" on its own
X
X3.19.15 - notes 31
X
X31. ECUUNGETTY_CHOWN now a semi-permanent feature.  It can
Xstill be turned off by editing config.c or Makefiles.  It
Xis just too good not to have it in.
X
X3.19.16 - notes 32-37
X
X32. cmostime4 backed out of distribution; if you want it, ask me
X
X33. Direct phone numbers longer than 10 characters got doubled in
Xone instance. Thanks to felton!rll for pointing this out.
X
X34.  Good news!  -DWORKING_SELECT can be and is now used for
X3.2v4; as a side effect, the Nap() wrapper/surrogate is now in
Xnap.c and all the several Nap() functions in ecusea.c, zcommon.c
Xand gendial.c have been removed.
X
XAlso, if -DWORKING_SELECT is used, Nap() uses ftime() instead of
Xgettimeofday().  Adding -DUSE_GETTIMEOFDAY will return to the
Xold usage.  This latter note is for porters, since all currently
Xsupported systems have ftime() and several lack gettimeofday().
X
X35. More work has been done on SCO utmp/Devices automatic tty selection
Xhas been done.  I apologize for the long chain of half-fixes.  Once
Xagain, I think it is fixed.  This time I REALLY believe it :-).
XFor sure, you should no longer find your /dev/tty chown()'d to uucp.
X
X36.  SCO multiscreen color escape sequences from the remote were
Xbeing filtered as if ECU were running on a non-multiscreen.  Now,
Xif you use ECU on an SCO multiscreen, the full set of ECU escape
Xsequences, including color, again work as specified in the
Xmanual.  Thanks to tps@jptcs.com for pointing this out.  This bug
Xcrept in when I reorganized keyboard management
X(nonansikeys->funckeymap).
X
X37. The ecuungetty chown feature is on permanently.  I added
Xquite a few security/safety checks to make sure some bug or
Xanother will not make the privileged ecuungetty go wild.
X
X3.19.17 - notes 38
X
X38.  The hz/hzmsec needed by nap.c was not being provided,
Xcalculated by ecusea.c, ecu[rs]z.c and gendial.c.
X
X3.19.18 - notes 39
X
X39.  I had started using <sys/time.h> if 3.2v4.  3.2v4 only has
X<sys/time.h> if the TCPRT package is installed .  Basic 3.2v4 does
Xnot have it at all.  So, we'll use <time.h> and <sys/select.h> just
Xlike before.  Thanks for the report go to robertle@sco.com.
X
X3.19.19 - notes 40-44
X
X40.  Added support for 3.2v4 CRTSFL.
XNow for SCO, rtscts command arguments:
X
Xusage: rtscts [ off | on | no | yes | 0..7 ]
X
Xargument | RTSFLOW | CTSFLOW   argument | RTSFLOW | CTSFLOW | CRTSFL
X---------+---------+---------  ---------+---------+---------+--------
X  off    |   0     |   0         0      |   0     |   0     |
X  on     |   0     |   1         1      |   0     |   1     |
X  no     |   0     |   0         2      |   1     |   0     |
X  yes    |   0     |   1         3      |   1     |   1     |
X                                 4      |   0     |   0     |   1
X
XChoice 4 only works on SCO 3.2v4 and ODT 2.0.
XAs you can see, numeric values are masks.
XIf the 4 bit is present in the numeric value, it
Xoverrides the lower-order bits:  Specifying 7 as an argument
Xspecifies CRTSFL is to be used if it is supported, otherwise
XRTSFLOW and CTSFLOW.
X
XThe interactive help and iteractive and procedure command
Xdocumentation has been updated.  I added to README.RTSCTS 
Xsome illuminating comments by chip@tct.com (Chip Salzenberg).
XIt was seeing this article that brought CRTSFL off the todo
Xlist and into the code.
X
X41.  Warnings about not using ^\Z in Kermit transfers (^Z suspend)
Xwere added to the 'sk' and 'rk' interactive and procedure commands.
X
X42.  This fix went into 3.19.16 but I forgot to note it: color
Xsequences sent to ECU on a multiscreen console were not being
Xpassed to the driver.  Now they are..  I only know of color
Xworking on SCO.
X
X43.  Changes to make_dirs() was needed to handle making
Xdirectories with pathname components which are symbolic links
X(possibly on a read-only file system).
X
X44.  The DCD watcher did not work if you use SCO sio.  I have
Xbeen using FAS and forgot a a fact about SCO sio: to toggle
XCLOCAL meaningfully, you must open the modem (e.g.  tty2B) rather
Xthan the direct (tty2b) file.  On SCO systems, if the tty filename
Xhas a digit+letter as the last two characters,  ECU will
Xforce the lower case (direct) version to be used.  3.19.19 opens
Xthe upper case (modem) device, but continues to store
Xand display tty names in their lower case version.
X
X3.19.20 - notes 45-46
X
X45. Somewhere in the lifetime of .19, I sent a copy to a guy.
XThis revision bump is just to keep from having different
Xversions called .19 out the door.
X
X46.  On 3.19.17/18, there were various reports of hangs on line 
Xclose, hang up, or HOME prompt when using 3.2v2.  I cannot
Xreproduce any of these errors.  Please get and send me this 
Xinformation for me the next time it happens to you:
X
XInstall ecu, but execute the ecu built in the distribution directory.
X
X  a. Is the receiver process active (two ecu processes active)?
X
X  b. The ecu transmitter process will either be the only ecu
X     process or the oldest.  Kill -4 the transmitter process and move
X     the core file to the distribution directory if you 'cd'ed in ecu.
X
X     You may have to type ^Jstty sane^J on the console it failed on
X     (expect no echo) to restore the console to something usable.  This
X     may not reinstate your choice of character delete, line kill, etc.
X
X  c. do  'sdb ecu |& tee sdb.log'
X
X  d. do  't', then 'q'
X
X  e. repeat the failing scenario if you found the receiver process
X     alive in step a.  If so, repeat a-d above, but this time kill
X     the receiver process and do  'sdb ecu |& tee -a sdb.log'
X
X  f. Guess.  (mail me the sdb.log) with a description of
X     1) the OS
X     2) any non-vendor serial driver
X     3) what was going on when it failed (in 100 words or more :-> )
X
X3.19.21 - notes 47-49
X
X47.  The UNIX sio driver may generate a SIGTTOU upon execution of
Xcertain ioctl() functions, namely, XCSETA, XCSETAF, XCSETAW,
XTIOCSPGRP, TCSBRK, TCFLSH, and TCXONC.  My ignorance caused the
Xlast few revisions to hang for many upon closing a line or upon
Xperforming miscellaneous operations like sending a break.  All
Xecu executables now set job control signals to SIG_IGN.  I hope
Xthis fixes the problem.  (Job control is not supported at this
Xtime.)  
X
X48. config.c has been returned to normal compilation (no -g).
XI shipped an alternate config.c "out of turn" after 3.19.20.
XSome may have installed it, some not. Therefore, unsharing
Xthis patch replaces any config.c you may have in place.
X
X49. The -F switch was added to the command line arguments:
X
XThe new manual section titled "-F path":
X
X    Normally, the $TERM environment variable is used to
X    determine the funckeymap entry (keyboard configuration)
X    to be used.  Sometimes, the $TERM variable is not
X    adequate for identifying your keyboard arrangement.
X    The -F switch, like the $ECUFUNCKEY environment
X    variable, allows you to use override the funckeymap
X    entry used.  For more information, see the section
X    titled "Function Key Mapping (Recognition)".
X
X3.19.22 - notes 50-52
X
X50.  This note is only of interest to SCO users.
XPrevious revisions of SCO were lenient on the user in the choice
Xof the direct or modem tty device.  You could specify either
Xtype and ecu would force the one it thought appropriate.
XUsers of ecu under other operating systems have always had to
Xspecify the correct name.
X
XIf you have time, I'd love feedback on what part of the manuals
XI have missed updating with the new paradigm.
X
XSince there are several types of async drivers and we want
Xto support them, ecu can no longer make a choice for you.
XI did radical surgery on the "SCO tty naming" logic.  As it
Xstands nowu, on SCO, the tty you specify in a dialing entry is the exact
Xtty name opened.  The convention of using a lower-case lock name
Xis still observed.  Also, both senses are searched for in utmp
Xfor conflict determination.  ecuungetty chown()/chmod() both
Xdevice file names.
X
XHowever, your choice of which line type (line placed in tty field
Xof a directory entry or the tty field of the setup form) depends
Xupon the driver you are using:
X
Xsio  modem   /dev/tty1A
Xfas  direct  /dev/tty1a
X
XI don't know about others.  Tell me.
X
XNotes:
Xa. An sio direct line ignores setting of CLOCAL (no DCD watcher)
X   and lacks support for hardware flow control.
Xb. Opening the fas modem line causes various forms of conflict
X   resulting in EBUSY being returned by fas for an ecu open or
X   a dialer program open.
X
XFor now, this is meaningful only on SCO.  In the future, perhaps,
Xwe'll manage an installation-dependent table of what line names
Xrefer to the same device and which are modem, direct, etc.
X
Xe.g.,
X#line_to_use:modem:direct:others:comment
Xtty1A:tty1A:tty1a::sio
Xtty1a:tty1A:tty1a::fas
Xacu0:acu0:ttya,ttyd0:SunOs
X
XThis would re-automate SCO tty line type choices and add it anew
Xfor others.  Then, ecu could for the first time on non-SCO (and
XSCO naming to boot) search for all possible lock files and utmp
Xentries.  What do you think?  Yes, one more damn configuration file
Xto hack on.
X
X51.  ecusz, ecurz and ecusea are now placed in the ecu library directory
X(usually /usr/locsal/lib/ecu).  This is a more appropriate place
Xsince it is meaningful only for ecu to execute them.  Kermit or ckermit
Xis still searched for through $PATH.  Remove any old ecurz, ecusz
Xand ecusea executables from your locsl bin directory.
X
X52.  I'm sorry the preformatted manuals you have been getting
Xwere malformed.  The new Makefile in doc failed to supply -mm !
X
XBETA 3.20.01 notes 53-58
X
X53. There is still one installation where /dev/tty is getting
Xincorrectly chown/chmoded.  There are now three brute-force
Xtests for an attempt at this (up from two).  The bug
Xhasn't been fixed, but we ought to know how it happens
Xthis time around.
X
X54. The procedure and interactive command fkmap has been added:
X
XUsage: fkmap                           display current mapping
X       fkmap <keyname>                 display single key mapping
X       fkmap <keyname> <keylist>       modify a key's mapping
X       fkmap -r                        reset to original mapping
X       fkmap -s <file>                 append current to file
X
XThis command manages the mechanism ECU uses to recognize function
Xkeys when they are entered at the console.  If supplied, the
Xfirst argument to the command must be the recognized name of a
Xfunction key from the list:
X
XF1 F2 F3 F4 F5 F6 F7 F8 F9 F10 F11 F12 
XHome End PgUp PgDn CUP CUL CU5 CUR CUD
X
XIf only one argument is supplied, the mapping for the specified
Xkey is displayed.  If more than one argument is supplied, the
Xkeyboard mapping is changed.  Arguments 2-n are character code
Xspecifiers in the format used to define a funckeymap entry.
X
XWARNING: If found to be syntactically correct, a mapping change
Xis installed immediately.  If incorrect mapping of the HOME key
Xis requested, you may lose control of ECU.
X
XExamples:
X
X    fkmap f10       display F10 mapping
X    fkmap Home ^Z   map Home to ^Z
X                    after this command, type ^Z for Home
X
X55.  Non-SCO color appears broken and it is beyond me to fix it.
XIf you want to diddle with it, look at the top of ecutty.c at the
Xlist of conditionals regarding USE_COLOR.  I'd appreciate
Xpatches.  BTW, in the past, I have attempted fixes for ISC
Xcharacter attributes like underlining and standout, but I've
Xnever heard back.  Are there attribute problems on ISC (3.2 or
Xother)?
X
X56.  The procedure command exec was added:
X
Xusage: exec <string>
X
XThis function executes a string as a procedure statement.
XArgument <string> must contain an ecu statement exactly as
Xmight appear on a procedure line, with a few exceptions.
X
X1. There may be no label: the first command may 
X   start in column one.
X2. You should not execute a goto, gosub or return.
X3. You should not code if, while or compound statement
X   brackets.
X
XYou are on your honor with regard to items 2 and 3 above.
XIf you stretch it, it will break.
X
XExample:
X
X    $s20 = 'Home';   $s30 = '^H' 
X    $s21 = 'End';    $s31 = '^E'
X    $s22 = 'F1';     $s32 = '^A'
X    $s23 = 'F2';     $s33 = '^B'
X    $i10 = 0
X    whilei $i0 < 4
X    {
X        $s0 = 'fkmap '+$s[20+$i10]+' '+$s[30+$i10]
X        exec $s0
X        $i10 = $i10 + 1
X    }
X
X57.  ECU has been made successfully with gcc 2.2.2.  There is a
Xbug in the configure procedure in the 2.2.2 I received.  In
Xattempting to configure for 3.2v4, the tm.h header file got
Xlinked to the wrong file.  Make sure tm.h is linked to
Xconfig/i386_sco4.h and not config/i386_sco.h.  Starting with
X2.2.2, those nice M_ identifiers are predefined by gcc.  I wish
Xeverybody's compiler had a predefine that would identify the
Xenvironment.
X
XThe Configure procedure is unchanged.  Answer yes to the question
Xabout version 1.40 or later.
X
X58.  John Dashner, wa4cyb!jmd, proofread the main manual (THANKS).  His
Xchanges are in the manual.
X
XFINAL 3.20 notes 59-65
X
X59. Expect/respond \M and \m implimented for SVR4.  The old \m
Xmillisecond delay is now ~n[##].  See the procedure manual in the
Xdescription of the expresp command.
X
X60. Further bugs with managing line chown/chmod fixed.
XA directly specified line not managed by getty was not getting
Xchowned back to uucp when the line was closed.
X
X61. Better syntax checking is done when reading Devices lines.
X
X62.  A bug in ecusz caused data transfer rate calculations to be
Xwrong after any receiver ZRPOS ("nak") after the first one at
Xtransfer startup.
X
X63.  A "Resume interrupted transfer" choice has been added
Xto the interactive sz menu.  An equivalent -r switch was added
Xto the sz procedure command.  Previously, you had to "just know"
Xyou can sneak switches to the file transfer protocols by
Xprefixing them to the file list.
X
XThere is still no clean way for the sz procedure command to set
Xthe ZMODEM window size on sends other than the aforementioned
Xtrick.  The thing to do here is
X
X    sz '-w 65536 file1 file2'
X
XThere is no foreseeable reason this hack will cease to work.
XHowever, if I get 1.0001 requests, and I'll come up with something
Xbetter.
X
X64.  The receiver process was being started too soon after a
Xconnect resulting for a directory entry dial.  As a result,
Xif ther remote began transmitting very soon after connect
Xor if there was remaining modem dialog remaining bufferred
Xin the tty driver, the CONNECT or [interactive mode] messsages
Xcould have been intermixed with data from the line.
XThis longstanding nuisance bug has finally been fixed.
X
X65.  The rtscts procedure command would take only on/off/yes/no
Xalphabetic arguments.  Now it will accept numeric arguments
Xlike its interactive equivalent.
X
X==========================================================================
Xprior to x3.19
X1992-04-19-thanks to jhpb@sarto.budd-lake.nj.us, 3.18.37 has ESIX SVR4 
X1992-04-19-if TERM=ansi with WINDOWID, assume scoterm 
X1992-04-17-default tty, baud and parity moved to config.c 
X1992-04-17-fkey command has -r reset switch 
X1992-04-17-ecu.c-"default" keyset read if present 
X1992-04-17-ecufkey.c-initialize keyset to SCO "ANSI" send strings 
X1992-04-12-eculine.c-was not canceling alarm on lopen error 
X1992-04-09-ecugrabbag.c-cleanup new "bn" argument parsing 
X1992-04-05-ecuutil.c-no more use of memmove in any environment 
X1992-03-30-gendial/tbit.sync.h-add lbreak before wakeup 
X1992-03-30-gendial/gendial.c-add lbreak 
X1992-03-29-proc_error.c-build_err-creation from ecuerror.h 
X1992-03-29-eculine.c-put three second timer on lopen 
X1992-03-27-*.h-include protection for all .h files 
X1992-03-20-esd.h-max size of esd now 16384 
X1992-03-20-esdutil.c-esdstrcat will grow an esd 
X1992-03-20-config.c-correct XENIX tcap/tlib test thanks to tbetz 
X1992-03-17-eculine.c-optimize parameter 1 to select() 
X1992-03-10-ecutcap.c-quick sanity check on ttype features 
X1992-03-01-config.c-add -Wswitch to gcc compiles 
X1992-03-01-feval.c-come up to modern times ... enum for FI/FS  
X1992-03-01-ecucmd.h-come up to modern times ... enum for CT 
X1992-02-24-ecutcap.c-getenv COLUMNS not COLS 
X1992-02-22-ecuutil.c-build arg/str array now handles zero tokens 
X1992-02-22-kbdtest3.c-thank markd@phoenix.pub.uu.oz.au for typo fix 
X1992-02-16-ecu.c-add -P phonedir switch for rll@sco 
X1992-02-16-ecusighdl.c-turn off xterm_title + add _terminate.ep 
X1992-02-16-ecugrabbag.c-turn off xterm_title 
X1992-02-16-ecuDCE.c-turn off xterm_title 
X1992-02-16-ecu.c-turn off xterm_title 
X1992-02-14-feval.c-add uname 
X1992-02-13-ecu.h-when port to many time() can be int/long/time_t 
X1992-02-10-gendial/dceT2500.c-made it 1.5 years not setting S131 - then drat 
X1992-02-10-gendial/dceTBPlus.c-improved sync_Telebit 
X1992-02-10-gendial/dceT2500.c-improved sync_Telebit 
X1992-02-09-z/zcurses.c-ruling characters only on  SCO (tcap curses) 
X1992-02-07-ecuicmaux.c-fix incorrect log append/write notification 
X1992-02-06-config.c-depressing ... SCO keeps chging their minds 
X1992-02-04-ecuDCE.c-fix bug in kill_rcvr_process logic 
X1992-02-02-gendial/template.c-proper ordering of DCE_result entries 
X1992-01-29-ecu_types.h-creation 
X1992-01-29-ecu_stat.h-creation 
X1992-01-29-ecu_pwd.h-creation 
X1992-01-27-z/ecurz.c-more efficient fopen processing 
X1992-01-26-gendial-gendial 1.2 for ecu 3.20- better hangup 
X1992-01-21-afterlint.c-better handling of commented items with UNNAMED 
X1992-01-20-z/ecurz.c-ZMAPND works now 
X1992-01-18-hdbintf.c-use proctrace value for expresp_verbosity 
X1992-01-17-ecuDCE.c-.credit open to public 
X1992-01-12-pcmd.c-add autorz command 
X1992-01-11-ecuicmhelp.c-bug in help + F1 reverts to cat menu 
X1992-01-06-kbdtest3.c-much more error checking 
X1992-01-06-kbdtest3.c-eliminate sun stty - causes problems 
X1992-01-05-z/zcurses.c-properly display progress for resumed transfers 
X1991-12-24-fasi/digi-pc8.h-creation 
X1991-12-16-expresp.c-allow for backslash in expect and respond 
X1991-12-16-z/ecurz.c-support ZCRESUM 
X1991-12-15-ecushm.h-autorz and zmodem_asterisk_count added 
X1991-12-15-ecushm.c-autorz initialized 
X1991-12-13-ecuicmd.c-formalize bell notify 
X1991-12-13-ecugrabbag.c-add parse_bell_notify_argument 
X1991-12-13-ecugrabbag.c-add bell_notify_text 
X1991-12-13-ecushm.c-move bell_notify_state to shm 
X1991-12-12-pcmd.c-proctrace of intvar shows char value if 0-255 
X1991-12-12-eculine.c-lgetc_timeout can now return a null character 
X1991-12-02-ecupde.c-breakout into separate module 
X1991-12-01-dvent.h-new typedef for striuct dvent 
X1991-11-30-smap.c-smap conditional compilation reorg 
X1991-11-30-ecuicmd.c-smap conditional compilation reorg 
X1991-11-30-ecu.h-smap conditional compilation reorg 
X1991-11-28-ecupde.h-add dcdwatch 
X1991-11-28-ecuphdir.c-add dcdwatch option 
X1991-11-26-ecu.h-add shm->Ldcdwatch values 
X1991-11-26-eculine.c-add ldcdwatch_str 
X1991-11-26-ecu.h-add STR_CLASSIFY 
X1991-11-26-ecuutil.c-add str_classify and yes_or_no uses it 
X1991-11-20-ecuphdir.c-improve "Any" line handling on add or edit 
X1991-11-16-ecunumrev.c-better development "x" rev numbering 
X1991-11-16-proc.c-add pcmd_upon stub 
X1991-11-16-proc.c-add proc_dcdloss_handler 
X1991-11-16-ecucmd.h-add upon + rearrance pcmd_... decls 
X1991-11-16-proc.c-calloc pcb instead of malloc 
X1991-11-16-proc.h-add upon_dcdloss 
X1991-11-15-hdbintf.c-SCO tty naming now observed in getdvline 
X1991-11-13-ecu.h-use if __STDC__ instead of defined(__STDC__) 
X1991-11-12-ecushm.c-remove obsolete shmx_rc_report 
X1991-11-11-ecu.h-redefinition of Ltermio's place in life 
X1991-11-11-eculine.c-ldcdwatch and lCLOCAL code 
X1991-11-11-ecushm.h-add Ldcdwatch and Ltiobuf 
X1991-11-11-ecushm.c-shmr_notify_xmtr_of_DCD_loss 
X1991-11-11-pcmd.c-add pcmd_dcdwatch code 
X1991-11-11-eculine.c-lzero_length_read code 
X1991-11-11-ecucmd.h-add dcdwatch 
X1991-11-11-ecurcvr.c-lzero_length_read code 
X1991-11-11-ecurcvr.c-add LIMIT_BELL code 
X1991-11-08-utmpstat.c-bug in strcmpi made for erratic return value 
X1991-11-07-ecuDCE.c-tmcsys!lothar-alternate OK string for built-in dialer 
X1991-10-24-ecumon/xecumon.c-SEND_KEYS separated from AITEST 
X1991-10-17-config.c-add can_pipe code 
X1991-10-09-pcmd.c-add -p and -v switch to send 
X1991-10-09-pcmd.c-proctrace code for send 
X1991-10-09-expresp.c-bad llookfor echo argument 
X1991-10-04-ecuicmd.c-reset proc_interrupt before interactive pcmd 
X1991-09-25-ecuchdir.c-fix seg viol in popd w/o argument on Sun 
X1991-09-25-ecufork.c-find_executable flunks directories now 
X1991-09-25-ecuxfer.c-flexible C-Kermit filename 
X1991-09-17-ecuxfer.c-restore console termio after xfer prog runs 
X1991-09-06-ecufork.c-expand_wildcard_list minor bug 
X1991-09-03-ecuxkey.h-alt-[a-z] starts w/0xE1: crisp compatibility 
X1991-09-03-timetest/naptest2.c-make part of suite 
X1991-09-03-timetest/naptest3.c-creation 
X1991-09-03-timetest/seltest.c-creation 
X1991-09-03-ecugrabbag.c-sigint rearrangement in send_get_response 
X1991-09-03-config.c-iron out sun gcc options 
X1991-09-02-z/zcurses.c-show sun driver information 
X1991-09-01-pcmd.c-baud cmd can set rate even if no line open 
X1991-09-01-ecucmd.h-add setline 
X1991-09-01-ecucmd.h-add setline 
X1991-09-01-pcmd.c-add setline 
X1991-09-01-config.c-show package and config versions 
X1991-09-01-hdbintf.c-generalize HDB configuration files location 
X1991-09-01-config.c-generalize HDB Devices, etc. files location 
SHAR_EOF
chmod 0644 HISTORY ||
echo 'restore of HISTORY failed'
Wc_c="`wc -c < 'HISTORY'`"
test 30872 -eq "$Wc_c" ||
	echo 'HISTORY: original size 30872, current size' "$Wc_c"
rm -f _shar_wnt_.tmp
fi
# ============= OLD-HISTORY-1 ==============
if test -f 'OLD-HISTORY-1' -a X"$1" != X"-c"; then
	echo 'x - skipping OLD-HISTORY-1 (File already exists)'
	rm -f _shar_wnt_.tmp
else
> _shar_wnt_.tmp
echo 'x - extracting OLD-HISTORY-1 (Text)'
sed 's/^X//' << 'SHAR_EOF' > 'OLD-HISTORY-1' &&
XANCIENTHISTORY - Revision History for ECU
X-----------------------------------------
X
XChanges and fixes since 'unet1' alt.sources release:
X
X1. The uucp lock file code has been upgraded.  When I added uucp dialer
Xsupport a while back, I just hacked the necessities needed for
XecuLCK.c and put the new code into hdbintf.c.  Also, I don't try
Xto create two lock files anymore because there is no need.
X
X2. In esdutil.c, skip_paren could return a wrong error code.
X
X3.  ctype.h style integer functions were added to the procedure
Xlanguage: %isalnum, %isalpha, %isascii, %iscntrl, %isdigit, %isgraph,
X%islower, %isprint, %ispunct, %isspace, %isupper and %isxdigit.
X
X4. Logical operators were added to the ifi, ifs, whilei and whiles
Xsyntax, making possible:
X   ifi $i0 ==5 || %i30 == 6
X       statement(s)
XThis still ain't perl, but things are a little better.
X
X5.  %right() was broken.  strfunc_right() in feval.c returned a random
Xerror code on success.
X
X6.  A copy of the screen as received from the line is now kept in shared
Xmemory.  Three new functions use this feature: integer functions %curx
Xand %cury and string function %screen().  There are limitations, so read
Xthe appropriate manual sections.
X
X7.  Since some program may want to use the shared memory segment to read
Xthe screen, the shared memory segment is no longer RMID'd as soon as it
Xis created.  The integer function %shmid returns the shared memory
Xsegment id for passing to a called program.  Many other interesting
Xthings are kept in shared memory to enable efficient use of auxiliary
Xprograms.  See echshm.h and ecufriend/ecufriend.c.
X
X8.  Procedure tracing of string variable assignment prints "unprintable"
Xcharacters in the style of '^A' rather than clobbering your screen.
X
X9.  kill_rcvr_process is better at terminating the receiver process.
X
X10.  Screen dumps having extra repeated lines at the bottom won't happen
Xany more.  (The restarted rcvr process was getting a copy of the stdio
Xbuffers to flush too :-/).
X
X11.  By modifying the mapkey file to return certain codes for ALT-A
Xthrough ALT-Z, it is possible to have 26 procedures (named
X'alt_[a-z].ep') to execute "silently" by pressing one key (OK, two keys:
XALT and a-z).  See mapkeys/README, /usr/lib/keybord/keys and mapkey(ADM).
X
X12.  The receiver was not getting properly informed when the parity of
Xthe line was changed with the interactive or procedure parity command.
XSo it could improperly mask or fail to mask incoming characters.
X
X13.  The crypt library is no longer required.  Indeed, the default is
Xnot to use crypt.  The paranoia required for "safe" big systems is not
Xalways warranted on smaller PCs.  You can still get extra protection
Xagainst false ecuungetty action by using crypt if you want (and in the
Xcase of non-USA user, if you CAN).
X
X14.  A running count is displayed on the screen of the number of files
Xskipped during a ZMODEM transfer.
X
X15.  You can now specify the colors used by ecu when it makes an
Xinternal choice to change colors.  See ecu.man.
X
X16.  UNIX, thanks to POSIX, is loathe to accept a filename of greater
Xthan 14 characters when creating a file.  The XMODEM, YMODEM and
XZMODEM file receive protocols have been modified to truncate long
Xfilenames.  A patch to UNIX libsys.a to put the POSIX people back in
Xtheir place has been floating around the net.
X
X--------------------------------------------------------------------
X
XChanges and fixes since '2.10' patch level 6:
X
X1.  The nap procedure command has an additional feature, the -m
X    switch.  -m specifies the <int> parameter is a period of
X    milliseconds to suspend execution.  Without -m, <int> is
X    tenths of seconds.
X
X    nap 2 suspends execution .2 seconds
X    nap -m 250 suspends execution 250 milliseconds.
X
X
X--------------------------------------------------------------------
X
XChanges and fixes since '2.10' patch level 7:
X
X1.  added rname procedure command to allow overriding connected
X    remote name.
X
X2.  improve banner at top of session log file
X
X3.  add popen and pclose procedure commands
X
X4.  Added facility for restoring receiver display after the
X    interactive help command, or on demand using the BkTab key
X    (shift TAB).
X
X5.  fix bug whereby partial function names could be enetered
X    (e.g., '%col', '%colo', '%color' all recognized for '%colors').
X
X6.  Add the %mhack integer function, returning the life of the
X    ecu process in milliseconds.  (added mhack_test.ep to models)
X
X7.  A better representation of the received screen is kept in
X    shared memory.
X
X8.  The X, Y and ZMODEM transfer screens show per-file elapsed
X    time transfers as well as session elapsed time.
X
X9.  A modified TBIT UUCP dialer, IMHO highly optimized, is is the
X    uucp directory.
X
X10. A bug in automatic creation of string variables was fixed.
X
X11. Certain endless loops in procedure execution could not be
X    interrupted.
X
X--------------------------------------------------------------------
X
XChanges and fixes since '2.72'
X
X1.  The 'expresp' procedure command has been added:
X    usage: expresp [-v[v...]] <exp-resp-str> [<timeout_msecs>]
X    a.  -v turns on script debugging
X    b.  multiple v's (e.g., -v -vv, -vvv) up to 3 'v's produce
X        more verbose debug output
X    c.  <exp-resp-str> is as defined in /usr/lib/ecu/Dialers:
X        Meaning of some of the escape characters:
X        \p - pause (approximately 1/4-1/2 second delay)
X        \d - delay (2 seconds)
X        \D - phone number/token
X        \T - phone number with Dialcodes and character translation
X        \N - null byte
X        \K - insert a BREAK
X        \E - turn on echo checking (for slow devices)
X        \e - turn off echo checking
X        \r - carriage return
X        \c - no new-line
X        \n - send new-line
X        \nnn - send octal number
X        Speed - Hayes-specific speed-adaptive connect handler
X    d.  <timeout_msecs> specifies the optional delay for waiting
X        on expect strings;  it defaults to 10 seconds; the timeout
X        for 'Speed' expects is fixed at 90 seconds
X
X2.  Added partial support for HDB Dialers scripts
X    a.  \E echo checking is not actually performed, but
X        essentially the same effect is achieved by pacing
X        output to the modem
X    b.  The Speed expect string works only for modems
X        which return "CONNECT xxxx" connect result codes.
X    c.  Modems which return status codes during dialing, such
X        as the Trailblazer RRING, will cause Speed processing
X        to fail. Fortunately, RRING can be disabled (you should use 
X        the dialTBIT program anyway)
X    d.  the timeout for non-Speed expects is 10 seconds
X    e.  the timeout for 'Speed' expects is 90 seconds
X
X
X3.  Note, the SCO HDB documentation states that a dialer
X    program may be specified by either a complete pathname
X    or a partial pathname in /usr/lib/uucp.  Ecu requires a
X    complete pathname.
X
X4.  The string functions %dayz, %monthz, %datez, %timez and %timesz
X    have been added to retreive UTC (Z) date and time values.
X
X5.  If no dialing action results from a visit to the dialing directory,
X    the previous receiver screen contents is redisplayed.
X
X6.  The 'P' option to the 'fi' (file insert) interactive command
X    has been added.  In this mode, the file is sent character-by-
X    character to the line with 20 milliseconds pacing between each
X    character.
X
X7.  Previously, if you started ecu on an HDB machine and no line was
X    available at the specified (or default) baudrate, ecu would exit
X    with an error message.  The workaround was to explicitly state the
X    desired device with a -l argument.  The error (now as a warning) is
X    still printed, but the setup screen or initial procedure is allowed
X    to execute with tty1a forced to be the line (though this will likely
X    fail if tty1a is in Devices since ecu has already determined tty1a
X    is busy).
X
X8.  When a string is requested from the keyboard, the Cursor Left,
X    Cursor Right and Ins keys are functional, allowing editing of the
X    string.  Pressing Ins toggles insert mode.  In non-curses modes,
X    (e.g., after HOME pressed and before Enter) ^L (or ^R) displays the
X    insert mode state and redisplays the string, after which editing may
X    continue.
X
X9.  Though not appearing on the help line, the cursor up and cursor down
X    keys work in the dialing directory in a fashion similar to 'u' and 'd',
X    respectively.
X
X10. Warning: using vidi(C) to change the screen configuration while
X    ecu is running, (e.g. Home !vidi xxx) can cause the ecu to later
X    fault and dump core.  Why this occurs is not known yet.
X
X11. After pressing Home, pressing it again gives you access to a 
X    command history mechanism.  Pressing cursor up and cursor down
X    while in this mode causes less and more recent commands to be displayed.
X    You can use Ins, Cursor Left, Cursor Right and Backspace, ^L/^R to
X    edit the old entry as desired, and then press Enter. (see #8 above).
X    Users of ksh will find this a familiar feature.
X
X--------------------------------------------------------------------
X
XChanges and fixes since '2.80'
X
X1.  It was not possible to interrupt the built-in modem dialer
X    modem initialization sequence.  SIGINT will do it now.
X
X2.  A Zmodem window size may now be specified when sending files.
X    The file transfer status screen shows the number of unacknowleged
X    bytes which have been sent.  If full streaming is allowed (window
X    size of zero), then this size will match the file position until
X    the transfer is complete or the receiver sends a ZRPOS.
X
X3.  Output generated by procedures is now written to any active receiver
X    log file in addition to any active procedure log file.
X
X4.  Just a note: on 286 systems you make have to use makeL, since
X    make is a small model (medium?) and makeL is a large model
X    program.
X
X5.  The dependency of eculine.c on sys/select.h has been removed.
X    If you re-'make depend', you probably won't have this problem
X    show up again (a side effect of make depend is that it misses
X    '# include' and I have patched eculine.c to use this).
X
X6.  A new command, xon, has been added (both interactive and procedure
X    versions).  The format is:
X         xon <arg>
X    where <arg> is on    input and output flow control
X                   off   no flow control
X                   in    input flow control
X                   out   output flow control
X    If <arg> is omitted from the interactive command, the current
X    flow control status is displayed.  This command is documented in
X    the patched built-in help file and nroff txt files, but no pre-
X    printed manual changes were issued with this release.
SHAR_EOF
true || echo 'restore of OLD-HISTORY-1 failed'
fi
echo 'End of ecu320 part 2'
echo 'File OLD-HISTORY-1 is continued in part 3'
echo 3 > _shar_seq_.tmp
exit 0

exit 0 # Just in case...
