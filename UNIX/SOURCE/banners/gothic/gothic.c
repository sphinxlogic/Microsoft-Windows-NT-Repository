/*
 * Print a line of text in Gothic (Black) Script. Very simple routine,
 * just a lot of data to worry about...
 * 
 * Remember to escape all backslashes when editing characters...
 *  -- hyc, 12-29-91
 *
 * $Log: gothic.c,v $
 * Revision 1.6  1992/08/14  07:11:20  hyc
 * Fix typos in back-slash and right bracket.
 *
 * Revision 1.5  1992/08/14  05:06:45  hyc
 * Streamlined MTS support.
 *
 * Revision 1.4  1992/08/14  04:26:49  hyc
 * Implement word-wrap in addition to previous character/line wrap.
 * Full 96 character printable ASCII set implemented.
 *
 */

#ifdef _MTS
#define _ADD 1
#include <stdlib.h>
#include <ctype.h>
#else
#include <stdio.h>
#include <ctype.h>
#undef toascii
#define toascii(x) x
#endif

#ifndef __STDC__
#define	const
#endif

#ifndef DEFWIDTH
#define DEFWIDTH 79
#endif

const struct letter {
    const char     *lines[9];
}               glyphs[96] = {
    {
	"  ",			/* space */
	"  ",
	"  ",
	"  ",
	"  ",
	"  ",
	"  ",
	"  ",
	"  "
    },

    {
	"   ",			/* ! bang */
	"/\\ ",
	"\\/ ",
	"}{ ",
	"\\/ ",
	"   ",
	"<> ",
	"   ",
	"   "
    },

    {
	"      ",		/* " double-quote */
	"<> <> ",
	" )  ) ",
	"      ",
	"      ",
	"      ",
	"      ",
	"      ",
	"      "
    },

    {
	"          ",		/* # sharp */
	"  <> <>   ",
	"  }{ }{   ",
	"<>++=++<> ",
	"  }{ }{   ",
	"<>++=++<> ",
	"  }{ }{   ",
	"  <> <>   ",
	"          "
    },

    {
	"       ",		/* $ dollar */
	" _++_, ",
	"||||   ",
	"||--.  ",
	" ~|||| ",
	"  |||| ",
	",-__-  ",
	"  ||   ",
	"       "
    },

    {
	"      ",		/* % per-cent */
	"    , ",
	"<>  / ",
	"   /  ",
	"  /   ",
	" /    ",
	"/  <> ",
	"`     ",
	"      "
    },

    {
	"      ",		/* & ampersand */
	" /\\   ",
	" \\/   ",
	" /\\ , ",
	"/'\\\\, ",
	"|  \\\\ ",
	"\\\\-/\\ ",
	"      ",
	"      "
    },

    {
	"   ",			/* ' single quote */
	"<> ",
	" ) ",
	"   ",
	"   ",
	"   ",
	"   ",
	"   ",
	"   "
    },

    {
	"   ",			/* ( left paren */
	" / ",
	"// ",
	"|| ",
	"|| ",
	"|| ",
	"\\\\ ",
	" \\ ",
	"   "
    },

    {
	"   ",			/* ) right paren */
	"\\  ",
	"\\\\ ",
	"|| ",
	"|| ",
	"|| ",
	"// ",
	"/  ",
	"   "
    },

    {
	"        ",		/* * asterisk */
	"        ",
	" <> <>  ",
	"  \\ /   ",
	"<>-*-<> ",
	"  / \\   ",
	" <> <>  ",
	"        ",
	"        "
    },

    {
	"       ",		/* + plus */
	"       ",
	"  <>   ",
	"  }{   ",
	"<>--<> ",
	"  }{   ",
	"  <>   ",
	"       ",
	"       "
    },

    {
	"   ",			/* , comma */
	"   ",
	"   ",
	"   ",
	"   ",
	"   ",
	"<> ",
	" ) ",
	"   "
    },

    {
	"      ",		/* - hyphen */
	"      ",
	"      ",
	"      ",
	"<>-<> ",
	"      ",
	"      ",
	"      ",
	"      "
    },

    {
	"   ",			/* . period */
	"   ",
	"   ",
	"   ",
	"   ",
	"   ",
	"<> ",
	"   ",
	"   "
    },

    {
	"      ",		/* / slash */
	"    / ",
	"   /  ",
	"  //  ",
	"  /   ",
	" //   ",
	" /    ",
	"/     ",
	"      "
    },

    {
	"      ",		/* 0 */
	" /\\\\  ",
	"|| || ",
	"|| || ",
	"|| || ",
	"|| || ",
	" \\\\/  ",
	"      ",
	"      "
    },

    {
	"     ",		/* 1 */
	" /|  ",
	"/||  ",
	" ||  ",
	" ||  ",
	" ||  ",
	",/-' ",
	"     ",
	"     "
    },

    {
	"     ",		/* 2 */
	" /\\  ",
	"(  ) ",
	"  // ",
	" //  ",
	"/(   ",
	"{___ ",
	"     ",
	"     "
    },

    {
	"____ ",		/* 3 */
	"` // ",
	" //  ",
	" \\\\  ",
	"  )) ",
	" //  ",
	"/'   ",
	"     ",
	"     "
    },

    {
	"  ,  ",		/* 4 */
	" /|  ",
	"/ |  ",
	"__|_ ",
	"---- ",
	"  |  ",
	" ,_, ",
	"     ",
	"     "
    },

    {
	"____  ",		/* 5 */
	"||  ` ",
	"||_   ",
	"|/ \\  ",
	"   )) ",
	"  //  ",
	" /'   ",
	"      ",
	"      "
    },

    {
	"      ",		/* 6 */
	"  ,/  ",
	" //   ",
	"((_-  ",
	"|| )) ",
	"(( || ",
	" \\//  ",
	"      ",
	"      "
    },

    {
	"____  ",		/* 7 */
	"`  || ",
	"   /, ",
	"  //  ",
	" ((   ",
	" ||   ",
	" |'   ",
	"      ",
	"      "
    },

    {
	"      ",		/* 8 */
	" /\\\\  ",
	"|| || ",
	" \\ /  ",
	" /\\\\  ",
	"// \\\\ ",
	"|| || ",
	" \\\\/  ",
	"      "
    },

    {
	"      ",		/* 9 */
	" /\\\\  ",
	"|| || ",
	"|| || ",
	" \\/|| ",
	"   || ",
	" \\_/  ",
	"      ",
	"      "
    },

    {
	"   ",			/* : */
	"   ",
	"   ",
	"<> ",
	"   ",
	"   ",
	"<> ",
	"   ",
	"   "
    },

    {
	"   ",			/* ; */
	"   ",
	"   ",
	"<> ",
	"   ",
	"   ",
	"<> ",
	" ) ",
	"   "
    },

    {
	"      ",		/* < */
	"    / ",
	"   /  ",
	" //   ",
	"<<    ",
	" \\\\   ",
	"   \\  ",
	"    \\ ",
	"      "
    },

    {
	"      ",		/* = */
	"      ",
	"      ",
	"<>-<> ",
	"      ",
	"<>-<> ",
	"      ",
	"      ",
	"      "
    },

    {
	"      ",		/* > */
	"\\     ",
	" \\    ",
	"  \\\\  ",
	"   >> ",
	"  //  ",
	" /    ",
	"/     ",
	"      "
    },

    {
	" -_  ",		/* ? */
	"/ \\\\ ",
	"` || ",
	"  |, ",
	" ((  ",
	"     ",
	" <>  ",
	"     ",
	"     "
    },

    {
	"      ",		/* @ */
	" /\\\\  ",
	"|| || ",
	"||/|| ",
	"||\\|  ",
	"||    ",
	" \\\\_, ",
	"      ",
	"      "
    },


#ifdef ITALIC
    {
	"           ",
	" _--_,     ",
	"   ,\\\\     ",
	"  ~' \\\\    ",
	"   |==\\\\   ",
	"   |   \\\\. ",
	" _---_  \\/ ",
	"(          ",
	"           "
    },
#else
    {
	"  ___    ",
	" -   -_, ",
	"(  ~/||  ",
	"(  / ||  ",
	" \\/==||  ",
	" /_ _||  ",
	"(  - \\\\, ",
	"         ",
	"         "
    },
#endif

    {
	"          ",
	"_-_ _,,   ",
	"   -/  )  ",
	"  ~||_<   ",
	"   || \\\\  ",
	"   ,/--|| ",
	"  _--_-'  ",
	" (        ",
	"          "
    },

    {
	"         ",
	"  ,- _~. ",
	" (' /|   ",
	"((  ||   ",
	"((  ||   ",
	" ( / |   ",
	"  -____- ",
	"         ",
	"         "
    },

    {
	"          ",
	"-_____    ",
	"  ' | -,  ",
	" /| |  |` ",
	" || |==|| ",
	"~|| |  |, ",
	" ~-____,  ",
	"(         ",
	"          "
    },

    {
	"         ",
	"  ,- _~, ",
	" (' /| / ",
	"((  ||/= ",
	"((  ||   ",
	" ( / |   ",
	"  -____- ",
	"         ",
	"         "
    },

#ifdef ITALIC
    {
	"  __    ",
	"_// --_/",
	"  ||    ",
	" ~+|-/  ",
	"  ||    ",
	"  ||    ",
	" ,/     ",
	"        ",
	"        "
    },
#else
    {
	"    _ ,",
	"  ,- - ",
	" _||_  ",
	"' ||   ",
	"  ||   ",
	"  |,   ",
	"_-/    ",
	"       ",
	"       "
    },
#endif

    {
	"    __ ,  ",
	"  ,-| ~   ",
	" ('||/__, ",
	"(( |||  | ",
	"(( |||==| ",
	" ( / |  , ",
	"  -____/  ",
	"          ",
	"          "
    },

    {
	"          ",
	"_-_-      ",
	"  /,      ",
	"  || __   ",
	" ~||-  -  ",
	"  ||===|| ",
	" ( \\_, |  ",
	"       `  ",
	"          "
    },

    {
	"     ",
	"_-_, ",
	"  // ",
	"  || ",
	" ~|| ",
	"  || ",
	"_-_, ",
	"     ",
	"     "
    },

    {
	"      ",
	" _-_,,",
	"(  // ",
	"  _|| ",
	"  _|| ",
	"   || ",
	"-__-, ",
	"      ",
	"      "
    },

    {
	"         ",
	"_-_-,    ",
	"  // ,   ",
	"  ||/\\\\  ",
	" ~|| <   ",
	"  ||/\\\\  ",
	" _-__,\\\\,",
	"         ",
	"         "
    },

    {
	"        ",
	"_-_-    ",
	" /,     ",
	" ||     ",
	"~||     ",
	" ||     ",
	"(  -__, ",
	"        ",
	"        "
    },

    {
	"          ",
	"  /\\\\,/\\\\,",
	" /| || || ",
	" || || || ",
	" ||=|= || ",
	"~|| || || ",
	" |, \\\\,\\\\,",
	"_-        ",
	"          "
    },

    {
	"    __   ",
	"   /  -, ",
	"  ||   ) ",
	" ~||---) ",
	" ~||---, ",
	" ~||  /  ",
	"  |, /   ",
	"-_-  --~ ",
	"         "
    },

    {
	"    __     ",
	"  ,-||-,   ",
	" ('|||  )  ",
	"(( |||--)) ",
	"(( |||--)) ",
	" ( / |  )  ",
	"  -____-   ",
	"           ",
	"           "
    },

    {
	"         ",
	"-__ /\\\\  ",
	"  ||  \\\\ ",
	" /||__|| ",
	" \\||__|| ",
	"  ||  |, ",
	"_-||-_/  ",
	"  ||     ",
	"         "
    },

    {
	"    __     ",
	"  ,-||-,   ",
	" ('|||  )  ",
	"(( |||--)) ",
	"(( |||--)) ",
	" ( / |  )  ",
	"  -____-\\\\ ",
	"           ",
	"           "
    },

    {
	"        ",
	"-__ /\\  ",
	"  || \\, ",
	" /|| /  ",
	" \\||/-  ",
	"  ||  \\ ",
	"_---_-|,",
	"        ",
	"        "
    },

    {
	"        ",
	"  -_-/  ",
	" (_ /   ",
	"(_ --_  ",
	"  --_ ) ",
	" _/  )) ",
	"(_-_-   ",
	"        ",
	"        "
    },

    {
	" ___        ",
	"-   ---___- ",
	"   (' ||    ",
	"  ((  ||    ",
	" ((   ||    ",
	"  (( //     ",
	"    -____-  ",
	"            ",
	"            "
    },

    {
	" _ _    _ ,",
	"- - /  - - ",
	"  ('||  || ",
	" (( ||--|| ",
	" (( ||--|| ",
	" (( /   || ",
	"   -___-\\\\,",
	"           ",
	"           "
    },

    {
	" _      ",
	"- - _-  ",
	"  )-  ) ",
	"  )___) ",
	" ~)___) ",
	"  )  )  ",
	" /-_/   ",
	"        ",
	"        "
    },

    {
	" _        ",
	"- - /, /, ",
	"  )/ )/ ) ",
	"  )__)__) ",
	" ~)__)__) ",
	"  )  )  ) ",
	" /-_/-_/  ",
	"          ",
	"          "
    },

    {
	" _       ",
	"- -    /`",
	"  \\\\  /  ",
	"   \\\\/   ",
	"  ==/\\== ",
	"   / \\\\  ",
	"\\\\/   \\\\,",
	"         ",
	"         "
    },

    {
	"         ",
	"-_   _   ",
	"  |,- `  ",
	" ~||__)) ",
	" ~||__)) ",
	"  |_ _,  ",
	" -' -    ",
	"( _-_    ",
	" -   '   "
    },

    {
	"      ",
	"_-___ ",
	"    / ",
	"   /  ",
	" =/=  ",
	" /    ",
	"/-__- ",
	"      ",
	"      "
    },

    {
	"  __ ",		/* [ left bracket */
	"||   ",
	"||   ",
	"||   ",
	"||   ",
	"||   ",
	"||   ",
	"||__ ",
	"     "
    },

    {
	"      ",		/* \ back-slash */
	"\\     ",
	" \\    ",
	" \\\\   ",
	"  \\   ",
	"  \\\\  ",
	"   \\  ",
	"    \\ ",
	"      "
    },

    {
	"__   ",		/* ] right bracket */
	"  || ",
	"  || ",
	"  || ",
	"  || ",
	"  || ",
	"  || ",
	"__|| ",
	"     "
    },

    {
	"  x   ",		/* ^ caret */
	" / \\  ",
	"/   \\ ",
	"      ",
	"      ",
	"      ",
	"      ",
	"      ",
	"      "
    },

    {
	"      ",		/* _ underscore */
	"      ",
	"      ",
	"      ",
	"      ",
	"      ",
	"      ",
	"_____ ",
	"      "
    },

    {
	"   ",			/* ` back-quote */
	"<> ",
	"(  ",
	"   ",
	"   ",
	"   ",
	"   ",
	"   ",
	"   "
    },
#ifdef ITALIC
    {
	"       ",
	"       ",
	"       ",
	" _-_   ",
	"|| \\\\, ",
	"|| ||  ",
	"\\\\/\\\\, ",
	"       ",
	"       "
    },
#else
    {
	"      ",
	"      ",
	"  _   ",
	" < \\, ",
	" /-|| ",
	"(( || ",
	" \\/\\\\ ",
	"      ",
	"      "
    },
#endif

    {
	"      ",
	",,    ",
	"||    ",
	"||/|, ",
	"|| || ",
	"|| |' ",
	"\\\\/   ",
	"      ",
	"      "
    },

    {
	"     ",
	"     ",
	"     ",
	" _-_ ",
	"||   ",
	"||   ",
	"\\\\,/ ",
	"     ",
	"     "
    },
#ifdef ITALIC
    {
	"        ",
	"     ,  ",
	"    ||  ",
	" _-_||  ",
	"|| \\\\|  ",
	"||  ||  ",
	" \\\\/\\\\, ",
	"        ",
	"        "
    },
#else
    {
	"      ",
	" |\\   ",
	"  \\\\  ",
	" / \\\\ ",
	"|| || ",
	"|| || ",
	" \\\\/  ",
	"      ",
	"      "
    },
#endif
    {
	"      ",
	"      ",
	"      ",
	" _-_  ",
	"|| \\\\ ",
	"||/   ",
	"\\\\,/  ",
	"      ",
	"      "
    },

    {
	"     ",
	"  /\\ ",
	" ||  ",
	"=||= ",
	" ||  ",
	" ||  ",
	" \\\\, ",
	"     ",
	"     "
    },

    {
	"      ",
	"      ",
	"  _   ",
	" / \\\\ ",
	"|| || ",
	"|| || ",
	"\\\\_-| ",
	" /  \\ ",
	"'----`"
    },
#ifdef ITALIC
    {
	"      ",
	" ,    ",
	"||    ",
	"||,<> ",
	"|| || ",
	"|| || ",
	"<>,|| ",
	"   |/ ",
	"  ./  "
    },

    {
	"   ",
	"   ",
	"<> ",
	"-_ ",
	"|| ",
	"|| ",
	"\\\\,",
	"   ",
	"   "
    },
#else
    {
	"      ",
	",,    ",
	"||    ",
	"||/\\\\ ",
	"|| || ",
	"|| || ",
	"\\\\ |/ ",
	"  _/  ",
	"      "
    },

    {
	"   ",
	"   ",
	" ' ",
	"\\\\ ",
	"|| ",
	"|| ",
	"\\\\ ",
	"   ",
	"   "
    },
#endif
    {
	"   ",
	"   ",
	" ' ",
	"\\\\ ",
	"|| ",
	"|| ",
	"|| ",
	"|; ",
	"/  "
    },

    {
	"     ",
	",,   ",
	"||   ",
	"||/\\ ",
	"||_< ",
	"|| | ",
	"\\\\,\\ ",
	"     ",
	"     "
    },

    {
	"   ",
	",, ",
	"|| ",
	"|| ",
	"|| ",
	"|| ",
	"\\\\ ",
	"   ",
	"   "
    },

    {
	"         ",
	"         ",
	"         ",
	"\\\\/\\\\/\\\\ ",
	"|| || || ",
	"|| || || ",
	"\\\\ \\\\ \\\\ ",
	"         ",
	"         "
    },

    {
	"      ",
	"      ",
	"      ",
	"\\\\/\\\\ ",
	"|| || ",
	"|| || ",
	"\\\\ \\\\ ",
	"      ",
	"      "
    },

    {
	"      ",
	"      ",
	"      ",
	" /'\\\\ ",
	"|| || ",
	"|| || ",
	"\\\\,/  ",
	"      ",
	"      "
    },

    {
	"      ",
	"      ",
	"      ",
	"-_-_  ",
	"|| \\\\ ",
	"|| || ",
	"||-'  ",
	"|/    ",
	"'     "
    },

    {
	"      ",
	"      ",
	"      ",
	" /'\\\\ ",
	"|| || ",
	"|| || ",
	"\\\\,|| ",
	"   || ",
	"   '` "
    },

    {
	"      ",
	"      ",
	"      ",
	",._-_ ",
	" ||   ",
	" ||   ",
	" \\\\,  ",
	"      ",
	"      "
    },

    {
	"      ",
	"      ",
	"      ",
	" _-_, ",
	"||_.  ",
	" ~ || ",
	",-_-  ",
	"      ",
	"      "
    },

    {
	"     ",
	"  ,  ",
	" ||  ",
	"=||= ",
	" ||  ",
	" ||  ",
	" \\\\, ",
	"     ",
	"     "
    },

    {
	"      ",
	"      ",
	"      ",
	"\\\\ \\\\ ",
	"|| || ",
	"|| || ",
	"\\\\/\\\\ ",
	"      ",
	"      "
    },

    {
	"     ",
	"     ",
	";    ",
	"\\\\/\\ ",
	"|| | ",
	"|| | ",
	"\\\\/  ",
	"     ",
	"     "
    },

    {
	"       ",
	"       ",
	";      ",
	"\\\\/\\/\\ ",
	"|| | | ",
	"|| | | ",
	"\\\\/\\\\/ ",
	"       ",
	"       "
    },

    {
	"      ",
	"      ",
	",     ",
	"\\\\ /` ",
	" \\\\   ",
	" /\\\\  ",
	"/  \\; ",
	"      ",
	"      "
    },
#ifdef ITALIC
    {
	"      ",
	"      ",
	"      ",
	"-_ -_ ",
	"|| || ",
	"|| || ",
	"\\\\,|| ",
	"   |/ ",
	"  ./  "
    },
#else
    {
	"       ",
	"       ",
	"       ",
	"'\\\\/\\\\ ",
	" || ;' ",
	" ||/   ",
	" |/    ",
	"(      ",
	" -_-   "
    },

#endif
    {
	"    ",
	"    ",
	"    ",
	"/\\\\ ",
	" /  ",
	"/\\\\ ",
	" || ",
	" /  ",
	"(,  "
    },

    {
	"   _ ",		/* { left curly bracket */
	"  (  ",
	"  )  ",
	"  )  ",
	"-{   ",
	"  )  ",
	"  )  ",
	"  (_ ",
	"     "
    },

    {
	"   ",			/* | vertical bar */
	"|| ",
	"|| ",
	"|| ",
	"|| ",
	"|| ",
	"|| ",
	"|| ",
	"   "
    },

    {
	"_    ",		/* } right curly bracket */
	" )   ",
	" (   ",
	" (   ",
	"  }- ",
	" (   ",
	" (   ",
	"_)   ",
	"     "
    },

    {
	" _    ",		/* ~ tilde */
	"/ \\_/ ",
	"      ",
	"      ",
	"      ",
	"      ",
	"      ",
	"      ",
	"      "
    }
};

char           *outbuf;
void            print();
int             width = DEFWIDTH;
#ifdef _MTS
__fortran void  scards(), sprint();
short           len;
int             lnum, mods = 0, _noopen, rc;
#define gets(buffer) \
	scards(buffer,&len,&mods,&lnum, __retcode rc), \
	buffer[len]='\0', \
	rc == 0 ? 1 : 0
#define puts(outbuf)	\
	len = outptr - outbuf;	\
	sprint(outbuf,&len,&mods,&lnum)
#define NewLine \
	len=1;	\
	sprint(outbuf,&len,&mods,&lnum)
#define BufAdj	1
#define GE	>
#else
#define NewLine	putchar('\n')
#define BufAdj	0
#define GE	>=
#endif


main(argc, argv)
    int             argc;
    char          **argv;
{
    char            buffer[256], *malloc();

    if (argc > 1) {
	if (argv[1][0] == '-') {
	    width = atoi(&argv[1][1]);
	    argc--;
	    argv++;
	}
    }
    outbuf = malloc(width + 20);
#ifdef _MTS
    *outbuf = ' ';
#endif

    if (argc < 2) {		/* read message from stdin */
	while (gets(buffer) != NULL)
	    print(buffer);
    } else {
	for (--argc; argc != 1; argc--) {
	    argv[argc]--;
	    *argv[argc] = ' ';
	}
	print(argv[1]);
    }
}

void
print(buf)
    char           *buf;
{
    register int    i;
    register char  *inptr, *outptr, *prevptr, *spinptr, *spptr;
    register char const *dataptr;
    int             wrapped;
    char	    oldc;

    do {
	wrapped = 0;
	spinptr = buf;
	for (i = 0; i < 9; i++) {
	    outptr = outbuf + BufAdj;
	    *outptr = '\0';
	    for (inptr = buf; *inptr; inptr++) {
		prevptr = outptr;
		if (isprint(*inptr))
		    dataptr = glyphs[toascii(*inptr) - toascii(' ')].lines[i];
		else
		    dataptr = glyphs[0].lines[i];
		if (dataptr == glyphs[0].lines[i]) {
		    spinptr = inptr+1;
		    spptr = outptr;
		}
		for (; *dataptr;)
		    *outptr++ = *dataptr++;
		if (outptr - outbuf > width) {
		    wrapped = 1;
		    if (spinptr == buf) {
		    	outptr = prevptr;
		    } else {
			outptr = spptr;
			inptr = spinptr;
			if (spptr == prevptr)
			    inptr--;
		    }
		    oldc = *inptr;
		    *inptr = '\0';
		    break;
		}
	    }
	    for (outptr--; outptr GE outbuf; outptr--)
		if (*outptr != ' ')
		    break;
	    *++outptr = '\0';
	    puts(outbuf);
	}
	NewLine;
	if (wrapped) {
	    buf = inptr;
	    *inptr = oldc;
	    if (oldc == ' ')
		buf++;
	}
    } while (wrapped);
}
