
/*  @(#)CHANGES-v1.4 1.17 91/04/09
 *
 *  Copyright (c) Rich Burridge - Sun Microsystems Australia.
 *                                All rights reserved.
 *
 *  Permission is given to distribute these sources, as long as the
 *  copyright messages are not removed, and no monies are exchanged.
 *
 *  No responsibility is taken for any errors on inaccuracies inherent
 *  either to the comments or the code of this program, but if reported
 *  to me, then an attempt will be made to fix them.
 */

Faces change history.
=====================

v1.4 - patchlevel 14 - 2nd April 1991.

         - From Philip Gladstone <philip@bigben.dle.dg.com>
           Better handling of X11 events -- fixes a number of bugs whereby
           things didn't get drawn.

         - From Philip Gladstone <philip@bigben.dle.dg.com>
           Fits text better into the icon even if proportional spaced font.

         - From Philip Gladstone <philip@bigben.dle.dg.com>
           The option of displaying the hostname rather than the username if
           the icon represents the username rather than the hostname. This is
           controled by the X resource "faces.displayHostname", and defaults
           to false.

         - From Philip Gladstone <philip@bigben.dle.dg.com>
           Fixes some bug (I can't recall what) attached to doing NIS lookups
           when a failing NIS lookup turns into a domain name lookup.

         - From Philip Gladstone <philip@bigben.dle.dg.com>
           Fixes a problem with utime system call not taking two longs!

         - From Philip Gladstone <philip@bigben.dle.dg.com>
           Fixes a problem if you change the width across to be not 10.

         - Added a Makefile.dist file to the faces distribution. This will
           replace the Makefile, and allows further changes to this file,
           without blowing the users changes out of the water. Patching the
           Makefile should be simpler now. The MANIFEST and FILES files have
           been updated.

         - From Chris Steinbroner <hesh@lll-crg.llnl.gov>
           From Philip Colmer <pcolmer@acorn.co.uk>
           Loading xfaces fails because XSetWMProtocols() does not exist on my
           system. It's an X11R4 routine. A new definition (X11R3) has been
           added to the Makefile.dist file. This needs to be uncommented if
           you are running the X11 (Xlib) version under MIT X11R3.

         - From John B. Melby <melby@daffy.yk.fujitsu.co.jp>
           If one creates a directory "edu" in the faces directory, it does
           not have any effect on a domain address in which EDU is capitalized.
           It seems to me that "faces" should not pay any attention to the
           case of a domain name (since case is only supposed to be significant
           in the user name).

           From John Mackin <john@syd.dit.csiro.au>
           The comparison when looking up the domain in the faces
           directory appears to be case-sensitive.  This is wrong per
           RFC822, domain-parts are case-insensitive.  Both the directory
           name and the host name from the mail item should be downcased
           before comparison.

           From Peter Gray <pdg@draci.cs.uow.oz.au>
           When comparing the domain of the mail with the machine.tab entries
           strcasecmp should be used since mail addresses are case invarient.

           From u502sou@mpirbn.mpifr-bonn.mpg.de (Ignatios Souvatzis)
           As far as I remember, RFC822 states that 'domains' and 'mailboxes'
           ignore case. I frequently get mail with domain or subdomain names
           uppercase or capitalized. 'gethostname' on the DECstations of the
           university's radio astronomy institute returns upper case names
           (probably set up this way to get it compatible to DECnet
           conventions, they talk DECnet to the VAXes...). [Patch included].

         - From Ken Wood <kwood@adl.austek.oz.au>
           Details of how to generate X-Face: headers from within GNU Emacs.
           Added to the README file.

         - Converted the mini faces database supplied with the faces
           distribution to face.xbm format. MANIFEST and FILES files updated.

         - Reversed the order of the patch entry descriptions in the CHANGES
           file, so the latest entry is at the top.

         - From Steve Kinzler <kinzler@iuvax.cs.indiana.edu>
           Added a variety of scripts and filters to the faces distribution.
           These are:

           ikon2xbm, xbm2ikon  bitmaps filters for Blit ikon and X11 bitmaps

           lpqall.sh, lpqall   customized "faces -e" script for monitoring all
                               printers

           mailq               customized "faces -e" script for monitoring the
                               system sendmail queue

         - The faces mailing list is now mentioned in the README file.

         - The resource handling that was in x11.c, has been abstracted out
           into main.c. The XView version now also reads the X resources.

         - From Michael Urban <urban%hercules@rand.org>
           Inclusion of support for the RAND mailer in mon.c, which insists on
           four ^A characters to mark the beginning and end of messages. These
           mods are included via an #ifdef RAND, with a new entry in the
           Makefile.dist file.

         - From Robert Adams <adams@littlei.intel.com>
           Details of how to use the X-Face: lines with SVR4 have been added
           to the README file.

v1.4 - patchlevel 13 - 13th March 1991.

         - From James Ashton <jaa@cs.su.oz.au>
           From Mark Shand <shand@prl.dec.com>
           Fixed a corruption problem with the [un]compface routines.

         - From Dave Cohrs <dave@cs.wisc.edu>
           Changed some #ifndef mips to #if !defined(mips) || defined(ultrix)
           because a DECstation defines mips as its processor type.

         - From Dave Cohrs <dave@cs.wisc.edu>
           Added a new option to set the X11 font name, -fn.  Also, added
           support internally to handle fonts other than the standard 6x12
           font by removing inline constants and using font parameters instead.

         - From Dave Cohrs <dave@cs.wisc.edu>
           Added support for the standard X11 resources that correspond to the
           command line options. I could have gone further with this, but it
           gets tiring after a while. I wouldn't want to do much more without
           changing it into a toolkit program, but that's just too much work!
 
         - From Dave Cohrs <dave@cs.wisc.edu>
           Added the ability to specify the 4 .facesrc parameters via the X11
           resource file -- X11 users are used to everything being in the X11
           resources, so this gives them what they expect.
            
         - From Dave Cohrs <dave@cs.wisc.edu>
           Allow X11 users to make an X11 bitmap rather than a Sun icon for
           the background pixmap.
            
         - From Dave Cohrs <dave@cs.wisc.edu>
           Added an XFlush() to the bell code, to make the beeps intelligible,
           and changed an XSync() to an XFlush() -- the former caused the
           window to hang until an event occured -- probably a buffering
           problem.

         - From Dave Cohrs <dave@cs.wisc.edu>
           Removed some stuff for displaying the username/timestamp text for
           X11. It made the display look really bad for a color monitor.

         - From Dave Cohrs <dave@cs.wisc.edu>
           Updated the man page to mention all of the X options and resources.

         - From Dave Cohrs <dave@cs.wisc.edu>
           If the "X-Face: " is the last header line, it doesn't get displayed,
           because the final processing never gets done to set "x_face".

         - From Dave Cohrs <dave@cs.wisc.edu>
           In the X11 event processing, KeyPress gets sent for real key presses
           (e.g 'q') and for other presses, like <Shift>.  The latter doesn't
           clear out the lookup string, so you need to do so manually.
           Otherwise, if you type <DEL> to clear the window, you can press
           <Shift> or <Control> or any such key accidentally later on, and it
           clears the window.

         - From Mark Shand <shand@prl.dec.com>
           Changes to fgetheader function which returns a folded header line
           (in the RFC822 sense), and associated to the "line" variable which
           must now accomodate arbitrarily long input lines. Also deal with
           space between the header-field and the :

v1.4 - patchlevel 12 - 17th January 1991.

         - The Del key was being incorrectly recognised in the XView version.

         - From Craig Bishop <csb@gdwb.oz.au>
           If you are monitoring "New" mail after clicking on the Apply
           button from the property sheet, with the XView version, then the
           faces window should be cleared first.

         - From Craig Bishop <csb@gdwb.oz.au>
           If you were monitoring new mail, mail messages with X-Face: lines
           were being incorrectly extracted if the X-Face: line(s) were the
           last header field, now that faces only looks for X-Face: lines in
           the mail header.

         - Fixed up the X11 and XView drivers so there is a definite pause
           between each beep and flash when new mail arrives.

         - If the hostname to be monitored is an empty string, do_users()
           defaults to "localhost". If the printer name to be monitored is
           an empty string, do_printer() defaults to "lp".

v1.4 - patchlevel 11 - 14th January 1991.

         - Removed the mailing list hack from Gregory Dudek. It doesn't seem
           to work quite right, and it cause the incorrect handling of From:
           lines on other mail items.

         - The check to see if the spool file has changed, needed to call
           show_display() if there was no change, otherwise the old offscreen
           memory pixrects, would not be freed.

         - Added a property sheet to the XView version. This allows you to
           toggle the monitoring option (mail/users/printer/custom) on the fly.
 
         - Ran faces through Saber-C, and fixed up inconsistencies.

v1.4 - patchlevel 10 - 7th January 1991.

         - Faces now only looks for X-Face: lines in the mail header, now
           that there is a simple method for everybody to get their X-Face:
           lines into the mail header (see below). This fixes up the following
           problems (which have been removed from the TODO file):

           If an X-Face is found inside a piece of mail that has been
           forwarded inside another mail item, and the -U option is set, then
           it is possible to update the wrong face in the faces database. The
           only clean solution to this, is if faces only recognises X-Face
           lines in the mail header.

           From Pat Lashley <patl@Sun.COM>
           The problem with finding an X-Face: entry in an included message
           can be resolved by a flag which would restrict X-Face: recognition
           to the header or the first non-blank line of the body.
 
         - From John Mackin <john@cs.su.oz.au>
           The code in mon.c recognises From: lines in the body of the mail.
           This is an error. From: lines should only be recognised before
           the first blank line.
            
         - From John Mackin <john@cs.su.oz.au>
           A small shell script called faces.sendmail has been written, which
           will automatically add X-Face: compressed image lines to a mail
           header. This is used in conjunction with the set sendmail entry in
           a user's ~/.mailrc file. See the README file and the faces manual
           pages for more details. This method is known to work with Berkeley
           Mail, Open Windows mailtool and mush. It should work with other
           mailers too. The special patch to mush is no longer needed; in
           fact if it has been applied, it should be un-applyed otherwise you
           will get two sets of X-Face: lines in your mail headers. The
           mush.xface.patch file can be removed from the faces distribution.
           FILES, MANIFEST, Makefile, README and faces.1 have been updated.

         - From John Mackin <john@cs.su.oz.au>
           The manual entry makes no mention of X-Face: lines.

         - From Mike Khaw <khaw@parcplace.com>
           The "install" target for the Makefile is missing a "/" between
           $(MANSECT) and face_update; i.e., the last line should be

                $(MANDIR)/man$(MANSECT)/face_update.$(MANSECT)

         - From Chris Mackerell <chris@bcl.co.nz>
           Changes to faces to get it compile in the BSD4.3 environment of
           Mips RISCos 4.5 (beta).

         - From brew%qa@tplrd.tpl.oz.au
           There is a problem parsing the address from which mail comes
           if the address looks like

           From: person@machine

           ie: no "(comment)" after it.  You parse this so that the machine
           name has a trailing '\n'.

           Although I sometimes get mail like this, perhaps this is not correct
           RFC822 syntax.

         - From Chris Maltby <chris@softway.sw.oz.au>
           It the user had cleared the faces window by hitting the Del key,
           the icon wasn't being reset to the "no mail" icon.

         - From Howard Pelling <Howard.Pelling@UK.Sun.COM>
           Modifications to allow faces to recognise partial domains in the
           machine.tab file. Eg. mail from bristol.ac.uk and edinburgh.ac.uk
           will come from the same community.

         - From Graham Dumpleton <grahamd@otc.otca.oz>
           From Alan Skea <skea@vast.eecs.unsw.oz>
           If the From: line just had a username (no hostname), then the
           trailing newline was not being removed (in parsefrom.c).

         - A plain text version of the faces manual pages is now included with
           the faces distribution. It's called faces.man.text.

         - From Gregory Dudek  <dudek@daeron.McRCIM.McGill.EDU>
           In process_info() in mon.c, don't do anything if the mailbox hasn't
           changed since the last look.

         - From Gregory Dudek  <dudek@daeron.McRCIM.McGill.EDU>
           In process_from() in mon.c, I've added an UGLY hack so that mailing
           lists could be recognized as such, rather than causing zillions of
           different unknown's to appear. It expects an ugly ugly magic trick
           in people.tab. The mailing list must appear as
           listplace/list@listplace  eg.

           ics.UCI.EDU/fa.think-c-outbound-request@ics.UCI.EDU

v1.4 - patchlevel 9 - 11th October 1990.

       * From Robert Adams <adams@littlei.intel.com>
         Speedups in directory searching in main.c:
                1) all of the lists are now terminated by a NULL (saves
                        a 'strlen' call);
                2) the removal of the leading "." is done earlier and a
                        check is made for removing a last trailing dot (this
                        saves an extra bunch of stat's for the dir "misc.");
                3) if the 'stat' for the old style file name fails, that
                        means that the directory containing the files also
                        can't be there.  The loop is terminated if the 'stat'
                        fails.  This reduces the number of 'stat's done
                        when searching for a face by an order of magnitude.

       * From Robert Adams <adams@littlei.intel.com>
         The time delay for the SysV kludge 'select' replacement was reduced
         from 5 to 3.

       * From Johan Vromans <jv@mh.nl>
         With GNU gcc, you cannot say "#ifdef XXX || YYY". It must be either
         "#if XXX || YYY" or "#if defined(XXX) || defined(YYY)".

       * From Johan Vromans <jv@mh.nl>
         Defined CC and $(CC) in the compface/Makefile, which can easily be
         altered for other C compilers.
 
       * From Bruno Pillard <bp@chorus.fr>
         The installation of the machine.tab and the people.tab has been
         removed from the standard "make install" rules in the Makefile.
         Typically sites will have customised these files in their faces
         directory, and do want them overwritten when you do a new
         installation of the faces program.

         Instead, an extra definition has been added to the Makefile. If you
         now do a "make tables", then the default machine and people tables
         will be installed. The README has been updated to reflect this
         change.

       * From John Mackin <john@cs.su.oz.au>
         Some systems (that don't use Berkeley Mail) have a ~/.mailrc format
         that is not compatible with the format of the commands that faces
         wants to find there. So, look for .facesrc first, and if that is
         found use it; otherwise examine .mailrc. This has been implemented,
         and the manual pages have been updated to reflect these changes.

       * From John Mackin <john@cs.su.oz.au>
         The manual page did not actually document the format of the commands
         faces looks for in .mailrc/.facesrc (that is, "set bell = <number>"
         and "set flash = <number>"). These have been documented, and two
         new options have also been added: "set raise" causes the window to
         be raised when new mail arrives, and "set button1clear" causes
         button 1 to clear the window, like it did in the previous version
         of faces, and like hitting Delete does now, and moves button 1's
         "toggling" function to button 2. This functionality is present in
         the X11, XView and SunView drivers. The TODO file has been updated
         to show that the NeWS driver still needs to be modified.

       * From John Mackin <john@cs.su.oz.au>
         Several functions (getenv, malloc, index and rindex) are all
         standard V7 and are all always char *. There is no reason they
         should be declared inside the SYSV32 conditional.

       * From John Mackin <john@cs.su.oz.au>
         The code has been made more robust for the case where uncompface
         never gets called. It will core-dump otherwise if an X-Face: line
         is the last thing in the mail file. In any case, the return value
         of index should always be checked.

       * From John Mackin <john@cs.su.oz.au>
         Various #include file adjustments for a MIPS machine:

         netdb.h      ==>  bsd/netdb.h
         sys/types.h  ==>  bsd/sys/types.h
         sys/time.h   ==>  bsd/sys/time.h

         In general, you should not assume that sys/time.h will automatically
         include sys/types.h for you.

       * From John Mackin <john@cs.su.oz.au>
         X-Face: lines are ignored if we've already seen one in this mail
         item. (This is similar to the way From: lines are already treated.)
         This will work correctly in all cases except when someone who puts
         their X-Face: in their signature includes (and doesn't indent) mail
         with an X-Face: in it. The TODO file entry has been modified to
         reflect this change.

       * From John Mackin <john@cs.su.oz.au>
         An extra definition has been added to the Makefile. This is
         NO_SELECT, and should be uncommented if your machine doesn't have
         the select() system call. Before this patch, this option was
         determined by the SYSV32 #ifdef. In these days of hybrid Unix
         systems this is no longer appropriate.

       * From John Mackin <john@cs.su.oz.au>
         The X11 driver now sets the WM_CLIENT_MACHINE property.

       * From John Mackin <john@cs.su.oz.au>
         Fixed a bad, core-dump-causing bug in the compface/compress routine.
         BigRead calls BigMul which assumes B is initialised. That's fine for
         the compface and uncompface _programs_ -- in that case it is
         initialised to zero, being statically allocated -- but a disaster
         for programs that call the library routines repeatedly, as faces does.

       * From John Mackin <john@cs.su.oz.au>
         Fixed a naming conflict between BACKGROUND in faces.h, and the
         Makefile definition BACKGROUND (if uncommented).

       * From John Mackin <john@cs.su.oz.au>
         The following points have been added to the TODO file:

         - If the mailbox is empty, or contains just one mail item, faces -a
           starts out 10 icon-widths long (with the right-hand part being
           white instead of background grey), then shrinks to one icon-width
           as soon as a mail item arrives or you delete the mail.
           I don't care about this since I don't use -a, but what I _would_
           like to see (here comes the wishlist item) is an option that you
           can use with monitor-new that keeps the window always 10 (or -c
           if specified) icon-widths wide, but adds extra rows of icons as
           needed if more than 10/-c new mail items arrive between clearings
           of the window, and shrinks the window back to one row/-c widths
           when it is cleared.

         - The usage message claims you can use "-bg background_color".
           This isn't in the manual page, and it also doesn't work at all
           (under X11). The argument appears to be completely ignored

         - The "-b icon_file" option doesn't work. It still comes up with
           the default background.

         - The manual entry makes no mention of X-Face: lines.

         - It should be made more explicit in the manual page that in the
           previous version of faces, a -f option _added_ the directory to
           the face search path, so that if you did -f you got those faces
           in addition to the system default faces, whereas now -f
           _supersedes_ the system faces and you must include a trailing
           colon to have them searched.

         - A comment on the domain lookup algorithm. According to the manual
           page:

           $DIR/machine.dom.ain/uid/iconname
           $DIR/dom.ain/uid/iconname
           $DIR/ain/uid/iconname
           $DIR/misc./uid/iconname
           $DIR/machine.dom.ain/unknown/iconname
           $DIR/dom.ain/unknown/iconname
           $DIR/ain/unknown/iconname
           $DIR/misc./unknown/iconname

           This leads to a top-level directory with a _lot_ of subdirectories.
           I think this is responsible for much of faces' CPU time; it's well
           known that large directories are a UNIX performance no-no. What I
           would like to see instead (or in addition, or as an option, perhaps
           compile-time) is the following.

           $DIR/ain/dom/uid/iconname
           $DIR/ain/uid/iconname
           $DIR/misc./uid/iconname
           $DIR/ain/dom/machine/unknown/iconname
           $DIR/ain/dom/unknown/iconname
           $DIR/ain/unknown/iconname
           $DIR/misc./unknown/iconname

           The idea is that at each level, if the next component exists and is
           a directory, you descend into it and look there.

         - The code in mon.c recognises From: lines in the body of the mail.
           This is an error. From: lines should only be recognised before
           the first blank line.

         - You test if the beginning of the line is identically equal to
           "X-Face:" or "From:". This is contrary to RFC822, which specifies

            (1) that headers should be recognised in either case (so "X-Face:"
                and "X-FACE:" and "x-FaCe:" are all equivalent).
            (2) that there may be linear white space (spaces or tabs) between
                the field-name and the colon (so "FRoM  : Foo Bar <foo@bar>"
                should work).

         - The RFC822 address parsing in parsefrom.c appears, on quick
           inspection, to be grossly inadequate.  (It certainly doesn't
           handle comments in addresses, for one thing.)

v1.4 - patchlevel 8 - 13th September 1990.

       * From Mike Khaw <khaw@parcplace.com>
         From Rod Whitby <rwhitby@austek.oz.au>
         From John Pritchard <john@latcs1.lat.oz.au>
         faces v1.4.7 dumps core in make_iconname(). It's doing an strlen
         on facepath[i] when it could be NULL. This is probably caused
         when your FACEDIR directory doesn't have a misc./unknown subtree.

       * From Ian Darwin <ian@sq.com>
         The x11 driver does not set XA_WM_CLASS, so things that depend
         on CLASS to operate won't operate properly.

       * From Greg Rose <greg@softway.sw.oz.au>
         From Ken Wood <adl.austek.oz.au>
         faces with both the -MH and -a options together didn't work
         correctly.

       * The -v command line option now displays the usage message and exit.
         The new -? command line option is similar. The usage message is now
         upto date and also lists the keyboard accelerators.

       * From John Pritchard <john@latcs1.lat.oz.au>
         The file netdb.h was included twice if DNSLOOKUP is defined.

       * From Chris Maltby <chris@softway.sw.oz.au>
         The window attributes structure with the X11 driver is now zeroised
         before being used.

       * From Chris Maltby <chris@softway.sw.oz.au>
         With the X11 driver, if the icon position hasn't been specified
         with the -WP option, then the position defaults to the where the
         right end of the open window would appear.

       * From Steven M. Miller <miller@SCTC.COM>
         Under X, when faces is started up in iconic mode nothing is displayed
         in the icon until the icon is clicked on and opened and then closed
         again.

       * From Michael Schmidt <michael@uni-paderborn.de>
         Perhaps my configuration (SparcStation, SunOS4.0.3, X11R4, twm with
         ForceIcons, IconManager and IconRegion) is wierd, but... The icon is
         not placed in the IconRegion, but just at 0x0 (or 1x1, or so). Then I
         cannot deiconify the icon by a mouse click (all other icons deiconify
         on a left button click).

       * From Steven M. Miller <miller@SCTC.COM>
         faces now recognises -iconic (as well as -Wi) to specify iconic mode.
         Inverse mode is still -i. The manual page has been updated.

       * From Ian Darwin <ian@sq.com>
         faces uses -s <spoolfile> to indicate a different spool file to
         monitor. How about a -S <spooldir> to indicate a different spool
         directory? The manual page has been updated.

       * From Lindsay F. Marshall <Lindsay.Marshall%newcastle.ac.uk@munnari.oz>
         faces works incorrectly when either the -h <height> or the -w <width>
         options are given. The image area is not being cleared first.

v1.4 - patchlevel 7 - 6th August 1990.

       * From Chris Steinbroner <hesh@lll-crg.llnl.gov>
         From Bob Posert <psitech.psitech!bob@uunet.UU.NET>
         Incoming mail is not always stored in /usr/spool/mail/username.
         HP-UX and Dell Unix (Interactive 386/ix) store it in
         /usr/mail/username. Another definition (SPOOLDIR), has been added
         to the Makefile. The README file has also been updated.
 
       * From Hugues Leroy <Hugues.Leroy@irisa.fr>
         From Graham Dumpleton <grahamd@otc.otca.oz.au>
         From Peter Chubb <peterc@softway.oz.au>
         From Robert Adams <adams@trim.intel.com>
         The parsefrom() function was not replacing a '\n' at the end of
         a line with '\0' before preceding.
          
       * From Michael Schmidt <michael@uni-paderborn.de>
         The faces window now accepts two more keyboard characters:
            q - to terminate the faces program.
           ^L - to refresh the faces window.
          
       * From Michael Schmidt <michael@uni-paderborn.de>
         Added support for printer monitoring with the PLP printer
         spooling system. Another definition (PLP) has been added to
         the Makefile. The README file has been updated.
          
       * From Chris Steinbroner <hesh@lll-crg.llnl.gov>
         Diffs included to allow faces to run under HP-UX.
          
       * From Robert Adams <adams@trim.intel.com>
         Changed the SYSV definition to SYSV32 because I work with both
         System V.3.2.2 and System V.4.0 from AT&T and they need different
         defines.

       * From Robert Adams <adams@trim.intel.com>
         Added -bg and -fg to the parameter string and modified x11.c
         to set the background and foreground colors. Currently this is
         only available with the X11 graphics driver.

       * From Robert Adams <adams@trim.intel.com>
         people.tab now accepts the syntax "aliascomm/alias=comm/name"
         to map a whole name (this is one of the TODO points).
         It still accepts the old syntax. As a side effect, the
         people.tab and machine.tab routines were re-written to be
         better parsers and are now forgiving of white space.

       * From Robert Adams <adams@trim.intel.com>
         make_iconname was rewritten to get rid of the cut and paste
         code and now is a gaggle of 'for' loops.

       * From Robert Adams <adams@trim.intel.com>
         From Michael Schmidt <michael@uni-paderborn.de>
         The domain name parsing code in make_iconname was not working.
         The problem was that the 'old_style' code 'goto'ed out of the
         middle of the domain breakdown loop thus defeating same.

       * From Robert Adams <adams@trim.intel.com>
         The code for building the name for people.tab and machine.tab was
         broken if an alternate directory ("-f") was specified (changes
         in rec.c in read_alias and read_machines).

       * From Robert Adams <adams@trim.intel.com>
         If 'host' does not appear in an RFC822 address, the code would
         assume "LOCAL".  The code has been fixed to assume 'hostname'
         instead (fix to parsefrom.c).

       * From Robert Adams <adams@trim.intel.com>
         There was a strange bug that would cause icons on the end of the
         list (after entries were deleted) to get mangled.  This usually
         showed up as the NOMAIL icon not being shown but garbage being
         shown instead.  The problem was that in 'garbage_collect', there
         was a local variable 'last' that was hidding the global variable
         of the same name and thus the global was not getting updated

       * From Pat Lashley <patl@Sun.COM>
         Added code to use the Domain Name Service to attempt to convert
         unqualified hostnames, or hostnames with partial domains to fully
         qualified domain names. Another definition (DNSLOOKUP) has been
         added to the Makefile. The README file has been updated.

       * From Pat Lashley <patl@Sun.COM>
         When no icon is found for a given user, the unknown icon may be
         displayed either with the user name, or labeled as `unknown'.
         The former case provides the most information, the latter allows
         all unknown users within a given community to be lumped into a
         single image. Another definition (NAMEUNKNOWN) has been added to
         the Makefile. The README file has been updated.

       * From Pat Lashley <patl@Sun.COM>
         Support is now included for multiple face directories. Faces
         will search for the environment variable FACEPATH, and use this
         as a list of colon separated face directories. See the manual
         page for more details.

       * Official support for X-Face lines was not included with patch #2
         to mush v7.1. Dan and Bart suggested that instead, a new file
         (mush.xface.patch) should be included with the faces distribution
         which in an unofficial patch to mush v7.1.2, to allow that X-Face
         support. The README, MANIFEST and FILES files have been updated.

       * From Rod Whitby <rwhitby@austek.oz.au>
         faces v.1.4.6 dumps core when the following message (cut down to the
         smallest case) is in my mail box. This was a case of a valid X-Face:
         being followed by a line starting with the word "X-Face ". Faces now
         searches for "X-Face:" rather than "X-Face". This really needs to be
         tightened up some more.

v1.4 - patchlevel 6 - 5th July 1990.

       * From Tony Landells <ahl@technix.oz.au>
         Change all the .LP macros in the manual pages to .PP, since .PP is
         an alternative to .LP is newer versions of the manual pages, while
         it is the alternative to .P in older versions; but older versions
         don't have .LP and newer ones don't have .P.  Thus .PP seems to be
         the only universally accepted one.

       * From Pat Lashley <patl@Sun.COM>
         make_iconname() is broken with respect to multi-level domains. One
         symptom is that `unknown' will always come from misc.. The problem
         is that the for loops are nested backwards.
 
       * From Pat Lashley <patl@Sun.COM>
         Code to impliment simple NIS lookup for hosts not explicitly
         mentioned in the machines table. Note there is another definition
         at the front of the Makefile (NISLOOKUP), then should be uncommented
         to use this feature. The README file has been updated.
        
       * From Dave Glowacki <dglo@ads.com>
         From Steven M. Miller <miller@SCTC.COM>
         If the geometry has been set with -geometry you don't want to try
         and get the default. Additionally if no default is set XGetDefault
         returns NULL which crashes the faces program.
        
       * From Chris Steinbroner <hesh@lll-crg.llnl.gov>
         For system V and varients, there is no <strings.h>; it is <string.h>.
         I've added yet another definition (SYSV) to the Makefile, that
         should be uncommented, if this is the case for your machine. The
         README file has been updated.
        
       * From Chris Steinbroner <hesh@lll-crg.llnl.gov>
         Making rs2icon fails because my machine has no rasterfile.h
         include file. The #include <rasterfile.h> has been removed from
         this file, and the structure definition added to the source file.

       * From Chris Steinbroner <hesh@lll-crg.llnl.gov>
         ikon2icon in the filters directory uses index(), so you have to do
         the NOINDEX define stuff there too.

v1.4 - patchlevel 5 - 29th June 1990.

       * From John Togasaki <toga@Eng.Sun.COM>
         From John Fong <johnfong@Ebay.Sun.COM>
         The definition in the Makefile for CFACEDIR was incorrect.
         The use of CFACEDIR in main.c should be FACEDIR instead.

       * From John Togasaki <toga@Eng.Sun.COM>
         The definition for MANDIR in the main Makefile is incorrect.

       [Posted to comp.sources.misc]

v1.4 - patchlevel 4 - 26th June 1990.

       * From Pat Lashley <patl@Sun.COM>
         made several adjustments to the Makefile to get "make install" to
         work properly.

       * From Steve Piette <Steve.Piette@Central.Sun.COM>
         added a missing i from an int (nt) declaration in xview.c.

       * included a new version of the face_update script. This version
         logs an entry for each update in a logfile (var/log/facelog by
         default. The script also has support for the "old" style of the
         faces database, where the username was the ikon.

       * created a manual page for face_update (face_update.1). Updated
         MANIFEST, FILES and Makefile to reflect this change.

       * From Pat Lashley <patl@Sun.COM>
         the NeWS version has been fixed. The NeWS PostScript code has
         been converted to use cps, and a faces_cps.cps file has been generated.         The news.c C frontend, has been rewritten to use the new cps
         routines. The NeWS code has been changed to be more object oriented.

       * From Cameron Humphries <cameron@cs.flinders.oz.au>
         From Chris Maltby <chris@softway.sw.oz.au>
         From Rich McAllister <rfm@Eng>
         From Hakon Lie <howcome@Eng>
         From Darryl K. Ramm <darryl@pyrmania.oz.au>
         From Tony Landells <ahl@technix.oz.au>
         Need to include <ctype.h> in get.c

       * From Rick Gunderson <rickg@toshiba.tic.oz.au>
         On the Sun386i version under SunView, the default icons were
         scrambled because of byte ordering problems in the load_icon routine.
         The icons loaded with get_blit_ikon were okay because I defined the
         REVORDER flag in the Makefile so the image gets massaged when it is
         loaded. I fixed this by redefining the interface to load_icon (but
         only when REVORDER is defined) by adding a flag to tell load_icon if
         the image had not already been ``massaged''.

       * From Rick Gunderson <rickg@toshiba.tic.oz.au>
         From Tony Landells <ahl@technix.oz.au>
         The FACEDIR make variable is undefined for make install
         FACEDIR (for make install) clashes with FACEDIR (-D option).

       * From John Fong <johnfong@Ebay.Sun.COM>
         With each mail message, stop looking for From: lines once you've
         found one.

       * From Chris Maltby <chris@softway.sw.oz.au>
         With the default mail option, the spy (unknown) ikon should
         display the correct username.

       * When no faces database is found, the noface ikon should display
         the correct username.

       * Added support for the "old" style of face database. This is where
         the username is not a directory, but the ikon in 48x48x1 format.

       * If the spool file was non existent then the icon was blank instead
         of NOMAIL.

       * The -a option used with the -U option was supplying the facemaker
         alias with the wrong filename to update.

       * From Darryl K. Ramm <darryl@pyrmania.oz.au>
         Make install, clean etc did not work because Pyramid make does not
         predifine $(MAKE).  The declaration 'MAKE=make' fixes this.

       * From Darryl K. Ramm <darryl@pyrmania.oz.au>
         The mv commands in install should be a cp because it makes
         restarting install easier should it fall over half way through.

       * From Darryl K. Ramm <darryl@pyrmania.oz.au>
         faces/compface/compface.h: Needs #include <strings.h> on Pyramid
         not <string.h>.

       * From Darryl K. Ramm <darryl@pyrmania.oz.au>
         x11.c: Pyramid's cc warns about illegal operation on geometry.
         if (!geometry)   should be   if (geometry[0] != '\0')

       * The icon dimensions should be imagewidth and imageheight in case
         the user has given the -w and -h command line options.

       * From Chris Maltby <chris@softway.sw.oz.au>
         There is no mention in the manual about having to press DEL to
         clear the open window display with the default mail option.

       * From Tony Landells <ahl@technix.oz.au>
         The programs in the filters directory never get built. Make
         install correctly does this now.

       * In the -a -U mode, when an "on-the-fly" face was found, faces
         would attempt to send mail to update the database each time the
         spoolfile was checked. The internal record chaining was incorrect,
         and a new garbage collection routine has been written.

       * From Chris Maltby <chris@softway.sw.oz.au>
         A rewrite of the faces manual page to provide the most important
         information on the first page.

       * the X11 version now correctly displays on the icon.

       * From Chris Maltby <chris@softway.sw.oz.au>
         Some machines don't automatically define popen() to return a
         FILE *.

       * the X11 version no longer puts out the ICCCM protocol error message
         when it's deleted.

v1.4 - patchlevel 3 - 21st June 1990.

       version made available internally via anon ftp and the mail server.
       also made available via fetchfile in Australia for beta testing.

v1.4 - patchlevel 2 - 20th June 1990.

       copy sent to various people for internal testing.

v1.4 - patchlevel 1 - 19th June 1990.

       copy sent to James Ashton for uncompression enhancements.

v1.4 - patchlevel 0. - started 7th June 1990.

       released to volunteers for various enhancements.
