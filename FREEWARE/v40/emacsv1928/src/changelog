Sun Oct 23 16:25:48 1994  Richard Stallman  <rms@mole.gnu.ai.mit.edu>

	* Version 19.28 released.

	* s/linux.h (LD_SWITCH_SYSTEM): Definition deleted.

	* s/freebsd.h (LD_SWITCH_SYSTEM): New definition.

	* s/freebsd.h (BSD): Have two definitions according to version number.

	* s/freebsd.h (DECLARE_GETPWUID_WITH_UID_T): Defined.
	[NO_SHARED_LIBS and __FreeBSD__]:
	(LD_SWITCH_SYSTEM, A_TEXT_OFFSET, A_TEXT_SEEK): Alternate definitions.

	* xfns.c (x_real_positions): Catch errors and retry if error happens.

	* textprop.c (Fset_text_properties): Special case for getting
	rid of all properties of a string.

	* xterm.c (x_new_font): Don't use the FONT property
	unless it has enough dashes to be an official font name.

	* keyboard.c (read_char): Add local variable key_already_recorded.
	If an event comes from read_char_minibuf_menu_prompt,
	return as early as we safely can.

	* textprop.c (Fset_text_properties): Don't let validate_interval_range
	increment START and END twice.

	* xfaces.c (Fset_face_attribute_internal): Mark frame garbaged whenever
	any face's font or color is changed.

	* m/hp9000s300.h [not BSD4_3] [__GNUC__] (HAVE_ALLOCA): Defined.

	* m/dpx2.h (POSIX_SIGNALS): Define it.
	(sigsetmask): Add #undef.

	* s/linux.h: Don't include signal.h, values.h.
	(signal): Definition deleted.

	* s/sco4.h (POSIX_SIGNALS): Defined.

	* config.h.in (HAVE_X11R6): Add #undef.
	* s/sol2.h (REL_ALLOC): Test HAVE_X11 and HAVE_X11R6.
	Don't test USE_X_TOOLKIT.

	* emacs.c (shut_down_emacs): Don't call Fx_close_current_connection.

	* s/hpux9.h (HAVE_TERMIO, HAVE_TERMIOS, NO_TERMIO): Undo Jul 28 change.

	* unexsunos4.c [SUNOS4]: Include link.h.
	(unexec) [SUNOS4]: Turn off relocations that ld.so did.

	* s/sunos4-0.h (SUNOS4): Defined.

	* unexec.c (make_hdr): Undo June 16 change.

	* s/bsd386.h (__bsdi__): Define, unless already defined.
	(DECLARE_GETPWUID_WITH_UID_T): Define.

	* filelock.c (getpwuid): Test just DECLARE_GETPWUID_WITH_UID_T,
	not __bsdi__.
	* xrdb.c (getpwuid, getpwnam): Test just DECLARE_GETPWUID_WITH_UID_T,
	not __bsdi__.

Sun Sep 11 14:56:01 1994  Richard Stallman  <rms@mole.gnu.ai.mit.edu>

	* Version 19.27 released.

Sat Sep 10 01:10:04 1994  Richard Stallman  <rms@mole.gnu.ai.mit.edu>

	* keymap.c (syms_of_keymap): Doc fix.

	* keyboard.c (gobble_input): Block SIGALRM if we are using it.

	* gmalloc.c: Bug fix affecting __ptrdiff_t in non-ANSI case.

Wed Sep  7 03:54:08 1994  Richard Stallman  <rms@mole.gnu.ai.mit.edu>

	* Version 19.26 released.

Thu Sep  8 15:13:32 1994  Richard Stallman  <rms@mole.gnu.ai.mit.edu>

	* keyboard.c (record_asynch_buffer_change): Don't test
	Fwaiting_for_user_input_p if no subprocesses.

Mon Sep  5 21:33:48 1994  Richard Stallman  <rms@mole.gnu.ai.mit.edu>

	* s/sol2.h [USE_X_TOOLKIT && HAVE_X11XTR6] (REL_ALLOC): Undefine it.

Sun Sep  4 23:20:51 1994  Richard Stallman  <rms@mole.gnu.ai.mit.edu>

	* emacs.c (init_cmdargs): After chasing link, use only the
	expanded name.

Sun Sep  4 20:12:07 1994  Karl Heuer  <kwzh@hal.gnu.ai.mit.edu>

	* fileio.c (Ffile_accessible_directory_p): Put back the gcpro.

	* sysdep.c (srandom): Pass arg to srand48; no return value.

Sun Sep  4 00:35:24 1994  Richard Stallman  <rms@mole.gnu.ai.mit.edu>

	* emacs.c (init_cmdargs): When setting dir, expand the dir name.

	* sysdep.c (random, srandom): Check HAVE_LRAND48, not HAVE_RAND48.
	Call lrand48, nor rand48.

	* config.h.in (HAVE_LRAND48): Replaces HAVE_RAND48.

Sat Sep  3 14:44:42 1994  Kaveh R. Ghazi  (ghazi@noc.rutgers.edu)

	* m/delta88k.h [__GNUC__] (HAVE_ALLOCA): Defined.
	[__GNUC__] (C_ALLOCA): Add #undef
	(LIB_X11_LIB): Add #undef.
	(HAVE_TERMIOS): Defined.
	(HAVE_TERMIO): Add #undef.
	(NO_TERMIO): Defined.
	(sigsetmask): Add #undef.
	(USE_GETOBAUD): Defined.

Sat Sep  3 00:33:58 1994  Richard Stallman  <rms@mole.gnu.ai.mit.edu>

	* sysdep.c (init_baud_rate): Test that getobaud is actually defined.

	* sysdep.c (init_baud_rate) [USE_GETOBAUD]: Use getobaud.

Fri Sep  2 17:57:36 1994  Richard Stallman  <rms@mole.gnu.ai.mit.edu>

	* insdel.c (prepare_to_modify_buffer): Don't call
	verify_overlay_modification if no overlays or
	verify_interval_modification no intervals.

	* textprop.c (Fset_text_properties):
	Return early if buffer has no intervals and PROPS is nil.

Fri Sep  2 03:01:48 1994  Lennart Staflin  (lenst@rudolf)

	* xdisp.c (display_text_line): Don't overrun the charstart area.

Fri Sep  2 01:31:58 1994  Richard Stallman  <rms@mole.gnu.ai.mit.edu>

	* insdel.c (insert_1): Don't call interval fns if buffer has none.

	* textprop.c (Fset_text_properties): Don't create or split an interval
	if we trivially do not need to change anything.

Wed Aug 31 16:39:57 1994  Richard Stallman  <rms@mole.gnu.ai.mit.edu>

	* xfns.c (defined_color): New arg ALLOC--optionally don't allocate
	the color.
	(x_decode_color, Fx_color_defined_p): Pass new arg.
	(Fx_color_values): New function.

Tue Aug 30 04:24:59 1994  Richard Stallman  <rms@mole.gnu.ai.mit.edu>

	* frame.c (Fdelete_frame): Fix previous change.

Tue Aug 30 11:11:59 1994  enami tsugutomo  <enami@sys.ptg.sony.co.jp>

	* fileio.c (Fwrite_region): unbind_to should take two args.

Tue Aug 30 00:21:51 1994  Richard Stallman  <rms@mole.gnu.ai.mit.edu>

	* fileio.c (Ffile_accessible_directory_p): No need for gcpro.

	* keyboard.c (input_polling_used): New function.
	* xterm.c (x_make_frame_visible): Call input_polling_used.

Sun Aug 28 01:53:01 1994  Richard Stallman  <rms@mole.gnu.ai.mit.edu>

	* frame.c (Fdelete_frame): Free the frame's glyphs arrays.
	Free the line insert/delete cost vectors.

	* dispnew.c (free_frame_glyphs): No longer static.

	* m/next.h (HAVE_MACH_MACH_H): Defined.

	* editfns.c (Finsert_and_inherit_before_markers):
	Use insert_before_markers_and_inherit for character args.
	(Finsert_and_inherit): Use insert_and_inherit for character args.

	* insdel.c (insert_before_markers_and_inherit): New function.

	* cmds.c (internal_self_insert): Use insert_and_inherit.

Sat Aug 27 18:45:24 1994  Richard Stallman  <rms@mole.gnu.ai.mit.edu>

	* indent.c (Findent_to): Pass new arg to Finsert_char.

	* editfns.c (Finsert_char): New arg INHERIT.
	Use insert_and_inherit if requested.

	* insdel.c (insert_1): New arg INHERIT.
	(insert_and_inherit): New function.

Fri Aug 26 17:19:52 1994  Richard Stallman  <rms@mole.gnu.ai.mit.edu>

	* keyboard.c (polling_for_input): Define var unconditionally.
	* keyboard.h (polling_for_input): Declared.
	* xterm.c: Include keyboard.h.
	(x_make_frame_visible): Fix previous change: test polling_for_input
	instead of whether SIGIO is defined.
	* Makefile.in.in (xterm.o): Depend on keyboard.h.

Fri Aug 26 16:35:06 1994  Kevin Rodgers <kevinr@ihs.com>

	* xfns.c (Fx_color_defined_p): Return list of RGB values, not just t.

Fri Aug 26 01:17:17 1994  Karl Heuer  <kwzh@hal.gnu.ai.mit.edu>

	* xterm.c (x_make_frame_visible): Call signal handler directly.

Thu Aug 25 18:18:50 1994  Richard Stallman  <rms@mole.gnu.ai.mit.edu>

	* s/linux.h: Add LINUX_QMAGIC conditional.

	* m/alliant-2800.h (USE_NONANSI_DEFUN): Defined.

	* lisp.h (DEFUN): Check USE_NONANSI_DEFUN.

	* Makefile.in.in (obj): Put cm.o before term.o.
	(Avoids mysterious lossage on Irix.)

	* xmenu.c (xmenu_show): Don't queue events that are in the menu bar.

Wed Aug 24 15:40:04 1994  Richard Stallman  <rms@mole.gnu.ai.mit.edu>

	* xmenu.c (xmenu_show): Do nothing special for ButtonPress in the menu.
	Call XtDispatchEvent for all ButtonRelease events.
	xlwmenu.c now deals with posting the menu.
	Check for events in subwidgets of the menu
	when deciding whether to queue them for later handling.

	* unexelfsgi.c (unexec): Copy previous change in unexelf.c.

	* s/irix5-0.h [__GNUC__] (LD_SWITCH_SYSTEM): Defined.

Wed Aug 24 17:40:38 1994  Simon Leinen  <simon@lia.di.epfl.ch>

	* term.c (term_init): Added missing argument to tgetstr.
	(tgetstr): Move declarations to top level.

Wed Aug 24 02:26:54 1994  Karl Heuer  <kwzh@hal.gnu.ai.mit.edu>

	* xterm.c (x_make_frame_visible): Raise a signal to cause the
	pending X I/O to be read.

Wed Aug 24 01:16:45 1994  Richard Stallman  <rms@mole.gnu.ai.mit.edu>

	* xdisp.c (display_scan_buffer): New function.
	(display_count_lines): Use that.

	* intervals.c (textget): Ignore category prop if not a symbol.

Tue Aug 23 22:04:05 1994  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* s/gnu.h: New file.

Tue Aug 23 18:56:19 1994  Karl Heuer  <kwzh@hal.gnu.ai.mit.edu>

	* indent.c (pos_tab_offset): Don't trigger point-motion hooks.

	* buffer.c (Frename_buffer): Fix gcpro problems.
	* fileio.c (Fmake_symbolic_link, Ffile_accessible_directory_p,
	Finsert_file_contents, auto_save_error, Fwrite_region): Likewise.
	(Fcopy_file, build_annotations, Fdo_auto_save): Delete unused
	 variables.

Tue Aug 23 03:04:51 1994  Richard Stallman  <rms@mole.gnu.ai.mit.edu>

	* fileio.c (O_RDONLY): Defined.
	(Finsert_file_contents, Fcopy_file): use it.
	(barf_or_query_if_file_exists, Ffile_exists_p): Use stat, not access.
	(Ffile_readable_p): Use open, not access.

	* lread.c (O_RDONLY): Defined.
	(openp): Use it.

	* unexelf.c (unexec): Don't alter the info field
	of SHT_SYMTAB and SHT_DYNSYM sections.

	* xdisp.c (redisplay_window): Don't access text before BEGV.

	* keyboard.c (read_char): After read_char_minibuf_menu_prompt,
	don't just return; jump to non_reread.

	* fileio.c (Fmake_directory_internal): Pass just 2 args to handler.

Tue Aug 23 00:46:27 1994  Karl Heuer  <kwzh@hal.gnu.ai.mit.edu>

	* frame.c (Fmake_frame_invisible, Ficonify_frame): Don't switch frames.

Mon Aug 22 19:17:08 1994  Karl Heuer  <kwzh@hal.gnu.ai.mit.edu>

	* search.c (Fstring_match): Fix sign error.

	* m/ibmrs6000.h (LD_SWITCH_MACHINE): Use full path to ibmrs6000.inp.

Sun Aug 21 14:03:32 1994  Richard Stallman  <rms@mole.gnu.ai.mit.edu>

	* m/ibmrs6000.h (LD_SWITCH_MACHINE): Supply m/ibmrs6000.inp as input.

	* m/ibmrs6000.inp: New file.

Fri Aug 19 20:47:38 1994  Hiroshi NAKANO  <nakano@whale.math.ryukoku.ac.jp>

	* unexelf.c: Eliminate local var bss_end.
	Update the symbol values of _edata and _end.

Fri Aug 19 01:37:54 1994  Richard Stallman  <rms@mole.gnu.ai.mit.edu>

	* process.c (wait_reading_process_input):
	Clear waiting_for_user_input_p before returning.

	* xterm.c (x_make_frame_visible): Quit if requested, in loop at end.

Wed Aug 17 22:07:20 1994  Richard Stallman  <rms@mole.gnu.ai.mit.edu>

	* keyboard.c (read_char): Don't show buffer-events to the user.
	Handle chars over 255 in dribble files.

Wed Aug 17 17:43:22 1994  Karl Heuer  <kwzh@hal.gnu.ai.mit.edu>

	* callproc.c (Fcall_process_region): gcpro filename_string.

Wed Aug 17 16:05:56 1994  Richard Stallman  <rms@mole.gnu.ai.mit.edu>

	* doc.c (store_function_docstring): Do nothing for bytecode object
	which has no slot for doc string.

Tue Aug 16 19:51:36 1994  Richard Stallman  <rms@mole.gnu.ai.mit.edu>

	* buffer.c (list_buffers_1): Update header line layout.

Sat Aug 13 19:11:21 1994  Richard Stallman  <rms@mole.gnu.ai.mit.edu>

	* s/sol2-4.h (pid_t): New definition.
	(vfork): Definition deleted.

	* xmenu.c (xmenu_show): Unconditionally update x_mouse_grabbed
	and Vmouse_depressed.

	* window.c (window_loop, case UNSHOW_BUFFER):
	When we delete a frame, skip all the windows on that frame.

Fri Aug 12 19:11:43 1994  Karl Heuer  <kwzh@hal.gnu.ai.mit.edu>

	* s/isc4-0.h (NEED_SIOCTL): moved to isc-3.0.h.
	* s/isc3-0.h (NEED_SIOCTL): moved from isc-4.0.h, and disabled
	BROKEN_TIOCGWINSZ since it works fine when you use <sioctl.h>.
	(C_SWITCH_SYSTEM): Add -D_SYSV3 to ensure availability of
	traditional non-standard functions.
	(memmove): Delete this macro; it screws up <string.h> if you
	use the native cc.  (Emacs already does the right thing anyway.)

Fri Aug 12 01:22:45 1994  Richard Stallman  <rms@mole.gnu.ai.mit.edu>

	* indent.c (compute_motion): Use WIN's frame, not selected one.

	* xterm.c (x_new_font): Don't set filename = full_name if that's null.

Thu Aug 11 15:45:00 1994  Richard Stallman  <rms@mole.gnu.ai.mit.edu>

	* Makefile.in.in (FRAME_SUPPORT): Add faces.elc.

	* search.c (Freplace_match): Treat caseless initial like a
        lowercase initial.

	* keymap.c (Fdefine_key): Fix error message.
	(Fsingle_key_description): Likewise.

Wed Aug 10 16:28:47 1994  Richard Stallman  <rms@mole.gnu.ai.mit.edu>

	* s/sol2-3.h (POSIX_SIGNALS): Define it.
	(PTY_TTY_NAME_SPRINTF): New overriding definition.
	(sigsetmask): Add #undefs.

	* s/sol2-4.h (POSIX_SIGNALS, PTY_TTY_NAME_SPRINTF, sigsetmask):
	Delete those things (moved to sol2-3.h).

	* s/sol2-4.h (HAVE_VFORK): Deleted.
	(vfork): Define as emacs_vfork.

	* window.c (Fwindow_end): Undo previous change.

Tue Aug  9 13:39:31 1994  Richard Stallman  <rms@mole.gnu.ai.mit.edu>

	* keyboard.c (record_asynch_buffer_change): Do nothing
	except when waiting_for_user_input_p.

	* m/i860.h [USG5_4] (SVR4): Defined.

	* xdisp.c (display_text_line):
	Make previous change #ifdef HAVE_X_WINDOWS.

Mon Aug  8 05:03:18 1994  Richard Stallman  <rms@mole.gnu.ai.mit.edu>

	* puresize.h [MULTI_FRAME] (PURESIZE): Increased.

	* window.c (Fwindow_end): If window_end_valid is nil, return nil.

	* window.c (Fpos_visible_in_window_p): Do something reasonable
	if w->start is outside the buffer bounds.

Sun Aug  7 02:40:34 1994  Richard Stallman  <rms@mole.gnu.ai.mit.edu>

	* s/sol2-4.h (PTY_TTY_NAME_SPRINTF): New definition.
	(sigsetmask): Add #undef.

	* keymap.c (Faccessible_keymaps): Fix previous change.

Sat Aug  6 20:58:03 1994  Richard Stallman  <rms@mole.gnu.ai.mit.edu>

	* xdisp.c (display_text_line): Use the face properties
	of the overlay arrow, if any.

	* xfaces.c (compute_glyph_face_1): New function.

	* m/intel386.h (LIBS_MACHINE): If SOLARIS2_4, don't define this. 
	* s/sol2-4.h (SOLARIS2_4): Defined.

Fri Aug  5 23:06:16 1994  Richard Stallman  <rms@mole.gnu.ai.mit.edu>

	* keymap.c (Fuse_global_map, Fuse_local_map):
	Call record_asynch_buffer_change.

	* xterm.c (XTread_socket):
	Don't test X_IO_BUG; make that code unconditional.
	(x_noop_count, x_term_init): Likewise.

Thu Aug  4 17:00:11 1994  Richard Stallman  <rms@mole.gnu.ai.mit.edu>

	* data.c (Fdefine_function, Fdefalias): Handle advice as in Ffset.
	(Qad_advice_info): Lisp and C names renamed from Qadvice_info.
	(Qad_activate): C name renamed from Qactivate_advice.

	* fileio.c (Fread_file_name_internal): Call double_dollars
	when `changed' is set.

Wed Aug  3 21:53:58 PDT 1994  Caveh Jalali  (caveh@eng.sun.com)

	* m/intel386.h [SOLARIS2] (VALBITS, GCTYPEBITS): New definitions.

	* s/sol2-4.h: New file.

Wed Aug  3 00:38:43 1994  Richard Stallman  <rms@mole.gnu.ai.mit.edu>

	* buffer.c (list_buffers_1): Add one column to size column.

	* xterm.c (x_make_frame_visible): Start one_in_four at 1.

	* window.c (Fwindow_end): Doc fix.

	* xterm.c (construct_mouse_click, construct_menu_click):
	Don't update x_mouse_grabbed, Vmouse_depressed, last_mouse_frame here.
	(XTread_socket): Update them here, so we do it without fail.
	(XTmouse_position, XTread_socket case MotionNotify):
	Check last_mouse_frame is nonzero before using it.

	* Makefile.in.in (alloca.o): Use -f in all rm's.

Tue Aug  2 18:08:18 1994  Richard Stallman  <rms@mole.gnu.ai.mit.edu>

	* keymap.c (Faccessible_keymaps): Use PREFIX to set loop starting
	point; don't even consider maps except those reached via prefix.

	* keyboard.c (make_lispy_event): If the position is not in a window,
	at least pass along the frame it is in.

Mon Aug  1 18:28:32 1994  Roland McGrath  <roland@churchy.gnu.ai.mit.edu>

	* data.c (Ffset): Don't call Fget unless SYM's plist is consp.

Mon Aug  1 14:58:58 1994  Richard Stallman  <rms@mole.gnu.ai.mit.edu>

	* eval.c (Fprog2): Doc fix.

	* window.c (Fmove_to_window_line): Doc fix.

Mon Aug  1 11:10:40 1994  Frederic Pierresteguy  (F.Pierresteguy@frcl.bull.fr)

	* xmenu.c (xmenu_show): Ignore any geometry resource from the user.

Sun Jul 31 02:37:25 1994  Richard Stallman  <rms@mole.gnu.ai.mit.edu>

	* xfns.c (Fx_get_resource): Doc fix.

	* data.c (syms_of_data): Set up Qadvice_info, Qactivate_advice.
	(Ffset): Activate advice if symbol has advice-info property.

	* xdisp.c (redisplay_window): Avoid using SET_PT to change point
	temporarily.

	* dispnew.c (sit_for): Undo previous change.

Sat Jul 30 14:26:59 1994  enami tsugutomo  <enami@sys.ptg.sony.co.jp>

	* dispnew.c (direct_output_for_insert): Pass missing 8th
	argument to compute_char_face.

Sat Jul 30 16:36:38 1994  Richard Stallman  <rms@mole.gnu.ai.mit.edu>

	* keyboard.c (follow_key): Don't downcase letters here.
	Delete arg `case_converted'.
	(read_key_sequence): Do it here; but not if in middle of fcn key.

	* fns.c (Frandom): Handle LIMIT >= 40000000.

	* xdisp.c (decode_mode_spec): Handle %&.

Fri Jul 29 21:21:09 1994  Richard Stallman  <rms@mole.gnu.ai.mit.edu>

	* process.c (create_process): Set default handling for SIGINT, etc.

Thu Jul 28 08:46:00 1994  Richard Stallman  <rms@mole.gnu.ai.mit.edu>

	* process.c (wait_reading_process_input): Fix previous change.

	* s/hpux9.h (HAVE_TERMIOS, NO_TERMIO): Defined.
	(HAVE_TERMIO): Add #undef.

	* sysdep.c (random): Use rand differently, and distinguish BSD/USG.

	* fns.c (Frandom): Fix previous change.

Wed Jul 27 13:29:53 1994  Richard Stallman  <rms@mole.gnu.ai.mit.edu>

	* syssignal.h [POSIX_SIGNALS] (signal): New definition.

	* config.h.in (HAVE_RAND48): Add #undef.

Tue Jul 26 11:25:58 1994  Richard Stallman  <rms@mole.gnu.ai.mit.edu>

	* xterm.c (x_queue_event, x_unqueue_events): New functions.
	(x_start_queuing_selection_requests): New function.
	(x_stop_queuing_selection_requests): New function.
	(XTread_socket): Queue up SelectionRequest events sometimes.
	* xselect.c (x_get_foreign_selection): Use the new feature
	to queue up SelectionRequest events.

	* process.c (wait_reading_process_input): If wait_for_cell,
	do check for keyboard input and handle it.

	* fns.c (Frandom): Use just the low 30 bits of random's value.

	* sysdep.c (random, srandom): Obey HAVE_RAND48 flag.
	Test that random is not a macro.  Don't test USG or BSD4_1.

	* m/tek4300.h (tek4300): Don't define if already defined.

Mon Jul 25 14:39:34 1994  Richard Stallman  <rms@mole.gnu.ai.mit.edu>

	* m/tek4300.h (BSD_PGRPS): Defined.

	* puresize.h (PURESIZE): Increase non-MULTI_FRAME value.

	* editfns.c (get_system_name): Add a cast.

	* config.h.in: Add #undef HAVE_H_ERRNO.
	* process.c, sysdep.c [!HAVE_H_ERRNO]: Declare h_errno.
	* sysdep.c (init_system_name): Set h_errno to 0 initially.
	* process.c (Fopen_network_stream): Set h_errno to 0 initially.

	* window.c (Fdisplay_buffer): Add MULTI_FRAME cond in last change.

	* Makefile.in.in: Add #undef alloca.

Sat Jul 23 21:20:05 1994  Richard Stallman  <rms@mole.gnu.ai.mit.edu>

	* minibuf.c (Fdisplay_completion_list): gcpro `completions'.

	* print.c (internal_with_output_to_temp_buffer): gcpro things.

	* puresize.h (PURESIZE): Incremented to 252000.

Sat Jul 23 12:26:36 1994  Jim Blandy  (jimb@totoro.bio.indiana.edu)

        * .gdbinit: Set the breakpoint in x_error_quitter instead of
        _XPrintDefaultError.

Wed Jul 20 00:56:24 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* window.c (Fnext_window, Fprevious_window): Don't get stuck in a loop
	in the minibuffer frame.

	* dispnew.c (direct_output_for_insert): Dpn't call compute_char_face
	for a non-X frame.

	* s/usg5-4.h: Move #undef static before the includes.

	* xrdb.c [USG5] (SYSV): Don't define if already defined.

	* fileio.c (Fwrite_region): Do unwind the new unwind protect.

Tue Jul 19 12:05:00 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* xterm.c (struct font_info): New field full_name.
	(x_new_font): Record, and return, the full name of the font.

	* widget.c (EmacsFrameSetCharSize): Delete the code to make rows at
	least 3.

	* fileio.c (Vwrite_region_annotations_so_far): New variable.
	(syms_of_fileio): Set up Lisp var.
	(build_annotations): Handle annotate functions that switch buffers.
	Set Vwrite_region_annotations_so_far.
	(Fwrite_region): Handle change of buffer in build_annotations.
	Add an unwind protect to restore original buffer and kill the temp.

	* sysdep.c (init_system_name): Retry gethostbyname after TRY_AGAIN
        failure.

	* process.c (Fopen_network_stream):
	Retry gethostbyname after TRY_AGAIN failure.

	* s/isc4-0.h [__GNUC__] (LIBX11_SYSTEM): Add -lcposix.

	* s/usg5-4.h (PTY_TTY_NAME_SPRINTF): Fail smoothly if cannot get pty.

	* sysdep.c (sys_subshell): Expand ~ in dir.
	Do the processing of dir before calling fork.
	Use vfork.

Mon Jul 18 02:09:30 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* xterm.c (note_mouse_movement): Use proper data type for window
	args to XQueryPointer.
	(x_scroll_bar_note_movement): Likewise.

	* keyboard.c (Vdeferred_action_list, Vdeferred_action_function):
	New variables.
	(command_loop_1): Handle them.
	(syms_of_keyboard): Set up Lisp variables.

	* s/linux.h [emacs]: Include stdio.h.

	* commands.h (unread_command_char): Declared.
	* dispnew.c (sit_for): Return immediately if unread events exist.

Sun Jul 17 19:52:42 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* textprop.c (Fget_text_property): Simplify using Ftext_properties_at.

Sun Jul 17 02:41:19 1994  Richard Stallman  <rms@mole.gnu.ai.mit.edu>

	* xfns.c (Fx_create_frame): Use 140 as default font size.

	* xmenu.c [USE_X_TOOLKIT] (xmenu_show): Handle UnmapNotify events.

Sat Jul 16 14:31:34 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* window.c (Fdisplay_buffer): Cope with unsplittable frames
	and dedicated windows.

	* frame.c [!MULTI_FRAME] (Fframe_first_window): Defined.
	(syms_of_frame): Defvar it.

Thu Jul 14 19:56:33 1994  Morten Welinder  (terra@diku.dk)

	* s/msdos.h (HAVE_VOLATILE): Define.

Thu Jul 14 00:59:50 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* keyboard.c (safe_run_hooks): Use local var to restore hook's value.

Wed Jul 13 20:55:47 1994  Morten Welinder  (terra@diku.dk)

	* keyboard.c (kbd_buffer_get_event) [HAVE_MOUSE]: Include code
	to check for mouse dragging.
	(make_lispy_movement) [HAVE_MOUSE]: Define also in this case,
	but only include the non-multiframe stuff.

	* msdos.c (mouse_init1): Use alternate mouse detection for old
	mouse drivers.
	(mouse_get_pos): Downscale coordinates by 8.

Wed Jul 13 00:11:17 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* window.c (Fselect_window): Fix bug checking new_point is in range.

	* fileio.c (syms_of_fileio): Finish previous change.

	* keyboard.c (command_loop_1): Do direct output for cursor motion
	over text chars when disp tab exists but says nothing for them.

	* frame.h (FRAME_EXTERNAL_MENU_BAR) [!USE_X_TOOLKIT]: Give zero.

	* xdisp.c [!HAVE_X_WINDOWS] (compute_char_face, compute_glyph_face):
	Add simple alternate definitions for non-X case.

Tue Jul 12 15:09:25 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* process.c (Qlast_nonmenu_event): New variable.
	(syms_of_process): Set it up.
	(read_process_output, exec_sentinel): Bind it to t around filter.

	* fileio.c (Fmake_directory_internal): Use Qmake_directory_internal.
	(syms_of_fileio): Set up Qmake_directory_internal, not Qmake_directory.

	* frame.c [MULTI_FRAME] (Fframe_parameters): For non-X frames,
	fill in menu-bar-lines value.

Mon Jul 11 20:46:53 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* xmenu.c (xmenu_show): Don't call XtUngrabPointer here.

	* Makefile.in.in (ctagsfiles): Rewrite to avoid compiler bug.

Sun Jul 10 20:37:09 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* window.c (Fdisplay_buffer): Add MULTI_FRAME conditional
	in previous change.

Sun Jul 10 19:11:24 1994  Morten Welinder  (terra@diku.dk)

	* m/intel386.h [MSDOS] (NO_REMAP): Defined.
	* s/msdos.h (HAVE_MOUSE, PURESIZE): Definitions moved here.
	* m/dos386.h: File obsolete and deleted.

	* msdos.c (dos_rawgetc): Use bios, not kbhit ().

Sat Jul  9 14:20:11 1994  Morten Welinder  (terra@diku.dk)

	* fileio.c (Ffile_name_directory, Ffile_name_nondirectory,
	file_name_as_directory, directory_file_name, Fexpand_file_name,
	Ffile_name_absolute_p, Fsubstitute_in_file_name) [MSDOS]:
	Allow backslashed file names.

Sat Jul  9 00:43:51 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* puresize.h (PURESIZE) [MULTI_FRAME]: Increased to 250000.

	* lread.c (readevalloop): Correctly unbind the unwind protect.

Fri Jul  8 16:24:59 1994  Morten Welinder  (terra@diku.dk)

	* msdos.c (do_visible_bell): Clean-up using GNU assembly extension.

Thu Jul  7 00:52:10 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* m/sparc.h (BIG_ENDIAN): Don't redefine if defined.

	* Makefile.in.in (alloca.o): Delete allocatem.c first thing.

	* xmenu.c (xmenu_show) {USE_X_TOOLKIT}: ButtonPress no longer pops
	down; instead it forces the next ButtonRelease to exit.  Don't
	dispatch on ButtonPress events.

	* xfns.c (syms_of_xfns): Provide x-toolkit in toolkit version.
	Undo previous change.
	(x_toolkit): Variable deleted.

	* xfns.c (x_toolkit): New variable.
	(syms_of_xfns): Set up Lisp var x-toolkit.

	* window.c (Fnext_window, Fprevious_window): ALL_FRAMES = 0 means
	try both visible frames and iconified frames.
	(window_loop): Likewise, for FRAMES = 0.
	(Fget_buffer_window): Likewise, for FRAME = 0.
	(Fdisplay_buffer): Pass 0 to Fget_buffer_window;
	if the frame is iconified, make it visible.

	* frame.c (next_frame, prev_frame):
	MINIBUF = 0 means try visible frames and iconified frames.

Wed Jul  6 15:30:48 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* xmenu.c (xmenu_show) [USE_X_TOOLKIT]: Keyboard input exits the menu.
	ButtonRelease does so if within Vdouble_click_time.
	Ignore mouse motion if button was already released.
	(menu_item_selection): Declare volatile, if __STDC__.

	* keyboard.c (make_lispy_event): Ignore menu bar up events.

Tue Jul  5 02:18:22 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* doprnt.c (doprnt): Handle padding on %c.

	* frame.c (next_frame, prev_frame): Change which frames to use
	when MINIBUF is a window.
	(Fnext_frame, Fprevious_frame): Doc fixes.

	* window.c: Doc fixes.

Mon Jul  4 23:54:05 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* xterm.c (XTread_socket, construct_menu_click) [USE_X_TOOLKIT]:
	Update x_mouse_grabbed and Vmouse_depressed.

Sat Jul  2 00:23:23 1994  Richard Stallman  (rms@gnu.ai.mit.edu)

	* xdisp.c (decode_mode_spec): %+ makes % for unmodified RO buffer.

	* buffer.c (syms_of_buffer): Doc fix.

	* xfaces.c (get_cached_face): Set the cached_index field.

Fri Jul  1 11:34:08 1994  Richard Stallman  (rms@gnu.ai.mit.edu)

	* sysdep.c (init_sys_modes): Turn off VSTART and VSTOP chars.
	On DGUX, turn off INPCK.

Fri Jul  1 03:13:06 1994  Paul Reilly  (pmr@churchy.gnu.ai.mit.edu)

	* xfns.c (Fx_create_frame): Add GC protection for frame being made.

Thu Jun 30 00:27:11 1994  Richard Stallman  (rms@gnu.ai.mit.edu)

	* xterm.c (x_make_frame_visible): In x_sync loop at the end,
	every fourth time, sleep for 1/4 second.

	* xselect.c (x_own_selection, x_get_foreign_selection):
	Get rid of spurious X_TOOLKIT conditional.

	* frame.c (Fdelete_frame): Call x_clear_frame_selections.

	* xselect.c (x_own_selection): Put the frame in Vselection_alist.
	(x_clear_frame_selections): New function.

	* xterm.c (x_draw_box): Use curs_x and curs_y, not f->cursor_[xy].

	* xfns.c (XLIB_ILLEGAL_ACCESS): Defined.

Wed Jun 29 14:57:27 1994  Richard Stallman  (rms@gnu.ai.mit.edu)

	* s/hpux.h (random, srandom): Defined.

	* cmds.c (internal_self_insert): Now can return 2.
	* keyboard.c (command_loop_1): Don't clear nonundocount
	when internal_self_insert returns 1.

Tue Jun 28 18:21:08 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* xfns.c (x_set_frame_parameters): Call x_set_offset directly.
	Handle `-' for position parameters.

Tue Jun 28 17:50:22 1994  Karl Heuer  (kwzh@hal.gnu.ai.mit.edu)

	* lread.c (readchar): Restart interrupted I/O.

Tue Jun 28 15:00:45 1994  Roland McGrath  (roland@churchy.gnu.ai.mit.edu)

	* fileio.c (a_write): Loop while *ANNOT is listp, not consp.
	Previous code omitted all data from output files when *ANNOT was
	nil.

Tue Jun 28 05:25:06 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* xfns.c (x_set_name): If no change needed, avoid consing.

	* xdisp.c (prepare_menu_bars): Call x_consider_frame_title
	only if windows_or_buffers_changed.

	* keyboard.c (safe_run_hooks): Take symbol as arg.
	Use Fsymbol_value and Fset.
	(command_loop_1): Pass symbol to safe_run_hooks.
	Look in the value cell to check for trivial case (no hooks).

	* xdisp.c (redisplay_region): For special treatment, BUF most be
	both current and displayed in selected window.

	* buffer.c (Foverlay_put): Pass redisplay_region a struct buffer *.

Mon Jun 27 16:43:46 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* fileio.c (a_write): Verify that *annot is a cons.

Sun Jun 26 12:28:23 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* keyboard.c (echo_dash): Fix backwards conditional.
	(read_key_sequence): Don't echo if echo_keystrokes is 0.

	* m/news-risc.h (C_DEBUG_SWITCH) [not NEWSOS5]:
	Don't define if __GNUC__.
	(KERNEL_FILE) [not NEWSOS5]: New override definition.

Sat Jun 25 12:28:24 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* process.c (send_process): Major rewrite.
	Don't put in a C-d unless a single line is too long.
	Read process input whenever output gets stuck.
	Relocate BUF if we read input.  New arg OBJECT.
	(Fprocess_send_region, Fprocess_send_string, process_send_signal)
	(Fprocess_send_eof): Pass new arg OBJECT.

	* buffer.h (BUF_PTR_CHAR_POS): New macro.

	* window.c (Fsave_window_excursion): Doc fix.

	* s/hpux9.h (C_SWITCH_SYSTEM): Add -D_BSD.

	* frame.c (Fframe_parameters): Don't handle menu-bar-lines explicitly.

	* window.c (Fother_window_for_scrolling): New function.
	(Fscroll_other_window): Use that.
	(syms_of_window): defsubr it.

Fri Jun 24 20:13:01 1994  Karl Heuer  (kwzh@nutrimat.gnu.ai.mit.edu)

	* fileio.c (Finsert_file_contents): Fix check for non-regular files.

Fri Jun 24 10:09:46 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* syntax.c (scan_lists, Fforward_comment): When moving backward over
	a comment, ignore a comment-starter that overlaps the comment-ender.

	* minibuf.c (Fcompleting_read): Doc fix.

Thu Jun 23 20:33:17 1994  Karl Heuer  (kwzh@hal.gnu.ai.mit.edu)

	* keyboard.c (syms_of_keyboard): Don't staticpro the same var twice.

Thu Jun 23 15:15:09 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* s/convexos.h: File deleted.

	* xterm.c: Don't include string.h or strings.h.

	* term.c (term_get_fkeys): Don't redeclare term_get_fkeys_1 here.

	* m/convex.h (LIBS_MACHINE, GETPGRP_NO_ARG): Defined.
	(NLIST_NAME_UNION, DECLARE_GETPWUID_WITH_UID_T): Defined.
	(CRT0_DUMMIES): Conditionalize according to __GNUC__.
	(convex): Define if necessary.
	(C_SWITCH_MACHINE): Definition deleted.

Wed Jun 22 00:15:49 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* buffer.c (Fmove_overlay): Fix typo in previous change.

	* s/sunos4shr.h (X_IO_BUG): Defined.

Tue Jun 21 13:51:44 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* minibuf.c (read_minibuf_unwind): Run Qminibuffer_exit_hook here.
	(read_minibuf): Not here.

	* buffer.c (Fkill_buffer): Don't delete auto save file
	if it didn't come from this Emacs session.
	(Fmove_overlay): Add missing XINT calls in previous change.

Mon Jun 20 20:40:37 1994  Karl Heuer  (kwzh@hal.gnu.ai.mit.edu)

	* xfns.c (x_window): Delete duplicate computation.
	Change type of reference argument from int to Dimension.

Mon Jun 20 10:50:29 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* config.h.in: Move #undef HAVE_STRERROR before the #includes.

	* m/mips4.h (HAVE_STRERROR, HAVE_XRMSETDATABASE)
	(HAVE_XSCREENRESOURCESTRING, HAVE_SETSID): Add #undefs.

	* buffer.c (Fmove_overlay): Call redisplay_region even when
	changing to a different buffer.

	* syntax.c (Fmatching_paren): Fix typo.

	* xterm.c (show_mouse_face): Set endcolumn ok in side-by-side windows.

Sun Jun 19 01:01:42 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* s/linux.h (SEGMENT_MASK): Defined.

	* xfns.c (x_window): Take account of pane widget internal border width.

	* s/linux.h (C_OPTIMIZE_SWITCH): Definition deleted.

	* lisp.h (RETURN_UNGCPRO): Swallow semicolon.
	(GCPRO5): New macro.

	* xmenu.c (single_keymap_panes): Put menu_item_equiv_key in the gcpro.
	(menu_item_equiv_key): GCPRO things.

	* keymap.c (Flookup_key): Add gcpro.
	(Fkey_binding, Fminor_mode_key_binding): Likewise.
	(Fwhere_is_internal): Likewise.

	* keyboard.c (apply_modifiers): Use assq_no_quit.

Sun Jun 19 03:54:02 1994  Erik Naggum  (erik@naggum.no)

	* syntax.h (SYNTAX_MATCH): Fix typo (syntax -> matcher).

	* syntax.c (Fmatching_paren): New function.
	(Fchar_syntax): Pass arg directly to SYNTAX, no masking.

Sat Jun 18 15:20:10 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* .gdbinit: Doc fixes.
	(xsymbol): Cast $ to int.
	(xvector, xstring): Don't use a string constant.
	Reduce size limit for printing contents.

	* s/sol2.h (GETTIMEOFDAY_ONE_ARGUMENT): Undo previous change.

Sat Jun 18 19:52:15 1994  Francesco Potorti`  (pot@fly.cnuce.cnr.it)

	* m/delta.h (memmove): switch the first two args.

Sat Jun 18 09:00:50 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* xterm.c (x_make_frame_visible): At end, wait till Emacs sees
	frame is visible.

	* keyboard.c (echo_after_prompt): New variable.
	(echo_prompt, cancel_echoing): Set it.
	(echo_dash): Test it.

	* s/linux.h (C_DEBUG_SWITCH): Define, if THIS_IS_CONFIGURE.
	(HAVE_GETTIMEOFDAY, HAVE_MKDIR, HAVE_RMDIR): 
	(HAVE_XSCREENNUMBEROFSCREEN, HAVE_XRMSETDATABASE):
	Comment out these definitions.

	* Makefile.in.in (doprnt.o): Depend on config_h.

Fri Jun 17 19:30:46 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* systime.h (EMACS_GET_TIME): Test GETTIMEOFDAY_ONE_ARGUMENT,
	not USG5_4.
	* s/usg5-4.h (GETTIMEOFDAY_ONE_ARGUMENT): Define it.
	* s/sol2.h (GETTIMEOFDAY_ONE_ARGUMENT): Undef it.

	* xfns.c (x_real_positions): Make sure we know the parent window.

Fri Jun 17 16:01:55 1994  Karl Heuer  (kwzh@hal.gnu.ai.mit.edu)

	* window.h (minibuf_prompt): Now a Lisp_Object.  All uses changed.

	* minibuf.c (minibuf_save_list): New variable, replaces
	minibuf_save_vector.
	(read_minibuf): Cons it up.
	(read_minibuf_unwind): Pop back the saved values.
	(syms_of_minibuf): staticpro it.

	* indent.c (compute_motion): Recenter overlays, for speed.

Fri Jun 17 09:33:21 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* xterm.c (scratch_cursor_gc): New variable.
	(dumpglyphs): Rework handling of GCs for cursor display
	to use scratch_cursor_gc, and reuse the GC more.

Thu Jun 16 14:50:43 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* unexec.c (make_hdr): Handle case of no "additional header".

	* xdisp.c (redisplay_region): Treat selected window's buffer
	specially, not current buffer.

	* syssignal.h [USG5_4] (sigblock): Use |, not &.

Thu Jun 16 11:36:35 1994  Karl Heuer  (kwzh@hal.gnu.ai.mit.edu)

	* xdisp.c (redisplay_window): Don't use shortcut if window_end_vpos
	is out of date.

Thu Jun 16 11:01:33 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* process.c (Fprocess_status): Return nil for process name
	that has no process.

	* dispnew.c (syms_of_display): Make baud-rate a user var.

	* syntax.c (scan_lists): Get error if eob within comment with depth!=0.

Thu Jun 16 02:55:51 1994  Roland McGrath  (roland@geech.gnu.ai.mit.edu)

	* unexec.c: Include <sys/file.h> and [USG5] <fcntl.h> to define
        O_* macros.
	(O_RDONLY, O_RDWR): Define if undefined.
	[emacs] (report_error): Use report_file_error so the user can tell
	what the errno code was.
	(unexec): Use O_RDONLY instead of explicit 0.
	(make_hdr): Don't undo A_TEXT_OFFSET adjustment #ifndef NO_REMAP,
	since it was never adjusted earlier #ifndef NO_REMAP.
	(adjust_lnnoptrs): Use O_RDWR instead of explicit 2.

Wed Jun 15 16:11:16 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* xterm.c (x_noop_count): New variable.
	(x_term_init) [X_IO_BUG]: Init it.
	(XTread_socket) [X_IO_BUG]: Don't do XNoOp every time, just 1 in 100.

Wed Jun 15 00:03:36 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* syssignal.h (sigblock) [USG5_4]: Define if not defined.

Tue Jun 14 23:40:29 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* lread.c: Put config.h first.

	* hftctl.c: Put sys/signal.h and errno.h first, then config.h.

	* dired.c: Put stdio.h, sys/types.h and sys/stat.h after config.h.

	* callproc.c, dispnew.c, frame.c, term.h: Put stdio.h after config.h.
	* widget.c, xmenu.c, xterm.c: Put stdio.h after config.h.

Tue Jun 14 20:17:16 1994  Karl Heuer  (kwzh@hal.gnu.ai.mit.edu)

	* sysdep.c (init_system_name): New function, replaces get_system_name.
	* lisp.h: declare it.
	* editfns.c (init_editfns): Call it.
	(get_system_name): New function, now just uses Vsystem_name.
	* xterm.c (x_term_init): Use Vsystem_name instead of calling
	get_system_name.

	* keymap.c (Fsingle_key_description): Allow strings as keys.

	* process.c (create_process): Set input_wait_mask before forking.

Tue Jun 14 15:45:44 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* indent.c (vmotion): Use find_next_newline_no_quit.
	(indented_beyond_p): Likewise.

	* search.c (find_next_newline_no_quit): New function.

	* sysdep.c (init_sys_modes): Don't set up sigio here if window system.

	* keyboard.c (read_key_sequence): Verify event has a POSN_BUFFER_POSN
	before trying to extract it.

	* eval.c (init_eval_once): Call xmalloc, not malloc.

	* process.c (Fprocess_send_eof): Doc fix.

Mon Jun 13 17:07:59 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* keyboard.c (interrupt_signal, init_keyboard): 
	Don't handle SIGINT and SIGQUIT if using window system directly.

	* sysdep.c (init_sys_modes): Don't call set_terminal_modes
	if using a window system.

	* xterm.c (XTread_socket): Use x_top_window_to_frame in prev change.

	* s/sol2.h (SOLARIS2): Defined.

	* m/intel386.h: Add conditional for SOLARIS2.

Mon Jun 13 16:55:30 1994  Karl Heuer  (kwzh@hal.gnu.ai.mit.edu)

	* xmenu.c (single_keymap_panes): gcpro some things.

Mon Jun 13 15:44:51 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* xterm.c (XTread_socket): Handle Xatom_wm_save_yourself
	by calling XSetCommand.

	* emacs.c (init_cmdargs): Set up initial_argv, initial_argc.

	* keyboard.c (syms_of_keyboard): Properly init Vsystem_key_alist.

	* unexaix.c (adjust_lnnoptrs): Handle multiple aux symbols.

Sun Jun 12 15:57:02 1994  Karl Heuer  (kwzh@hal.gnu.ai.mit.edu)

	* editfns.c (transpose_markers): Allow for gap at start of region.
	(Ftranspose_regions): Don't precompute pointers into buffer text.

Sun Jun 12 08:42:36 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* xfns.c (x_window): Request "save yourself" commands.

	* callint.c (Fcall_interactively): Ignore `-' in string.
	(Fcall_interactively): Don't call minibuffer-window-active-p;
	determine directly whether a minibuf window is active.

	* keyboard.c (read_char): When we loop and call redisplay,
	do prepare_menu_bars first.

Sat Jun 11 08:12:46 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* search.c (Freplace_match): Be sure not to treat non-digit like digit.

	* xmenu.c (xmenu_show): Don't call XMenuDestroy twice
	in XM_FAILURE case.

	* Makefile.in.in (xterm.o): Depend on dispextern.h.

	* s/sunos4-1-3.h (X_IO_BUG): Defined.

Fri Jun 10 16:31:19 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* s/linux.h (CLASH_DETECTION): Defined.

	* minibuf.c (Fdisplay_completion_list):
	Require at least two spaces between items.

Tue Jun  7 13:33:23 1994  Richard Stallman  (rms@geech.gnu.ai.mit.edu)

	* keyboard.c (command_loop_1):
	Treat nil in display tab like no display tab.

Tue Jun  7 11:50:49 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* mips-siemens.h:  Include pyramid.h, not mips.h.
	(LOAD_AVE_TYPE, LOAD_AVE_CVT): Definitions deleted.
	(NO_ARG_ARRAY, HAVE_ALLOCA): Defined.
	(BROKEN_FIONREAD): Add #undef.

Tue Jun  7 19:19:04 1994  Morten Welinder  (terra@diku.dk)

	* msdos.c (init_environment): Clean up code and make the default
	EMACSPATH equal to the directory from which Emacs was started.
	(emacsroot): New variable.
	(rootrelativepath): New function.
	* msdos.h: Add template for rootrelativepath.
	* lread.c [MSDOS]: #include "msdos.h".
	* callproc.c (init_callproc) [MSDOS]: Exclude less code, so ../etc
	is still tested for doc file.

Mon Jun  6 21:11:13 1994  Karl Heuer  (kwzh@hal.gnu.ai.mit.edu)

	* fns.c (Fy_or_n_p, Fyes_or_no_p) [HAVE_X_MENU]: Redisplay before
	popping up a menu.

	* dispnew.c (Fframe_or_buffer_changed_p): Reuse the state vector.

Mon Jun  6 08:37:39 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* frame.c (Ficonify_frame, Fmake_frame_invisible, Fmake_frame_visible):
	Increment windows_or_buffers_changed.

	* xdisp.c (redisplay): Don't call x_consider_frame_title.
	(display_mode_line): Likewise.
	(prepare_menu_bars): Call it here.

Mon Jun  6 01:02:32 1994  Karl Heuer  (kwzh@hal.gnu.ai.mit.edu)

	* dispnew.c (Fframe_or_buffer_changed_p): New function.

Sun Jun  5 07:13:01 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* xterm.c (x_wm_set_icon_position, x_wm_set_icon_pixmap):
	[USE_X_TOOLKIT]: Use top-level widget's window.

	* s/bsd386.h (BSD): Redefine.
	(WAITTYPE, WRETCODE, WCOREDUMP): New definitions.
	Include wait.h.

	* m/sun386.h (LIBS_MACHINE) [USG]: New #define.

	* xterm.c (x_term_init): New args xrm_option and resource_string.
	Pass an -xrm option to XtAppInitialize if appropriate.

	* xfns.c (Fx_open_connection): Set up Vx_resource_name and xrm_option
	before calling x_term_init.  Pass new args.

	* keyboard.c (modify_event_symbol): Return nil if out of range.

	* keymap.c (Fkey_description): Avoid using Fmapconcat--do it directly.

	* keyboard.c, dispnew.c: Include systime.h after xterm.h.

	* xfns.c (x_window): Take account of internal border of paned widget.

	* m/dos386.h (PURESIZE): Increased to 240000.

	* xfns.c (using_x_p): New function.
	* fns.c (Fy_or_n_p): Don't use dialog box if not an X frame.
	(Fyes_or_no_p): Likewise.

Sat Jun  4 14:35:09 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* s/hpux9shr.h (C_DEBUG_SWITCH): Define as empty.

Fri Jun  3 20:14:30 1994  Morten Welinder  (terra@diku.dk)

	* callproc.c [MSDOS]: #include "msdos.h" for rootrelativepath
	template.

	* msdos.c (run_msdos_command): Make local copy of argv[2] on stack,
	not on heap.
	(run_msdos_command): When changing argv[2] from using slashes to
	using backslashes, only do so on the first white-space delimited
	part.

Thu Jun  2 19:41:08 1994  Karl Heuer  (kwzh@hal.gnu.ai.mit.edu)

	* textprop.c (Fprevious_single_property_change): Check for null
	interval after correcting for edge effects.

	* xdisp.c (display_text_line): Make sure pointer is in range.

	* xmenu.c (xdialog_show): Fix problem with message in dialog box.

Thu Jun  2 15:11:57 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* emacs.c (main): Do the setpgrp after checking for -batch.

	* keyboard.c (command_loop_1): Properly handle nil in display table.

	* s/hpux9.h (C_SWITCH_SYSTEM): Put inside __GNUC__ conditional.

Wed Jun  1 14:55:45 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* process.c (kill_buffer_processes): For net conn, use Fdelete_process.

Mon May 30 06:16:48 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* Version 19.25 released.

	* xdisp.c (redisplay): Limit prev change to pause != 0.

	* keyboard.c (command_loop_1): Allow direct output for insert
	if have display table but it says nothing for this char code.
	Don't allow it if char code has a glyph with a face code.

	* process.c (create_process): Get a pty for any non-nil
	Vprocess_connection_type value.

Sat May 28 00:33:16 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* s/bsd386.h (TABDLY, TAB3): Defined.
	(SYSV_SYSTEM_DIR): Defined.

	* unexhp9k800.c (roundup): Undef before defining.

	* xdisp.c (redisplay): If have window change at end, redisplay again.

	* lread.c (defvar_bool, defvar_int, defvar_lisp, defvar_lisp_nopro): 
	Delete third arg DOC.

	* s/hpux8.h (LD_SWITCH_SYSTEM): Delete the -L options.
	(LD_SWITCH_X_DEFAULT): Put them here instead.

	* Makefile.in.in (LD_SWITCH_X_DEFAULT): Define if not defined.
	(LIBX): Use LD_SWITCH_X_DEFAULT.

	* xterm.c (x_iconify_frame): Call x_set_offset,
	if x_make_frame_visible would do so.
	(x_make_frame_visible): Don't call x_set_offset if frame is iconic.
	(XTread_socket): For ConfigureNotify, if wm decorations exist,
	set NorthWestGravity.

	* Makefile.in.in (mostlyclean): Don't mention xmakefile*.

	* emacs.c (main): In batch mode, don't set the pgrp.

Fri May 27 06:32:24 1994  Paul Eggert  (eggert@twinsun.com)

	* callproc.c (child_setup): If PWD is set, set it in the child so that
	it points at the child's working directory.

Fri May 27 03:59:59 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* m/mips4.h (C_DEBUG_SWITCH) [not __GNUC__]: Add -Wf option.

	* s/hpux9.h (C_SWITCH_SYSTEM): Defined.

	* keyboard.c [HAVE_X_WINDOWS]: Include xterm.h.

	* xterm.c (x_is_vendor_fkey): Function deleted.
	(XTread_socket, case KeyPressed): Don't clear the vendor-specific bit.
	Pass thru almost any vendor-specific keysym.

	* s/linux.h (HAVE_XRMSETDATABASE): Define if not defined.

Fri May 27 06:52:13 1994  Paul Eggert  (eggert@twinsun.com)

	* editfns.c (difftm): Don't store a long value into an int variable.

Thu May 26 18:29:17 1994  Karl Heuer  (kwzh@hal.gnu.ai.mit.edu)

	* fileio.c (Finsert_file_contents): Check for beginning of file.

Thu May 26 18:13:31 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* systime.h: Make previous change limited to HPUX.

Thu May 26 14:46:35 1994  Karl Heuer  (kwzh@hal.gnu.ai.mit.edu)

	* systime.h: If _STRUCT_TIMEVAL is defined, also define __TIMEVAL__.

Wed May 25 20:20:53 1994  Morten Welinder  (terra@diku.dk)

	* msdos.c (output_string): New function.
	(internal_flush): Use output_string for faster screen update.
	(internal_flush): Clear to end of line by writing a string of
	spaces.

Wed May 25 00:36:35 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* xfns.c (Vx_sensitive_text_pointer_shape):
	Renamed from Vx_cross_pointer_shape.
	(syms_of_xfns): Provide Lisp var x-sensitive-text-pointer-shape.

	* xmenu.c (menu_item_equiv_key): Look for equiv keys both before
	and after one stage of symbol function indirection.

	* xterm.c (note_mouse_movement): Use frame's window in XQueryPointer.
	Special case if mouse isn't on that window.
	(note_mouse_highlight): Handle negative args and too-large args.

	* lread.c (openp): Don't use O_RDONLY.

Tue May 24 22:20:01 1994  Karl Heuer  (kwzh@hal.gnu.ai.mit.edu)

	* search.c (Freplace_match): Improve capitalization heuristics.

	* minibuf.c (Fminibuffer_complete_word): GCPRO completion and tem.

	* undo.c (Fprimitive_undo): GCPRO next and list.
	Check argument type before calling XINT.

Tue May 24 17:14:49 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* buffer.c (verify_overlay_modification): GCPRO tail and overlay.
	Avoid copying tail twice.

Tue May 24 17:11:38 1994  Andreas Schwab  (schwab@informatik.uni-dortmund.de)

	* keymap.c (describe_map): Fix the call to Fequal.

Tue May 24 16:50:42 1994  Morten Welinder  (terra@diku.dk)

	* msdos.c (do_visible_bell): Renamed from visible_bell to avoid
	potential conflict with variable of the same name.  Caller changed.
	(internal_flush): Code for audio bell inserted.
	* s/msdos.h (INTERNAL_TERMINAL): Allow audio bell.

	* msdos.c (dos_rawgetc): Doc fix.  Make C-, S-, and M- modifiers
	independent.  Make modifiers work with mouse.  Improve C-S-<ascii>
	handling by using look-up tables.  Fix kp-decimal problem.

Mon May 23 00:38:44 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* Version 19.24 released.

	* s/hpux8.h (LD_SWITCH_SYSTEM): Put back -Xlinker for GCC.

	* Makefile.in.in (LIBXT): Move -lXmu before -lXt.

	* term.c (update_end): Undo previous change.

	* frame.c (other_visible_frames): No longer static.

	* window.c (window_loop): Fix test of dedicated flag in prev change.

	* window.c (window_loop, UNSHOW_BUFFER case):
	Put prev change in #ifdef MULTI_FRAME.

	* keyboard.c (menu_bar_one_keymap):
	When there's no item string, use Qnil.
	Don't ever put `undefined' into the list of definitions.

Sun May 22 16:16:32 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* window.c (window_loop, UNSHOW_BUFFER case): Kill a special frame.

	* xterm.c (x_set_window_size): If cursor outside new size, mark it off.
	* dispnew.c (change_frame_size): Keep cursor coords in range.

	* s/linux.h (HAVE_GETTIMEOFDAY, HAVE_MKDIR, HAVE_RMDIR)
	(HAVE_XSCREENNUMBEROFSCREEN): Define these if not already defined.

Sun May 22 16:36:34 1994  Morten Welinder  (terra@diku.dk)

	* unexec.c [MSDOS]: Don't include files from the dos extender
	and debugger.  Use the <coff.h> that was put in the right place
	a couple of djgpp versions ago.  Consequently, use `unsigned short'
	for `word16' and `unsigned long' for `word32'.

Sun May 22 04:22:16 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* xterm.c (note_mouse_highlight): Handle case of highlight extending
	past end of window.
	(fast_find_position): Fix bugs when no text on screen
	and when the mouse is on an empty line.

	* s/hpux9shr.h: New file.

	* s/hpux8.h (LD_SWITCH_SYSTEM): Add conditionals for HPUX_USE_SHLIBS.
	Delete explicit -Xlinker in GCC case.

	* unexhp9k800.c: Include config.h.
	[HPUX_USE_SHLIBS]: Include dl.h.
	(brk_on_dump): New variable.
	(unexec): Set brk_on_dump.
	(copy_file): Change buffer size to 8192.

	* window.c (change_window_height): Test for DELTA too small
	only after making it smaller based on maxdelta.

Sat May 21 19:16:03 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* fileio.c (Fdelete_directory): Allow dir names as well as file names.

	* Makefile.in.in (${etc}DOC): Ignore error from rm.
	(MSDOS_SUPPORT): New variable.
	(lisp): Use MSDOS_SUPPORT.

	* s/freebsd.h (A_TEXT_OFFSET, A_TEXT_SEEK): Commented out.

Fri May 20 21:10:58 1994  Karl Heuer  (kwzh@hal.gnu.ai.mit.edu)

	* xfns.c (x_set_background_color): Set scroll bar backgrounds.

Fri May 20 18:57:09 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* xterm.c (x_wm_set_window_state) [USE_X_TOOLKIT]: Use XtSetValues.
	(x_iconify_frame) [USE_X_TOOLKIT]: New code for invisible window case.
	(XtNinitialState) [USE_X_TOOLKIT]: New #define.
	(x_make_frame_invisible): Mostly combine toolkit/non-toolkit cases,
	in the process fixing a dumb bug.

Fri May 20 12:16:00 1994  Michael I Bushnell  (mib@geech.gnu.ai.mit.edu)

	* lread.c (openp): Only lusers assume that O_RDONLY == 0.

Fri May 20 01:28:59 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* Makefile.in.in (UNEXEC_ALIAS): New variable, used
	to make the unex...o target.

	* xfaces.c (Fset_face_attribute_internal): Always return valid data.

	* textprop.c (syms_of_textprop): Set up Lisp fn get-char-property.

Thu May 19 16:57:10 1994  Andreas Schwab  (schwab@issan.informatik.uni-dortmund.de)

	* fileio.c (Finsert_file_contents): Declare buffer as unsigned
	char.  When comparing with file size convert same_at_start to
	distance to buffer start.  If the file matches the buffer
	contents truncate the buffer to the size of the file.

Thu May 19 18:03:26 1994  Jim Blandy  (jimb@totoro.bio.indiana.edu)

        * keyboard.c (read_char_minibuf_menu_prompt): Don't forget to
        initialize nobindings.

Thu May 19 00:11:34 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* Makefile.in.in (ORDINARY_LINK): Define by default
	if __GNU_LIBRARY__ and not LINUX.

	* s/isc4-0.h (EXTRA_INITIALIZE): Definition deleted.

	* s/isc3-0.h (EXTRA_INITIALIZE): Define here.

	* keyboard.c (lispy_function_keys): Add `backtab'.

	* frame.c (syms_of_frame): Set up frame-first-window as Lisp fn.

	* indent.c: Add "args" to dummy definition of compute-motion.

	* sysdep.c [BROKEN_TIOCGWINSZ]: Undef TIOCSWINSZ too.

	* Makefile.in.in (FRAME_SUPPORT): Add menu-bar.el.

	* dispnew.c: Include errno.h.

	* widget.c (EmacsFrameSetCharSize): Once again preserve x and y pos,
	but not the same way as before.

	* xmenu.c (other_menu_bar_item_p): Return 0 if no menu bar.

	* fileio.c (Fwrite_region): Set update_mode_lines.

	* xmenu.c (xmenu_show): Don't look in menubar for core.height
	if no menu bar.

	* xterm.c (x_iconify_frame): Fix error messages.

Wed May 18 01:36:22 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* dispnew.c (PENDING_OUTPUT_COUNT): If __GNU_LIBRARY__,
	use GNU_LIBRARY_PENDING_OUTPUT_COUNT if defined.

	* keyboard.c (lispy_function_keys): Add various kp- keys for X11R6.

	* fileio.c (syms_of_fileio): Doc fix.

	* s/linux.h (GNU_LIBRARY_PENDING_OUTPUT_COUNT): Both definitions
	renamed from PENDING_OUTPUT_COUNT.

	* process.c (create_process): Don't complain about error
	from TIOCSETD.

	* window.c (Fset_window_buffer): Fix dedicated window error call.
	(window_loop, case UNSHOW_BUFFER): Clear dedicated flag.

	* fileio.c (Finsert_file_contents): Declare `buffer' as unsigned char.

	* dispnew.c: Include systime.h after xterm.h.

	* m/tek4300.h (WORDS_BIG_ENDIAN): Define this, not BIG_ENDIAN.

	* emacs.c (syms_of_emacs), config.h.in:
	EMACS_CONFIGURATION renamed from CONFIGURATION.

Tue May 17 18:57:20 1994  Andreas Schwab  (schwab@issan.informatik.uni-dortmund.de)

	* eval.c (Fbacktrace): Properly nest parentheses.
	(Fbacktrace_frame): Don't bomb on invalid frame number.

Tue May 17 05:41:51 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* keyboard.c (command_loop_1): Fix test for valid display table entry,
	for backwards motion.

	* Makefile.in.in (ALL_LDFLAGS): Add LDFLAGS.
	(MAKE): Don't override a previous value of MAKE set by configure.

	* dispnew.c (update_frame): Fix test of outq and baud_rate.

	* emacs.c (shut_down_emacs): Don't call intern.

Tue May 17 03:23:39 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* Version 19.23 released.

Tue May 17 00:04:25 1994  Morten Welinder  (terra@diku.dk)

	* msdos.c (gettimeofday): New function substituting the library
	function of the same name.
	(init_gettimeofday): New function.
	(init_environment): Call init_gettimeofday after possibly
	setting TZ environment variable.
	* msdos.h: Add template for init_gettimeofday.

Mon May 16 23:25:12 1994  Karl Heuer  (kwzh@hal.gnu.ai.mit.edu)

	* buffer.c (fix_overlays_in_range): New function.
	* editfns.c (Ftranspose_regions): Call it.  Also update point as
	if it were a marker.

Mon May 16 03:25:22 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* xmenu.c (xmenu_show): Completely ignore nameless panes
	except for the first pane.  Ignore named panes too if KEYMAPS.

	* widget.c (setup_frame_gcs): Move cursor_bits variable out of
	setup_frame_gcs and rename to setup_frame_cursor_bits.

	* eval.c (syms_of_eval): Doc fixes.

Sun May 15 00:14:04 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* xterm.c (x_display_box_cursor): Preserve mouse highlight
	if the old cursor was in it.

	* editfns.c (Fcurrent_time_zone): Add cast.

	* s/bsd386.h (LOCALTIME_CACHE): Defined.

	* m/pmax.h (LOCALTIME_CACHE): Define, if not OSF1.

	* xfns.c (validate_x_resource_name): Don't let Vx_resource_name
	have invalid characters.

Sat May 14 20:07:44 1994  Morten Welinder  (terra@diku.dk)

	* msdos.c (crlf_to_lf): Fix off-by-one condition.

Sat May 14 02:33:12 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* keyboard.c (bind_polling_period): Never decrease polling_period.

	* fileio.c (Fdo_auto_save): Save listdesc as an integer, only if open.
	(do_auto_save_unwind): Corresponding changes.

	* keyboard.c (echo): Don't echo motion events.

	* fileio.c (Fcopy_file): Close output before setting its times.
	Close both before discarding the unwind protects.

Fri May 13 18:12:44 1994  Karl Heuer  (kwzh@hal.gnu.ai.mit.edu)

	* buffer.c (Foverlay_lists): Doc fix.
	(Fnext_overlay_change): Doc fix.

Fri May 13 03:16:47 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* xterm.c (XTread_socket): For button events, clear compose_status.

	* Makefile.in.in (LIBXTR6): New variable.  Test HAVE_X11XTR6.
	(LIBXT): Use it.
	* config.h.in (HAVE_X11XTR6): Add #undef.

	* editfns.c (save_excursion_restore): Don't run activate-mark-hook
	if mark position is unchanged.

	* emacs.c (main): PRIO_PROCESS renamed to SET_EMACS_PRIORITY.
	* callproc.c (child_setup): PRIO_PROCESS renamed to SET_EMACS_PRIORITY.
	Don't call nice if emacs_priority is positive.
	* sysdep.c (sys_subshell): PRIO_PROCESS renamed to SET_EMACS_PRIORITY.
	Don't call nice if emacs_priority is positive.

Thu May 12 13:51:11 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* Makefile.in.in: Handle Motif and Open-look.
	(LIBW): New variable.
	(LIBXT): Use it.

	* process.c (POLL_FOR_INPUT): Define, if appropriate.

Thu May 12 12:17:16 1994  Karl Heuer  (kwzh@hal.gnu.ai.mit.edu)

	* xdisp.c (display_text_line): Fix check for end of buffer.

Thu May 12 02:17:20 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* xterm.c (dumpglyphs): For cursor foreground, try the
	face's background before the face's foreground.
	(XTread_socket): Call note_mouse_movement for EnterNotify.

	* process.c (Fopen_network_stream):
	Call bind_polling_period; later unbind the binding.

	* keyboard.c (syms_of_keyboard): Set up Qpolling_period.
	(bind_polling_period): New function.

	* callproc.c (init_callproc): Never set Vdata_directory based on
	the executable's location.  But maybe set it from source dir.

Wed May 11 18:15:27 1994  Roland McGrath  (roland@churchy.gnu.ai.mit.edu)

	* systty.h [__GNU_LIBRARY__]: Include <termios.h>.

Wed May 11 05:17:56 1994  Frederic Pierresteguy  (F.Pierresteguy@frcl.bull.fr)

	* xmenu.c (xmenu_show): New var mb_item. Use it to determine the
	menubar item that led to the menu.
	(Fx_popup_menu): Suppress duplicate test case in the way to determine
	whether the menu is handling a menu bar click.

Wed May 11 00:15:22 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* buffer.c (Frename_buffer): Reject empty string as new name.

Tue May 10 23:54:11 1994  Karl Heuer  (kwzh@hal.gnu.ai.mit.edu)

	* process.c (exec_sentinel): Don't deactivate the mark.
	Check for asynch buffer switch.

Tue May 10 20:15:56 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* s/bsd4-2.h (BSD): Define as 42.
	(BSD4_2): Define as 1.  This makes it like bsd4-3.h.

	* floatfns.c: Don't declare logb if it is a macro.

Tue May 10 19:36:17 1994  Karl Heuer  (kwzh@hal.gnu.ai.mit.edu)

	* keyboard.c (read_char): Preserve echo area on asynch buffer switch.

Tue May 10 18:39:40 1994  Roland McGrath  (roland@churchy.gnu.ai.mit.edu)

	* dispnew.c [__GNU_LIBRARY__]: Redefine PENDING_OUTPUT_COUNT even
	if already defined.

Tue May 10 03:24:16 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* fileio.c (Finsert_file_contents) [MSDOS]: Ignore the replace feature.

	* buffer.c (syms_of_buffer): Doc fix.

	* keyboard.c (syms_of_keyboard): Doc fix.

Tue May 10 01:36:31 1994  Karl Heuer  (kwzh@hal.gnu.ai.mit.edu)

	* keyboard.c (safe_run_hooks): New function, extracted from
	command_loop_1.  Bind inhibit_quit.

Mon May  9 00:51:27 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* xmenu.c (string_width): Deleted.

	* xterm.c (x_set_window_size) [USE_X_TOOLKIT]:
	Preserve the main widget's x and y position.

Sun May  8 17:52:48 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* process.c (process_send_signal): If PREFER_VSUSP,
	use VSUSP instead of VSWTCH.
	* s/sco4.h (PREFER_VSUSP): Defined.
	* s/irix5-0.h (PREFER_VSUSP): Defined.

	* fileio.c (Fdo_auto_save): Write a list of all auto save file names.
	(Vauto_save_list_file_name): Specify file name to put them in.
	(syms_of_fileio): Set up Lisp var.

Sat May  7 02:29:37 1994  Morten Welinder  (terra@diku.dk)

	* callproc.c [MSDOS]: Rename Vbinary_process to Vbinary_process_output.
	(syms_of_callproc) [MSDOS]: Rename lisp variable binary-process to
	binary-process-output.
	(Fcall_process, syms_of_callproc) [MSDOS]: Use new names.
	(Vbinary_process_input) [MSDOS]: New variable.
	(syms_of_callproc) [MSDOS]: Declare binary-process-input.
	(Fcall_process_region) [MSDOS]: Bind binary-process-input temporarily
	to buffer-file-type.
	(init_callproc) [MSDOS]: Don't add lib-src as the wrapped binaries
	are in bin.

Sat May  7 04:37:41 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* buffer.c (Qbuffer_file_type): Var deleted.
	* callproc.c (Qbuffer_file_type): Var added.

	* keyboard.c (read_char): Don't test do_mouse_tracking;
	instead, do prepare_menu_bars only if commandflag > 1.
	(read_char): Do call add_command_key for mouse-movement events.
	Test detect_input_pending, not EVENT_QUEUES_EMPTY, for kbd menus.
	But don't test either one for mouse menus.

	* undo.c (record_delete): Record the old point value
	only right after a boundary.

Fri May  6 22:22:24 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* s/dgux5-4r3.h: Use dgux5-4r2.h under new name.

	* puresize.h (PURESIZE): Increase to 235000 and 205000.

Fri May  6 00:22:18 1994  Morten Welinder  (terra@diku.dk)

	* s/msdos.h: Define NO_MATHERR.
	* floatfns.c: Don't guard DOMAIN && SING && OVERFLOW check by
	an #ifndef MSDOS.

Fri May  6 19:46:03 1994  Francesco Potorti` (pot@cnuce.cnr.it)

	* m/delta.h: (SYSTEM_MALLOC): deleted.  The problem isn't there.

Fri May  6 00:25:30 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* xterm.c (x_set_offset): Set gravity and size hint
	before moving the window.

	* keyboard.c (make_lispy_event): Ignore mouse events for deleted frame.

	* xterm.c (XTread_socket):
	For ReparentNotify, use x_top_window_to_frame.
	Also recompute frame position using x_real_positions.
	For ConfigureNotify, don't ignore send_events.
	Also recompute frame position using x_real_positions.

Thu May  5 20:59:39 1994  Karl Heuer  (kwzh@hal.gnu.ai.mit.edu)

	* window.c: Use PT, not point.
	(Fdelete_other_windows): Do nothing if w->start is outside region.
	Don't temporarily move point when recomputing window position.

Thu May  5 15:18:27 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* xfns.c (x_real_positions): New function.

	* keyboard.c (make_lispy_movement): Don't call pixel_to_glyph_coords
	if FRAME is 0.

	* xterm.c (x_set_offset): Update XNegative and YNegative for new pos.
	(x_calc_absolute_position): Clear XNegative and YNegative.

	* xrdb.c (x_load_resources) [USE_X_TOOLKIT]: Don't call XrmInitialize.

	* keymap.c (describe_map): Ignore bindings for all except
	symbols and integers.

	* unexelfsgi.c (unexec): Handle debugging info properly.

	* s/freebsd.h: Don't use netbsd.h.  Do all those things right here.

Thu May  5 01:33:46 1994  Karl Heuer  (kwzh@hal.gnu.ai.mit.edu)

	* xmenu.c (Fx_popup_menu): Restore accidentally-deleted call to
	mouse_position_hook.
	(xmenu_show): Disallow empty menus.

Thu May  5 00:03:36 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* keyboard.c (last_point_position_buffer): New variable.
	(command_loop_1): Set it.
	* undo.c (record_delete): Test it.
	* commands.h (last_point_position_buffer): Declared.

	* Makefile.in.in: Put in a separator for where to start cpp procssing.
	Above that, use Make-style comments.
	This goes with changes in ../configure.in.

Wed May  4 01:20:45 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* s/isc4-0.h (NEED_SIOCTL, ISC4_0): Declared.

	* sysdep.c: Test ISC4_0 along with TIOCGWINSZ.

	* process.c (wait_reading_process_input): Don't call prepare_menu_bars
	unless we are going to redisplay for a garbaged frame.
	(read_process_output): Call prepare_menu_bars if waiting for input.
	(exec_sentinel): Call prepare_menu_bars if waiting for input.

	* s/dgux5-4r3.h, s/dgux5-4r2.h: Renamed from ..4R..

	* eval.c (error): Fix logic in call to xmalloc/xrealloc.

	* xterm.c (x_make_frame_invisible): Use XWithdrawWindow again.

	* s/sol2.h, s/sol2-3.h (LD_SWITCH_SYSTEM):
	Use ./prefix-args, not -Xlinker directly.

Tue May  3 00:21:01 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* xfns.c (x_set_cursor_color): Fix typo.

	* xselect.c (x_own_selection): Catch errors around XSetSelectionOwner.

	* buffer.c (syms_of_buffer): Doc fix.

	* xdisp.c (display_text_line): Since HPOS is negative, avoid
	writing before the beginning of the charstarts line.

	* minibuf.c (read_minibuf): Clear previous_echo_glyphs.

Mon May  2 19:36:24 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* dired.c (file_name_completion_stat): Use both lstat and stat.

Mon May  2 17:07:56 1994  Karl Heuer  (kwzh@hal.gnu.ai.mit.edu)

	* xterm.c (show_mouse_face): Fix test for cursor in highlighted area.
	(note_mouse_highlight): Reorder test for simplicity.
	(note_mouse_highlight, show_mouse_face, clear_mouse_face,
	x_destroy_window): Use row/col instead of buffer position to keep
	track of highlighted area.

Mon May  2 19:46:03 1994  Francesco Potorti` (pot@cnuce.cnr.it)

	* m/delta.h: (SYSTEM_MALLOC): Defined, since GNU malloc does not work.
	(BCOPY_UPWARD_SAFE): Defined to 0 for the Green Hills compiler.

Mon May  2 00:06:46 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* process.c (create_process): Undo April 19 setsid change.

Sun May  1 03:32:22 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* xterm.h (struct x_display): New field size_hint_flags.
	* xfns.c (Fx_create_frame): Set the size_hint_flags field.
	Don't call x_calc_absolute_position.
	* xterm.c (x_calc_absolute_position): Use size_hint_flags.
	New FLAGS arg deleted.  Callers changed. 

	* xfns.c (x_figure_window_size): Handle `-' for top or left.
	(Fx_parse_geometry): Handle one element at a time.
	Give `-' when appropriate.
	(x_figure_window_size): Allow just height or just width.

	* xterm.c (x_wm_set_size_hint): Don't try to handle negative positions.
	(x_calc_absolute_position):
	New arg FLAGS.  Use XNegative and YNegative.
	(x_set_offset): Pass new arg.

	* xfns.c (x_figure_window_size): Set USPosition only if user-position
	is non-nil; otherwise, if pos is specified, set PPosition.
	Likewise for USSize and PSize.
	(Fx_create_frame): Use XNegative and YNegative to set win_gravity.
	[USE_X_TOOLKIT] (x_window): Use XNegative and YNegative
	to set win_gravity.  Pass new arg to x_calc_absolute_position.

	* editfns.c (Ftranspose_regions): Take addresses only after move gap.
	Cast result of alloca.  Use xmalloc instead, for large objects.
	Always copy the middle portion directly; never put it in temp.
	Always move the gap to START1 or END2, whichever is nearer.

	* keyboard.c (Ftrack_mouse): Call prepare_menu_bars at the start.
	(read_char): Don't call prepare_menu_bars if doing mouse tracking.

Sat Apr 30 22:08:09 1994  Karl Heuer  (kwzh@hal.gnu.ai.mit.edu)

	* puresize.h (PURESIZE) [MULTI_FRAME]: Increase to 232000.

Sat Apr 30 19:09:08 1994  Paul Reilly  (pmr@churchy.gnu.ai.mit.edu)

	* s/dgux5-4R3.h: new file.

	* s/dgux5-4R2.h: new file.

	* s/dgux.h (SVR4): Make conditional on ELF environment.
	(INTERRUPT_INPUT, ORDINARY_LINK): Set by default.
	(C_COMPILER, LINKER and MAKE_COMMAND): Remove.

	* process.c (IN_ADDR, NUMERIC_ADDR_ERROR): Made conditional on
	HAVE_BROKEN_INET_ADDR.

Sat Apr 30 01:58:46 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* keyboard.c (record_asynch_buffer_change): Block SIGIO.
	(force_auto_save_soon): Call record_asynch_buffer_change.

	* emacs.c (memory_warning_signal): Call force_auto_save_soon.

	* keyboard.c (force_auto_save_soon): New function.

	* process.c (Fopen_network_stream): Retry the connect if EADDRINUSE.
	Ignore EISCONN.

Fri Apr 29 22:15:44 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* eval.c (init_eval): Initialize when_entered_debugger to -1.

Fri Apr 29 19:21:02 1994  Jim Blandy  (jimb@totoro.bio.indiana.edu)

        * data.c (Ffset, Ffmakunbound): Signal an error if SYM is nil or t.

Fri Apr 29 19:12:35 1994  Karl Heuer  (kwzh@hal.gnu.ai.mit.edu)

	* data.c, floatfns.c, lread.c [MSDOS]: Re-enable some #undef's.

Fri Apr 29 20:07:33 1994  Karl Fogel  (kfogel@phylo)

	* editfns.c (Ftranspose_regions): New function.
        (transpose_markers): Helper func for above.
        (syms_of_frame): Call defsubr for Stranspose_regions.

Fri Apr 29 05:35:49 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* xterm.h (x_mouse_grabbed): Declared.
	* xmenu.c (xdialog_show): Clear x_mouse_grabbed.

	* frame.c (Fframe_live_p): Alternative defn for not MULTI_FRAME.
	(syms_of_frame): Call defsubr for it.

	* process.c: Doc fixes.

	* xterm.c (x_wm_set_size_hint): Always set PWinGravity.
	Rename the args.  Compute x and y fields from negative positions.
	Use XGetWMNormalHints if X11R4 or newer.
	(x_make_frame_visible): Call x_set_offset only if not USE_X_TOOLKIT.
	(x_make_frame_invisible): Call x_wm_set_size_hint.
	(x_set_offset): Pass 0 as 3rd arg to x_wm_set_size_hint.
	(x_set_window_size): Likewise.  Set win_gravity field here if nec.

	* xfns.c (Fx_create_frame): Pass 0 as 3rd arg to x_wm_set_size_hint.
	(x_figure_window_size): Fix typo setting XNegative.

	* minibuf.c (Fminibuffer_complete): Add third arg to Fset_window_start.

	* buffer.c (init_buffer_once): Initialize buffer_file_type field right.

	* m/dos386.h (HAVE_MOUSE): Defined.
	(PURESIZE): Increase value.

	* xdisp.c (decode_mode_spec): Fix handling of `%t'.

	* msdos.c, dosfns.c: Finish downcasing mouse_init1, mouse_off,
	mouse_check_moved, mouse_pressed, mouse_released, mouse_on, mouse_init.

	* dispnew.c (update_frame): Fix previous change:
	Unconditionally bzero at the end.

Fri Apr 29 00:38:09 1994  Morten Welinder  (terra@diku.dk)

	* msdos.c (visible_bell): Now static.  Make the asm volatile.
	Don't expect register %gs to survive calls to other functions
	(just to be safe, %gs will survive at present).

	* keyboard.c (make_lispy_movement): if HAVE_MOUSE then include
	the mouse handling code.
	* msdos.c (glyph_to_pixel_coords, pixel_to_glyph_coords) new
	functions imitating those in xterm.c.

	* s/msdos.h (getppid): Definition deleted.

	* msdos.c (dos_rawgetc): Key numbers are biased by 0xff00.

	* dosfns.c (Fmode25, Fmode4350): Clean up the coding and return
	a well-defined value.
	(syms_of_dosfns): Doc fix.

Fri Apr 29 01:16:04 1994  Karl Heuer  (kwzh@hal.gnu.ai.mit.edu)

	* keymap.c (Fsingle_key_description): Undo previous change.
	(describe_map): Skip string entries.

	* minibuf.c (do_completion): Initialize vars before gcpro.

Fri Apr 29 00:03:50 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* dispnew.c (update_frame): Move those assignments even farther down.

	* xterm.c (x_wm_set_size_hint): Don't set PMaxSize.
	Don't touch win_gravity field if no PWinGravity.

Thu Apr 28 22:51:04 1994  Karl Heuer  (kwzh@hal.gnu.ai.mit.edu)

	* print.c: Doc fixes.

	* keymap.c (describe_map_tree, describe_buffer_bindings): gcpro stuff.
	(describ_buffer_bindings): Delete unused code.

Thu Apr 28 21:05:23 1994  Per Abrahamsen  (abraham@research.att.com)

	* keymap.c (Fsingle_key_description): Accept strings as keys since
	the buffer menu uses them.

Thu Apr 28 14:12:32 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* dispnew.c (update_frame): Move assignments to current_frame
	and desired_frame.

	* floatfns.c (logb): Test HPUX, not hpux.

	* s/sunos4-1.h (LIBS_SYSTEM): #if 0'd.

	* xmenu.c (Fx_popup_menu): Doc fix.

	* xfns.c (x_window) [USE_X_TOOLKIT]: Call XSetWMHints.

Thu Apr 28 09:05:09 1994  Michael D. Ernst  (mernst@monozygote.research.microsoft.com)

	* fileio.c (inhibit-file-name-handers): Correct documentation.

Thu Apr 28 02:13:28 1994  Karl Heuer  (kwzh@hal.gnu.ai.mit.edu)

	* xterm.c (XTread_socket): Only top window cares about LeaveNotify.

	* frame.c (Fframe_parameters) [!MULTI_FRAME]: Unstub it again.

Thu Apr 28 00:35:25 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* emacs.c (syms_of_emacs): Doc fix.

	* callproc.c (child_setup): Test PRIO_PROCESS, as in sys_subshell.

	* m/hp800.h: Renamed from hp9000s800.h.
	(hp9000s800): Undo previous change.

	* process.c (create_process): If vfork fails, close forkin and forkout.

Wed Apr 27 22:33:41 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* xterm.c (x_make_frame_visible): Use XtMapWidget, not XtPopup.

	* m/hp9000s800.h (hp800): Define this instead of hp9000s800.

	* Makefile.in.in (mostlyclean): Remove liblw.a.

	* lread.c (read1): Allow `\C- ' and `\C-?'.

Wed Apr 27 15:15:51 1994  Karl Heuer  (kwzh@hal.gnu.ai.mit.edu)

	* unexmips.c (unexec): Cast pointers.
	Fix error message.

	* Makefile.in.in: Use C-style comments.

	* frame.c (Fframe_parameters) [!MULTI_FRAME]: Replace with stub.
	(Fframe_parameters, Fmodify_frame_parameters) [!MULTI_FRAME]:
	Remove extra docstring.

Wed Apr 27 00:46:36 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* s/sunos4-0.h (LD_SWITCH_SYSTEM): Undo previous change.

	* xterm.c (XTread_socket, case ClientMessage): Don't call
	XSetInputFocus if event is not for an existing frame.

	* xmenu.c (xmenu_show, xdialog_show):
	If we unread some events, set interrupt_input_pending.

	* xterm.c (XTread_socket) [USE_X_TOOLKIT]: Never pass motion
	events to the toolkit.

	* CONFIGURATION now comes via config.h.
	* Makefile.in.in (emacs.o): Use the default .c.o command.
	(configuration): Make variable deleted.
	* config.h.in (CONFIGURATION): Add #undef.

	* xterm.c (XTread_socket) [USE_X_TOOLKIT]: Undo previous change.
	(x_wm_set_size_hint): Do set max_height, max_width, and PMaxSize flag.

Tue Apr 26 17:15:45 1994  Karl Heuer  (kwzh@hal.gnu.ai.mit.edu)

	* process.c (create_process) [HAVE_TERMIOS && LDISC1]: Use tcsetattr.

Tue Apr 26 05:28:44 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* alloc.c (mark_object, case frame): Mark menu_bar_vector field.

Mon Apr 25 18:04:44 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* keyboard.c (Vunread_command_events):
	Renamed from unread_command_events.
	All uses changed.
	* command.h (Vunread_command_events): Renamed.
	* lread.c (read_filtered_event): Use Vunread_command_events.
	* minibuf.c (temp_echo_area_glyphs): Use Vunread_command_events.

	* keyboard.c (read_char): Don't use menus if we have events waiting.

	* xterm.c (XTread_socket) [USE_X_TOOLKIT]: Let toolkit handle
	menu bar click. 

Mon Apr 25 16:29:45 1994  Karl Heuer  (kwzh@hal.gnu.ai.mit.edu)

	* insdel.c: Use PT, not point.
	(gap_left, gap_right, adjust_markers): Make these functions static.
	(adjust_point): New function.
	(insert_1, insert_from_string_1, del_range_1): Use it.

	* xterm.c (x_term_init): Add explicit cast.
	(XTmouse_position): Don't use last_mouse_frame if it's dead.
	(XTread_socket): Ditto.

	* textprop.c (F*_property_change): Typecheck limit argument.

Mon Apr 25 00:11:16 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* xdisp.c (syms_of_xdisp): Set up Qmenu_bar_update_hook.
	(update_menu_bar): Run that hook.
	Fix failure to update menu bar when w->update_mode_line was nil.

	* frame.h (struct frame): New fields menu_bar_vector and
	menu_bar_items_used.
	* frame.c (make_frame): Initialize fields menu_bar_vector and
	menu_bar_items_used.

	* keyboard.c (menu_bar_item): Put a list of keymaps into the third
	slot of an item in menu_bar_items_vector.

Sun Apr 24 01:13:32 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* fileio.c (Finsert_file_contents): Fix accessing buffer_file_type
	since it is t or nil.  Change to handle t or nil as value
	of find-buffer-file-type.

	* buffer.c (Fkill_all_local_variables): Doc fix.

Sat Apr 23 12:32:25 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* process.c (create_process): Use SETUP_SLAVE_PTY only if pty_flag.
	Likewise for child_setup_tty.

	* window.c (Fselect_window): Use Fselect_frame.

	* frame.c (Fset_frame_selected_window): New function.
	(syms_of_frame): Set up Lisp function.

	* lisp.h (Vascii_canon_table, Vascii_eqv_table): Declared.

	* buffer.c (reset_buffer_local_variables): Use Vascii_eqv_table
	and Vascii_canon_table.

	* window.c: Implement special frames for specified buffers.
	(Vspecial_display_buffer_names, Vspecial_display_regexps)
	(Vspecial_display_function): New variables.
	(syms_of_window): Set up Lisp variables.
	(Fdisplay_buffer): Handle them.

Fri Apr 22 20:04:41 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* Makefile.in.in (alloca.o): Use config_h.
	(config_h): Use M_FILE and S_FILE.
	(S_FILE, M_FILE): New variables hold names of config files.

	* fileio.c (syms_of_fileio): New Lisp var inhibit-file-name-operation.
	(Ffind_file_name_handler): Obey that variable.  Use new meaning
	for inhibit-file-name-handlers.

	* config.h.in (HAVE_LIBRESOLV): Add #undef.
	* s/sunos4-1.h (LIBS_SYSTEM): Test HAVE_LIBRESOLV, not HAVE_RES_INIT.
	Do not test HAVE_GETHOSTNAME.

	* s/sunos4-1.h (LIBS_SYSTEM): Invert the HAVE_RES_INIT condition.

Fri Apr 22 19:55:22 1994  Karl Heuer  (kwzh@hal.gnu.ai.mit.edu)

	* fileio.c (Ffind_file_name_handler): New argument OPERATION.
	All callers changed.

Fri Apr 22 16:00:24 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* process.c (max_process_desc): New variable.
	(wait_reading_process_output): Don't look for process output
	beyond that many bits.
	(create_process, Fopen_network_stream, deactivate_process): Update it.
	(init_process): Initialize it.

	* frame.c (Fmouse_pixel_position, Fset_mouse_pixel_position):
	New functions.
	(syms_of_frame): Set up Lisp functions.

	* xterm.c (x_set_mouse_pixel_position): New function.

Thu Apr 21 18:56:10 1994  Simon Leinen  (simon@lia.di.epfl.ch)

	* process.c (send_process): If fpathconf fails, use 250.

Thu Apr 21 00:34:56 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* emacs.c (init_cmdargs): Check only for etc and lib-src subdirs
	when setting Vinstallation_directory.
	(syms_of_emacs): Make Lisp vars invocation-name, invocation-directory
	and installation-directory.

	* lread.c (init_lread): Maybe put build-time Lisp dirs on load-path.

	* callproc.c (init_callproc): Set Vdoc_directory like Vdata_directory.

	* lread.c (init_lread): Improve warning message.

	* xterm.c (x_make_frame_visible): Args to x_set_offset were swapped.

Wed Apr 20 16:38:41 1994  Karl Heuer  (kwzh@hal.gnu.ai.mit.edu)

	* xterm.h (x_top_window_to_frame): Declare this function.

Wed Apr 20 10:20:10 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* fns.c: Doc fixes.

	* Makefile.in.in (TAGS): Split off included tags file lisp/TAGS.
	(../lisp/TAGS): New target uses recursive make.
	(ctagsfiles, lisptagsfiles): New variables.

	* xfns.c (x_window): Test FRAME_EXTERNAL_MENU_BAR
	to decide on calling initialize_frame_menubar.

Wed Apr 20 12:52:15 1994  Francesco Potorti`  (pot@fly.cnuce.cnr.it)

	* m/delta.h (HAVE_SOCKETS): defined if HAVE_INET_SOCKETS is defined.

Wed Apr 20 04:32:47 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* frame.c (Fmodify_frame_parameters, Fframe_parameters): 
	Define even if not MULTI_FRAME.

	* config.h.in (HAVE_INET_SOCKETS): Add #undef.

	* xterm.c (XTread_socket): Delete the non-NEW_SELECTIONS code
	and simplify the toolkit conditional for those cases.

	* xterm.c (XTread_socket, case ClientMessage):
	Always use x_window_to_frame.

	* xfns.c (x_top_window_to_frame): New function.

Tue Apr 19 23:23:07 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* process.c (create_process): Call setsid only if pty_flag.

	* xterm.c (x_make_frame_invisible): Explicitly clear visible and
	iconified flags, as well as the async flags.

Tue Apr 19 20:23:52 1994  Karl Heuer  (kwzh@hal.gnu.ai.mit.edu)

	* keymap.c (describe_map): Merge with describe_map_2.
	(describe_map_tree, describe_map): Skip keymaps we've seen before.

	* keyboard.c (read_avail_input): Don't retry read.

Tue Apr 19 17:45:16 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* keyboard.c (Vlast_event_frame): Define unconditionally.
	(syms_of_keyboard): Always make the Lisp var.

	* Makefile.in.in (${etc}DOC): Delete redundant version.el from cmd.

Tue Apr 19 00:16:34 1994  Karl Heuer  (kwzh@hal.gnu.ai.mit.edu)

	* keyboard.c (read_avail_input): Test EINTR, not EAGAIN.
	Write loop as a do-while.

	* puresize.h (PURESIZE) [!MULTI_FRAME]: Increase to 200000.

Mon Apr 18 19:27:05 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* xterm.c (XTread_socket): Call XSetInputFocus.

Mon Apr 18 18:38:51 1994  Karl Heuer  (kwzh@hal.gnu.ai.mit.edu)

	* config.h.in: (EMACS_INT, EMACS_UINT): Omit if NOT_C_CODE.

Mon Apr 18 13:40:14 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* mem-limits.h (get_lim_data): Handle NO_LIM_DATA.

	* xterm.c (x_make_frame_invisible) [USE_X_TOOLKIT]: Use XtPopdown.
	(XTread_socket): Call _XEditResCheckMessages only if HAVE_X11R5.

	* m/convex.h (CRT0_DUMMIES): Ignore one arg.
	(LIBS_TERMCAP): Use the system's termcap.

	* process.c (create_process): Fix previous change.

Sun Apr 17 03:33:18 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* xfns.c (Xatom_editres_name): Declared.
	(Fx_open_connection): Initialize it.
	* xterm.c (Xatom_editres_name): Variable defined.
	(XTread_socket): Handle that kind of message.
	(x_term_init): Specify -name option in XtAppInitialize.

	* xterm.c (Qface, Qmouse_face): Supply missing Lisp_Object.

	* config.h.in (EMACS_INT, EMACS_UINT): New typedefs.

	* casetab.c (set_case_table): Handle nil for EQV with non-nil CANON.
	(Fcase_table_p): Accept nil for EQV with non-nil CANON.

	* keyboard.c (read_avail_input): Test both aix386 and _BSD.

	* window.c (set_window_width):
	Don't delete root window for being too narrow.

	* xterm.c (dumpglyphs): When HL=2, check explicitly for using
	the frame's default font or not.

	* keyboard.c (read_char_x_menu_prompt): Don't check for value = nil
	if value was originally a cons.

	* xmenu.c (xmenu_show): Fix typo in last change.

Sat Apr 16 02:50:27 1994  Karl Heuer  (kwzh@hal.gnu.ai.mit.edu)

	* frame.c (Fmouse_position): Don't clip.
	* keyboard.c (make_lispy_movement): Don't clip.

Sat Apr 16 00:50:41 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* s/netbsd.h: Add NO_SHARED_LIBS conditional.
	* s/freebsd.h: Rewrite to use netbsd.h and define NO_SHARED_LIBS.

	* keyboard.c (read_avail_input): Fix previous change--test _BSD.

	* data.c (Fsetq_default): Doc fix.

	* eval.c (Fsetq): Doc fix.

	* Makefile.in.in (configuration): Use SET_MAKE to get
	the value of $(MAKE).

Fri Apr 15 17:38:30 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* keyboard.h (map_prompt): Declared.

	* xmenu.c (xmenu_show): Don't cons on subprefix_stack[j] if nil.

	* keyboard.c (read_avail_input): Don't generate SIGHUP of aix386;
	only on other AIX systems.

	* xterm.c (XTread_socket):
	For UnmapNotify, use x_any_window_to_frame.

	* process.c (create_process): Test TIOCSETD along with NTTYDISC.

	* frame.c (Fset_frame_position): Pass new arg to x_set_offset.

	* xterm.c (x_set_offset): New arg CHANGE_GRAVITY.
	(x_make_frame_visible): Pass new arg.

	* xfns.c (Fx_create_frame): Delete excess args to x_wm_set_size_hint.

	* xterm.c (x_wm_set_size_hint): Args spec_x and spec_y deleted.
	(x_set_offset, x_set_window_size): Don't pass those args.

	* fileio.c (Finsert_file_contents): Fix test for unchanged file.

	* xterm.c (x_destroy_window): Just clear out mouse_face... vars.

	* keyboard.c (syms_of_keyboard): Init and staticpro system_key_syms.
	(modify_event_symbol): Use the cdr of the alist entry.
	Whenever value is nil, intern a new symbol.

	* Makefile.in.in (LIBX): Put LIBXT after LD_SWITCH_X_SITE.

Fri Apr 15 15:11:10 1994  Karl Heuer  (kwzh@hal.gnu.ai.mit.edu)

	* xdisp.c (fix_glyph) [HAVE_X_WINDOWS]: When glyph face is 0, use
	the computed face as given.

	* keyboard.c (read_avail_input): Fix comment delimiter.

	* m/pmax.h (C_SWITCH_X_MACHINE): add -DNeedVarargsProrotypes=0.

Thu Apr 14 21:03:23 1994  Karl Heuer  (kwzh@hal.gnu.ai.mit.edu)

	* scroll.c (calculate_scrolling): Add explicit casts.

Thu Apr 14 00:45:53 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* xterm.c (x_wm_set_size_hint): Use win_gravity from frame.

	* xterm.h (x_display): New field win_gravity.
	* xfns.c (Fx_create_frame): Set win_gravity field.

	* xfns.c (x_window, both versions):
	Don't call x_calc_absolute_position.
	* xterm.c (x_make_frame_visible): Call x_set_offset.

	* xterm.c (x_make_frame_visible): Don't call XMapSubwindows.
	(x_iconify_frame): Likewise.

	* s/isc4-0.h (LIBS_SYSTEM): Defined.

	* keyboard.c (make_lispy_event): Put mouse event code
	into MULTI_FRAME conditional.

	* xfns.c (Fx_list_fonts): Error if non-X frame used.

	* xdisp.c (update_menu_bar): Take frame as arg.
	(update_menu_bars): Function deleted.
	(prepare_menu_bars): Call update_menu_bar; do it for all frames.
	Simplify computation of all_windows; ignore irrelevant criteria.

	* xterm.h (HAVE_X11R4): If we define HAVE_X11R5, define this too.

	* xterm.c (pending_autoraise_frame): New variable.
	(x_new_focus_frame): Don't autoraise here; just set that var.
	(XTread_socket): Raise that frame here.

Wed Apr 13 17:19:30 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* emacs.c (inherited_pgroup): Conditionalize on BSD_PGRPS.

	* s/netbsd.h (TABDLY): Defined.

	* doc.c, fileio.c, unexsunos4.c [HAVE_UNISTD_H]: Include unistd.h.

	* dired.c (Ffile_attributes): Cast st_size to int.

	* xmenu.c (last_menu_bar_item_end): New variable.
	(xmenu_show): Set that var.
	(other_menu_bar_item_p): Return 0 if mouse is not in any menu bar item.

	* keymap.c (describe_map_tree): Fix call to Flookup_key.

	* xfns.c (x_window): Don't call initialize_frame_menubar
	if no menu bar.
	(Fx_create_frame): Default menu-bar-lines parm before calling x_window.

Wed Apr 13 13:59:32 1994  Karl Heuer  (kwzh@hal.gnu.ai.mit.edu)

	* dispnew.c (Vglyph_table): Doc fix.

	* frame.c (Fmouse_position) [MULTI_FRAME]: Use pixel_to_glyph, not
	glyph_to_pixel.  Skip the conversion if args are nil.
	[!MULTI_FRAME]: All results are nil.  Remove extra docstring.

	* window.c (Fnext_window, Fprevious_window, Fdisplay_buffer): Test
	MULTI_FRAME when frame-walking.
	(Fset_window_configuration): Only call X fns if HAVE_X_WINDOWS.

	* fns.c (Fy_or_n_p, Fyes_or_no_p): Test HAVE_X_MENU in popup code.

Wed Apr 13 02:20:44 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* indent.c (compute_motion): Do not abort if window shows some
	other buffer.
	(Fcompute_motion): Use whatever buffer is current.

Tue Apr 12 12:02:07 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* s/bsd4-2.h (BSD): Give it a number as definition.

	* s/sol2-3.h: Fix #include file name.

	* xterm.c (x_destroy_window): Call clear_mouse_face if necessary.

	* xmenu.c (xmenu_show, xdialog_show): Add casts in assignments
	to widget_value fields from string contents.
	(dispatch_dummy_expose): Cast arg to XtDispatchEvent.
	[!USE_X_TOOLKIT] (xmenu_show): Right-justify char equivalents.
	Use alloca for concatenated strings, if alloca is fast.

	* lisp.h (Fprocess_send_eof, Foverlay_get): Declared.

	* keymap.c (Fkey_binding): Declare accept_default.

	* sysdep.c (sys_siglist) [sun]: Check SIGFREEZE and SIGTHAW defined.

Tue Apr 12 00:53:28 1994  Per Bothner  (bothner@cygnus.com)

	Provide a hook for elisp to signal a changed window size
	to a process inferior.
	* sysdep.c (set_window_size):  New function.
	* process.c (Fset_process_window_size):  New function.

Tue Apr 12 00:39:12 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* eval.c (specbind): Use find_symbol_value.

	* xfaces.c (frame_update_line_height): Don't call x_set_window_size.
	Return 1 if line_height changed.
	(Fset_face_attribute_internal): Call x_set_window_size here if nec.
	* xterm.c (x_new_font): Always call x_set_window_size.

	* xmenu.c (xmenu_show) [USE_X_TOOLKIT]: Use XtTranslateCoords.

	* process.c (send_process): Test pty_flag field for nil, not 0.

Mon Apr 11 18:40:25 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* s/sunos4-0.h (LD_SWITCH_SYSTEM): Alternate definition if __GNUC__.

	* callproc.c: If we include fcntl.h, define INCLUDED_FCNTL.
	* systty.h: Check for INCLUDED_FCNTL already defined.

	* xterm.c (x_wm_set_size_hint): If PROMPTING is 0,
	copy the old win_gravity field.
	If USPosition is set, don't set PWinGravity.

	* keyboard.c (read_avail_input): Separate local var n_to_read
	so that reading doesn't clobber that info when it sets nread.

	* s/isc4-0.h (LIBS_SYSTEM): Defined.

	* emacs.c (main): Fix typo in prev. change.

	* Makefile.in.in (temacs): Include ${ALL_LDFLAGS} within
	the call to YMF_PASS_LDFLAGS.

Mon Apr 11 17:41:56 1994  Karl Heuer  (kwzh@hal.gnu.ai.mit.edu)

	* keyboard.c (make_lispy_event): Initialize item.

	* indent.c (vmotion): Use minibuf_prompt_width despite window-start.

	* print.c (printchar, strout): Use FRAME_PTR, not struct frame *.

	* frame.c (Fmouse_position) [!MULTI_FRAME]: Declare col and row.

Mon Apr 11 17:09:46 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* keyboard.c (make_lispy_movement): Conditionalize on MULTI_FRAME.
	(kbd_buffer_get_event): Call make_lispy_movement only if MULTI_FRAME.

	* xselect.c (x_decline_selection_request): Call XFlushQueue.

	* eval.c (Fsetq): Doc syntax fix.
	* print.c (syms_of_print): Doc syntax fix.
	* editfns.c (Fuser_real_login_name): Doc syntax fix.
	* data.c (Fsetq_default, Fmake_local_variable): Doc syntax fix.

Sun Apr 10 15:15:08 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* xterm.c (x_wm_set_size_hint): If change_gravity is 0,
	just don't set the gravity.

Sat Apr  9 01:02:22 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* xterm.c (dumpglyphs): Clear any extra pixel rows below the text.

	* xfns.c (x_figure_window_size): Don't call x_calc_absolute_position.
	(x_window): Separate into two alternative definitions.
	Call x_calc_absolute_position here.

	* widget.c (EmacsFrameSetCharSize): Do not attempt to preserve
	the window position.

	* xfns.c (Fx_list_fonts): Doc fix.

	* buffer.c (Vafter_change_functions, Vbefore_change_functions):
	New variables.
	(syms_of_buffer): Set up Lisp vars.
	* buffer.h (Vafter_change_functions, Vbefore_change_functions):
	Declared.

	* insdel.c (before_change_functions_restore): 
	(after_change_functions_restore): New functions.
	(signal_before_change): Handle Vbefore_change_functions.
	(signal_after_change): Handle Vafter_change_functions.

	* cmds.c (internal_self_insert): Test Vafter_change_functions,
	Vbefore_change_functions.

	* xfaces.c (frame_update_line_height): Check param_faces[i] not null.

	* emacs.c (main): Handle EXTRA_INITIALIZE.

	* s/isc4-0.h: New file.

	* keymap.c (get_keymap): Pass 1 as ERROR to get_keymap_1.
	(get_keyelt): New arg AUTOLOAD means load keymaps indirected thru.
	All callers changed; most pass 0.
	(Fdefine_key, Flookup_key): Load all the keymaps we look in.

	* editfns.c (make_buffer_string): Copy properties whenever we
	have some, even if they don't change.

	* xterm.c (x_display_box_cursor): Explicitly clear full height of line.
	(dumpglyphs): New arg just_foreground.  Callers changed.
	(x_set_window_size): Call XSync.

	* xterm.c (note_mouse_highlight): Do nothing if buffer has changed.

	* xterm.c (x_new_font): Fix setting line_height.

	* Support fonts of different heights, using tallest as line height:

	* xfaces.c (frame_update_line_height): New function.
	(Fset_face_attribute_internal): Call that.

	* xterm.c (x_new_font): If frame is new, set line_height field.
	Otherwise call frame_update_line_height.

	* xterm.h (struct x_display): New field line_height.
	(VERTICAL_SCROLL_BAR_PIXEL_HEIGHT, PIXEL_TO_CHAR_ROW)
	(CHAR_TO_PIXEL_ROW): Use line_height field.

	* xterm.c (stufflines, scraplines, dumprectangle, x_do_pending_expose)
	(pixel_to_glyph_coords, x_draw_box, clear_cursor, x_display_bar_cursor)
	(x_set_resize_hint, x_set_mouse_position, x_wm_set_size_hint)
	(XTclear_end_of_line, redraw_previous_char): Use line_height field.
	* xfns.c (x_char_height): Use line_height field.
	* widget.c (get_default_char_pixel_size): Use line_height field.
	* dispnew.c (update_line): Use line_height field.
	* xmenu.c (Fx_popup_menu): Use line_height field.

Sat Apr  9 00:14:18 1994  Karl Heuer  (kwzh@hal.gnu.ai.mit.edu)

	* indent.c (Fvertical_motion): Use window arg, not selected_window.

Fri Apr  8 11:47:03 1994  Frederic Pierresteguy  (fp@hal.gnu.ai.mit.edu)

	* xterm.c (show_mouse_face): Change the mouse cursor accordingly.

	* xterm.h (cross_cursor): New field for struct x_display.

	* xfns.c (syms_of_xfns): Define Vx_cross_pointer_shape.
	(Vx_cross_pointer_shape): New variable.
	(Vx_cross_pointer_shape): Create a mouse face cursor for the mouse-face
	properties.

Fri Apr  8 00:37:05 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* xmenu.c (Fx_popup_dialog): Doc fix.
	(list_of_items): Handle nil in item list as left/right boundary.
	(push_left_right_boundary): Record the boundary.
	(xmenu_show): Disregard a boundary if any.
	(xdialog_show): Really obey a boundary.

Thu Apr  7 20:40:41 1994  Karl Heuer  (kwzh@hal.gnu.ai.mit.edu)

	* intervals.h (Qintangible): New symbol, replacing Qhidden.
	* textprop.c (syms_of_textprop): Initialize it.
	* intervals.c (set_point): Skip past intangible regions.

	* term.c (system_uses_terminfo): New variable.
	(syms_of_term): New function, to initialize it.
	* emacs.c (main): Call syms_of_term.

	* termhooks.h (enum event_kind): Add buffer_switch_event.
	* keyboard.c (kbd_buffer_get_event): Make it lispy.
	(record_asynch_buffer_change): New.  Store it in the event queue.
	* process.c (read_process_output): If buffer changes, record that fact.

	* minibuf.c (Vminibuffer_exit_hook): New variable.
	(read_minibuf): Run hook when exiting minibuffer.

	* xdisp.c (copy_part_of_rope): Replace non-glyph with 0.

	* insdel.c (insert_1): New function, extracted from insert.
	(insert_from_string_1): Likewise, taken from insert_from_string.
	(insert, insert_from_string): Call the new functions.
	(insert_before_markers, insert_from_string_before_markers): Adjust
	the markers before calling the after-change function.

Thu Apr  7 02:25:51 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* scroll.c (struct matrix_elt): Use int, not short.
	Use unsigned char for insertcount and deletecount.
	(INFINITY): Increase to 1000000.

Wed Apr  6 22:01:50 1994  Karl Heuer  (kwzh@hal.gnu.ai.mit.edu)

	* minibuf.c (Fminibuffer_prompt_width): Undo previous change.
	* xdisp.c (display_text_line): minibuffer_prompt_width is a
	distance, not an absolute position.

	* editfns.c (Fformat): Reword confusing error message.
	* doprnt.c (doprnt): Likewise.

	* eval.c (Fsetq): Doc fix.

Tue Apr  5 18:52:30 1994  Karl Heuer  (kwzh@hal.gnu.ai.mit.edu)

	* xdisp.c (display_string): Allow for hpos < 0 when clearing array.

	* indent.c (vmotion): Don't use minibuf_prompt_width if
	window-start has suppressed the prompt.

	* minibuf.c (Fminibuffer_prompt_width): Allow for negative value.

	* buffer.c (Fget_buffer_create): Disallow empty string.

	* keymap.c (describe_buffer_bindings): Move XSYMBOL to after SYMBOLP.
	Exclude trailing null in string copies.

	* indent.c (compute_motion): Add window argument.  All callers changed.

	* minibuf.c (do_completion): gcpro some things.

	* minibuf.c, xdisp.c: Use PT, not point.

Mon Apr  4 22:45:58 1994  Karl Heuer  (kwzh@hal.gnu.ai.mit.edu)

	* textprop.c (Fget_char_property): Doc fix.

	* dired.c (file_name_completion): Honor completion-regexp-list.

	* search.c (Freplace_match): Don't capitalize unless all matched
	words are capitalized.

	* buffer.c (verify_overlay_modification): Run modification-hooks
	for any deletion that intersects the overlay.

Mon Apr  4 01:28:18 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* fileio.c (Fdo_auto_save): Don't turn off auto save mode.
	Instead, store -1 in b->save_length.  And don't auto save
	if there is -1 there.

	* xterm.c (note_mouse_highlight): Temporarily widen the buffer.

	* xdisp.c (display_text_line): Rename startp to leftmargin.
	Use that, not p1start, when checking for char off left edge.

	* dispnew.c (verify_charstarts): Handle truncation of lines.

	* xdisp.c (mark_window_display_accurate, redisplay):
	Set window_end_valid to the buffer displayed, not Qt.
	* xterm.c (note_mouse_highlight): Check window still shows that buffer.

Sun Apr  3 15:02:56 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* xterm.c (show_mouse_face): Turn off cursor only if it's
	in the area being manipulated.
	(XTupdate_begin): Don't turn off highlight if we aren't updating
	the window that it is in.

	* buffer.c (overlays_at): Fix previous change.

	* lisp.h (gc_in_progress): Declared.

	* xterm.c (note_mouse_highlight): Do nothing if gc_in_progress.
	Set mouse_face_deferred_gc when that case arise.
	(XTframe_up_to_date): If mouse_face_deferred_gc, redo highlighting.

	* xdisp.c (display_text_line): Properly handle charstarts for hscroll,
	and for continuation in mid character.
	(message2): Call frame_up_to_date_hook.

	* xterm.c (undefer_mouse_highlight, defer_mouse_highlight): New fns.
	* alloc.c (Fgarbage_collect): Call ..._mouse_highlight.

	* buffer.c (overlays_at): Use XGCTYPE.

	* buffer.h (OVERLAY_POSITION): Use XGCTYPE.

	* xmenu.c (Fx_popup_dialog): If POSITION is t, use selected frame.

Sat Apr  2 03:40:12 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* xdisp.c (redisplay): do_verify_charstarts controls whether to
	call verify_charstarts.
	Fix one-off when checking for the last line.

	* xterm.c (note_mouse_highlight): Reject out-of-range pos value
	before it causes an error.

	* dispnew.c (verify_charstarts): Count right for continued lines.
	(direct_output_for_insert): Add charstarts entry after the new char.
	Use the right point value for the inserted character.

	* xdisp.c (display_text_line): Always store in charstart
	even if at endp.  When clearing charstart, do the whole width.

	* dispnew.c (scroll_frame_lines): When updating charstarts,
	treat all columns alike--don't zero out any.
	Fix end tests of loops over i.
	(adjust_window_charstarts): Fix typo.

	* xterm.c (fast_find_position): Always return coords within the window.

	* xdisp.c (redisplay): Call verify_charstarts.

	* dispnew.c (verify_charstarts): New function.

	* xdisp.c (redisplay): Don't call adjust_window_charstarts
	if on last text line of window.

	* xterm.c (note_mouse_highlight): Handle disable_mouse_highlight.

Fri Apr  1 22:54:01 1994  Karl Heuer  (kwzh@hal.gnu.ai.mit.edu)

	* buffer.c (list_buffers_1): Set buffer contents, then mode.

Fri Apr  1 14:15:57 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* dispnew.c (scroll_frame_lines): Fix previous changes.

Fri Apr  1 08:06:29 1994  Frederic Pierresteguy  (fp@hal.gnu.ai.mit.edu)

	* xterm.c (x_wm_set_size_hint): Add USE_X_TOOLKIT conditional and call
	XtGetValues to get the width and the height of the Emacs frame.

	* xdisp.c (update_menu_bar): Pass 0 to set_frame_menubar.

	* widget.c (EmacsFrameSetCharSize): Clean up code.
	Replace XtVaSetValues by XtSetValues.

Fri Apr  1 03:08:23 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* xterm.c (construct_menu_click, construct_mouse_click): 
	Use XSET when setting result->x and result->y.

	* xmenu.c (xmenu_show): Undo part of March 11 change:
	Do call lw_destroy_all_widgets at the end.

	* dispnew.c (scroll_frame_lines): Typo in previous change.
	Arg POS_ADJUST replaced with arg NEWPOS.
	* xdisp.c (try_window_id): Pass new arg to scroll_frame_lines.

	* xdisp.c (redisplay): In previous change, handle case where
	no newline follows.

	* xterm.c (note_mouse_highlight): Use the value from sort_overlays.
	Make the window's buffer current temporarily.
	window_end_pos is relative to Z, not ZV.

Thu Mar 31 19:07:52 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* dispnew.c (adjust_window_charstarts): New function.
	(direct_output_for_insert): Call it.
	(make_frame_glyphs): If EMPTY, don't leave junk in ->total_charstarts.

	* xdisp.c (redisplay): Call adjust_window_charstarts
	to update the charstarts of following lines.

Thu Mar 31 17:18:42 1994  Karl Heuer  (kwzh@hal.gnu.ai.mit.edu)

	* callproc.c (child_setup): Check out==err when relocating fds.

Thu Mar 31 11:45:48 1994  Frederic Pierresteguy  (fp@hal.gnu.ai.mit.edu)

	* xfns.c (x_window) [USE_X_TOOLKIT]: When doing geometry management,
	don't compute the size of the menubar if there is no menubar.

Thu Mar 31 11:33:04 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* xterm.c (XTread_socket, MotionNotify and LeaveNotify cases):
	If not in any frame, call clear_mouse_face.

Thu Mar 31 08:08:56 1994  Frederic Pierresteguy  (fp@geech.gnu.ai.mit.edu)

	* xterm.h: Define HAVE_X11R4 if AIX3_2 is defined.

	* xfns.c (x_window) [USE_X_TOOLKIT]: New args window_prompting and 
	minibuffer_only.
	Don't pass top_pos and left_pos to XtCreatePopupShell.
	Call initialize_frame_menubar before creating the Emacs frame if it is
	not the minibuffer. Call XtManageChild for the menubar widget if any.
	Compute some geometry management.
	(Fx_create_frame): Pass window_prompting and minibuffer_only to 
	x_window.
	Don't call x_wm_set_size_hint.
	Don't call initialize_frame_menubar.

	* xmenu.c (set_frame_menubar): New arg, first_time.
	Don't update the menubar the first time it is created via x_window.
	(initialize_frame_menubar): Pass 1 to set_frame_menubar.

	* widget.c (set_frame_size): Dont compute any geometry management.

Thu Mar 31 03:33:18 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* xterm.c (x_term_init): Set frame_up_to_date_hook.
	(XTframe_up_to_date): New function.
	* termhooks.h (frame_up_to_date_hook): Declared.
	* term.c (frame_up_to_date_hook): Defined.
	* xdisp.c (redisplay): Call frame_up_to_date_hook.

Wed Mar 30 13:51:05 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* scroll.c (do_scrolling): Handle charstarts like glyphs.

	* dispnew.c (scroll_frame_lines): Handle charstarts like glyphs.
	(direct_output_for_insert): Likewise.
	(preserve_other_columns): Likewise.

	* systty.h (INCLUDED_FCNTL): Define, if include fcntl.h.
	* xterm.c [INCLUDED_FCNTL]: Don't include fcntl.h again.

Wed Mar 30 00:21:30 1994  Karl Heuer  (kwzh@hal.gnu.ai.mit.edu)

	* minibuf.c (Fminibuffer_prompt, Fminibuffer_prompt_width): New funcs.

Tue Mar 29 21:29:07 1994  Karl Heuer  (kwzh@hal.gnu.ai.mit.edu)

	* indent.c (Fcompute_motion): Doc fix.
	(Fcompute_motion): Don't use XFASTINT on possibly-negative coords.

Tue Mar 29 21:08:59 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* dispnew.c (update_line): Update charstarts like glyphs.

Tue Mar 29 19:48:57 1994  Karl Heuer  (kwzh@hal.gnu.ai.mit.edu)

	* systime.h (EMACS_TIME_NEG_P): Cast to signed.

Tue Mar 29 03:16:38 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* xterm.c (XTupdate_begin): Turn off mouse face display, and defer it.
	(XTupdate_end): Undefer.
	(mouse_face_defer): New variable.
	(mouse_face_mouse_frame, mouse_face_mouse_x, mouse_face_mouse_y):
	New variables.

	* xfaces.c (compute_char_face): New arg MOUSE.
	(Qmouse_face): New variable.
	(syms_of_xfaces): Initialize Qmouse_face.
	* xterm.c (dumpglyphs): Handle HL = 3 by using mouse_face_face_id.
	(note_mouse_movement): Check for mouse face.
	(show_mouse_face, fast_find_position): New functions.
	(clear_mouse_face): New functions.
	(mouse_face_beg, mouse_face_end, mouse_face_face_id): New variables.
	(mouse_face_window): New variable.
	(syms_of_xterm): Init and staticpro it.

	* xdisp.c (display_text_line): Pass new arg to compute_char_face.
	Fill in charstarts array.
	(display_string): Clear part of charstarts array.

Tue Mar 29 00:57:49 1994  Karl Heuer  (kwzh@hal.gnu.ai.mit.edu)

	* window.c (Fwindow_width): Delete unnecessary variable declarations.

	* indent.c (Fcompute_motion): Typecheck all arguments.

Tue Mar 29 00:19:24 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* xdisp.c (display_text_line): Fill in charstart values.

	* dispextern.h (struct frame_glyphs): New fields charstarts
	and total_charstarts.
	* dispnew.c (make_frame_glyphs):
	Initialize charstarts, total_charstarts.
	(free_frame_glyphs): Free those fields.

Mon Mar 28 18:01:48 1994  Karl Heuer  (kwzh@hal.gnu.ai.mit.edu)

	* xdisp.c (display_text_line): Handle selective display at window edge.

	* dired.c (file_name_completion): Don't step on dirname.

	* xterm.c (x_find_modifier_meanings): Skip zero entries.

Mon Mar 28 02:12:55 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* dired.c (file_name_completion): Protect things from GC.

	* buffer.c (verify_overlay_modification):
	Copy TAIL before a hook, in case the hook recenters the overlay lists.

	* s/dgux.h (LIBS_SYSTEM): Commented out.

Sun Mar 27 02:51:32 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* fileio.c (Vinhibit_file_name_handlers): New var.
	(syms_of_fileio): Set up Lisp var.
	(Ffind_file_name_handler): Obey the variable.

	* minibuf.c (Vcompletion_regexp_list): New var.
	(syms_of_minibuf): Set up Lisp var.
	(Ftry_completion, Fall_completions):
	Limit possible completions to strings matching those regexps.

	* search.c (Freplace_match): Doc fix.

Sat Mar 26 02:20:06 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* minibuf.c (read_minibuf): Return val via unbind_to.

Fri Mar 25 14:17:19 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* commands.h (this_command, last_command): Declared.

	* minibuf.c (Fminibuffer_complete): Scroll the completion window
	in some cases.

	* print.c (debug_print): New function.
	* .gdbinit (pr): Use debug_print.

Fri Mar 25 01:06:02 1994  Karl Heuer  (kwzh@hal.gnu.ai.mit.edu)

	* frame.c (Fframe_first_window): New function.

Thu Mar 24 19:29:49 1994  Karl Heuer  (kwzh@hal.gnu.ai.mit.edu)

	* editfns.c (Fformat): Validate number and type of arguments.

	* xmenu.c (xmenu_show): Enable asynchronous events.

	* keymap.c (Fwhere_is_internal): Skip duplicate keybindings.

	* xfns.c (x_report_frame_params): Sample visibility.
	(x_get_arg): Use downcased string in compare.

	* process.c (status_notify): Use assignment, not initialization.
	* textprop.c (add_properties, remove_properties): Ditto.
	* window.c (unshow_buffer, window_loop, Fdisplay_buffer): Ditto.
	* xdisp.c (x_consider_frame_title, decode_mode_spec): Ditto.
	* xfns.c (x_set_frame_parameters, x_get_arg, x_window,
	Fx_create_frame, Fx_create_frame): Ditto.
	* xselect.c (x_get_local_selection, x_handle_selection_request): Ditto.
	* xterm.c (x_window_to_scroll_bar, x_new_font): Ditto.

Thu Mar 24 02:34:37 1994  Frederic Pierresteguy  (fp@mole.gnu.ai.mit.edu)

	* xfns.c (Fx_create_frame): Add USE_X_TOOLKIT conditional around the 
	call to initialize_frame_menubar.

Wed Mar 23 23:09:15 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* intervals.c (verify_interval_modification): For insertion in
	middle of an interval, use the same criterion as between intervals
	for whether read-only forbids it.

Wed Mar 23 15:08:42 1994  Karl Heuer  (kwzh@hal.gnu.ai.mit.edu)

	* alloc.c (make_event_array): Use assignment, not initialization.
	* buffer.c (sort_overlays, Fmake_overlay): Ditto.
	* callint.c (check_mark, Fcall_interactively): Ditto.
	* callproc.c (call_process_cleanup, getenv_internal): Ditto.
	* cmds.c (internal_self_insert): Ditto.
	* data.c (store_symval_forwarding, Fsymbol_value): Ditto.
	* fileio.c (Finsert_file_contents): Ditto.
	* filelock.c (lock_file): Ditto.
	* frame.c (next_frame, prev_frame, other_visible_frames,
	Fdelete_frame): Ditto.
	* intervals.c (adjust_intervals_for_insertion,
	merge_properties_sticky, delete_interval): Ditto.
	* keymap.c (access_keymap, store_in_keymap, Fcopy_keymap,
	Fdefine_key, Faccessible_keymaps, Fwhere_is_internal): Ditto.
	* lread.c (read_filtered_event, intern): Ditto.
	* minibuf.c (read_minibuf): Ditto.
	* msdos.c (run_msdos_command): Ditto.

	* sysdep.c (reset_sys_modes): Turn off O_NDELAY.

	* window.c (Fscroll_up, Fscroll_down, Fscroll_other_window): Doc fix.

	* frame.c (do_switch_frame): Common code for Fselect_frame and
	handle_switch_frame.

	* xfns.c (x_get_focus_frame): New function.

Wed Mar 23 13:06:24 1994  Frederic Pierresteguy  (fp@geech.gnu.ai.mit.edu)

	* xmenu.c (update_frame_menubar): Function renamed from 
	update_one_frame_psheets.
	(initialize_frame_menubar): New function.
	(set_frame_menubar): Call menu_bar_items when items is NIL.

	* xfns.c (Fx_create_frame): Call initialize_frame_menubar.

Wed Mar 23 00:06:59 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* buffer.c (reset_buffer): Init auto_save_failure_time slot.

Tue Mar 22 23:51:23 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* keymap.c: (where_is_string, Fwhere_is): Deleted.
	(syms_of_keymap): Corresponding changes.

Tue Mar 22 16:58:12 1994  Karl Heuer  (kwzh@hal.gnu.ai.mit.edu)

	* keymap.c (Fdefine_key): Check for non-events in keyvector.

	* minibuf.c (read_minibuf): Don't redirect focus unless minibuf is
	on another frame.

	* lread.c (read1): Check for invalid modifier bits in a string.
	(unreadchar): Don't back up the pointer when unreading EOF.

Tue Mar 22 13:30:49 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* callproc.c (Fcall_process): Make sure to close descriptors.
	(call_process_cleanup): Always close descriptor.

Tue Mar 22 09:35:36 1994  Frederic Pierresteguy  (fp@mole.gnu.ai.mit.edu)

	* widget.c (set_frame_size): Put #if 0 around a lot of useless code.
	Compute explicitely the geometry of the toplevel widget.
	Call XtSetValues not XtVaSetValues.

Tue Mar 22 00:18:00 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* emacs.c (__do_global_ctors, __do_global_ctors_aux)
	(__do_global_dtors): Don't define if GCC_CTORS_IN_LIBC.
	(__CTOR_LIST__, __DTOR_LIST__): Likewise.

Mon Mar 21 23:23:09 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* keyboard.c (init_keyboard): Don't handle SIGINT if using X.

Mon Mar 21 20:20:21 1994  Karl Heuer  (kwzh@hal.gnu.ai.mit.edu)

	* keyboard.c (add_command_key): Use assignment, not initialization.
	(command_loop_1, read_char, kbd_buffer_store_event,
	kbd_buffer_get_event, make_lispy_event, make_lispy_movement,
	apply_modifiers_uncached, parse_modifiers, apply_modifiers,
	reorder_modifiers, read_key_sequence): Ditto.

Mon Mar 21 19:11:33 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* data.c (Qwholenump): New variable.
	(syms_of_data): Set and gcpro Qwholenump.
	* lisp.h (Qwholenump): Declared.
	(CHECK_NATNUM): Use Qwholenump.

Mon Mar 21 17:43:49 1994  Karl Heuer  (kwzh@hal.gnu.ai.mit.edu)

	* keymap.c (Fcopy_keymap): Account for menus and equiv-key cache.
	(Fkeymapp): Doc fix.

Mon Mar 21 01:56:39 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* data.c (Fstring_to_number): Doc fix.

Sun Mar 20 20:38:15 1994  Karl Heuer  (kwzh@hal.gnu.ai.mit.edu)

	* data.c (Fmake_local_variable): Void variables stay void.

Sun Mar 20 00:27:55 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* alloca.c, alloca.s, gmalloc.c: Make them symlinks again.

	* fns.c (Fy_or_n_p, Fyes_or_no_p): Call Fx_popup_dialog the new way.
	(Fyes_or_no_p): Always display just one dialog box
	whether or not USE_X_TOOLKIT.

Sat Mar 19 00:34:21 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* xmenu.c (xdialog_show): Delete args x, y.
	(Fx_popup_dialog): Don't pass those args; don't compute them.
	Second arg is now just one pane.  Lots of simplification.
	Always start by decoding POSITION arg to get a frame.
	[! USE_X_TOOLKIT]: Put the menu in middle of that frame.

	* s/freebsd.h (HAVE_TERMIOS, NO_TERMIO): Defined.

	* Makefile.in.in (emacs): rm emacs before the ln.
	(tagsfiles): Accept capital letters.

	* process.c (wait_reading_process_input, both versions): Don't call
	redisplay_preserve_echo_area unless do_display.

	* emacs.c (syms_of_emacs): Don't initialize Vinstallation_name
	and Vinstallation_directory.

	* fns.c (Fyes_or_no_p) [USE_X_TOOLKIT]: Display just one menu.

	* xmenu.c (Fx_popup_dialog, Fx_popup_menu): Require 2 args.
	(Fx_popup_dialog): Don't fail to set X, Y from POSITION.
	(xdialog_show): Call lw_modify_all_widgets properly.
	Generate dialog's name at run time to specify number of buttons.
	Report error if too many buttons to handle or if multiple panes.

Fri Mar 18 21:35:32 1994  Karl Heuer  (kwzh@hal.gnu.ai.mit.edu)

	* lisp.h (MAKE_GLYPH, GLYPH_CHAR, GLYPH_FACE): Handle termcap
	frames as well as X.
	(FAST_MAKE_GLYPH, FAST_GLYPH_CHAR, FAST_GLYPH_FACE): New macros.
	* xdisp.c (fix_glyph): Handle termcap frames as well as X.
	(display_text_line, copy_part_of_rope, display_mode_line): Ditto.
	* dispnew.c (direct_output_for_insert): Ditto.
	* xterm.c (dumpglyphs): Use the fast macros.

Fri Mar 18 01:57:20 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* xmenu.c (list_of_items): Arg to push_menu_item was missing.

Fri Mar 18 01:27:10 1994  Roland McGrath  (roland@churchy.gnu.ai.mit.edu)

	* Makefile.in.in (LIBXT): Add -lXext.

Fri Mar 18 00:19:14 1994  Karl Heuer  (kwzh@hal.gnu.ai.mit.edu)

	* s/netbsd.h (LD_SWITCH_SYSTEM): Undo previous change.

Thu Mar 17 23:18:01 1994  Jim Blandy  (jimb@totoro.bio.indiana.edu)

        * indent.c (compute_motion): Doc fixes.

Thu Mar 17 22:21:51 1994  Roland McGrath  (roland@churchy.gnu.ai.mit.edu)

	* Makefile.in.in (X_WINDOWS_SUPPORT): New macro.
	(lisp): Include X_WINDOWS_SUPPORT.  Also add version.el; it is no
	longer changed by building.

Thu Mar 17 17:37:52 1994  Karl Heuer  (kwzh@hal.gnu.ai.mit.edu)

	* process.c (create_process): Skip the ioctl if fd is -1.

	* lread.c (openp, Fload): GCPRO some things.
	* callproc.c (Fcall_process): Ditto.
	* process.c (Fstart_process): Ditto.

	* s/netbsd.h (LD_SWITCH_SYSTEM, HAVE_WAIT_HEADER): Define these.

Wed Mar 16 17:42:50 1994  Karl Heuer  (kwzh@hal.gnu.ai.mit.edu)

	* data.c (Fchar_or_string_p, Fintegerp, Fnatnump): Doc fix.

	* minibuf.c (read_minibuf): Disallow trailing junk.

Wed Mar 16 17:13:08 1994  Morten Welinder (terra@diku.dk)

	* fileio.c (Ffile_modes) [MSDOS]: set exec-bit based on file suffix.
	* s/msdos.h: use bcopy when moving gap.

Wed Mar 16 01:11:48 1994  Karl Heuer  (kwzh@hal.gnu.ai.mit.edu)

	* fns.c (Frandom): Eliminate bias in random number generator.

	* floatfns.c (FLOAT_TO_INT, FLOAT_TO_INT2, range_error2): New macros.
	(ceiling, floor, round, truncate): Use them.

Tue Mar 15 18:00:26 1994  Karl Heuer  (kwzh@hal.gnu.ai.mit.edu)

	* xdisp.c (redisplay): Don't consider minibuffer name for frame title.
	(update_menu_bar): Delete unused second argument.  Callers changed.

	* fileio.c (Frename_file, Fcopy_file, Fadd_name_to_file,
	Fmake_symbolic_link): Fix typo in previous change.

	* s/netbsd.h (LOCALTIME_CACHE): Define this symbol.

Tue Mar 15 13:45:51 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* fileio.c (Frename_file): Use RETURN_UNGCPRO when run handler.
	(Fcopy_file, Fadd_name_to_file, Fmake_symbolic_link): Likewise.

Tue Mar 15 01:34:08 1994  Karl Heuer  (kwzh@hal.gnu.ai.mit.edu)

	* xdisp.c (message1): Call message2 instead of duplicating code.

Mon Mar 14 16:34:24 1994  Karl Heuer  (kwzh@hal.gnu.ai.mit.edu)

	* floatfns.c (Flogb): Check for 0.0.  Emulate logb if needed.

	* xterm.c (x_scroll_bar_expose): Don't make the right border thicker.
	* xterm.h (VERTICAL_SCROLL_BAR_RIGHT_BORDER): Change from 3 to 2.

	* frame.c (terminal-frame) [! MULTI_FRAME]: Create this variable.

	* minibuf.c (read_minibuf): Make minibuffer frame visible when
	minibuffer activated.

	* frame.c (Fhandle_switch_frame): Ignore switch to dead frame.

	* fileio.c (Fread_file_name): Delete docstring of second version.
	* frame.c (framep, selected-frame, frame-char-height, frame-char-width,
	frame-pixel-height, frame-pixel-width, set-frame-height,
	set-frame-width, set-frame-size): Ditto.

	* buffer.c (buffer-display-table, buffer-undo-list): Ditto.

	* xdisp.c (redisplay_window): Avoid dividing negative numbers.
	* window.c (window_scroll, Fmove_to_window_line): Ditto.
	* search.c (search_buffer): Avoid boolean/integer confusion.

	* dispnew.c (Fredraw_frame) [! MULTI_FRAME]: Make noninteractive.

Mon Mar 14 15:00:59 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* xmenu.c (Fx_popup_dialog, Fx_popup_menu): Handle case where
	mouse_position_hook doesn't store anything.

Mon Mar 14 11:39:49 1994  Frederic Pierresteguy  (fp@mole.gnu.ai.mit.edu)

	* widget.c (EmacsFrameSetCharSize): Set the values of left_pos and
	top_pos to the values of the toplevel widget coordinates.

Sun Mar 13 17:58:04 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* xmenu.c (Fx_popup_dialog) [! USE_X_TOOLKIT]: Call Fx_popup_menu.

	* indent.c (Fvertical_motion): New optional arg WINDOW.
	* window.c (Fdelete_other_windows): Pass new arg to Fvertical_motion.
	(window_scroll, Frecenter, Fmove_to_window_line): Likewise.

	* fileio.c (Finsert_file_contents): Don't let same_at_end be less
	than same_at_start.

Sat Mar 12 19:35:08 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* puresize.h (PURESIZE): Reduce to 230000.

Fri Mar 11 18:13:13 1994  Karl Heuer  (kwzh@hal.gnu.ai.mit.edu)

	* floatfns.c (Fexpt): Delete extraneous `for' statement.

	* process.c (get_process): Allow arg to be a buffer object.

	* xdisp.c (x_consider_frame_title): New function, extracted from
	display_mode_line.
	(redisplay): Update frame title on iconified frames.

Fri Mar 11 05:13:25 1994  Frederic Pierresteguy  (fp@mole.gnu.ai.mit.edu)

	* xmenu.c (xdialog_show): New function to handle the display of dialog
	boxes.
	(Fx_popup_dialog): New function.
	(dialog_selection_callback): New function.
	(xmenu_show) [USE_X_TOOLKIT]: Don't call lw_destroy_all_widgets at the
	end.
	Do the work of construct_mouse_click in the ButtonRelease case.

	* Makefile.in (LIBXT): Add -lXext to the list.

	* widget.c (EmacsFrameSetCharSize): Call XawPanedSetRefigureMode.
	Call XtSetValues not XtVaSetValues.

	* fns.c (Fyes_or_no_p): Call Fx_popup_dialog instead of Fx_popup_menu.
	(Fy_or_n_p): Likewise.

Thu Mar 10 17:54:00 1994  Karl Heuer  (kwzh@hal.gnu.ai.mit.edu)

	* filelock.c (lock_superlock): Synchronize NFS cache.

	* search.c (Fre_search_forward, Fre_search_backward): Doc fix.

Thu Mar 10 00:00:02 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* indent.c (compute_motion): Initialize prev_hpos.

	* keyboard.c (command_loop_1): On entry, set this_command
	after running Vpost_command_hook.

	* puresize.h (PURESIZE): Increment to 240000.

	* xmenu.c (Fx_popup_menu): If POSITION is nil,
	don't require an open X connection.
	(single_keymap_panes, keymap_panes, menu_item_enabled_p):
	New arg NOTREAL.
	(Fx_popup_menu): Pass new arg (1 if POSITION is nil).
	(menu_item_enabled_p): If NOTREAL, always return t.

	* xmenu.c (single_keymap_panes) [!USE_X_TOOLKIT]:
	Append > to item_string if submenu.

Wed Mar  9 17:05:04 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* xmenu.c [USE_X_TOOLKIT]: Display submenus in Xt style.
	(menu_items): Record where submenus start and end.
	(menu_items_submenu_depth): New variable.
	(init_menu_items): Init it.
	(push_submenu_start, push_submenu_end): New functions.
	(grow_menu_items): New function.
	(push_menu_pane, push_menu_item): Use it.
	(push_menu_pane): Increment menu_items_n_panes only if depth is 0.
	(single_keymap_panes) [USE_X_TOOLKIT]: Record submenus in menu_items.
	(xmenu_show) [USE_X_TOOLKIT]: Give submenus to toolkit.

	* xdisp.c (display_mode_line): Highlight partial-width mode lines
	for a non-termcal frame.

	* lisp.h (GLYPH_MODE_LINE_FACE): New macro.

	* callproc.c: Don't kill remaining processes if child exits.
	(call_process_exited): New variable.
	(Fcall_process): Set it.
	(call_process_cleanup): Test it.

Wed Mar  9 01:02:07 1994  Karl Heuer  (kwzh@hal.gnu.ai.mit.edu)

	* window.c (Fselect_window): Undo previous minibuffer patch.
	* callint.c (Fcall_interactively): Don't select an active minibuffer.

Wed Mar  9 00:56:31 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* window.c (window_loop): Delete MULTI_FRAME
	conditional within the loop, spuriously added in prev change.
	Don't ignore invisible or iconified frames for GET_BUFFER_WINDOW;
	instead, let Fnext_window skip them if appropriate.

Tue Mar  8 23:16:53 1994  Karl Heuer  (kwzh@hal.gnu.ai.mit.edu)

	* window.c (Fselect_window): Don't select an inactive minibuffer.

Tue Mar  8 11:32:28 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* window.c (Fdisplay_buffer): If pop_up_frames != 0,
	consider just visible frames when looking for existing window.

	* undo.c (syms_of_undo): staticpro pending_boundary.

Tue Mar  8 01:20:31 1994  Roland McGrath  (roland@churchy.gnu.ai.mit.edu)

	* process.c (send_process) [_PC_MAX_CANON]: Also test #ifdef
	HAVE_FPATHCONF before trying to use fpathconf.
	* config.h.in: Add #undef HAVE_FPATHCONF.

	* term.c (term_get_fkeys_data): Variable removed.
	(term_get_fkeys_define_1, term_get_fkeys_define): Functions removed.
	(term_get_fkeys_address): New variable, to pass arg through
	condition-case.
	(term_get_fkeys): Set that to ADDRESS; just do condition-case
	around call to term_get_fkeys_1, ignoring all errors.
	(term_get_fkeys_1): New function, containing body of term_get_fkeys.
	Don't use term_get_fkeys_define_1; call Fdefine_key directly.

Tue Mar  8 00:02:18 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* window.c (Fprevious_window, Fnext_window): ALL_FRAMES = visible
	means consider only visible frames.
	(window_loop): Likewise for FRAMES.
	(Fget_buffer_window, Fget_largest_window, Fget_lru_window): Doc fix.
	(Fdelete_windows_on): Doc fix.

	* frame.c (next_frame, prev_frame): If MINIBUF is `visible',
	consider only visible frames.
	(Fnext_frame, Fprevious_frame): Doc fix.
	(syms_of_frame): Staticpro Qvisible.
	* lisp.h (Qvisible): Declared.

Mon Mar  7 19:03:50 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* indent.c (Fcompute_motion): New function.

	* window.c (Fwindow_width): Doc fix.

Mon Mar  7 13:38:51 1994  Karl Heuer  (kwzh@hal.gnu.ai.mit.edu)

	* doprnt.c (doprnt): Do the right thing for negative size spec.

	* minibuf.c (temp_echo_area_glyphs): Use quit_char, not C-g.
	(Fminibuffer_complete, Fminibuffer_complete_word): Doc fix.
	(get_minibuffer): Make name buffer large enough.

	* window.c (Fscroll_other_window): Doc fix.

Sun Mar  6 00:59:52 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* alloc.c (mark_object): Add no-op cast.

	* eval.c (error): Use doprnt.  Make buffer larger as necessary.

	* casefiddle.c (operate_on_word): Don't move point; store in *NEWPOINT.
	(Fupcase_word, Fdowncase_word, Fcapitalize_word):
	Set point after changing case.  Rename opoint to beg.

	* undo.c (pending_boundary): New variable.
	(syms_of_undo): Initialize it.
	(Fundo_boundary): Use pending_boundary.
	(record_insert, record_delete, record_property_change):
	Set pending_boundary.

Sat Mar  5 15:17:47 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* vmsproc.c: Include config.h, lisp.h, buffer.h, process.h, commands.h,
	errno.h and file.h.
	(write_to_vms_process): Change =- to -=.
	(create_process): Set status field instead of obsolete flags field.
	(child_sig): Likewise.

	* emacs.c (shut_down_emacs): Set Vrun_hooks to nil.
	* minibuf.c (read_minibuf):  Don't call Vrun_hooks if it is nil.
	* keyboard.c (command_loop_1, read_key_sequence, Fcommand_execute):
	Don't call Vrun_hooks if it is nil.
	* editfns.c (save_excursion_restore): Don't call Vrun_hooks if nil.
	* buffer.c (Fkill_buffer, Fkill_all_local_variables):
	Don't call Vrun_hooks if it is nil.

	* fileio.c (Fdo_auto_save): Doc fix.

	* lisp.h (ARRAY_MARK_FLAG): Define here.
	* alloc.c (ARRAY_MARK_FLAG): Not here.

Fri Mar  4 22:56:25 1994  Karl Heuer  (kwzh@hal.gnu.ai.mit.edu)

	* keyboard.c (command_loop_1): Fix misplaced assignment of
	last_point_position.

Fri Mar  4 16:20:16 1994  Paul Eggert  (eggert@twinsun.com)

	* data.c (isnan): New macro.
	(float_arith_driver): min and max yield NaN if any argument is a NaN.

Fri Mar  4 04:07:43 1994  Frederic Pierresteguy  (fp@mole.gnu.ai.mit.edu)

	* xmenu.c (update_one_frame_psheets): Call EmacsFrameSetCharSize to 
	force the paned widget to resize to the right value.
	(xmenu_show): No need to check a second time whether the mouse has
	moved to another menu bar item. This slows down execution.

	* widget.c (EmacsFrameSetCharSize): Don't call XtMakeResizeRequest. Use
	XtVaSetValues for geometry management.

Fri Mar  4 02:52:41 1994  Roland McGrath  (roland@churchy.gnu.ai.mit.edu)

	* xmenu.c [USE_X_TOOLKIT] (xmenu_show): Pass display to 
	XtWindowToWidget.

Thu Mar  3 23:18:35 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* search.c (skip_chars): Treat `-' as alias for space, if syntaxp.

	* fileio.c (Finsert_file_contents): Pass del_range_1 two ends,
	not a length.

Thu Mar  3 20:07:16 1994  Karl Heuer  (kwzh@hal.gnu.ai.mit.edu)

	* process.h (chan_process): Don't specify size.

Thu Mar  3 12:35:19 1994  Karl Heuer  (kwzh@mole.gnu.ai.mit.edu)

	* fileio.c (Fread_file_name):  Do the right thing when
	insert-default-directory is nil.
	Allow for doubled dollar signs in dir when computing pos.

	* commands.h: New variable last_point_position.
	* keyboard.c (command_loop_1): Set it to the value of point.
	* undo.c (record_delete): Save this value in the undo record,
	rather than the current value of point.)

	* buffer.c (Fget_file_buffer): Doc fix.

	* s/aix3-2.h (C_SWITCH_SYSTEM): Increase maxmem when using IBM's
	compiler.

Wed Mar  2 11:49:28 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* process.c (chan_process, Vprocess_alist): No longer static.
	* process.h (chan_process, Vprocess_alist): Declared.

	* puresize.h (PURESIZE) [MULTI_FRAME]: Incremented to 230000.

	* minibuf.c (Fdisplay_completion_list): Restore original buffer
	before running completion-setup-hook.

	* frame.c (Fdelete_frame): Don't initialize a Lisp_Object.
	Clean up line breaks.

	* process.c: Include unistd.h.
	(pty_max_bytes): New variable.
	(send_process): Send an eof after each pty_max_bytes bytes.

	* keyboard.c (menu_bar_items): When moving an item to the end,
	shift all the following ones forward one slot.

Wed Mar  2 00:00:24 1994  Karl Heuer  (kwzh@hal.gnu.ai.mit.edu)

	* xfns.c (Fx_list_fonts): Avoid confused increment of info.

	* syntax.c (Fforward_comment): Do the right thing at eob.

Tue Mar  1 22:22:39 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* keyboard.c (menu_bar_items): Accept old vector as arg.
	Return a vector.
	(menu_bar_one_keymap, menu_bar_item): Associated changes.
	(make_lispy_event): Use FRAME_MENU_BAR_LINES as vector.
	* frame.c (make_frame): Init menu_bar_items field to 0.
	* xdisp.c (update_menu_bar): Change call to menu_bar_items.
	(display_menu_bar): Use FRAME_MENU_BAR_LINES as vector.
	* xmenu.c (map_event_to_object, set_frame_menubar): 
	Use FRAME_MENU_BAR_LINES as vector.

Tue Mar  1 22:17:37 1994  Karl Heuer  (kwzh@hal.gnu.ai.mit.edu)

	* s/aix3-2.h: Use -g with the native compiler.
	* s/aix3-2-5.h: New file.  Use -O with the native compiler.

Tue Mar  1 19:14:25 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* lisp.h (struct handler): New field chosen_clause.
	* eval.c (Fsignal): Record the clause in chosen_clause.
	(Fcondition_case, internal_condition_case): Look there.
	(internal_condition_case_1): Look there.

	* fileio.c (Finsert_file_contents): If undo_list was t, leave it t.

	* alloc.c (memory_signal_data): No longer static. 
	(syms_of_alloc): Stick Qerror onto memory_signal_data.
	* lisp.h (memory_signal_data): Declare it.
	* eval.c (Fsignal): If DATA is memory_signal_data, don't add to it.

Mon Feb 28 15:16:57 1994  Karl Heuer  (kwzh@hal.gnu.ai.mit.edu)

	* alloc.c (memory_full): Use new variable memory_signal_data with
	precomputed value instead of trying to build it after memory is
	already exhausted.

Mon Feb 28 07:53:35 1994  Frederic Pierresteguy  (F.Pierresteguy@frcl.bull.fr)

	* xmenu.c (xmenu_show): Test XtWindowToWidget before inserting into
	the event_queue.

	* xterm.c (XTread_socket): For case ClientMessage and
	Xatom_wm_delete_window, use x_any_window_to_frame.

Sat Feb 26 04:26:38 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* s/sol2-3.h (LD_SWITCH_SYSTEM): New definitions, with #undef.

	* insdel.c (del_range_1): New function.
	(del_range): Use it.
	* fileio.c (Finsert_file_contents): Use del_range_1.

Sat Feb 26 00:51:41 1994  Karl Heuer  (kwzh@hal.gnu.ai.mit.edu)

	* keyboard.c (Fsuspend_emacs): New variable cannot-suspend forces
	a subshell even if the system seems to support job control.
	* sysdep.c (sys_subshell): New function, split from sys_suspend.

Fri Feb 25 22:50:34 1994  Karl Heuer  (kwzh@hal.gnu.ai.mit.edu)

	* window.c (Fset_window_configuration): Allow for menu-bar-lines
	to have changed since the configuration was created.

Fri Feb 25 22:41:47 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* keyboard.c (Vsystem_key_alist): Renamed from Vvendor_key_alist.
	(syms_of_keyboard): Rename Lisp var to system-key-alist.

Fri Feb 25 16:20:33 1994  Karl Heuer  (kwzh@hal.gnu.ai.mit.edu)

	* buffer.h (OVERLAY_POSITION): Don't check which buffer it points to.

	* lisp.h: Delete extra backslash on last line of macro.

	* xdisp.c (display_text_line): Allow for invisible overlays in
	next_invisible lookahead.
	* indent.c (compute_motion): Likewise.

Fri Feb 25 04:07:27 1994  Frederic Pierresteguy  (fp@mole.gnu.ai.mit.edu)

	* widget.c (EmacsFrameSetCharSize): Set coordinates values to the
	toplevel widget.

	* xterm.c (XTread_socket): For case ConfigureNotify, call
	x_any_window_to_frame.
	[USE_X_TOOLKIT]: Call XTranslateCoordinates for case ConfigureNotify
	when send_event is 0 and when the event is relative to toplevel widget.

	* widget.c (EmacsFrameSetCharSize): Call check_frame_size and update
	vertical_scroll_bar_extra.
	Call SET_FRAME_GARBAGED.

Thu Feb 24 16:49:42 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* lread.c (Fload): Cast the args to stat.

Thu Feb 24 14:06:33 1994  Karl Heuer  (kwzh@hal.gnu.ai.mit.edu)

	* xdisp.c (try_window): Add #ifdef USE_TEXT_PROPERTIES around call
	to Fget_text_property.

	* textprop.c (Fget_char_property): New function.
	* buffer.c (sort_overlays): Allow for null window.
	* xdisp.c (try_window, display_text_line): Use Fget_char_property
	to test for invisibility.
	* indent.c (compute_motion, vmotion): Likewise.
	* dispnew.c (direct_output_forward_char): Likewise.

Thu Feb 24 07:51:48 1994  Frederic Pierresteguy  (fp@mole.gnu.ai.mit.edu)

	* xfns.c (x_window): Call XChangeWindowAttributes with the standard
	event set to make all these events reach the Emacs frame.

Thu Feb 24 00:40:01 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* xmenu.c (Fx_popup_menu): Allow t as position, meaning use mouse pos.

	* fns.c (Fy_or_n_p): Use a popup menu if reached via mouse command.
	(Fyes_or_no_p): Likewise.

	* unexelf.c (ELF_BSS_SECTION_NAME): New macro (config.h may override).
	(unexec): Use it.

Wed Feb 23 22:46:50 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* buffer.c (Fkill_buffer): Call the Vkill_buffer_query_functions.
	(syms_of_buffer): Make Lisp var for kill-buffer-query-functions.

Tue Feb 22 19:02:48 1994  Karl Heuer  (kwzh@geech.gnu.ai.mit.edu)

	* lisp.h: New variable Vdoc_directory.
	* doc.c (get_doc_string, Snarf_documentation): Use it.
	* callproc.c (syms_of_callproc, init_callproc_1): Initialize it.
	* paths.h.in: Define PATH_DOC for default doc-directory.

Tue Feb 22 17:25:30 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* keyboard.c (make_lispy_movement, make_lispy_event):
	In non-scrollbar mouse case, return coords in pixel units.

	* frame.c (Fmouse_position): Convert to glyph units.

	* xterm.c (construct_mouse_click): Don't convert to glyph units.
	(XTmouse_position): Don't convert to glyph units.
	* msdos.c (mouse_get_pos): Don't convert to glyph units.

	* fileio.c (Finsert_file_contents): If REPLACE, always do lseek.
	Exit main loop if INSERTED reaches TOTAL.

Tue Feb 22 16:50:43 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* xterm.c (XTmouse_position): Use x_any_window_to_frame.

Tue Feb 22 14:41:31 1994  Karl Heuer  (kwzh@mole.gnu.ai.mit.edu)

	* emacs.c: Move extern declarations to top of file.

Mon Feb 21 03:33:08 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* keyboard.c (make_lispy_event): For menu bar event in USE_X_TOOLKIT
	case, convert x position to glyphs after map_event_to_object.
	Call window_from_coordinates later on.

	* xmenu.c (menu_item_equiv_key): Cached equiv-key data is a sublist.
	* keymap.c (get_keyelt): Cached equiv-key data is now a sublist.

	* xterm.c (x_had_errors_p): New function.
	(construct_menu_click):	Move function after pixel_to_glyph_coords.

	* xmenu.c: Most of file rewritten.
	(menu_items, menu_items_*): New variables.
	(MENU_ITEMS_*): New macros.
	(init_menu_items, discard_menu_items, push_menu_pane, push_menu_item)
	(finish_menu_items): New functions.
	(menu_item_enabled_p): New function.
	(keymap_panes, single_keymap_panes): Major rewrite; most args changed.
	(list_of_panes, list_of_items): Major rewrite; most args changed.
	(Fx_popup_menu): Major rewrite.  Now independent of display mechanism.
	No more conditionals here.
	(set_menu_items, free_menu_items): Functions deleted.
	(xmenu_show): Both versions rewritten to work from menu_items
	and to do all the conditionalized things that were in Fx_popup_menu.
	(unread_menu_bar_button, other_menu_bar_item_p): New functions.
	(check_mouse_other_menu_bar): New function.

	* xterm.c [!USE_X_TOOLKIT] (x_any_window_to_frame):
	Define as x_window_to_frame.

Sun Feb 20 14:34:19 1994  Roland McGrath  (roland@churchy.gnu.ai.mit.edu)

	* unexsunos4.c: Move config.h after system includes.

	* syswait.h [BSD]: #undef WCOREDUMP before defining it.

Sat Feb 19 00:43:59 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* frame.c (Fframe_visible_p): Do FRAME_SAMPLE_VISIBILITY first.

	* xterm.c (XTread_socket--cases KeyPress, EnterNotify, LeaveNotify)
	(cases FocusIn, FocusOut): Use x_any_window_to_frame.

	* xfns.c (x_window_to_frame): Add parens for clarity.

	* xmenu.c: Find and display keyboard equivalents of menu items.
	(menu_item_equiv_key): New function.
	(single_keymap_panes): Call it.  Properly skip help-string if any.
	Rename item2 to item_string.
	GCPRO some things.
	(menu_item_equiv_key): Use either VECTORP or STRINGP, not both.

	* keymap.c (get_keyelt): Discard keyboard equivalents stored in a
	menu keymap element.

Fri Feb 18 05:58:51 1994  Frederic Pierresteguy  (fp@mole.gnu.ai.mit.edu)

	* widget.c (get_default_char_pixel_size): Clean up code.
	Remove code inside #if 0 directive.

	* xmenu.c (popup_selection_callback): Clean up code. Remove code inside
	#if 0 directive.
	(popup_down_callback): Likewise.

Fri Feb 18 01:09:26 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* fileio.c (restore_point_unwind): New function.
	(Finsert_file_contents): In REPLACE case, set point and restore it.

	* gnu.h (gnu_bits): Use unsigned char.

	* bitmaps/*.xbm: Use unsigned char, not char.

	* window.c (unshow_buffer): Unconditionally set last_window_start.

Thu Feb 17 00:29:23 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* window.c (Fdelete_other_windows): Don't call Frecenter;
	do it by hand and avoid setting w->force_start.

	* xterm.c (dumpglyphs): Try various alternatives for foreground color
	of a glyph with the cursor on it.

	* dosfns.c, msdos.c, widget.c: Use <...> for config.h.

	* fileio.c (Finsert_file_contents): New arg REPLACE.
	New feature to replace buffer contents with file contents.

Wed Feb 16 18:43:33 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* systty.h (EMACS_TTY_TABS_OK): Alternate definition if no TABDLY.

	* s/bsd4-2.h, s/dgux.h, s/rtu.h, s/umax.h (BSD_PGRPS): Defined.
	* s/netbsd.h, s/bsd386.h (BSD_PGRPS): Add #undef.
	* sysdep.c (init_sys_modes, reset_sys_modes): Test BSD_PGRPS.
	(narrow_foreground_group, widen_foreground_group): Define if BSD_PGRPS.

	* sysdep.c (child_setup_tty): Use IUCLC, OLCUC, NLDLY only if defined.

	* emacs.c (main): Test BSD_PGRPS, not BSD.

	* s/netbsd.h (TAB3): Defined.
	(NEED_ERRNO, NO_TERMIO, HAVE_TERMIOS, HAVE_UNION_WAIT): Defined.

	* sysdep.c (init_sys_modes): IEXTEN is in c_lflag, not c_iflag.

	* unexmips.c (unexec): Add cast to result of `sbrk'.

Tue Feb 15 16:18:55 1994  Chris Hanson  (cph@klia.ai.mit.edu)

	* s/newsos5.h: Include usg5-4.h.
	(LIBS_SYSTEM, LINKER, START_FILES, LIB_STANDARD):
	Definitions moved here.

	* m/news-risc.h [NEWSOS5] (C_DEBUG_SWITCH, C_OPTIMIZE_SWITCH)
	(LD_SWITCH_MACHINE): Definitions moved here.

	* m/mips.h: NEWSOS5 conditional deleted.
	[NEWSOS5] (START_FILES, LIB_STANDARD, C_DEBUG_SWITCH)
	(C_OPTIMIZE_SWITCH, LD_SWITCH_MACHINE): Definitions moved away.

Tue Feb 15 11:16:37 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* xfns.c (Fx_parse_geometry): Don't call check_x.

	* sysdep.c (sys_write): If any bytes were written, return how many.

	* xterm.c (XTread_socket): Do not assume that select returning
	immediately with no events implies a hangup.

Mon Feb 14 14:41:27 1994  Karl Heuer  (kwzh@geech.gnu.ai.mit.edu)

	* xterm.h (check_x): Declare it.
	* xfns.c (check_x): Make it global.
	(Fx_parse_geometry, Fx_list_fonts, Fx_close_current_connection):
	call check_x.

	* xmenu.c (Fx_popup_menu): Likewise.
	* xselect.c (Fx_own_selection_internal, Fx_get_selection_internal,
	Fx_disown_selection_internal, Fx_rotate_cut_buffers_internal,
	Fx_selection_exists_p, Fx_get_cut_buffer_internal,
	Fx_store_cut_buffer_internal, Fx_selection_owner_p): Likewise.

	* indent.c (indented_beyond_p): New function.
	(compute_motion, vmotion): Use it to treat blank lines specially
	in selective display.
	* xdisp.c (try_window_id, display_text_line): Likewise.

Sun Feb 13 17:19:44 1994  Roland McGrath  (roland@churchy.gnu.ai.mit.edu)

	* s/netbsd.h (BROKEN_START, TEXT_START): Don't define.
	(HAVE_TEXT_START): Define this instead.
	* sysdep.c (start_of_text): Don't define #ifdef HAVE_TEXT_START.

Sat Feb 12 17:32:02 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* xdisp.c (decode_mode_spec): Support %+.

	* keyboard.c (command_loop_1):
	On entry, set last_command to this_command.

	* term.c (term_init): If no `se', use `me';
	if no `me' either, don't use standout mode at all.

Fri Feb 11 20:56:24 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* Makefile.in.in (${libsrc}make-docfile): Don't pass ../arch-lib
	as target to submake.

Fri Feb 11 17:32:15 1994  Karl Heuer  (kwzh@mole.gnu.ai.mit.edu)

	* sysdep.c [USG]: Fix conditional includes.

	* m/convex.h, m/ibmps2-aix.h, m/ibmrs6000.h, m/tekxd88.h,
	s/386bsd.h, s/bsd386.h, s/dgux.h, s/irix3-3.h, s/linux.h,
	s/netbsd.h, s/usg5-4.h: Delete HAVE_SETSID; configure checks for
	that.

	* xrdb.c (gethomedir): Look at LOGNAME before USER.

	* editfns.c (Fuser_real_login_name): Doc fix.

Fri Feb 11 17:06:30 1994  Paul Eggert  (eggert@twinsun.com)

	* editfns.c (init_editfns): Look at LOGNAME before USER.
	* fileio.c (Fsubstitute_in_file_name): Remove long-dead code
	that looked at USER before LOGNAME.

Fri Feb 11 13:54:19 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* buffer.c (syms_of_buffer): Doc fix.

	* xdisp.c (decode_mode_spec): Implement `P'.

Fri Feb 11 12:52:15 1994  Charles Hannum  (mycroft@duality.gnu.ai.mit.edu)

	* s/netbsd.h (KERNEL_FILE, LDAV_SYMBOL): Undefine and leave them
	that way.
	(LIBS_TERMCAP): Define.  Native libtermcap is better than the Emacs
	version, and knows the correct path.
	(N_PAGSIZ, N_BSSADDR, N_TRELOFF): Don't redefine if they already
	exist (i.e. under NetBSD >0.9).

Fri Feb 11 12:33:02 1994  Roland McGrath  (roland@churchy.gnu.ai.mit.edu)

	* s/netbsd.h (SYSV_SYSTEM_DIR): Define.
	(BROKEN_START, TEXT_START, START_FILES, UNEXEC, RUN_TIME_REMAP):
	Define to use unexsunos4.
	(N_PAGSIZ, N_BSSSADDR, N_TRELOFF): Define so unexsunos4.c compiles.

Fri Feb 11 03:53:05 1994  Frederic Pierresteguy  (fp@mole.gnu.ai.mit.edu)

	* xfns.c (x_set_menu_bar_lines) [USE_X_TOOLKIT]: Dont Call
	XtDestroyWidget but free_frame_menubar.
	Undo previous changes.
	* xterm.c (x_destroy_window) [USE_X_TOOLKIT]: Call free_frame_menubar.
	* xmenu.c (free_frame_menubar) [USE_X_TOOLKIT]: New function to destroy
	the X Widget instance of the menubar.

	* widget.c (EmacsFrameResize): Don't call XTranslateCoordinates. Code 
	removed.

	* xmenu.c (xmenu_show) [USE_X_TOOLKIT]: Return Qnil when val is null.

Fri Feb 11 03:03:43 1994  Karl Heuer  (kwzh@mole.gnu.ai.mit.edu)

	* keyboard.c (Fexecute_extended_command): Copy this_command_keys
	as a vector, not a string.

Thu Feb 10 23:42:45 1994  Karl Heuer  (kwzh@mole.gnu.ai.mit.edu)

	* keyboard.c (syms_of_keyboard): Add a DEFVAR for command-hook-internal.
	(command_loop_1): Use it for post-command-hook.

Thu Feb 10 21:50:09 1994  Roland McGrath  (roland@churchy.gnu.ai.mit.edu)

	* process.c (sys_siglist): Protect decl with #ifndef
	SYS_SIGLIST_DECLARED.
	* config.h.in: Add #undef SYS_SIGLIST_DECLARED.

Thu Feb 10 15:27:41 1994  Karl Heuer  (kwzh@mole.gnu.ai.mit.edu)

	* lread.c (read_filtered_event): Retry read_char after a buffer change.
	* keyboard.c (read_char, read_char_minibuf_menu_prompt,
	read_key_sequence): Likewise.

	* dispnew.c (buffer_posn_from_coords): Take hscroll into account.
	* window.c (Fpos_visible_in_window_p): Likewise.

	* editfns.c (Fmessage): Copy the text to be displayed into a
	malloc'd buffer.

Thu Feb 10 04:34:49 1994  Frederic Pierresteguy  (fp@mole.gnu.ai.mit.edu)

	* xmenu.c (xmenu_show): Test again event.xmotion.x_root in the 
	MotionNotify case.

Wed Feb  9 23:37:07 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* vmsdir.h: File renamed from dir.h.
	* ndir.h, fileio.c: Use new name vmsdir.h.

Wed Feb  9 17:05:02 1994  Karl Heuer  (kwzh@mole.gnu.ai.mit.edu)

	* alloc.c (Fgarbage_collect): Save and restore echo_area_glyphs_length.
	* fileio.c (Fdo_auto_save): Likewise.

	* buffer.c (Fkill_all_local_variables): Run change-major-mode-hook.

	* xterm.c (x_display_cursor, process_expose_from_menu): Block input.

	* editfns.c (difftm): Simplify return expression.

	* m/news.h (CRT0_DUMMIES): Definition deleted.

	* alloc.c (mark_object): Fetch obj from *objptr at loop, not at
	the gotos.

Wed Feb  9 08:51:51 1994  Frederic Pierresteguy  (fp@mole.gnu.ai.mit.edu)

	* Implement a Motif behavior for the menubar. Now, if you move the 
	pointer on another menubar item while displaying the contents of a
	selected menubar item, the current pulldown menu is closed and the new
	one corresponding to the new pointed item is displayed.
	* xmenu.c (xmenu_show) [USE_X_TOOLKIT]: Clean up code.
	Handle the MotionNotify events in the XEvent loop.

Tue Feb  8 22:23:56 1994  Karl Heuer  (kwzh@mole.gnu.ai.mit.edu)

	* xfaces.c (compute_char_face): Extract overlay-sorting code as a
	separate function, which is now in buffer.c.
	* buffer.c (sort_overlays): New function, extracted from xfaces.c.

Tue Feb  8 17:42:42 1994  Roland McGrath  (roland@churchy.gnu.ai.mit.edu)

	* print.c (print): If print_escapes_newlines, print '\f' as "\\f".
	(syms_of_print): Update docstring.

Tue Feb  8 02:26:20 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* process.c (Fprocess_kill_without_query): Doc fix.

Mon Feb  7 13:26:04 1994  Frederic Pierresteguy  (fp@mole.gnu.ai.mit.edu)

	* xterm.c (x_make_frame_invisible): Add USE_X_TOOLKIT conditional.

Sun Feb  6 01:15:05 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* xterm.c (x_set_window_size): New arg CHANGE_GRAVITY.
	(x_new_font): Pass CHANGE_GRAVITY arg to x_set_window_size.
	(x_wm_set_size_hint): New arg CHANGE_GRAVITY.
	(x_set_offset, x_set_window_size): 
	Pass CHANGE_GRAVITY arg to x_set_window_size.
	* xfns.c (x_set_internal_border_width, x_set_vertical_scroll_bars): 
	Pass CHANGE_GRAVITY arg to x_set_window_size.
	(Fx_create_frame): Pass CHANGE_GRAVITY arg to x_wm_set_size_hint.
	* frame.c (Fset_frame_height, Fset_frame_width, Fset_frame_size): 
	Pass CHANGE_GRAVITY arg to x_set_window_size.

	* frame.c (other_visible_frames):
	New function; code taken from Fdelete_frame.
	(Fdelete_frame): Use it.
	(Fmake_frame_invisible): Use it.  New arg FORCE.
	* xfns.c (x_set_visibility): Pass new arg to Fmake_frame_invisible.

	* xdisp.c (fix_glyph): New function.
	(display_text_line, display_string): Use fix_glyph.

	* xfaces.c (init_frame_faces): Clear FRAME_N_COMPUTED_FACES
	and FRAME_SIZE_COMPUTED_FACES.

Sat Feb  5 02:15:11 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* xdisp.c (copy_rope): Function deleted.
	(copy_part_of_rope): Merge the glyph's face using compute_glyph_face.
	Take frame as additional arg.
	(display_text_line): Use copy_part_of_rope always, not copy_rope.
	Pass the frame as arg.
	(display_string): Likewise.

	* xfaces.c (compute_glyph_face): New arg CURRENT_FACE
	specifies face to merge with.

	* emacs.c (main) [AIX]: Don't handle signal 20, 21 or 22.
	Call signal 24 by name (SIGXCPU).

	* eval.c (internal_condition_case_1): New function.
	* lisp.h (internal_condition_case_1): Declared.
	* keyboard.c (menu_bar_item): Use internal_condition_case_1.
	(menu_bar_item_1): New function.
	* xmenu.c (single_keymap_panes): Use internal_condition_case_1.
	(single_keymap_panes_1): New function.

Fri Feb  4 15:19:07 1994  Karl Heuer  (kwzh@mole.gnu.ai.mit.edu)

	* intervals.c (verify_interval_modification): When checking
	read-only, allow for the case that stickiness might be t instead
	of a list.

	* data.c (fmod): Implement it on systems where it's missing, using
	drem if available.

Fri Feb  4 12:17:07 1994  Frederic Pierresteguy  (fp@mole.gnu.ai.mit.edu)

	* xmenu.c (xmenu_show) [USE_X_TOOLKIT]: Remove the #if 0 directives 
	and reverse one to avoid the flickering of the menubar.

Fri Feb  4 01:22:20 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* keymap.c (Fwhere_is_internal): Take just one keymap arg.
	(where_is_string): Pass Voverriding_local_map for that arg.
	* doc.c (Fsubstitute_command_keys): Pass keymap as that arg
	to Fwhere_is_internal.  Init keymap from Voverriding_local_map.

Thu Feb  3 13:54:11 1994  Karl Heuer  (kwzh@mole.gnu.ai.mit.edu)

	* intervals.c (merge_properties_sticky): Preserve original order
	of properties.

Thu Feb  3 00:02:03 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* s/hpux8.h (X_IO_BUG): Defined.

	* fileio.c (Fwrite_region):
	If FILENAME has no handler, see if VISIT has one.

	* search.c (scan_buffer): New arg ALLOW_QUIT.
	(find_next_newline): Pass new arg.
	* xdisp.c (display_count_lines): Pass new arg to scan_buffer.
	* syntax.c (find_defun_start): Pass new arg to scan_buffer.
	* cmds.c (Fforward_line): Pass new arg to scan_buffer.

Wed Feb  2 12:13:01 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* xterm.c (XTread_socket): Add X_IO_BUG conditional.

	* xdisp.c (display_menu_bar): Pass explicit max arg to display_string.
	(display_string): New arg OBEY_WINDOW_WIDTH.  All callers changed.

Wed Feb  2 01:21:07 1994  Karl Heuer  (kwzh@mole.gnu.ai.mit.edu)

	* xterm.c (x_iconify_frame): Fix misbalanced
	BLOCK_INPUT/UNBLOCK_INPUT.

	* xdisp.c (try_window_id): Don't pass value beyond ZV to
	compute_motion.
	* window.c (Fpos_visible_in_window_p): Return nil if POS > ZV.

	* sysdep.c (get_system_name): Remove restriction on hostname size.
	* lisp.h (get_system_name): Declared.
	* xterm.c (x_term_init): Use get_system_name instead of gethostname.
	* xrdb.c (x_get_customization_string): Use get_system_name instead
	of gethostname.

Wed Feb  2 00:04:35 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* keyboard.c (kbd_buffer_get_event): Pass 1 to read_avail_input.

Tue Feb  1 18:18:39 1994  Karl Heuer  (kwzh@mole.gnu.ai.mit.edu)

	* config.h.in (HAVE_FMOD): Add another #undef.
	* data.c (Fmod): Use HAVE_FMOD.

Tue Feb  1 17:33:14 1994  Frederic Pierresteguy  (fp@mole.gnu.ai.mit.edu)

	* xfns.c (x_set_menu_bar_lines): Test also menubar_widget before
	calling	XtDestroyWidget.

Tue Feb  1 01:48:32 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* xterm.c (dumpglyphs): Don't crash for invalid face code.

Mon Jan 31 23:13:17 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* undo.c (record_first_change): Check for buffer-undo-list = t.
	Make an undo boundary if appropriate.  Set last_undo_buffer.
	(record_property_change): Use BUFFER, not current_buffer,
	when testing undo_list.

Sat Jan 29 19:50:10 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* widget.c: Don't declare arg types in decls or fn definitions.

	* syntax.h (SYNTAX_MATCH, SYNTAX): Fix non-GNUC definitions.

	* widget.h (EmacsFrameSetCharSize): Don't declare arg types.

	* Makefile.in.in (configuration): Change # comment to C comment.

Sat Jan 29 02:09:41 1994  Karl Heuer  (kwzh@mole.gnu.ai.mit.edu)

	* keymap.c (currrent_minor_maps): Scale by sizeof when allocating
	objects.

	* buffer.c (Fkill_all_local_variables): Follow symbol forwarding.

Sat Jan 29 01:16:17 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* callproc.c: Include stdio.h.
	(init_callproc): Put non-ex-dir warnings on stderr.

	* lread.c (init_lread): Put non-ex-dir warnings on stderr.

Fri Jan 28 20:14:07 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* lread.c (init_lread): Put non-ex-dir warnings on stderr.
	* callproc.c: Include stdio.h.
	(init_callproc): Put non-ex-dir warnings on stderr.

Fri Jan 28 17:34:46 1994  Frederic Pierresteguy  (fp@mole.gnu.ai.mit.edu)

	* xterm.c (x_set_window_size): Add USE_X_TOOLKIT conditional. Call 
	EmacsFrameSetCharSize and return.

	* xterm.c (x_term_init): Cast to (char **) before assignment to argv.

Thu Jan 27 05:50:49 1994  Frederic Pierresteguy  (fp@mole.gnu.ai.mit.edu)

	* keyboard.c (make_lispy_event): Add USE_X_TOOLKIT conditional and
	test FRAME_EXTERNAL_MENU_BAR.
	(map_event_to_object) [USE_X_TOOLKIT]: Declare and use it.

Wed Jan 26 15:51:33 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* xterm.c (x_set_mouse_position): Don't raise the frame.

	* s/sunos4-0.h [__GNUC__] (MKDIR_PROTOTYPE): Defined.

	* sysdep.c (mkdir): Use MKDIR_PROTOTYPE if defined.

Wed Jan 26 12:23:12 1994  Frederic Pierresteguy  (fp@mole.gnu.ai.mit.edu)

	* xterm.h [USE_X_TOOLKIT]: Don't include Xaw/Box.h.

	* xdisp.c (update_menu_bar): Add USE_X_TOOLKIT conditional and test
	FRAME_EXTERNAL_MENU_BAR.

Wed Jan 26 00:09:18 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* Makefile.in.in (widgetobj): New variable.
	(otherobj): Use widgetobj.
	(XOBJ): Undo previous change.

Tue Jan 25 16:01:12 1994  Francesco Potorti`  (pot@cnuce.cnr.it)

        * m/delta.h (HAVE_BCOPY): undef'd for efficiency.
        (bcopy, bzero, bcmp): define'd for efficiency.
        (GAP_USE_BCOPY, BCOPY_DOWNWARD_SAFE): define'd for GHc compiler.

Mon Jan 24 13:17:12 1994  Francesco Potorti`  (pot@cnuce.cnr.it)

 	* m/delta.h (HAVE_RANDOM, BROKEN_FIONREAD): Defined if X is used.
	(HAVE_XSCREENNUMBEROFSCREEN): Defined if X is used.
	(LIB_X11_LIB, LIBX11_SYSTEM): Override only if X is used.
	(USG_SHARED_LIBRARIES): Undefine only if X is used.

Sun Jan 23 18:23:35 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* fns.c (Fconcat): Doc fix.

Sat Jan 22 11:13:08 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* keyboard.c (read_key_sequence): Properly gcpro fkey_map while
	using keytran_map.

	* fns.c (Fassq, Fassoc): Doc fixes.

	* data.c (Faset): Doc fix.

Fri Jan 21 01:33:11 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* xdisp.c (display_menu_bar): Add USE_X_TOOLKIT conditional.
	(redisplay_window) [USE_X_TOOLKIT]: Test FRAME_EXTERNAL_MENU_BAR.
	(update_menu_bar) [USE_X_TOOLKIT]: Call set_frame_menubar.

	* widget.c: Include X11/ObjectP.h.

	* keyboard.c (syms_of_keyboard): New Lisp var command-hook-internal.
	(command_loop_1): Use it when running the command hooks.

	* Makefile.in.in (LWLIB_OPTIONS): Define if not defined.
	(LIBXT): New variable.
	(LIBX): Use LIBXT.
	(widget.o): New target.
	(XOBJ) [USE_X_TOOLKIT]: Add widget.o.

	* xmenu.c: Find lwlib.h and xlwmenuP.h in ../lwlib.
	* xfns.c: Find lwlib.h in ../lwlib.

	* widgetprv.h: Renamed from widgetP.h.

	* Makefile.in.in (lwlibdir): New variable.
	($(OLDXMENU)) [USE_X_TOOLKIT]: Alternate rule.
	(OLDXMENU) [USE_X_TOOLKIT]: Alternate value.
	(really-lwlib): New rule.

	* xterm.h [USE_X_TOOLKIT]: Include StringDefs.h, IntrinsicP.h,
	CoreP.h, StringDefs.h, Xaw/Box.h.
	* xterm.c: Don't include them.

	* xrdb.c (search_magic_path): Fix logic testing for empty path element.

Thu Jan 20 08:11:00 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* xterm.c (x_wm_set_size_hint): Swap southeast and northwest.

	* xrdb.c (S_ISDIR): Define if not defined.
	(file_p): Use S_ISDIR.

	* xterm.c (XTupdate_end): No need to test updating_frame.
	* term.c (update_end): Clear updating_frame before calling hook.

	* fileio.c (double_dollars): New function.
	(Fread_file_name_internal): Use double_dollars.
	(Fread_file_name): Likewise.

	* textprop.c (Fprevious_property_change): Move back at least 1 char.
	(Fprevious_single_property_change): Likewise.
	* textprop.c: Doc fixes.

	* xfns.c (store_class_hints): Function deleted.

	* intervals.c (graft_intervals_into_buffer): Fix one-off
	comparing lengths of over and under.

	* keyboard.c (read_key_sequence): Don't call echo_truncate
	the first time through.

Wed Jan 19 09:57:57 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* s/sunos4-1-3.h: Add #undef SYSTEM_MALLOC.

	* xfns.c (Fx_create_frame): Bind x-resource-name to explicit title.
	(Qx_resource_name): Declared.
	(syms_of_xfns): Set up Qx_resource_name.

	* xmenu.c: Reshuffle functions; put new ones in #ifdef USE_X_TOOLKIT.
	(Fx_popup_menu): Add USE_X_TOOLKIT conditional around new decls.

	* xterm.c: Put new functions in #ifdef USE_X_TOOLKIT.

	* xdisp.c (truncate_echo_area): New function.
	* keyboard.c (echo_truncate): Call truncate_echo_area.

Tue Jan 18 17:56:02 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* config.h.in: Add #undef for USE_X_TOOLKIT.

	* xfns.c (x_window): Fix error message.

Tue Jan 18 14:36:35 1993  Frederic Pierresteguy  (F.Pierresteguy@frcl.bull.fr)

	* Support use of X toolkit.
	(USE_X_TOOLKIT): New macro to conditionalize the use of Xt.
	* widget.c, widgetP.h, widget.h: New files.
	* frame.h (struct frame): New field external_menu_bar.
	(FRAME_EXTERNAL_MENU_BAR): New macro.
	* xterm.h (struct x_display): New fields widget, column_widget,
	edit_widget, menubar_widget.
	(x_any_window_to_frame): Declared.
	* lisp.h (VOID_TO_LISP, CVOID_TO_LISP, LISP_TO_VOID, LISP_TO_CVOID):
	New macros.
	* xfns.c (x_any_window_to_frame): New function.
	(x_window_to_frame, x_window): Handle USE_X_TOOLKIT.
	(x_set_icon_type, x_set_menu_bar_lines, x_set_name): Likewise.
	(store_class_hints, hack_wm_protocols): New function.
	* xmenu.c (string_width): New function.
	(event_is_in_menu_item, map_event_to_object): Likewise.
	(set_menu_items, free_menu_items, popup_selection_callback): Likewise.
	(popup_down_callback, free_menubar_widget_value_tree): Likewise.
	(update_one_frame_psheets, set_frame_menubar): Likewise.
	(Fx_popup_menu, xmenu_show): Handle USE_X_TOOLKIT.
	* xterm.c (construct_mouse_click): New function.
	(process_expose_from_menu): Likewise.
	(XTread_socket, x_set_offset, x_set_window_size): Handle USE_X_TOOLKIT.
	(x_raise_frame, x_lower_frame, x_make_frame_visible): Likewise.
	(x_iconify_frame, x_destroy_window, x_wm_set_window_state): Likewise.
	(x_term_init): Likewise.

	* xmenu.c (dispatch_dummy_expose): New function.
	(XMenu_xpos, XMenu_ypos): Change the values of the constant assignment.
	(xmenu_show): Change the way to make the menubar to redraw itself by
	generating a dummy expose event.

	* xterm.c (x_term_init): Pass argv, argc to XtAppInitialize with the
	display_name value.

Sun Jan 16 17:42:11 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* s/linux.h: Don't include stdio.h.

	* dispnew.c: Include stdio.h before config.h.

	* emacs.c (init_cmdargs): Set Vinstallation_directory.
	(syms_of_emacs): staticpro it.
	* lisp.h (Vinstallation_directory): Declared.
	* lread.c (init_lread): Use Vinstallation_directory.
	* callproc.c (init_callproc): Use Vinstallation_directory.

	* fileio.c (Ffile_symlink_p): Doc fix.

	* keyboard.c (Voverriding_local_map): New variable.
	(syms_of_keyboard): Set up Lisp variable.
	(read_key_sequence, menu_bar_items): Handle Voverriding_local_map.

	* keymap.c (Fkey_binding): Handle Voverriding_local_map.
	(describe_buffer_bindings): Likewise.

Sat Jan 15 08:27:01 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* config.h.in (LD_SWITCH_X_SITE_AUX): Add #undef.
	* s/sol2.h (LD_SWITCH_SYSTEM): Use LD_SWITCH_X_SITE_AUX.

	* floatfns.c (Fffloor, Ffceil, Ffround, Fftruncate): New functions.
	(syms_of_floatfns): Turn them on.

Fri Jan 14 13:46:47 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* keyboard.c (command_loop_1): If there's an error in the
	post-command-hook or pre-command-hook, leave that hook nil.

	* s/sco4.h (BSTRING): Don't define it here.

Thu Jan 13 00:01:12 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* Makefile.in.in (xterm.o): Depends on syssignal.h.

Wed Jan 12 11:17:37 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* sysdep.c (sys_siglist) [sun]: Additional Sun-specific signal names.

Wed Jan 12 08:45:35 1993  Thomas Horsley  (tahorsley@csd.harris.com)

	* cxux-crt0.s: New file.

	* emacs.c (main) [USG5 and INTERRUPT_INPUT]: Call setpgrp.

	* m/nh3000.h: New file for the Night Hawk 3000 series hardware defs.

	* m/nh4000.h: New file for the Night Hawk 4000 & 5000 series hardware.

	* s/cxux.h: New file for the CX/UX operating system used by Night
	Hawks.

	* s/cxux7.h: New file.

	* sysdep.c (request_sigio, unrequest_sigio): Add new versions of
	these routines for the CX/UX operating system.
	(sys_signal) [SA_RESTART]: Set this flag.

	* xterm.c: Include syssignal.h.

Tue Jan 11 20:59:19 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* process.c (sigchld_handler, status_message):
	Handle a NULL in sys_siglist.

Tue Jan 11 19:49:46 1994  Roland McGrath  (roland@churchy.gnu.ai.mit.edu)

	* buffer.c (syms_of_buffer): Don't do (put 'erase-buffer 'disabled t).
	(keys_of_buffer): Do it here instead.

Tue Jan 11 00:49:14 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* lread.c (Fload): Record descriptor numbers on load_descriptor_list.
	(load_descriptor_unwind, close_load_descs): New function.
	(syms_of_lread): Init and staticpro load_descriptor_list.
	(init_lread): Clear load_descriptor_list.

	* callproc.c (child_setup): Call close_load_descs.

	* eval.c (Fcondition_case): Allow a list of condition names
	in a handler.
	(find_handler_clause): Likewise.
	(Fsignal): Rename 1st arg to error_symbol.
	(Fcondition_case): Doc fix.

	* process.c (read_process_output): Supply second arg to unbind_to.
	(exec_sentinel): Likewise.

Tue Jan 11 16:45:47 GMT 1994 (afs@hplb.hpl.hp.com)

	* keyboard.c (read_char_x_menu_prompt, read_char_minibuf_menu_prompt):
	New functions made by dividing up read_char_menu_prompt.
	(read_char): Call read_char_minibuffer_menu_prompt before the sit_for
	if X menus are not going to be used.
	(read_char_minibuf_menu_prompt): Correct access to keymaps for
	menus when not using X menus.  Only store character read in a keyboard
	macro if it is not the menu help character.

Mon Jan 10 12:08:18 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* process.c (create_process): Set line discipline only if pty_flag.

	* search.c (set_search_regs): New subroutine.
	(search_buffer): Use set_search_regs.
	Record beginning and end after matching null string.

Sun Jan  9 18:07:25 1994  Roland McGrath  (roland@churchy.gnu.ai.mit.edu)

	* mem-limits.h: Include <sys/types.h> before <sys/resource.h>.

	* process.c: Don't declare sys_nerr.  Don't declare sys_errlist
	unless #ifdef VMS.  Declare strerror instead.
	(wait_reading_process_input): Call strerror instead of using
	sys_errlist.

Sun Jan  9 10:20:07 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* xfns.c (x_sync): Block input.

	* buffer.h (struct buffer): New field auto_save_failure_time.

	* fileio.c (Fdo_auto_save): If auto save times out,
	don't try again for 20 minutes.
	(Fclear_buffer_auto_save_failure): New function.
	(Fset_buffer_auto_saved): Clear auto_save_failure_time.

	* xfns.c (x_sync): New function.
	* frame.c (Fdelete_frame): Call x_sync.

Sun Jan  9 01:16:24 1994  Roland McGrath  (roland@churchy.gnu.ai.mit.edu)

	* sysdep.c: Restore big block of #ifdef and #include lines for
	fcntl.h and friends, apparently accidentally removed in revision
	1.70 (Jan 5 changes).

Sat Jan  8 16:24:41 1994  Roland McGrath  (roland@churchy.gnu.ai.mit.edu)

	* callproc.c (child_setup): Don't declare PID `register'; we later
	take its address.

	* config.h.in: Add #undef HAVE_STRERROR.
	* sysdep.c [! VMS]: Don't declare sys_errlist here.
	[! HAVE_STRERROR] (strerror): New function.
	(dup2): Use strerror instead of sys_errlist.
	* fileio.c: Don't declare sys_errlist; declare strerror instead.
	(err_str): Macro removed.
	(Finsert_file_contents, Fwrite_region): Call strerror instead of
	err_str.
	(report_file_error): Call strerror instead of using sys_errlist.
	* emacs.c (main): Call strerror instead of using sys_errlist.
	* callproc.c: Don't declare sys_errlist; declare strerror instead.
	(relocate_fd): Call strerror instead of using sys_errlist.
	* unexenix.c: Don't declare sys_errlist; declare strerror instead.
	(fatal_unexec): Call strerror instead of using sys_errlist.
	* unexmips.c: Likewise.

Sat Jan  8 06:59:15 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* frame.c (Fdelete_frame): Do FRAME_SAMPLE_VISIBILITY before
	testing visibility of a frame.

	* emacs.c (main): Don't call setpgrp if !initialized.

	* Makefile.in.in (${etc}DOC): Put back ${lisp} accidentally deleted.

	* keymap.c (describe_map_tree): New arg NOMENU.
	(describe_buffer_bindings): Pass new arg.
	* doc.c (Fsubstitute_command_keys): Pass new arg to describe_map_tree.

Sat Jan  8 00:37:30 1994  Morten Welinder  (terra@diku.dk)

	* keyboard.c (interrupt_signal) [MSDOS]: write explicit CRs since
	stdout has been made binary.  Start at the top of the screen since
	the internal terminal otherwise will write "below the screen."

Fri Jan  7 00:57:49 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* Makefile.in.in (emacs): Don't run inc-vers.el.

	* config.h.in: Handle HAVE_BCMP.
	(BSTRING): Don't define unless HAVE_BCMP.

Wed Jan  5 16:12:38 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* s/msdos.h (getppid): Define as macro.

	* dired.c (DIRENTRY_NONEMPTY): New macro; two definitions.
	(Fdirectory_files, file_name_completion): Use it.

Wed Jan  5 22:20:15 1993  Morten Welinder  (terra@diku.dk)

	* buffer.c, buffer.h [MSDOS]: New buffer-local variable:
	buffer-file-type to handle DOS newlines.

	* callproc.c (syms_of_callproc) [MSDOS]: New lisp variable: 
	binary-process.
	(init_callproc) [MSDOS]: Initialize binary-process.
	[MSDOS]: Declare binary-process.
	[MSDOS]: Include <fcntl.h>, <sys/stat.h>, <sys/param.h>,
	and <errno.h> needed for the next changes.
	(Fcall_process) [MSDOS]: Create temporary file for process output.
	Run the subprocess using `run_msdos_command' instead of forking.
	Arrange for cleanup to erase temporary file.
	(Fcall_process) [not subprocesses]: Barf if zero buffer argument.
	(call_process_cleanup) [MSDOS]: Close and erase temporary file
	instead of the pid-stuff.
	(Fcall_process_region) [MSDOS]: Create temporary file in $TMP or 
	$TEMP.
	(Fchild_setup) [MSDOS]: #if 0, as it is not used.

	* cmds.c (keys_of_cmds) [MSDOS]: Chars 0200 to 0237 self-insert.

	* data.c (Frem) [MSDOS]: use `fmod', not `drem'.  Put in config.h?

	* dired.c [MSDOS]: #include <dirent.h> instead of <sys/dir.h>.  Avoid
	some external definitions.
	(Ffile_attributes) [MSDOS]: Set execute bits from file name.
	(Ffile_name_all_completions) [FILE_SYSTEM_CASE]: Convert
	case of file name as as indicated by conditional.

	* emacs.c (main) [MSDOS]: Call init_environment.  Set file types to
	binary for all files.  Call init_dosfns.
	(fatal_error_signal) [MSDOS]: Uncomment sigblock.

	* fileio.c [MSDOS]: #include "msdos.h" and <sys/param.h> needed for
	the following changes.
	(Ffile_name_directory, Fexpand_file_name) [FILE_SYSTEM_CASE]: Apply
	case conversion if defined.
	(Ffile_name_directory, Ffile_name_nondirectory, file_name_as_directory,
	directory_file_name, Fexpand_file_name, Fsubstitute_in_file_name,
	expand_and_dir_to_file) [MSDOS]: Drive letter support.
	(Fexpand_file_name) [MSDOS]: Support for multiple default directories.
	(Ffile_writeable_p) [MSDOS]: Don't call access with file name ending
	in a slash.
	(Finsert_file_contents) [MSDOS]: Determine file type by name (call
	find-buffer-file-type) and change CR+LF to LF if it is a text file.
	(Fwrite_region) [MSDOS]: Use text/binary mode as specified by 
	buffer_file_type.
	(syms_of_fileio) [MSDOS]: Set Qfind_buffer_file_type.
	(Fsubstitute_in_file_name) [MSDOS]: Ignore case in environtment
	variable.

	* floatfns.c [MSDOS]: Don't define HAVE_MATHERR.

	* keyboard.c [MSDOS]: #include <dos.h> and <time.h>, but not 
	<sys/ioctl.h>.
	(read_avail_input) [MSDOS]: Work around `ioctl'.  Also read through
	dos_keyread for better keyboard support.
	(interrupt_signal) [MSDOS]: Don't claim we can core dump.
	(kbd_buffer_store_event): Cast a pointer to avoid a compiler warning.

	* lread.c [MSDOS]: Use text mode for all files but ".elc" files.
	(complete_file_name) [MSDOS]: Drive letter support.

	* mem-limits.h [MSDOS] (get_lim_data): Use go32 call.

	* sysdep.c [MSDOS]: #include <dos.h>, "dosfns.h", "msdos.h", and
	<sys/param.h> needed for the following changes, but not <sys/ioctl.h>
	(discard_tty_input) [MSDOS]: Do it by reading till no more keys
	available.
	(init_baud_rate) [MSDOS]: Assume highest possible speed.
	(sys_suspend) [MSDOS]: Save default directory.  Call via system, not
	via fork.
	(emacs_get_tty, emacs_set_tty) [MSDOS]: Don't do anything.
	(init_sys_modes) [MSDOS]: Use raw mode.
	(get_frame_size) [MSDOS]: Get from bios.
	(reset_sys_modes) [MSDOS]: Back to cooked mode.
	(start_of_text) [MSDOS]: Reference _tstart.
	(select) [MSDOS]: Don't use signals, use sleeping.
	(init_sys_modes) [MSDOS]: Initialize internal terminal.

	* systty.h [MSDOS]: don't #include <sgtty.h>.  We haven't got it.
	Declare dummy main field.  Don't ever use TABs.

	* termcap.c (tgetent) [INTERNAL_TERMINAL]: Fake internal terminal 
	without reading any files.
	(valid_file_name, tgetent) [MSDOS]: Drive letter support.
	(tgetent) [MSDOS]: Use text mode for database.

	* unexec.c [MSDOS]: Don't #include <a.out.h>, but use other headers.
	(make_hdr) [MSDOS]: Cast a pointer for bzero.
	(write_segment) [EFAULT]: Check for before using.
	(adjust_lnnoptrs) [MSDOS]: Use provided descriptor.
	(adjust_lnnoptrs): Return 0 if ok.

	* xdisp.c (decode_mode_spec) [MSDOS]: Let 't' expand to 'T' for
	text mode or 'B' for binary mode.
	(decode_mode_spec) [not subprocesses]: Don't access Fprocess_status.

	* s/msdos.h, m/dos386.h: New files (for MSDOS).
	* dosfns.c, dosfns.h: New files (for MSDOS).
	* msdos.c, msdos.h: New files (for MSDOS).

Tue Jan  4 03:41:35 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* s/sunos4-1.h (SUNOS_LOCALTIME_BUG): #if 0'd.

	* print.c (strout, printchar): Use proper frame for minibuffer.

	* keyboard.c (read_avail_input): Args to `kill' were backwards.
	(kbd_buffer_get_event): If deleting last frame, call Fkill_emacs.

	* fns.c (Fmapconcat): Doc fix.

	* s/sco4.h (bcopy, bzero, bcmp): Defined.

Mon Jan  3 20:22:00 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* xfns.c (Fx_list_fonts): Don't fail to init `tail'.

Sun Jan  2 13:16:53 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* buffer.c: Don't include syntax.h.
	* Makefile.in.in (buffer.o): Don't depend on syntax.h.

	* syntax.h (enum syntaxcode): Add Sinherit.
	(RAW_SYNTAX, RAW_SYNTAX_MATCH, SYNTAX_CHOOSE_TABLE): New macros.
	(SYNTAX, SYNTAX_MATCH, SYNTAX_COMSTART_FIRST, SYNTAX_COMSTART_SECOND)
	(SYNTAX_COMEND_FIRST, SYNTAX_COMEND_SECOND, SYNTAX_PREFIX)
	(SYNTAX_COMMENT_STYLE): Handle Sinherit.
	Alternative definitions if __GNUC__.

	* syntax.c (describe_syntax): Handle Sinherit.
	(syntax_code_spec, syntax_spec_code): Add entry for @ and Sinherit.

	* Makefile.in.in (temacs): Delete redundant use of LDFLAGS.

Sun Jan  2 19:19:37 1994  Ulrich Mueller  (ulm@vsnhd1.cern.ch)

	* sysdep.c (get_system_name): If the official name of the host is
	not a fully qualified domain name, then try to find one in the
	list of alternate names.

Sun Jan  2 00:20:24 1994  Rick Sladkey  (jrs@world.std.com)

	* intervals.h (NULL_RIGHT_CHILD, NULL_LEFT_CHILD):
	Assume children must be intervals, never strings or buffers.

	* intervals.c (rotate_right, rotate_left): Simplify
	total_length calculation.  Minimize pointer dereferencing.
	(balance_an_interval): Remove recursive rebalancing.
	Rebalance precisely when imbalanced.  If a rotation is done,
	rebalance only the node which may have become unbalanced.
	Iterate	until the current node is balanced.
	(balance_possible_root_interval): New function.
	(balance_intervals): Move the interation into rebalance_an_interval.
	(balance_intervals_internal): New subroutine of balance_intervals.
	(split_interval_right, split_interval_left): Speed up by
	not checking LEAF_INTERVAL_P.
	(split_interval_right, split_interval_left, find_interval,
	adjust_intervals_for_insertion, graft_intervals_into_buffer):
	Add dynamic rebalancing anywhere a node may become unbalanced.
	(graft_intervals_into_buffer, copy_intervals): No longer
	any need to do a full rebalance as the tree stays balanced.

Sat Jan  1 02:00:32 1994  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* fileio.c (Fwrite_region): Don't change START and END from nil
	until after checking for a magic handler.

	* .gdbinit: Delete `show env TERMCAP'.

	* process.c (read_process_output): Use clip_to_bounds when moving
	to the process marker.

	* keyboard.c (modify_event_symbol): New arg NAME_ALIST.
	Allow SYMBOL_TABLE to be an alist.
	(Vvendor_key_alist): New variable.
	(syms_of_keyboard): Initialize it.
	(make_lispy_event): Handle vendor-specific keysyms.
	(lispy_function_keys): Delete `remove' and th HP keysyms.

	* xterm.c (XTread_socket): temp_buffer and temp_index deleted.
	Put all vendor-specific keys into the buffer.
	(x_is_vendor_fkey): Function deleted.
	(XTread_socket): Don't call it.

	* Makefile.in.in (SOME_MACHINE_OBJECTS): New var.
	(${etc}DOC): Use SOME_MACHINE_OBJECTS,
	not OBJECTS_MACHINE or OBJECTS_SYSTEM.
	Don't depend on SOME_MACHINE_OBJECTS.

	* dired.c (file_name_completion_stat): If have symlinks, use lstat.

Fri Dec 31 05:42:01 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* buffer.c (Qget_file_buffer): New variable.
	(syms_of_buffer): Set up Qget_file_buffer.
	(Fget_file_buffer): For magic file names, run the handler.

	* fileio.c (Finsert_file_contents): Don't run after change hook
	if inserted is 0.
	Avoid setting modtime or buffer-file-name field if ran a handler.

	jrs:
	* s/linux.h (PENDING_OUTPUT_COUNT): Two alternate definitions
	for different versions of stdio.h.

Thu Dec 30 02:09:55 1993  Morten Welinder  (terra@diku.dk)

	* frame.c: Always include termhooks.h.
	[! MULTI_FRAME] (Fmouse_position): New definition.
	[! MULTI_FRAME] (syms_of_frame): Add mouse-position.

Thu Dec 30 22:05:03 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* doc.c (Fsubstitute_command_keys): Fix previous change.

Thu Dec 30 10:41:39 1993  Lawrence R. Dodd  (dodd@roebling.poly.edu)

        * minibuf.c (read_from_minibuffer): Rename arg initial_input
        to initial_contents.

Thu Dec 30 01:55:54 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* editfns.c (Femacs_pid): New function.
	(syms_of_editfns): Define it for Lisp.

	* keyboard.c (read_avail_input): Turn O_NDELAY off on DGUX as on USG.

	* minibuf.c (Fall_completions): Allow completions that start with space
	if the input starts with space.

	* Makefile.in.in (LDFLAGS): Define as empty.
	(ALL_LDFLAGS): Define as LDFLAGS used to be defined.
	(temacs): Use ALL_LDFLAGS.

	* xfns.c (Fx_create_frame): Add to Vframe_list before making visible.

Wed Dec 29 02:43:10 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* keymap.c (describe_command): If binding is a kbd macro, say so.

Sun Dec 26 00:59:18 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* emacs.c (main) [AIX]: Call putenv.

	* s/linux.h (A_TEXT_OFFSET, A_TEXT_SEEK, ADJUST_EXEC_HEADER): Defined.

	* keyboard.c (lispy_accent_codes): Cope if an XK symbol is undefined.
	(make_lispy_event): Define i.

	* termhooks.h (struct input_event): FIx typo in previous change.

	* xterm.c (XTflash): Use EMACS_GET_TIME.
	(XTread_socket): Make proper junk values to pass to select.

Sat Dec 25 12:20:15 1993  Jerry Frain  (jerry.frain@tivoli.com)

	* s/usg5-4.h (bcopy): Use memmove instead of memcpy.

	* systime.h (EMACS_GET_TIME) [USG5_4]: Give gettimeofday just one arg.

Sat Dec 25 03:11:57 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* alloc.c (Fmemory_limit): No longer interactive.

Fri Dec 24 18:11:49 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* keyboard.c (command_loop_1): Test of whether disp tab elt
	was a vector was backwards.

	* fileio.c (Fwrite_region): If handler, don't mess with modtime.
	(Finsert_file_contents): Likewise.

	* config.h.in: Add #undef HAVE_SETSID.

	* process.c (create_process) [NTTYDISC]: Set the tty line discipline.

	* callproc.c: Include systty.h.
	(child_setup): Use EMACS_SET_TTY_PGRP.
	* Makefile.in.in (callproc.o): Depend on systty.h and syssignal.h.

	* xdisp.c (redisplay_window): Before altering lpoint,
	make sure the buffer it pertains to is the one being displayed.

	* syntax.c (Fmodify_syntax_entry): Doc fix.

Thu Dec 23 22:45:06 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* process.c (Fopen_network_stream): Turn off SIGIO while connecting.

Wed Dec 22 19:36:24 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* keyboard.c (lispy_accent_codes): New variable.
	(make_lispy_event): Use that to handle lots of dead accent keys.

	* xterm.c (XTread_socket): Handle a bunch more dead keys.

Wed Dec 22 18:09:45 MET 1993  Francesco Potorti`  (pot@cnuce.cnr.it)

	* m/delta.h (BROKEN_CLOSEDIR): added because closedir is interruptible.
	(HAVE_UNISTD_H): deleted because configure takes care of it.
	(C_SWITCH_MACHINE): added optimisation options for gnu cc.

Fri Dec 17 00:22:43 1993  Mike Long  (mike.long@analog.com)

	* s/vms.h (TERMCAP_NAME): Defined.
	* s/netbsd.h (TERMCAP_NAME): Defined.
	These correspond with changes in termcap.c.

Fri Dec 17 13:09:53 1993  Richard Stallman  (rms@gnu.ai.mit.edu)

	* xterm.c (XTread_socket): Don't offset keysym here.
	Special handling for "dead accent" keysyms.
	* keyboard.c (make_lispy_event): Offset the event code here.
	Special handling for "dead accent" keysyms.

	* keyboard.c (quit_throw_to_read_char): Don't switch frames if
	internal_last_event_frame is not a frame.

	* termhooks.h (struct input_event): `code' is now an int.
	* xterm.c (construct_mouse_click, x_scroll_bar_handle_click)
	(XTread_socket): `code' of an event is now an int.
	* keyboard.c (kbd_buffer_store_event, make_lispy_event)
	(stuff_buffered_input): `code' of an event is now an int.

	* s/sol2-3.h: New file.
	* xfns.c (Fx_list_fonts): Handle BROKEN_XLISTFONTSWITHINFO.

Thu Dec 16 11:16:22 1993  Richard Stallman  (rms@gnu.ai.mit.edu)

	* xterm.c (pixel_to_glyph_coords): New arg NOCLIP.  Callers changed.

	* keyboard.c (make_lispy_movement): If we have a frame but pos is not
	in a window, return an event with the frame.

	* xterm.c (XTread_socket): For MotionNotify, if x_mouse_grabbed,
	use last_mouse_frame.
	(construct_mouse_click): Set last_mouse_frame.
	(XTmouse_position): If x_mouse_grabbed, use last_mouse_frame.

	* xdisp.c (message): Use message2, not message1.

Wed Dec 15 11:20:54 1993  Richard Stallman  (rms@gnu.ai.mit.edu)

	* xfns.c (Fx_create_frame): Add frame to Vframe_list.
	* frame.c (make_terminal_frame): Add frame to Vframe_list.
	(make_frame): Don't add to frame list here.

	* window.c (Fdisplay_buffer): If pop_up_frames, pass t to
	Fget_buffer_window.

	* Makefile.in.in (configuration): New variable.
	(emacs.o): Define macro CONFIGURATION.
	* emacs.c (syms_of_emacs): Define Lisp var system-configuration.

	* xdisp.c (display_string): Fix truncation-criterion after main loop
	for termination due to LENGTH.
	* window.h (echo_area_glyphs_length): Declared.
	* print.c (printchar, strout): Set echo_area_glyphs_length.

	* keyboard.c (read_key_sequence): Don't return if in middle
	of possible function-key-map sequence, if the bindings were all
	found by case conversion.

	* lisp.h: Use WORDS_BIG_ENDIAN, not BIG_ENDIAN.
	(Qmenu_bar): Declared.

	* process.c (Fprocess_status): Use get_process, not Fget_process.

	* s/dgux.h (SYSTEM_TYPE): Make it dgux.

	* m/sun2.h (OTHER_FILES): Use ${libsrc} as dir.

Wed Dec 15 18:30:00 1993 Michal Jankowski (michalj@fuw.edu.pl)

        * insdel.c (del_range): Second argument in call to
        offset_intervals is 'from', not 'point'.

Tue Dec 14 21:42:46 1993  Richard Stallman  (rms@gnu.ai.mit.edu)

	* emacs.c (memory_warning_signal): New function.
	(main): Handle SIGDANGER, if defined.

	* minibuf.c (minibuffer_auto_raise): Really define it.

	* process.c [BROKEN_O_NONBLOCK]: Undefine O_NONBLOCK.

Tue Dec 14 20:59:54 1993  Roland McGrath  (roland@churchy.gnu.ai.mit.edu)

	* dispnew.c (update_frame): Only call sleep (outq / baud_rate) if
	baud_rate >= OUTQ.  Calling sleep (0) causes a gratuitous delay on
	some systems.

Mon Dec 13 00:30:12 1993  Andreas Luik  (luik@kepler.isa.de)

	* xterm.c (x_calc_absolute_position): Borderwidth must be doubled
	before subtracting from width to get correct value.

	* xfns.c (Fx_create_frame): Fix order of arguments of
	x_wm_set_size_hint call.  This corrects handling of +x-y and -x+y
	geometry specifications.

Sun Dec 12 19:08:01 1993  Richard Stallman  (rms@gnu.ai.mit.edu)

	* xdisp.c (echo_area_glyphs_length): New variable.
	(message1): Set it.
	(message2): New function.
	(display_string): New arg LENGTH.
	(echo_area_display): Pass new arg to display_string.
	(redisplay_window): Likewise.
	(display_text_line): Likewise.
	(display_menu_bar): Likewise.
	(display_mode_element): 

	* editfns.c (Fmessage): Use message2.

	* keyboard.c (set_waiting_for_input): Code testing echo_flag deleted.
	(echo_flag, echo_now): Vars deleted.

	* keyboard.c (read_key_sequence): Bind case_converted at top level.
	Clear it at replay_sequence.
	(follow_key): Never clear *CASE_CONVERTED.

Sat Dec 11 20:05:35 1993  Richard Stallman  (rms@gnu.ai.mit.edu)

	* xselect.c (x_get_foreign_selection): Use x_catch_errors.

	* fileio.c (Fmake_symbolic_link): Do expand FILENAME if starts with ~.

	* keymap.c (Fwhere_is_internal): Doc fix.

	* buffer.c (Fbuffer_disable_undo): Make arg optional.

Sat Dec 11 17:26:28 1993  Roland McGrath  (roland@churchy.gnu.ai.mit.edu)

	* unexsunos4.c [! MAP_FILE] (MAP_FILE): Define to zero.
	(unexec): Remove unused variable BUF.
	Use MAP_FILE bit in mmap call.
	(run_time_remap): Use MAP_FILE bit in mmap call.

Thu Dec  9 21:52:16 1993  Richard Stallman  (rms@gnu.ai.mit.edu)

	* insdel.c (modify_region): Call record_first_change if necessary.

	* emacs.c (main): Don't handle SIGDANGER.

	* minibuf.c (minibuffer_auto_raise): New variable.
	(syms_of_minibuf): Set up Lisp var.
	(read_minibuf): Maybe raise the minibuffer's frame.

Wed Dec  8 18:49:40 1993  Roland McGrath  (roland@churchy.gnu.ai.mit.edu)

	* dispnew.c (PENDING_OUTPUT_COUNT) [__GNU_LIBRARY__]: Alternate
	definition for the GNU C library.  I changed this in version 18 in
	1991, but the change never got propagated.

Tue Dec  7 11:49:34 1993    (pmr@legacy.pajato.com)

	* s/dgux.h (SYSV4_PTYS): Remove.
	(SIGNALS_VIA_CHARACTERS): Defined.

	* process.c (create_process): Delete SYSV4_PTYS code.
	(deactivate_process): Likewise.
	
Mon Dec  6 21:54:13 1993  Richard Stallman  (rms@gnu.ai.mit.edu)

	* doc.c (Fsubstitute_command_keys): Ignore menu bar bindings.

	* s/sunos4-1.h (LIBS_SYSTEM): Use -lresolv if HAVE_RES_INIT
	is not defined and HAVE_GETHOSTNAME is defined.

	* keyboard.c (syms_of_keyboard): Define Lisp var track-mouse.

	* keyboard.c (follow_key): New arg case_converted.
	(read_key_sequence): Pass the new arg.
	If key has a binding via case-conversion, that does not prevent
	use of function_key_map.

Sun Dec  5 13:33:47 1993  Richard Stallman  (rms@gnu.ai.mit.edu)

	* m/pmax.h (SET_CHILD_PTY_PGRP): Defined.

	* process.c (create_process) [SET_CHILD_PTY_PGRP]: Do ioctls
	to set the pgrp of the pty.

Sat Dec  4 15:00:10 1993  Richard Stallman  (rms@gnu.ai.mit.edu)

	* xfns.c (XSetWMProtocols): New function, defined conditionally.

	* config.h.in (HAVE_XSETWMPROTOCOLS): Add #undef.

	* intervals.c (graft_intervals_into_buffer): If SOURCE is null
	and TREE is null, no need to call Fset_text_properties.

	* dispnew.c (Fsit_for): Call prepare_menu_bars.
	* keyboard.c (read_char): Call prepare_menu_bars.
	* xselect.c (x_handle_selection_clear): Call prepare_menu_bars.
	* vmsproc.c (Fcall_process): Call prepare_menu_bars.
	* sysdep.c [VMS] (wait_for_kbd_input): Call prepare_menu_bars.
	* process.c (wait_reading_process_input): Call prepare_menu_bars.
	* callproc.c (Fcall_process): Call prepare_menu_bars.
	* keyboard.c (tracking_off): Call prepare_menu_bars.
	* xdisp.c (update_menu_bar, update_menu_bars): New functions.
	(prepare_menu_bars): New function.
	(redisplay_window): Don't update menu bar here.
	(display_menu_bar): Assume item list already updated.

Thu Dec  2 23:45:17 1993  Richard Stallman  (rms@gnu.ai.mit.edu)

	* editfns.c (Fsubst_char_in_region): Move the NOUNDO hacking code
	after the modify_region call.

Wed Dec  1 21:01:53 1993  Richard Stallman  (rms@gnu.ai.mit.edu)

	* eval.c (Fmacroexpand): For an autoload definition,
	check the 4th elt, not the car of the 4th elt.

	* m/mips4.h (C_DEBUG_SWITCH): Delete  -systype bsd43; not needed.

	* regex.c (regex_compile) [!MATCH_MAY_ALLOCATE]: If fail_stack.stack
	is nonzero, leave it alone.

	* fileio.c (Fread_file_name): If defalt is nil and user tries to use
	it, signal an error.

	* lisp.h (DEFUN_ARGS_MANY, DEFUN_ARGS_UNEVALLED, DEFUN_ARGS_0,...): 
	New macros.
	(DEFUN) [__STDC__]: Use those macros.

	* doc.c (Fdocumentation_property): 3 args is maximum.

	* callproc.c (Fgetenv): One arg is maximum.

Tue Nov 30 17:17:33 1993  Richard Stallman  (rms@gnu.ai.mit.edu)

	* dispnew.c (direct_output_forward_char):
	Give up if in truncated text at end of line.

	* process.c (create_process): The test to avoid closing forkin
	is now conditional on #ifndef SIGNALS_VIA_CHARACTERS.

	* xdisp.c (redisplay_window): Don't alter lpoint when w is
	selected window in a non-selected frame.

Tue Nov 30 14:46:38 1993  Richard Stallman  (rms@gnu.ai.mit.edu)

	* Makefile.in.in [__GNUC__ > 1]: Maybe define LINKER_WAS_SPECIFIED.
	[LINKER_WAS_SPECIFIED] (YMF_PASS_LDFLAGS): Define as identity.

	* m/mips4.h (NO_MODE_T): Defined.

Sat Nov 27 04:41:22 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* Version 19.22 released.

	* m/tek4300.h (NO_MODE_T): Defined.

Fri Nov 26 05:38:17 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* process.c (deactivate_process) [SVR4_PTYS]:
	If subtty is not nil, close it.

	* keyboard.c (kbd_buffer_get_event): For delete-window-event,
	do count iconified frames.

	* xfns.c (x_window): Call XSetWMProtocols.

	* keyboard.c (kbd_buffer_get_event): If user destroys the last frame,
	exit before calling Fdelete_frame.

	* s/irix5-0.h (SYSTEM_TYPE): Make it "irix".

	* sysdep.c (closedir): Test BROKEN_CLOSEDIR, not INTERRUPTIBLE_CLOSE.

Thu Nov 25 00:39:17 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* keyboard.c (read_avail_input): Undo Nov 18 change.

	* lread.c (readevalloop): Get error if buffer being eval'd is killed.

	* s/irix3-3.h (SETPGRP_RELEASES_CTTY): Defined.
	* s/irix5-0.h (IRIX5, SETPGRP_RELEASES_CTTY): Defined.
	* process.c (create_process): Do setpgrp for USG regardless of IRIX.
	(process_send_signal) [IRIX5]: For SIGTSTP, use VSUSP, not VSWTCH.
	* callproc.c (child_setup): Test SETPGRP_RELEASES_CTTY, not IRIX.
	(init_callproc): Fix previous change.

	* s/sunos4-1-3.h [!SYSTEM_MALLOC] (MEMMOVE_MISSING): Defined.

	* keyboard.c (quit_throw_to_read_char):
	Look at internal_last_event_frame only if MULTI_FRAME.

	* m/ibmrt.h (HAVE_FTIME): Deleted (autoconf does it).

	* m/hp9000s800.h (bcopy, bzero, bcmp): If HAVE_BCOPY, don't #define.

	* s/sco4.h (LIBS_SYSTEM): Always define this one way or another.
	Include -lPW in it.

	* intervals.c (merge_properties_sticky): Declared.

	* regex.c (MAX, MIN): Undef before defining.

	* frame.c (Fhandle_switch_frame, Fredirect_frame_focus): Declared.

	* m/delta.h (HAVE_RANDOM, HAVE_XSCREENNUMBEROFSCREEN, BROKEN_FIONREAD):
	Add definitions.
	(LIB_X11_LIB, LIBX11_SYSTEM): Add override definitions.
	(USG_SHARED_LIBRARIES): Add #undef.

	* sysdep.c (init_baud_rate): Avoid referring to sg uninitialized.

Wed Nov 24 03:01:23 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* emacs.c (main) [AIX]: Don't handle signals 23, SIGAIO, SIGPTY.

	* indent.c (Fmove_to_column): Increments for control characters
	were too low by 1.

	* process.c (Fdelete_process): Fix paren error.

	* sysdep.c (closedir): Pass on the value from sys_closedir.
	Do use this definition, if INTERRUPTIBLE_CLOSE.

Tue Nov 23 00:09:48 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* s/sco4.h (LIBX11_SYSTEM): Override the definition.

	* xterm.c (XTread_socket): Really handle Xatom_wm_window_moved events.

	* s/irix5-0.h (SIGNALS_VIA_CHARACTERS): Defined.

	* fileio.c (Finsert_file_contents): Don't call signal_after_change
	if we did not call prepare_to_modify_buffer.

	* editfns.c (make_buffer_string): Don't copy intervals
	if we don't really have any properties.

	* lisp.h: Declare Fnext_single_property_change
	and Fnext_property_change.

	* s/sco4.h (HAVE_GETTIMEOFDAY): Define only if HAVE_SOCKETS.
	Fix up conditionals changed recently.

	* editfns.c (Finsert_buffer_substring):
	Pass graft_intervals_into_buffer the current buffer.

	* intervals.c (graft_intervals_into_buffer): New arg LENGTH.
	If source has no intervals, set dest properties to nil.
	* editfns.c (Finsert_buffer_substring): Pass new arg.
	* insdel.c (insert_from_string): Likewise.

	* callproc.c (init_callproc): Maybe add ../lib-src to exec-path
	and maybe store it in exec-directory.
	Mabe put ../etc into data-directory.
	(init_callproc_1): Part of init_callproc is split out.
	* emacs.c (main): Call init_callproc and init_callproc_1.

Mon Nov 22 10:01:51 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* editfns.c (Fsubst_char_in_region): Call modify_region only if
	a change has to be made.  Call signal_after_change just once, at end.

	* lread.c (OBARRAY_SIZE): Increase from 509.

	* xrdb.c (search_magic_path): Fix colon-colon case.

	* textprop.c (Ftext_property_not_all):
	For trivial yes, return start, not Qt.

	* xselect.c (Fx_disown_selection_internal): When making the fake
	event for x_handle_selection_clear, use SELECTION_EVENT_... macros.

Sun Nov 21 14:06:21 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* s/sunos4-1-3.h (HAVE_TERMIOS, BSD_TERMIOS): Deleted.

	* systty.h (EMACS_GET_TTY_PGRP, EMACS_SET_TTY_PGRP):
	If HAVE_TERMIOS and BSD_TERMIOS, don't use tc[sg]etpgrp.

	* xfns.c (x_set_frame_parameters): Call check_frame_size
	before Fset_frame_size and Fset_frame_position.

	* termhooks.h (delete_window_event): New event kind.
	* xterm.c (XTread_socket): Generate delete_window_event's.
	* keyboard.c (kbd_buffer_get_event): Handle delete_window_event's.

	* s/sco4.h [HAVE_SOCKETS] (HAVE_XSCREENNUMBEROFSCREEN): Defined.

	* keymap.c: Doc fix.

	* window.c (window_loop, case DELETE_BUFFER_WINDOWS):
	Select a new buffer only if w is selected window.

	* hftctl.c: Include config.h.  Include sys/signal.h before config.h.
	(sav_alrm): Use SIGTYPE.
	(FUNC): Typedef deleted.

	* Makefile.in.in (hftctl.o): New rule.

	* process.c (wait_reading_process_input):
	Use -1 to mean wait_channel is empty.
	Start process loop with descriptor 0 if keyboard_descriptor is not 0.
	(make_process): Initialize descriptors to -1.
	(Fdelete_process): -1 means empty, in infd.
	(deactivate_process): Likewise.
	(process_send_signal): Likewise.
	(kill_buffer_processes): Likewise.
	(sigchld_handler): Likewise.
	(status_notify): Likewise.
	(close_process_descs): Likewise.
	(create_process): Likewise.
	(Fopen_network_stream): Likewise.
	(send_process): Likewise.
	(Fprocess_send_eof): Likewise.  Use XINT when closing outfd.
	(Fset_process_filter): Use XINT to get infd value.
	(wait_reading_process_input): Likewise.

	* process.c (wait_reading_process_input): When bypassing select,
	clear Available.

	* sysdep.c (getwd): If getcwd returns 0, we return 0.
	(getwd for VMS): Likewise.

Sat Nov 20 00:52:53 1993  Paul Reilly  (pmr@legacy.pajato.com)

	*  s/dgux.h (PTY_ITERATION, PTY_NAME_SPRINTF, PTY_TTY_NAME_SPRINTF): 
	Defined (copied from usg5-4.h).
	(FIRST_PTY_LETTER): Deleted.

Sat Nov 20 00:16:59 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* frame.c (Fmake_frame_visible): Doc fix.

	* textprop.c (Ftext_property_not_all): Swap t and nil values in
	the case where there are no intervals.
	(Fprevious_single_property_change, Fprevious_property_change)
	Extra arg LIMIT.  Return value was off by 1.
	(Fnext_single_property_change, Fnext_property_change): 
	Extra arg LIMIT.
	(Fnext_single_property_change): Require at least 2 args.
	* indent.c (compute_motion):
	Pass new arg to Fnext_single_property_change.
	* xfaces.c (compute_char_face): Accept new arg LIMIT.
	Pass Fnext_single_property_change its new arg LIMIT.
	* xdisp.c (display_text_line): Pass new arg to compute_char_face
	and to Fnext_single_property_change.
	* dispnew.c (direct_output_for_insert):
	Pass new arg to compute_char_face.

	* keyboard.c (follow_key): When downcasing, downcase just the
	basic part of the character, and preserve the modifier bits.

Fri Nov 19 22:49:05 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* keyboard.c (read_key_sequence): If we get a quit, and current buffer
	has changed, replay it to get proper keymap.
	(quit_throw_to_read_char): Switch frames to the frame the quit was in.

Fri Nov 19 20:42:06 1993  Roland McGrath  (roland@churchy.gnu.ai.mit.edu)

	* buffer.c (Frename_buffer): When the current buffer is already
	named NAME, don't short-circuit and just return unless UNIQUE is
	nil.  This makes passing UNIQUE=t equivalent to (rename-buffer
	(generate-new-buffer-name NAME)).  This is useful way to rename
	the buffer automatically so you can create another with the
	original name.

Fri Nov 19 12:43:47 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* keyboard.c (quit_throw_to_read_char): Select the frame
	which the quit char was typed in.

	* s/linux.h (HAVE_UNISTD_H): No need to define here.

	* buffer.c (Flist_buffers): Always return a value.

	* minibuf.c (read_minibuf): History list always gets strings,
	not Lisp objects made by read.

Thu Nov 18 01:04:39 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* keyboard.c (read_avail_input): Don't set nread to -1
	if we loop around in the loop that calls read.

	* sysdep.c (read_input_waiting): read_socket_hook
	delivers events, not characters.  Make buf smaller
	in the case where we actually call read itself.

	* ralloc.c (r_alloc_init): Explicitly use real_morecore
	to allocate the entire incomplete page.

	* frame.c (Fmake_frame_visible): Use FRAME_SAMPLE_VISIBILITY.

	* s/dgux.h (FIRST_PTY_LETTER): Defined.

Wed Nov 17 06:01:02 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* keymap.c (Fkey_binding): Doc fix.

	* cmds.c (keys_of_cmds): Make 0377 self-inserting.

Tue Nov 16 00:34:22 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* Version 19.21 released.

	* doprnt.c (doprnt): Cast the value alloca returns.

	* gmalloc.c [HPUX8]: Include unistd.h earlier on.

	* s/sunos4shr.h (GNU_MALLOC, REL_ALLOC): Don't define if
	already defined.

	* s/hpux8.h (LD_SWITCH_SYSTEM) [hp9000s700]: Add -L/lib/pa1.1.

	* Makefile.in.in (extraclean): Prevent wildcard from starting comment.
	(distclean): Do delete Makefile and Makefile.in.

Sun Nov 14 18:00:30 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* systty.h [BSD_TERMIOS]: Under NL0, NL1..., ECHO, NOFLSH, TOSTOP,
	FLUSHO and PENDIN.
	* s/sunos4-1-3.h (BSD_TERMIOS): Defined.

	* regex.c (re_set_registers): Use `regoff_t *' when casting 0.

	* Makefile.in.in: Delete spurious CFLAGS=-g.

	* s/sco4.h (HAVE_GETTIMEOFDAY): Don't define if already defined.

	* keyboard.c (read_avail_input): Make cbuf 1 char shorter.

Sun Nov 14 00:14:37 1993  Paul Reilly  (pmr@legacy.pajato.com)

	* s/dgux.h (INTERRUPT_INPUT): Undefined.
	(BROKEN_FIONREAD): Defined to work around a problem in DGUX
	whereby emacs will stop on a background write when invoked from a
	job control shell for the first time in a session.
	(FIRST_PTY_LETTER): Undefined.
	(PTY_ITERATION, PTY_NAME_SPRINTF, PTY_TTY_NAME_SPRINTF): Defined
	to use all the available PTYs in a COFF environment.
	(LINKER): Removed "-nostdlib" from to be compatible with a prior
	mod removing "/lib/crt0.o" from the LIBS_SYSTEM define.
	(LIBS_SYSTEM): Delete /lib/crt0.o.

Sun Nov 14 01:29:44 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* xterm.c (XTread_socket): Increase length of copy_buffer to 81.

	* lread.c (read1): If token has a \, don't treat it as a number.

Sat Nov 13 01:18:56 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* process.c (IN_ADDR, NUMERIC_ADDR_ERROR): New macros (two versions).
	(Fopen_network_stream): Use them.

	* doprnt.c: Include config.h.

	* keyboard.c (read_avail_input) [no FIONREAD]: On DGUX, as on USG,
	read input with O_NDELAY.

	* s/dgux.h (SYSTEM_MALLOC): Turned off.
	(NO_TERMIO): Defined.
	(BROKEN_FASYNC): Turned off.

	* buffer.c (Foverlay_put): Don't call redisplay_region
	if overlay has no buffer.

Fri Nov 12 15:38:15 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* process.c (get_process): Add `static' to definition.

	* xterm.c (XTmouse_position): Delete test inserted Nov 10.

	* fileio.c (syms_of_fileio): Fix missing \n\'s.

	* keyboard.c (Fread_key_sequence): Split the doc string with "".

	* textprop.c (Fprevious_single_property_change): Fix missing \n\.
	(Fnext_single_property_change): Likewise.

Wed Nov 10 21:32:40 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* Version 19.20 released.

	* callproc.c (Fcall_process): Clear synch_process_death and
	synch_process_retcode before the vfork.

	* xterm.c (XTmouse_position): Undo roland's change.
	Fix bug in bfox change.

Wed Nov 10 17:58:16 1993  Roland McGrath  (roland@churchy.gnu.ai.mit.edu)

	* unexec.c [! HPUX]: Don't declare sbrk at all, so as not to
	conflict with system headers.

	* xterm.c (XTmouse_position): First arg is FRAME_PTR, not
	FRAME_PTR *.

Wed Nov 10 15:12:22 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* s/convexos.h: New file.

Wed Nov 10 15:12:22 1993  Brian Fox  (bfox@mole.gnu.ai.mit.edu)

	* Makefile.in.in (intervals.o): Depend on puresize.h.

	* intervals.c (create_root_interval): Check to see if PARENT is in
	pure memory.  If so, we cannot write it.
	(includes): Add "puresize.h" so we get the definition of CHECK_IMPURE.

	* xterm.c (XTmouse_position): If the passed in frame is not an
	Xwindow frame, don't do anything.

	* frame.c (Fraise_frame): Do like the documentation says, and make
	the frame visible first.

	* systty.h (EMACS_GETPGRP): New macro hides argument passing to
	system getpgrp.  Reinstate some semblance of control over this
	macros behaviour by paying attention to GETPGRP_NO_ARG.
	* sysdep.c (sys_suspend): Use EMACS_GETPGRP macro.
	* emacs.c (main): Use EMACS_GETPGRP macro.
	(shut_down_emacs): Use EMACS_GETPGRP macro.

	* alloc.c (make_pure_string): If we USE_TEXT_PROPERTIES, set the
	interval of the pure string to NULL_INTERVAL.

	* syswait.h: Treat convex like hpux.

	* search.c (Fskip_chars_backward, Fskip_chars_forward): Doc fix.

Wed Nov 10 01:09:22 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* syntax.c (Fforward_comment): On backward scan, exit inner loop
	after we reach beginning of a comment.
	Check the SYNTAX_COMMENT_STYLE of a one-character comment ender.
	(scan_lists): Check the SYNTAX_COMMENT_STYLE
	of a one-character comment ender.

	* sysdep.c (read_input_waiting): Don't mess with meta bit
	if read_socket_hook is nonzero.

	* sysdep.c (LPASS8, LNOFLSH): Move definitions earlier.
	(child_setup_tty): Turn on LPASS8.

	* search.c (skip_chars): Finish reenabling checks for buffer bounds.
	Use XINT, not XFASTINT, when testing.

	* fileio.c (Fwrite_region): Fix minor bugs in POS arg to awrite.

	* xterm.c (syms_of_xterm): Initialize last_mouse_scroll_bar.

Tue Nov  9 16:33:49 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* buffer.c, editfns.c: Doc fix.

Sat Nov  6 00:13:11 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* sysdep.c (child_setup_tty): Make the pty handle 8-bit characters.

Thu Nov  4 17:09:11 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* s/linux.h [TERM]: Alternate definitions of LIBS_MACHINE
	and C_SWITCH_MACHINE.

	* process.c [TERM]: Include client.h.
	(Fopen_network_stream): Handle TERM.

Wed Nov  3 15:31:21 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* xterm.c (x_new_font): xmalloc arg was 1 too small.

Mon Nov  1 23:59:26 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* s/sunos4-1-3.h (HAVE_TERMIOS): Defined.

Mon Oct 25 00:41:31 1993  Brian Fox  (bfox@albert.gnu.ai.mit.edu)

	* process.c (Fopen_network_stream): Cast arg to inet_addr to (char *).

	* search.c (Freplace_match): Fix argument names to match doc string.
	(Fmatch_beginning): Fix doc string to match argument name.

	* floatfns.c: Declare `logb' only if HAVE_LOGB is defined.

	* fileio.c (Fcopy_file): Don't allow the copying of anything other
	than regular files or symlink files.

Sun Oct 24 17:25:52 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* keyboard.c (read_key_sequence): Arg prompt is now a Lisp object.
	Pass it to functions found in function-key-map and key-translation-map.
	(Fread_key_sequence, command_loop_1): Calls changed.

Fri Oct 22 07:22:12 1993  Brian Fox  (bfox@albert.gnu.ai.mit.edu)

	* config.h.in: Add #undef HAVE_UNISTD_H so configure can edit it
	correctly.

Thu Oct 21 21:15:37 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* process.c (status_notify): Don't read from process if filter is t.
	(Fset_process_filter): Set or clear bit in input_wait_mask when nec.

Tue Oct 19 22:46:54 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* data.c [hpux 7] (_MAXLDBL, _NMAXLDBL): New macro definitions.

Tue Oct 12 18:14:58 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* keyboard.c (read_key_sequence): Allow function in key-translation-map
	just as in function-key-map.

Mon Oct 11 00:13:12 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* buffer.c (Fdelete_overlay, Foverlay_put): Use marker_position,
	not OVERLAY_POSITION, to get args for redisplay_region.

	* fileio.c (Fcar_less_than_car): Fix typo in previous change.

Sat Oct  9 16:43:23 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* floatfns.c [hpux 7] (_MAXLDBL, _NMAXLDBL): New macro definitions.

	* fileio.c (Vafter_insert_file_functions): New variable.
	(Vwrite_region_annotate_functions): New variable.
	(Qcar_less_than_car): New variable.
	(Fcar_less_than_car): New function.
	(syms_of_fileio): Make Lisp variables and function available.
	staticpro Qcar_less_than_car.
	(a_write, build_annotations): New functions.
	(Fwrite_region): Call them.
	(Finsert_file_contents): Run the Vafter_insert_file_functions.

Fri Oct  8 11:05:23 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* s/sco4.h (SYSTEM_TYPE): Put into #if 0.
	(BSTRING): Define only if HAVE_BCOPY.

Fri Oct  8 03:36:20 1993  Brian Fox  (bfox@albert.gnu.ai.mit.edu)

	* search.c (skip_chars): Re-instate the check against the end of
	the buffer, ignoring cryptic comment.

Thu Oct  7 21:29:38 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* keyboard.c (read_key_sequence): Allow function-key-map to have a
	function as the binding; call the function and use its value.

Mon Oct  4 03:48:51 1993  Brian J. Fox  (bfox@ai.mit.edu)

	* minibuf.c (Fminibuffer_complete_word): GCPRO1 `completion'
	during calls to Ftry_completion.

	* keyboard.c (read_key_sequence): Don't declare first_event; it is
	no longer used.  Change "#if 0" for first_event reading to
	 "#if defined (GOBBLE_FIRST_EVENT)".

Sun Oct  3 12:21:23 1993  Brian J. Fox  (bfox@ai.mit.edu)

	* lisp.h: Doc fix.

	* minibuf.c (read_minibuf): Rewrite change of Sep 14.  Save the
	return value on the history list provided in the form that the
	value is returned, iff the value is not equal to the front of the
	history list.

Sun Oct  3 19:03:19 1993  Roland McGrath  (roland@churchy.gnu.ai.mit.edu)

	* Makefile.in: File removed.  It is now generated by ../configure.

	* Makefile.in.in (LIBES): Add $(GNULIB_VAR) again at end.  This
	change to ymakefile was mysteriously lost.  Were any others lost
	too?

Sat Oct  2 15:07:50 1993  Brian J. Fox  (bfox@ai.mit.edu)

	* minibuf.c (Fread_no_blanks_input): Change DEFUN to allow 2nd arg
	to be optional.  The code was already written correctly.

Thu Sep 30 01:22:06 1993  Brian J. Fox  (bfox@ai.mit.edu)

	* systty.h: If POSIX and HAVE_UNISTD_H are defined, and unistd.h
	hasn't already been included, include it.

	* s/linux.h (POSIX_SIGNALS): Comment fix.

Thu Sep 30 19:37:15 1993  Brian Fox  (bfox@albert.gnu.ai.mit.edu)

	* Makefile.in.in (ALL_CFLAGS): Make sure that `.' is searched
	before `${srcdir}' when looking for include files.

Tue Sep 28 05:56:12 1993  Jim Blandy  (jimb@geech.gnu.ai.mit.edu)

	* termhooks.h (enum event_kind): Doc fix.

Mon Sep 27 08:59:44 1993  Brian Fox  (bfox@ai.mit.edu)

	* ymakefile: Merged into Makefile.in.in.

	* Makefile.in.in: New file.  Now ../configure creates Makefile.in
	from Makefile.in.in, and creates Makefile from Makefile.in.
	ymakefile no longer exists, and xmakefile is never created.

Fri Sep 24 18:22:32 1993  Brian Fox  (bfox@ai.mit.edu)

	* textprop.c (validate_plist): Add declaration for `list'
	argument.

	* frame.c (Fhandle_switch_frame): Doc fix.

Sat Sep 25 18:46:34 1993  Roland McGrath  (roland@churchy.gnu.ai.mit.edu)

	* puresize.h: [MULTI_FRAME]: Increase PURESIZE to 220000.

Thu Sep 16 16:09:05 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* s/sunos4-1.h (LIBS_SYSTEM): Use -lresolv if it seems appropriate.

	* config.h.in: Add #undef HAVE_RES_INIT.

Tue Sep 14 15:06:08 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* m/mips4.h (LIB_STANDARD): Add a second -lc after crtn.o.

Mon Sep 13 00:07:33 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* pwd.h: File deleted.

	* intervals.c (graft_intervals_into_buffer): New arg INHERIT.

	* editfns.c (Finsert_buffer_substring): Pass extra arg to
	graft_intervals_into_buffer.
	* insdel.c (insert_from_string): Likewise.  New arg INHERIT.
	(insert_from_string_before_markers): New arg INHERIT.

	* search.c (Freplace_match): Call Finsert_and_inherit.

	* editfns.c (Finsert_and_inherit): New function.
	(Finsert_and_inherit_before_markers): New function.
	(Finsert, Finsert_before_markers): Pass new arg to insert_from_string*.
	* minibuf.c (Fminibuffer_complete_word):
	Pass new arg to insert_from_string*.
	* doc.c (Fsubstitute_command_keys): Pass new arg.
	* abbrev.c (Funexpand_abbrev, Fexpand_abbrev): Pass new arg.

	* s/aix3-2.h (AIX3_2): Defined.
	* m/ibmrs6000.h (LIBS_MACHINE): Include -lrts, -liconv only if AIX3_2.

	* xterm.h (HAVE_X11R4): If AIX, do not define HAVE_X11R4.

Sun Sep 12 08:36:02 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* sysdep.c (bzero, bcopy, bcmp): Don't define as functions
	if they are defined as macros.

Sat Sep 11 21:28:18 1993  Roland McGrath  (roland@baalperazim.gnu.ai.mit.edu)

	* lread.c, callproc.c, filelock.c: Include <paths.h>, not "paths.h".

Sat Sep 11 17:34:38 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* s/linux.h (LIBS_MACHINE): Make definition empty.

Fri Sep 10 01:03:00 1993  Roland McGrath  (roland@churchy.gnu.ai.mit.edu)

	* Support configuring in a different directory when ${srcdir} has
	already been configured.
	* frame.c, xfns.c, xdisp.c, casetab.c, cm.c, casefiddle.c, xterm.c,
	xrdb.c, eval.c, doc.c, lread.c, callint.c, cmds.c, term.c, fns.c,
	data.c, alloc.c, unexconvex.c, fileio.c, indent.c, bytecode.c,
	sunfns.c, xmenu.c, buffer.c, textprop.c, marker.c, print.c,
	emacs.c, dispnew.c, syntax.c, undo.c, mocklisp.c, scroll.c,
	search.c, ralloc.c, unexaix.c, unexec.c, unexenix.c, unexmips.c,
	unexsunos4.c, vmsfns.c, vmsmap.c, dired.c, xselect.c, floatfns.c,
	filelock.c, sysdep.c, abbrev.c, minibuf.c, xfaces.c, callproc.c,
	insdel.c, intervals.c, process.c, vm-limit.c, window.c,
	vmsgmalloc.c, keymap.c, editfns.c, keyboard.c, macros.c, vmstime.c:
	Include <config.h> instead of "config.h".
	* ymakefile (ALL_CFLAGS): Put -I. before -I${srcdir}.
	* Makefile.in (xmakefile): Use -I. in cpp run.

	* Makefile.in (clean): Use rm -f.

	* s/netbsd.h: New file.
	* ymakefile (LIBES): Add $(GNULIB_VAR) again at end.

Wed Sep  8 12:16:25 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* sysdep.c (stuff_char): Use input_fd.
	(narrow_foreground_group, widen_foreground_group, init_sys_modes)
	(init_baud_rate, init_sigio, request_sigio, unrequest_sigio): Likewise.
	(change_input_fd): New function.

	* process.c (keyboard_descriptor): New variable.
	(wait_reading_process_input, init_keyboard): Use it.
	Also call change_input_fd.
	(change_keyboard_wait_descriptor): New function.
	* xterm.c (x_term_init): Call change_keyboard_wait_descriptor,
	instead of dup2.  Use the existing X desc number in fcntl calls.
	* xterm.c (XTread_socket): Don't forget to clear out `mask'.

Wed Sep  8 17:25:40 MET 1993  Francesco Potorti`  (pot@cnuce.cnr.it)

	* filelock.c (fill_in_lock_short_file_name): Fix the crc
	generation algorithm.

Thu Aug 19 16:19:30 1993  Roland McGrath  (roland@churchy.gnu.ai.mit.edu)

	* textprop.c (F{next,previous}_single_property_change): Doc fix.

Wed Sep 15 13:09:20 1993  Brian Fox  (bfox@ai.mit.edu)

	* data.c: Add declaration for atof if not predefined.

	* xfns.c (XScreenNumberOfScreen): Move assignments out of
	declarations for (dpy, dpyscr).

	* sysdep.c (sys_write): Keep trying to write out the data until
	all of the data is written, or until we receive an error which is
	not an interrupted write.

Tue Sep 14 01:53:37 1993  Brian Fox  (bfox@ai.mit.edu)

	* keyboard.c (Qextended_command_history): New variable prevents
	sharing of M-x command history with other commands that read
	values in the minibuffer.

	* doprnt.c (doprnt): Use a fixed buffer to store the format
	specification, but only if we are sure it will fit.  Otherwise,
	use alloca () to get enough space.  Don't allow negative size
	specifications to core dump; instead, treat them as positive
	("%-20d" == "%20d").

	* minibuf.c (read_minibuf): Don't add history item if it is
	string-equal to the most recent history item.

Fri Jul  9 17:19:35 1993  Karl Berry  (karl@cs.umb.edu)

	* dired.c (file_name_completion): Install case-preserving 
	changes from Emacs 18 for completion_ignore_case.
	(completion_ignore_case): Declare.

Wed Sep  1 09:47:36 1993  Brian Fox  (bfox@ai.mit.edu)

	* window.c (Fdelete_windows_on): Fix DEFUN to allow optional
	second argument to appear.

Mon Aug 30 08:03:49 1993  Brian Fox  (bfox@ai.mit.edu)

	* ymakefile (alloc.o): Remove explicit compilation rule, since it
	is identical to the default rule, and `$<' doesn't work in
	explicit rules in all "make"s.

Fri Aug 27 00:43:06 1993  Brian Fox  (bfox@ai.mit.edu)

	* gmalloc.c (safe_bcopy): Compile if MEMMOVE_MISSING is defined,
	but only if we aren't compiling for emacs.

	* sysdep.c (read_input_waiting): If the user specifies
	`meta-flag', then notice characters with high-bit set.

	* Added fixes from Karl Berry for ISC-2.2.
	    * s/isc2-2.h (MEMMOVE_MISSING): Define.
	    (SIGNALS_VIA_CHARACTERS): Define.
	    (LIB_STANDARD): Do not include -lcposix.
	    (C_SWITCH_SYSTEM) [__GNUC__]: Do not use -traditional.

Tue Aug 17 12:20:43 1993  Brian Fox  (bfox@ai.mit.edu)

	* alloca.c: Invert sense of conditional for entire file (GNUC >=
	2).  Added `#else'.

	* xterm.c (x_wn_set_size_hint): Make recent window gravity
	addition depend on "PWinGravity" being `#defined'.

Sat Aug 14 00:23:11 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* Version 19.19 released.

	* Makefile.in (mostlyclean): Don't delete emacs here.
	(clean): Delete emacs and emacs-* here.
	(distclean): Don't delete emacs-* here.

	* xselect.c (struct property_change): New field `arrived'.
	(expect_property_change): Return struct property_change *.
	Clear `arrived'.
	(unexpect_property_change): Take one as argument.
	(wait_for_property_change): Take one as argument.
	If `arrived' is set, don't wait.
	(wait_for_property_change_unwind): Corresponding changes.
	(receive_incremental_selection): Corresponding changes.
	(x_reply_selection_request): Corresponding changes.
	(property_deleted_p): Function deleted.

	* xselect.c (x_handle_selection_clear): Redisplay.

	* search.c (compile_pattern): Cast result of re_compile_pattern.

	* emacs.c (init_cmdargs): Check openp result for 1, not != 0.

	* xterm.c (x_wm_set_size_hint): New args spec_x and spec_y.
	Set the window gravity.  All callers changed.
	* xfns.c (Fx_create_frame): Pass the new args to x_wm_set_size_hint.

	* xmenu.c (Fx_popup_menu): Adjust coords so they are relative
	to the inner window.

	* syswait.h: New file.
	* sysdep.c, process.c: Include it.
	* ymakefile (sysdep.o, process.o): Depend on syswait.h.

	* process.c (wait_reading_process_input): Exit without waiting
	if wait_for_cell is already non-nil.

	* sysdep.c (mkdir, rmdir): Use wait_for_termination to wait.
	Redirect descriptors 0...2 to /dev/null.

	* emacs.c (__CTOR_LIST__): Don't declare it on Linux.

	* filelock.c (getpwuid): Declare it as in xrdb.c.
	(init_filelock): Don't use return value of strcpy.

	* fns.c (internal_equal): Typo in previous change.

	* xfns.c (x_set_frame_parameters): Don't die if just one of
	height and width was set.  Likewise left and top.

	* textprop.c (property_change_between_p): Test NULL_INTERVAL_P
	in loop, before looking at next->position.

	* intervals.c (adjust_intervals_for_insertion): If inserting in middle
	of interval that is sticky in neither direction, don't copy props.
	(merge_properties_sticky): Handle non-list as front-sticky or
	rear-nonsticky property.

Fri Aug 13 23:49:07 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* fns.c (internal_equal): All markers in no buffer are equal.

Fri Aug 13 19:35:52 1993  Roland McGrath  (roland@churchy.gnu.ai.mit.edu)

	* config.h.in: Added #undef HAVE_XSCREENNUMBEROFSCREEN.

Fri Aug 13 17:38:53 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* xfns.c (XScreenNumberOfScreen): New function.

	* m/tek4300.h (C_DEBUG_SWITCH, SYSTEM_MALLOC): Defined.

	* m/iris4d.h (START_FILES, LIB_STANDARD): Don't define if USG5_4.
	(DEFAULT_ENTRY_ADDRESS): Likewise.
	(UNEXEC): Use unexelfsgi.o if USG5_4.

	* s/irix5-0.h (C_SWITCH_MACHINE): Deleted.

Fri Aug 13 07:42:39 1993  Frederic Pierresteguy  (F.Pierresteguy@frcl.bull.fr)

	* m/dpx2.h: Delete conditionals for HAVE_X_WINDOWS and HAVE_SOCKETS.

Fri Aug 13 00:33:48 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* m/iris4d.h (C_ALLOCA): Don't define it.

	* keyboard.c (kbd_buffer_store_event): Use bcopy to copy
	a selection request event.

	* unexnext.c (get_data_region): Add cast to avoid warning.

Thu Aug 12 01:38:36 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* ymakefile (prefix-args, filemode.o, lastfile.o): Dep on $(config_h).

	* floatfns.c (Flogb): Error at run time if not supported.

	* ymakefile (emacs.o): Depend on process.h and syssignal.h.
	* emacs.c: Include process.h.
	(init_cmdargs): Use EXEC_SUFFIXES.

	* s/irix5-0.h: Include alloca.h if appropriate.
	Fix the #include file name.
	(ULIMIT_BREAK_VALUE, GETPGRP_NO_ARG, NO_MATHERR): New macros.
	(LIB_STANDARD): #undef it.

	* frame.c (Fdelete_frame): Add parens for clarity.

	* keyboard.c (read_char): Never start echoing if -batch.

	* minibuf.c (Qread_file_name_internal): New var.
	(syms_of_minibuf): Set it up and protect it.
	(Fminibuffer_complete_word): When completing a file name,
	expand envvar references.

	* xterm.c (XTread_socket): Make copy_buffer unsigned.

	* s/usg5-4-2.h (HAVE_GETHOSTNAME): #if 0'd.

Wed Aug 11 00:25:31 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* s/hpux8.h (LD_SWITCH_SYSTEM): Delete the -L options.

	* termhooks.h (enum event_kind): Delete final comma.
	(meta_modifier): Delete final comma.
	* window.c (enum window_loop): Delete final comma.
	* xfns.c (enum resource_types): Delete final comma.

	* m/ibmrs6000.h (BIG_ENDIAN): Don't actually define it.

	* window.c (Frecenter): Preserve point in the buffer we change it in.

	* cmds.c (Fnewline): If we don't do the first SET_PT,
	clear flag, so we don't do the second SET_PT.

	* keyboard.c (make_lispy_event): Clear all but 0377 in event->code.

	* xselect.c (receive_incremental_selection): Use bcopy, not memcpy.

	* m/tek4300.h (BIG_ENDIAN): Provide a value that matches the system.

	* config.h.in: Add #undef HAVE_FTIME.

	* ymakefile (ALL_CFLAGS): Use C_SWITCH_X_SITE before
	C_SWITCH_X_SYSTEM and C_SWITCH_X_MACHINE.

	* s/hpux8.h (C_SWITCH_X_SYSTEM): Define instead of C_SWITCH_SYSTEM.

Wed Aug 11 02:21:15 1993  Shane Hartman  (shane@nugget.spr.com)

	* buffer.c (verify_overlay_modification): Initialize endpos.

	* keymap.c (describe_buffer_bindings): Declare shadow just once. 

Tue Aug 10 01:46:40 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* xterm.c (x_calc_absolute_position): For negative coords, take
	account of added width from window manager's outer window.

	* term.c (term_get_fkeys_define_1, term_get_fkeys_define):
	New functions.
	(term_get_fkeys): Use them.

	* m/tekxd88.h: Renamed from tekXD88.h.
	(LIB_X11_LIB, LIBX11_SYSTEM): Make #undefs unconditional.

	* systty.h: Handle NO_TERMIO in principal HAVE_TERMIOS case.

	* xrdb.c (x_get_customization_string): Don't use value of strcpy.

	* floatfns.c (Fexpt): Use IN_FLOAT2.

Tue Aug 10 15:12:13 1993  Frederic Pierresteguy  (F.Pierresteguy@frcl.bull.fr)

	* m/dpx2.h (HAVE_TCATTR): Macro #defined.
	(HAVE_CLOSEDIR): #undef to allow use of closedir in sysdep.c.
	(SIGTSTP): Commented #undef to allow use of ^Z in shell-mode.
	(SIGNALS_VIA_CHARACTERS): #defined.

Mon Aug  9 21:40:23 1993  Paul Eggert  (eggert@twinsun.com)

	* data.c (Fmod): New function; result is always same sign as divisor.
	(syms_of_data): Add Smod.
	* emacs.c (main): Invoke syms_of_floatfns even if LISP_FLOAT_TYPE
	isn't defined, since `(floor A B)' is now needed for integers.
	* floatfns.c (syms_of_floatfns): Likewise.
	(Ffloor): Optional second operand specifies divisor, as in Common Lisp.

Mon Aug  9 21:32:01 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* unexelf.c (unexec): Add casts for some comparisons.
	(PATCH_INDEX): Likewise.

Sun Aug  8 01:15:30 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* Version 19.18 released.

	* term.c (term_init): Improve error messages (give sh commands).

	* xterm.c (struct font_info): New structure.
	(x_font_table): Use struct font_info as elements.
	(x_new_font): Corresponding changes.
	Use XListFonts, not XListFontsWithInfo.
	Use XFreeFontNames, not XFreeFontInfo.
	Compare fonts by name, not by fid.
	If already_loaded is 0, that counts as "yes".

	* minibuf.c (Qminibuffer_setup_hook, Vminibuffer_setup_hook): New vars.
	(syms_of_minibuf): Set them up.
	(read_minibuffer): Run the hook, if not empty.

	* dispnew.c (direct_output_forward_char): Fix previous change:
	verify position is in range before calling Fget_text_property,
	and calculate position properly.

	* s/bsd4-2.h, s/bsd4-3.h, s/umax.h, s/rtu.h, s/dgux.h (HAVE_VFORK):
	Defined.

	* ymakefile (alloc.o): Don't use DEBUG_MOLE.
	(DEBUG_MOLE): Deleted.
	* gnu-hp300: File deleted.

	* .gdbinit: Don't put -q in args.
	Don't unset TERM and TERMCAP--show them instead.

	* alloc.c (mark_object): Declare ptr volatile, or don't use it
	after a recursive call.  Delete the aborts if ptr is clobbered.

	* fileio.c (expand_and_dir_to_file): Use Fdirectory_file_name.

Sun Aug  8 01:56:15 1993  Jim Blandy  (jimb@geech.gnu.ai.mit.edu)

	* config.h.in (HAVE_LOGB, HAVE_FREXP): Add #undefs for the
	configuration script to edit.
	* floatfns.c (Flogb): Use HAVE_LOGB and HAVE_FREXP, instead of
	assuming that all USG systems have FREXP.

Sat Aug  7 14:56:25 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* emacs.c (Vinvocation_directory): New var.
	(init_cmdargs): Set up its value.
	(Finvocation_directory): New function.
	(main): Call init_buffer, init_callproc and init_cmdargs
	before init_lread.
	(syms_of_emacs): Install the function, and protect the variable.
	* lisp.h (Vinvocation_directory): Declared.
	* lread.c (init_lread): Normally put Vinvocation_directory
	at end of Vload_path, if not present already.

Fri Aug  6 13:28:24 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* keyboard.c (set_poll_suppress_count): New function.
	* eval.c (unwind_to_catch): Call set_poll_suppress_count.

	* xterm.c (x_term_init): Set the hooks before we call Fset_input_mode.
	* keyboard.c (Fset_input_mode): Start polling, if appropriate.
	At the beginning, stop polling.
	Remove period from error message.
	(stop_polling, start_polling): Check for interrupt_input.
	(POLL_FOR_INPUT): Define whether or not target supports SIGIO.

	* m/ibm370aix.h (HAVE_VFORK, INTEL386, aix386): Add #undef.

Thu Aug  5 13:38:03 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* eval.c (do_autoload): Don't report autoload failure
	if the autoload definition now is a different one.

	* m/ibm370aix.h: Total rewrite; includes ibmps2-aix.h.

	* m/ibmps2-aix.h (SYSTEM_TYPE): Don't redefine it here. 

	* syntax.c: Doc fix.

Wed Aug  4 00:14:53 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* fns.c (Fyes_or_no_p): Use Qyes_or_no_p_history.
	(syms_of_fns): Set up Qyes_or_no_p_history.

	* fileio.c (expand_and_dir_to_file): Remove final / by copying abspath.

	* data.c (Frem): Don't accept floats, just ints and markers.

	* m/vax.h [BSD4_2] (HAVE_FTIME): Defined.

Tue Aug  3 14:21:15 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* m/7300.h (CRT0_COMPILE): Add -O and -Demacs.
	* ymakefile (CRT0_COMPILE): Add missing #endif.

Tue Aug  3 02:58:23 1993  Jim Blandy  (jimb@geech.gnu.ai.mit.edu)

	Changes for 3b1 suggested by Andy Fyfe <andy@scp.caltech.edu>
	* 7300.h [__GNUC__]: #define HAVE_ALLOCA.
	[not __GNUC__]: #define SWITCH_ENUM_BUG, C_ALLOCA, and STACK_DIRECTION.
	(HAVE_SYSVIPC, USE_UTIME): #define these.
	(memmove): We don't have this; call safe_bcopy.
	(CRT0_COMPILE): #define this, so we always use the system's cc.
	* config.h.in: Add #undefs for HAVE_MKDIR and HAVE_RMDIR, for
	configure to edit.
	* sysdep.c [not HAVE_MKDIR] (mkdir): New function, taken from tar,
	for use on systems lacking the mkdir function.
	[not HAVE_RMDIR] (rmdir): New function, taken from tar, for use on
	systems lacking the rmdir function.
	* ymakefile (crt0.o): Replace the compiler and switches with the
	symbol CRT0_COMPILE.
	(CRT0_COMPILE): If the system and machine description files have
	left this undefined, then define it to do the same as the old
	crt0.o rule used to.

Mon Aug  2 22:40:05 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* sysdep.c (vfork): Move this outside the USG conditional.

Mon Aug  2 18:16:39 1993  Roland McGrath  (roland@churchy.gnu.ai.mit.edu)

	* frame.c (Fprevious_frame): New function, for parity with
	Fnext_frame.
	(syms_of_frame): Add defsubr for Sprevious_frame.

Mon Aug  2 17:18:46 1993  Jim Blandy  (jimb@wookumz.gnu.ai.mit.edu)

	* xdisp.c (display_menu_bar): Redisplay all lines occupied by the
	menu bar, not just the first.

Mon Aug  2 01:54:41 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* keyboard.c (read_key_sequence): Use XFASTINT to convert value
	of Flength to an int.

	* buffer.c (Fmove_overlay): Avoid initializer for Lisp_Object vars.
	(verify_overlay_modification): Declare ostart, oend as Lisp_Object.

	* frame.c (Fset_frame_position): Doc fix.

Sun Aug  1 04:42:30 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* From daveg@synaptics.com:
	* keyboard.c (last_mouse_button): Renamed from button_up_button.
	(last_mouse_x, last_mouse_y): Likewise.
	(button_down_time): Replaces button_up_time.
	(make_lispy_event): Set button_down_time.
	Detect and report double-down and double-drag events.
	(apply_modifiers_uncached): Put `double' or `triple' first.
	(read_key_sequence): Convert unbound double-drag/down to drag/down.

	* fileio.c (Finsert_file_contents): Don't call prepare_to_modify_buffer
	if inserting zero characters.

	* syntax.c: Doc fix.

Sat Jul 31 01:36:33 1993  Gregor Schmid  (schmid@fb3-s7.math.tu-berlin.de)

	Handle `sticky' text properties.
	* intervals.c (adjust_intervals_for_insertion): Handle insertion
	between two unlike intervals via merge_properties_sticky.
	(merge_properties_sticky): New function.
	(graft_intervals_into_buffer): Leave handling of `sticky'-ness to
	adjust_intervals_for_insertion, then merge properties of the
	inserted text onto the old ones.
	(textget_direct): New function.
	(set_point): Fix calculating of fromprev.
	(verify_interval_modification): Check for `read-only' property
	and take its `sticky'-ness into account.
	* intervals.h (MERGE_INSERTIONS): Define as 1.
	(FRONT_STICKY): Add real definition.
	(END_NONSTICKY): New macro.
	(END_STICKY): Deleted.
	(textget_direct, Qfront_sticky, Qrear_nonsticky): Declared.
	* textprop.c (Qfront_sticky, Qrear_nonsticky): New variables.
	(syms_of_textprop): Set them up.
		
	Change display code to handle the `invisible' text property.
	* dispnew.c (direct_output_for_insert): Fail if character 
	just inserted has text properties.
	(direct_ouput_forward_char): Fail if moving near invisible chars.
	* indent.c (compute_motion): Compute correctly for invisible text.
	(vmotion): Take care of invisible newlines.
	* intervals.c (set_point): Ignore `invisible' property
	unless property value is `hidden'.
	* intervals.h (Qhidden): Declared.
	* textprop.c (Qhidden): New variable.
	(syms_of_textprop): Set up Qhidden.
	* xdisp.c (try_window): Handle invisible newline at end of buffer.
	(display_text_line): Don't display invisible text.

Sat Jul 31 01:36:33 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* indent.c (Fmove_to_column): After we split a tab, make sure
	to set last_known... consistently.

	* editfns.c (save_excursion_restore): Never make the buffer visible.

	* s/isc3-0.h: Don't mention dir `s/' in #include.

Fri Jul 30 19:11:58 1993  Jim Blandy  (jimb@geech.gnu.ai.mit.edu)

        * config.h.in (HAVE_AIX_SMT_EXP): New #undef for configure to edit.
	* m/ibmrs6000.h (LD_SWITCH_MACHINE): Don't mention
	/usr/lpp/X11/bin/smt.exp unless HAVE_AIX_SMT_EXP is #defined.

	* config.h.in (HAVE_BCOPY): Add an #undef for this.
	(BSTRING): #define this iff HAVE_BCOPY is #defined here.  Ignore what
	the system-description files say.  They don't always make fine
	enough distinctions between systems, and sometimes the bcopy
	routines are available only with X windows.

	* config.h.in (HAVE_XSCREENRESOURCESTRING): New #undef for
	configure to edit.
	* xrdb.c (get_user_db): Test it to decide whether or not to try to
	retrieve the screen-dependent resources.

	* xfns.c (Fx_open_connection): Test the CPP symbol
	HAVE_XRMSETDATABASE to decide whether or not to call
	XrmSetDatabase.

	* xfns.c (x_set_background_color): Change the foreground color of
	the cursor, too.

Fri Jul 30 03:45:05 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* editfns.c (syms_of_editfns): Just staticpro Vuser...name
	and Vsystem_name; don't make them Lisp variables.

	* xselect.c (prop_location_identifier): Was named prop_location_tick.
	(property_change_reply_identifier): Renamed from ...-tick.
	(struct prop_location): Field `identifier' renamed from `tick'.
	Various functions changed accordingly.
	(x_handle_selection_request): Delete local struct var `reply'.

	* xselect.c (wait_for_property_change_unwind): New function.
	(wait_for_property_change): Add unwind protect.

Thu Jul 29 00:56:12 1993  Jim Blandy  (jimb@geech.gnu.ai.mit.edu)

	* xfns.c (syms_of_xfns): Don't staticpro Vx_resource_name;
	DEFVAR_LISP takes care of that, and it's deadly to staticpro a
	variable containing a string twice.

	* window.c (check_frame_size): Include the menu bar height in the
	minimum frame height.

	* ymakefile (DEBUG_MOLE): Don't put parens around the command we
	run to detect the GNU hp300 machines.  If the make is still
	somehow using csh, it complains about the parens.

Thu Jul 29 00:07:47 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* frame.c (Fdelete_frame): New arg FORCE allows deletion
	of last non-invisible frame.

	* s/usg5-4.h (bzero, bcmp, bcopy): New macros.
	(LIB_STANDARD): Don't include libucb.a.

Wed Jul 28 20:25:49 1993  Roland McGrath  (roland@churchy.gnu.ai.mit.edu)

	* xfns.c (syms_of_xfns): Use DEFVAR_LISP, not DEFVAR_INT, for
	Vx_pointer_shape.

Wed Jul 28 04:57:37 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* cmds.c (Fnewline): Disable the "insert one position before"
	optimization if it would screw up text property behavior.
	* textprop.c (property_change_between_p): New function.

Tue Jul 27 03:25:16 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* keyboard.c (command_loop_1):
	Call Qrecompute_lucid_menubar only if defined.

	* emacs.c (decode_env_path): Strip trailing slashes if there are any.

	* unexec.c (make_hdr): Use & in call to bzero.

	* xfns.c (Fx_rebind_key, Fx_rebind_keys): Functions deleted.

	* syntax.c (scan_sexps_forward): Delete extra Fcdr when analyzing
	OLDSTATE.

	* xterm.c (x_iconify_frame): Handle case where frame was invisible.

	* s/hpux8.h (OLDXMENU_OPTIONS): Definition deleted.

	* ymakefile (really-oldXMenu): Pass down C_SWITCH_X_SYSTEM.

	* m/delta88k.h [USG5_4] (LIBX11_SYSTEM): Don't redefine in this case.

	* search.c (search_buffer): If n is 0, just return POS.

Mon Jul 26 14:37:40 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* s/usg5-4.h (BROKEN_TIOCGETC, BROKEN_TIOCGWINSZ): Add #undefs.

	* window.c (Fset_window_buffer): Clear window_end_{pos,valid}.

	* dispnew.c (Fsleep_for): If arg is 0, return right away.

Mon Jul 26 12:26:09 1993  Francesco Potorti`  (pot@spiff.gnu.ai.mit.edu)

	* m/delta.h (SWITCH_ENUM_BUG): Defined only for AT&T's pcc.
	(BSTRING): Deleted because they are stubs to the memory funcs.
	(memmove): Defined as safe_bcopy since memcpy is not safe.
	(HAVE_X_WINDOWS): Does not conditionally define anything any more.
	Added support fo the GNU C compiler bundled with R3V7.

Mon Jul 26 05:12:26 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* puresize.h [MULTI_FRAME] (PURESIZE): Increased to 210000.

Sun Jul 25 22:24:46 1993   Sam Dooley  (dooley@watson.ibm.com)

	* keyboard.c (kbd_buffer_store_event): Apply all the modifiers bits
	before testing for quit_char and stop_character.  Don't alter
	event->code, though.

Sun Jul 25 01:38:00 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* xselect.c (wait_for_property_change): Eventually time out with error.
	(x_reply_selection_request): XFlushQueue and UNBLOCK_INPUT
	before calling wait_for_property_change.
	(x_get_window_property): Simplify input blocking/unblocking.
	Don't delete the property here.
	(receive_incremental_selection): Delete property here.
	Call XSelectInput to enable and disable PropertyChangeMask.
	(x_get_window_property_as_lisp_data): And here.

	* process.c (wait_reading_process_input): Undo last two changes:
	when wait_for_cell, do not check the keyboard.

	* filelock.c: Fix typo in previous change.

	* xselect.c (lisp_data_to_selection_data): New arg NOFREE_RET.
	For a string, just return its data's address.
	(x_handle_selection_request): Pass new arg.
	If value comes back 1, don't call xfree.

	* xfns.c (MAXREQUEST): Defined.
	(Fx_server_max_request_size): New function.
	(syms_of_xfns): Set it up.

	* window.c (Fwindow_end): Don't assume WINDOW shows the current buffer.

	* s/386bsd.h (LOCALTIME_CACHE): Defined.
	(HAVE_SETSID): Defined.
	(LIB_STANDARD): Override, adding $(GNULIB_VAR).

	* emacs.c (main): Test LOCALTIME_CACHE.

	* filelock.c (getpwuid): Declare at top level, and not if __386bsd__.

	* keyboard.c (interrupt_signal): Tell Fdo_auto_save not to print msg.
	Print "Auto-save done" here.

	* fileio.c (Fdo_auto_save): Temporarily clear Vquit_flag.

	* xfns.c (Fx_create_frame): Typo in previous change.

Sat Jul 24 01:42:53 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* .gdbinit (xscrollbar): Fix typo specifying doc string.

	* process.c (Fprocess_status): Use Fget_process, to avoid error
	if unknown process name.

	* xfaces.c (face_name_id_number): Use assq_no_quit, not Fassq.

Fri Jul 23 17:05:49 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* keyboard.c (command_loop_1): Run post-command-hook first thing.

	* xterm.c (redraw_previous_char): New function.

	* xfns.c (Fx_create_frame): Don't look for default font
	if the caller has specified a valid font.  Try several
	alternative font patterns.

Fri Jul 23 16:38:15 1993  Roland McGrath  (roland@churchy.gnu.ai.mit.edu)

	* mem-limits.h: [_LIBC]: Define BSD4_2.

Fri Jul 23 03:47:49 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* s/sco4.h (HAVE_SOCKETS): Define, if HAVE_INET_SOCKETS.

	* sunfns.c: Fix comment syntax.  Put back the comment 
	saying that we don't maintain this file.

	* xterm.c (XTread_socket) [! HAVE_X11R5]:
	Check for XK_Mode_switch and XK_Num_Lock, if defined.

	* m/hp9000s300.h (TEXT_START) [__GNUC__]: Define as 0.

	* intervals.h (Vinhibit_point_motion_hooks): Declared.
	* textprop.c (syms_of_textprop): Set up Lisp var.
	* intervals.c (set_point): Test it.

Thu Jul 22 15:38:17 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* s/irix5-0.h (PTY_OPEN): Use sigaction, not sigsetmask.

	* s/386bsd.h (DECLARE_GETPWUID_WITH_UID_T): Declared.
	* xrdb.c (getpwuid): Test DECLARE_GETPWUID_WITH_UID_T.

	* process.c (Fget_buffer_process): Delete doc string from
	second alternative definition.

Thu Jul 22 14:59:43 1993  Roland McGrath  (roland@churchy.gnu.ai.mit.edu)

	* ralloc.c (ALIGNED, ROUNDUP):
	Use `unsigned long int' instead of `unsigned int' for
	casting addresses and sizes.  It matters on the 64-bit Alpha.

	* mem-limits.h [_LIBC]: Just include <sys/resource.h>, and skip
	hairy #ifdef mess.

Thu Jul 22 04:06:21 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* keyboard.c (Fread_key_sequence): Doc fix.
	(read_key_sequence): Handle Vkey_translation_map.
	(kbd_buffer_get_event): Discard an event whose kind is no_event.

	* buffer.c (syms_of_buffer): Lisp var doc fixes.

	* m/att3b.h (NO_MODE_T): Defined.

	* intervals.c (graft_intervals_into_buffer): When TREE is null,
	pass buffer as 2nd arg to reproduce_tree.

Wed Jul 21 18:09:12 1993  Paul Eggert  (eggert@twinsun.com)

	* print.c (float_to_string): Don't use uninitialized pointer `cp'.
	Set width to -1 at lose: and other places.
	Default to .17g, not .20g.

Wed Jul 21 00:37:25 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* buffer.c (Qmodification_hooks, Qinsert_in_front_hooks)
	(Qinsert_behind_hooks): Moved here.
	(syms_of_buffer): Lisp vars set up here.
	* textprop.c: No longer here.

	* alloc.c (compact_strings): Add USE_TEXT_PROPERTIES conditional.

	* intervals.h (Ftext_property_not_all): Fix typo in decl.

	* s/sunos4-1.h (SUNOS_LOCALTIME_BUG): Defined.

	* frame.c (Fdelete_frame): Allow deletion if there is some other
	visible (perhaps iconified) frame.  Also allow deleting terminal frame
	if there are X frames.

	* s/sunos4shr.h (memmove): Defined.

	* m/att3b.h (memmove): Defined as macro.

Tue Jul 20 01:08:47 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* Makefile.in (xmakefile): Use CFLAGS after C_SWITCH_SYSTEM.

	* xfns.c (validate_x_resource_name): Call make_string properly.

	* m/next.h (X_NOT_POSIX): Defined.

	* s/sol2.h (BROKEN_TIOCGETC, BROKEN_TIOCGWINSZ): Add #undefs.

	* s/isc3-0.h (memmove): Delete extra parens in the safe_bcopy call.

	* m/ibmrs6000.h (LD_SWITCH_MACHINE): Add -bI:/usr/lpp/X11/bin/smt.exp.

Mon Jul 19 17:15:20 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* eval.c (Fwhile): If mocklisp, test for nonzeroness.

	* s/sunos4shr.h (SYSTEM_MALLOC): Add #undef.
	(GNU_MALLOC, REL_ALLOC): Defined.

Mon Jul 19 17:07:22 1993  David J. MacKenzie  (djm@goldman.gnu.ai.mit.edu)

	* ymakefile: config.h is in current directory, not ${srcdir}.

Sun Jul 18 00:17:28 1993  Jim Blandy  (jimb@totoro.cs.oberlin.edu)

	* Version 19.17 released.

	* xfns.c (Fx_create_frame): Block input around call to
	x_new_font.  Test if the return value is a string, not if it's
	nil; x_new_font can return things besides nil and strings, to
	indicate error conditions.

	* window.c [not MULTI_FRAME] (Fdelete_windows_on): Set FRAME
	argument to Qt, instead of trying to typecheck it.

	* ymakefile (config_h): Set this to ${srcdir}/config.h; all the
	source dependencies mention $(config_h), but until now it never
	had a value.

	* xfns.c (Fx_open_connection): Don't trust HAVE_XRMSETDATABASE;
	use XrmSetDatabase only when HAVE_X11R5 is defined.

	* dispnew.c (direct_output_for_insert): By the time this function
	is called, we have already inserted the character into the buffer;
	the proper buffer position to pass to compute_char_face is point
	- 1, not point.

Sat Jul 17 02:45:04 1993  Jim Blandy  (jimb@totoro.cs.oberlin.edu)

	* Makefile.in (C_SWITCH_SYSTEM): New variable, set by top-level
	Makefile.
	(xmakefile): Pass it to the C preprocessor.

	* window.c (Fdelete_windows_on): New optional argument FRAME; if
	nil, delete windows on all frames.  If t, delete windows on the
	selected frame only.  If a frame, delete windows on that frame
	only.

	* intervals.c (split_interval_left, split_interval_right): Change
	OFFSET argument of these functions to be origin 0, not origin 1.
	This is what all the callers currently want.
	* intervals.c, textprop.c: All callers changed.

	* textprop.c (Ftext_property_not_all): Renamed from
	Ftext_property_all, and changed sense of return value, so that it
	returns useful information if not all characters have properties
	EQ to value.  Now all the existential and universal questions can
	be asked.

	* textprop.c (syms_of_textprop): Don't forget defsubr for
	Stext_property_all. 

	* textprop.c (Ftext_property_any, Ftext_property_all): Use EQ to
	compare property values, not Fequal.

	* xterm.c (x_term_init): Adjust message printed when we can't
	connect to the X server.

	* xfns.c (Vx_resource_name): Renamed from Vxrdb_name, and made a
	lisp-visible variable, so lisp/term/x-win.el can set it.  Doc it
	for "internal use only"; no need for NEWS entry.
	(validate_x_resource_name): New function.
	(Fx_get_resource): Doc fix.  References to Vxrdb_name renamed.  Call
	validate_x_resource_name.
	(x_window): References to Vxrdb_name renamed.  Call
	validate_x_resource_name.
	(Fx_open_connection): References to Vxrdb_name renamed.  Instead
	of setting and validating its value here, just call
	validate_x_resource_name.
	(syms_of_xfns): Add DEFVAR_LISP for Vx_resource_name.

Fri Jul 16 21:43:32 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* keyboard.c (Vhelp_menu_bar_map): Deleted.
	(menu_bar_items): Move elts for events in Vmenu_bar_final_items to end.
	(syms_of_keyboard): Corresponding changes.

Thu Jul 15 20:52:15 1993  Jim Blandy  (jimb@totoro.cs.oberlin.edu)

        Consistently use the mark bit of the root interval's parent field
	to say whether or not the interval tree has been visited (and skip
	it when revisited), and the mark bit of the plist field to say
	whether or not that interval has been visited (and abort if
	revisited); don't try to use the plist mark bit for both
	meanings.
	* alloc.c (mark_interval_tree): Don't test if the interval tree
	has already been visited here; let the MARK_INTERVAL_TREE macro do
	that; avoid function call overhead.  Mark the interval tree as
	having been visited by setting TREE->parent's mark bit.
	(MARK_INTERVAL_TREE): If the tree has been visited (according to
	I->parent's mark bit), don't call mark_interval_tree.
	(gc_sweep): Rebalance the interval trees of those large strings
	which are still alive.  This also clears the mark bits of those
	trees' root intervals' parent fields.
	(compact_strings): Rebalance the interval tree of each small
	strings which is still alive.  This also clears the mark bits of
	that tree's root interval's parent field.  Since the string has
	moved, update the root interval's parent pointer to contain the
	new address.
	* lisp.h (struct interval): Doc fix; explain the roles of the mark
	bits of the parent and plist members.

	* termhooks.h: In order to avoid declaring struct input_event
	(which contains Lisp_Objects) in those .c files which need access
	to the terminal hooks but don't #include lisp.h (like cm.c), test
	to see if the macro CONSP is #defined.  We used to test XINT, but
	config.h will #define that everywhere on systems that use tailored
	tagging schemes.

	* window.c (Fnext_window, Fprevious_window): Put these docstrings
	in comments; the strings are too long for some C compilers.

	* s/hpux9.h: Doc fix.

Thu Jul 15 19:05:38 1993  Jim Blandy  (jimb@wookumz.gnu.ai.mit.edu)

	* ymakefile (DEBUG_MOLE): New variable; a shell expression which
	expands to -DDEBUG_MOLE on HP 9000/300's in the domain
	gnu.ai.mit.edu, and the empty string on all other machines.
	(alloc.o): Cite ${DEBUG_MOLE}, so DEBUG_MOLE is #defined when
	compiling on mole.

Thu Jul 15 02:01:59 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* keyboard.c (read_char_menu_prompt): If the user rejects a menu,
	return t.  This makes read_char also return t.
	(read_key_sequence): If read_char returned t, return -1.
	(Fread_key_sequence): If read_key_sequence returned -1, quit.
	(command_loop_1): If read_key_sequence returned -1, loop around.

Thu Jul 15 00:56:31 1993  Jim Blandy  (jimb@wookumz.gnu.ai.mit.edu)

	* keyboard.c (menu_bar_one_keymap): If the key's binding is the
	symbol `undefined', don't try to take that symbol's cdr before
	passing it to menu_bar_item; pass the `undefined' binding itself,
	so menu_bar_item can remove bindings for the same key from result.

Wed Jul 14 12:02:17 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* buffer.c (Fbuffer_local_variables): For local var that is unbound,
	put just the symbol in the result, not a cons of (symbol . value).

	* keyboard.c (Qdisabled_command_hook): New variable.
	(Vdisabled_command_hook): Deleted.
	(syms_of_keyboard): Corresponding changes.
	(Fcommand_execute): Use Qdisabled_command_hook.

	* alloc.c (mark_object) [DEBUG_MOLE]: Add abort at beginning.

	* keyboard.c (Vhelp_menu_bar_map): New var.
	(syms_of_keyboard): Set up Lisp var for it.
	(menu_bar_items): Use Vhelp_menu_bar_map.

Wed Jul 14 00:14:31 1993  Jim Blandy  (jimb@totoro.cs.oberlin.edu)

	* textprop.c (Ftext_property_any, Ftext_property_all): New
	functions, from David Gillespie.
	* intervals.h (Ftext_property_any, Ftext_property_all): Declare them.

	* keyboard.c (read_key_sequence): Accept both strings and vectors
	as bindings in function-key-map.
    	* keymap.c (Vfunction_key_map in syms_of_keymap): Doc fix.

	* keyboard.c (Fsuspend_emacs): Pass selected_frame as the first
	argument to change_frame_size, not 0.  This function may be called
	in an Emacs compiled with multi-frame support.

Tue Jul 13 17:25:32 1993  Jim Blandy  (jimb@totoro.cs.oberlin.edu)

	* xterm.c (XTread_socket, UnmapNotify case): Add missing comment
	terminator.

	* intervals.c (graft_intervals_into_buffer): Properly compute
	length of buffer.

Tue Jul 13 17:03:09 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* minibuf.c (Fdisplay_completion_list): Run completion-setup-hook.

Mon Jul 12 18:46:17 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* textprop.c (Qinsert_in_front_hooks, Qinsert_behind_hooks): New vars.
	(syms_of_textprop): Set them up.
	* lisp.h (Qinsert_in_front_hooks, Qinsert_behind_hooks): Declared.
	(Qmodification_hooks): Declared.

	* intervals.c (verify_interval_modification):
	For insertion, run the insert-in-front-hooks and insert-behind-hooks,
	not the modification-hooks.
	* buffer.c (verify_overlay_modification): New function.
	(call_overlay_mod_hooks): New function.
	* insdel.c (prepare_to_modify_buffer): Call that.

	* keyboard.c (Qundefined): New variable.
	(syms_of_keyboard): Set up Qundefined.
	(menu_bar_items): Don't reverse the items.
	Process the maps in reverse order.
	(menu_bar_item): If definition is `undefined',
	delete any menu bar item already made, and don't make one.

Mon Jul 12 16:41:12 1993  Jim Blandy  (jimb@totoro.cs.oberlin.edu)

	* print.c (float_to_string): Distinguish between a precision of
	zero and an omitted precision.  Do allow %.0f to produce strings
	containing no decimal point or exponent.
	(syms_of_print): Doc fix for float-output-format.

	* xfns.c (x_set_frame_parameters): Don't set the frame's size and
	position unless those parameters are actually specified in ALIST.

	* syntax.c (Fmodify_syntax_entry): Doc fix.

Mon Jul 12 14:43:38 1993  Frederic Pierresteguy  (F.Pierresteguy@frcl.bull.fr)

	* xterm.c, sysdep.c (F_SETOWN_BUG): Defined.
	* m/dpx2.h: New file.

Sat Jul 10 19:23:41 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* textprop.c (set_properties): Call modify_region.
	(remove_properties): Call modify_region before record_property_change.
	(add_properties): Likewise.

Sat Jul 10 18:49:26 1993  Jim Blandy  (jimb@totoro.cs.oberlin.edu)

	* xrdb.c: Implement search for app-defaults directory and
	localized default databases, along with some other functionality
	provided by Xt.
	#include <stdio.h>, since we call sprintf.
	[emacs] (malloc, realloc, free): #define these to xmalloc,
	xrealloc, and xfree.
	(x_get_string_resource, file_p): Add forward declarations for
	these.
	(x_customization_string): New variable.
	(x_get_customization_string): New function.
	(gethomedir): Return malloc'ed space of the right size, instead of
	writing into a fixed-size buffer; this means that our callers do
	not impose an arbitrary limit on file name length.
	(magic_file_p): Rewrite of decode_magic; actually do the
	substitutions, instead of expanding all %-escapes to "".  Support
	the customization string.  Return 0 or the expanded file name,
	instead of just zero or one.  Allocate the space for the expanded
	file name ourselves, instead of writing into a fixed-size buffer
	passed to us; this removes an arbitrary limit.
	(search_magic_path): Rewrite of magic_searchpath_decoder.  Return
	0 or the expanded file name, instead of just zero or one.
	Allocate the space for the expanded file name ourselves, instead
	of writing into a fixed-size buffer passed to us; this means that
	our callers do not impose an arbitrary limit on file name length.
	(get_system_app): Changed to work with search_magic_path.
	(get_user_app): Rewritten to work with search_magic_path, and not
	to assume that the values of XAPPLRESDIR is a single directory.
	(get_user_db): Properly use the new version of gethomedir.
	(get_environ_db): Remove arbitrary limit on length of host name.
	(x_load_resources): Take a new argument, myname.  Call get_user_db
	early to obtain the customization string.
	Changes to stand-alone testing code.
	* xfns.c (Fx_open_connection): Set Vxrdb_name early, and pass it
	to x_load_resources.

	* keymap.c (syms_of_keymap): Doc fix.

Fri Jul  9 17:41:49 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* process.c (wait_reading_process_input): If wait_for_cell, do call
	swallow_events and do_pending_window_change when appropriate.

Thu Jul  8 19:45:22 1993  Roland McGrath  (roland@churchy.gnu.ai.mit.edu)

	* editfns.c (region_limit): Declare Vmark_even_if_inactive.

	* callint.c (syms_of_callint):
	Fix DEFVAR_LISP for Vmark_even_if_inactive to use right
	Lisp symbol name (without V prepended).

Thu Jul  8 17:43:11 1993  Roland McGrath  (roland@churchy.gnu.ai.mit.edu)

	* callint.c (check_mark): Don't check mark-active unless in
	transient-mark-mode.  
	For inactive mark, signal mark-inactive instead of error with a
	message.
	* editfns.c (region_limit): Don't error if Vmark_even_if_inactive
	is set.
	When the mark is inactive and that is a no-no, signal
	mark-inactive instead of using error with a message.
	* data.c (syms_of_data): Staticpro Qmark_inactive.
	* data.c: Define Qmark_inactive.
	(syms_of_data): Initialize it.
	* lisp.h: Declare Qmark_inactive.

Wed Jul  7 03:58:15 1993  Jim Blandy  (jimb@geech.gnu.ai.mit.edu)

	* editfns.c (Fformat): Since floats occupy two elements in the
	argument list passed to doprnt, we must use separate indices for
	the array of arguments passed to Fformat, and the array of
	arguments to be passed to doprnt.

	* .gdbinit: Add size to geometry spec.
	Specify sevenbit-strings in set print.
	(xfloat): New command.

Tue Jul  6 11:05:14 1993  Jim Blandy  (jimb@geech.gnu.ai.mit.edu)

	* Version 19.16 released.

	* ymakefile [not ORDINARY_LINK && __GNUC__ && __GNUC__ > 1 && not
	LIB_GCC] (LIB_GCC): Use "$(CC)" instead of "gcc".

Tue Jul  6 01:58:20 1993  Jim Blandy  (jimb@geech.gnu.ai.mit.edu)

        * textprop.c (copy_text_properties): Pass a copy of POS to
	validate_interval_range; that function increments its arguments,
	which isn't what we want.

	* fns.c (Fsubstring, concat): Pass all six arguments to
	copy_text_properties.

	* intervals.c (find_interval): Doc fixes, computation of
	tree->position rearranged for clarity.

	* intervals.c (find_interval): Consistently treat POSITION as an
	actual buffer position, i.e. origin 1.  The old code seemed
	undecided on this point.  Treat the end of the buffer as being
	part of the rightmost interval.
	(adjust_intervals_for_insertion): Consistently treat POSITION as
	origin 1.
	(interval_deletion_adjustment): The exception: FROM should be
	origin zero here.  Consistently treat it as such.  Simplify code
	which shrinks and possibly deletes intervals.
	(adjust_intervals_for_deletion): Treat start as origin 1; our
	caller does.
	(set_point): Use buffer positions throughout, not a mix of buffer
	posns and origin zero posns.
	(get_local_map): Remove special case for POSITION at end of buffer;
	find_interval handles that case correctly.
	(verify_interval_modification): Remove special case for START at
	end of buffer.
	* textprop.c (validate_interval_range): End-of-buffer/string
	positions no longer need special handling.

	* intervals.c (make_new_interval): #if 0 this out.  Nobody calls it.

	* textprop.c (copy_text_properties): New function, from David
	Gillespie.
	* intervals.h: Declare copy_text_properties.
	* fns.c: #include "intervals.h".
	(Fsubstring): Copy text properties to result string.
	(concat): Copy text properties to result string.
	* ymakefile (fns.o): Note that this depends on INTERVAL_SRC.

	* print.c: Get rid of extra space at the end of print syntax for
	strings with intervals.
	[USE_TEXT_PROPERTIES] (print): Don't print a space before the
	interval property lists.
	[USE_TEXT_PROPERTIES] (print_interval): Print a space before this
	internal's properties, not after.

	* m/pmax.h (C_SWITCH_X_MACHINE): Set this to
	"-DNeedFunctionPrototypes=0", to avoid lossage in DEC X11 header
	files.
	* ymakefile (really-oldXMenu): Pass C_SWITCH_X_MACHINE to the
	oldXMenu make.

	* doc.c (Fsubstitute_command_keys): Pass all five arguments to
	describe_map_tree.

Mon Jul  5 03:15:17 1993  Jim Blandy  (jimb@geech.gnu.ai.mit.edu)

	Compare the values of text properties using EQ, not Fequal.
	* intervals.c (intervals_equal): Call EQ, not Fequal.
	* textprop.c (interval_has_all_properties, add_properties): Same.

	* textprop.c (validate_interval_range): Don't increment both
	*begin and *end if they point to the same thing.
	(validate_plist): Call QUIT while scanning LIST.

	* intervals.c (intervals_equal): Test the return value of Fequal
	against Qnil, not 0.

	* keyboard.c (Vdouble_click_time): Renamed from double_click_time,
	and made a Lisp_Object instead of an int.  
	(make_lispy_event): If Vdouble_click_time is t, impose no time
	limit on double-clicks.
	(syms_of_keyboard): DEFVAR_LISP (not DEFVAR_INT)
	Vdouble_click_time (not double_click_time), and adjust doc string
	to say that `nil' means no double clicks, and `t' means no time
	limit.

Sun Jul  4 16:00:40 1993  Jim Blandy  (jimb@churchy.gnu.ai.mit.edu)

	* keyboard.h (EVENT_CLICK_COUNT, POSN_SCROLLBAR_PART): New
	accessors.

	* s/sunos4-1.h (LIBS_SYSTEM): Don't link against -lresolv; that's
	only needed for misconfigured systems.

Sun Jul  4 00:51:00 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* keymap.c (describe_map_tree): When inserting TITLE, mention PREFIX.
	Insert newline at end, if inserted anything else.
	(describe_buffer_bindings): Corresponding changes.
	For minor mode maps, build up a title string,
	then let describe_map_tree insert it.

	* eval.c (Fsignal): Clarify error message.

Sat Jul  3 22:19:19 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* keyboard.c (read_char): After Fgarbage_collect, call redisplay.

Sat Jul  3 17:11:19 1993  Jim Blandy  (jimb@churchy.gnu.ai.mit.edu)

	* frame.c (Fredirect_frame_focus): Allow redirection of focus of
	dead frames.

	* s/sunos4-1.h (LIBS_SYSTEM): Make this be -lresolv, so we get the
	versions of gethostbyname and such that use the DNS.

Sat Jul  3 02:58:05 1993  Roland McGrath  (roland@churchy.gnu.ai.mit.edu)

	* fileio.c (Frename_file):
	After prompting for ok-if-already-exists, pass only nil or
	t to copy-file, never an integer.

Fri Jul  2 23:57:42 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* keymap.c (Faccessible_keymaps): Doc fix.

Fri Jul  2 18:48:58 1993  Jim Blandy  (jimb@churchy.gnu.ai.mit.edu)

	* textprop.c (set_properties): Don't try to make undo records if
	OBJECT is a string.

Fri Jul  2 01:42:41 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* keyboard.c (read_key_sequence): When inserting `menu-bar' prefix,
	modify the position field to prevent doing so twice.
	Do all these forms of event expansion after replayed events also.
	Set last_real_key_start before each key.
	Use last_real_key_start in criterion for being the first event.

	* process.c (wait_reading_process_input): Do include the keyboard
	in the select, if read_kbd was a cons cell.

Thu Jul  1 22:25:05 1993  Jim Blandy  (jimb@churchy.gnu.ai.mit.edu)

	* xterm.c (XTread_socket): When handing non-synthetic
	ConfigureNotify events, don't refer to the parent window
	descriptor.

	* textprop.c (set_properties): Add undo records to remove entirely
	new properties.  Only record old property values for those
	properties whose values have changed.

Thu Jul  1 19:56:28 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* callint.c (Vmark_even_if_inactive): New var, with Lisp variable.
	(check_mark): Use it.

Thu Jul  1 00:03:50 1993  Jim Blandy  (jimb@wookumz.gnu.ai.mit.edu)

	* xfaces.c [XOS_NEEDS_TIME_H]: #undef USG while #including
	<X11/Xos.h>, so that file doesn't try to define struct timeval and
	struct timezone.

	* xterm.c (frame_highlight, frame_unhighlight): Don't test
	Vx_no_window_manager.  BLOCK_INPUT around the border manipulation
	calls.

Wed Jun 30 16:12:09 1993  Jim Blandy  (jimb@wookumz.gnu.ai.mit.edu)

	* xterm.c (XTread_socket): Initialize event_found to zero, and
	pass a zeroed timeout to select, not a null pointer; the latter
	means "wait forever".

	* s/hpux8.h (random, srandom): No need to define these to be
	foo_random and foo_srandom; autoconf should autodetect when the
	real random functions are available.

	* xdisp.c (redisplay): If we're not already showing the region,
	then don't disable the single-line optimizations just because the
	mark isn't where we last displayed it.

Wed Jun 30 13:50:08 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* keyboard.c (syms_of_keyboard): Doc fix.
	(Vhelp_char): Renamed from help_char.
	(Vprefix_help_command): New Lisp variable.
	(read_key_sequence): Use that, for help char after prefix key.

	* keyboard.c (kbd_buffer_get_event):
	Clear f before calling mouse_position_hook.

	* emacs.c, callproc.c (PRIO_PROCESS): Definition deleted.

	* vm-limit.c (check_memory_limits): Make data_size and five_percent
	unsigned long.

Wed Jun 30 00:55:41 1993  Jim Blandy  (jimb@wookumz.gnu.ai.mit.edu)

	* keyboard.c (kbd_buffer_get_event): Correctly generate
	switch-frame events when reading mouse motion events.

Tue Jun 29 19:05:54 1993  Jim Blandy  (jimb@wookumz.gnu.ai.mit.edu)

	* xterm.c: Add CPP tangle from process.c to get definitions for
	FD_SET, etcetera.
	(XTread_socket): Use those macros when testing for dropped connection.

Tue Jun 29 01:27:22 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* alloc.c (mark_object): Add aborts in Lisp_Symbol case.

	* keymap.c (describe_map_tree): Insert key_heading here.
	New arg TITLE.
	(describe_buffer_bindings): Corresponding changes.

	* process.c (wait_reading_process_input): Use SIGIO only if defined.

	* keymap.c (shadow_lookup): New function.
	(describe_map_2): Call it.  SHADOW is now a list of maps.
	(describe_vector): Likewise.
	(describe_map): SHADOW is now a list of maps.
	(describe_map_tree): Likewise.
	(describe_buffer_bindings): Build suitable list to pass as SHADOW.
	(Faccessible_keymaps): New arg PREFIX.  Callers changed.
	(describe_map_tree): New arg PREFIX.
	(Fdescribe_bindings): New arg PREFIX.
	Pass to describe_buffer_bindings along with buffer.
	(describe_buffer_bindings): Extract PREFIX and pass along.

Mon Jun 28 15:18:53 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* keymap.c (describe_map_2): Cleanups.
	Check there's no previous definition in same keymap. 

Thu Jun 24 00:15:54 1993  Jim Blandy  (jimb@wookumz.gnu.ai.mit.edu)

	* keyboard.c (read_char): Don't do idle autosaves if we're not
	interactive.

Wed Jun 23 21:32:25 1993  Jim Blandy  (jimb@wookumz.gnu.ai.mit.edu)

	* xfns.c (Fx_create_frame): Check for internalBorder resource, as
	well as internalBorderWidth.

	* xterm.c (XTread_socket): Remove #if 0''s around code which tests
	for dropped connection (i.e. sigio but no events).

Tue Jun 22 02:58:40 1993  Jim Blandy  (jimb@wookumz.gnu.ai.mit.edu)

	* keyboard.c (menu_bar_items, read_key_sequence): Use
	current_global_map, not global_map; the latter is only meant to be
	used for initial_define_key.
	* commands.h: Doc fix.

	* commands.h (Vglobal_mouse_map): Removed; unused.
	* xfns.c (Vglobal_mouse_map): Same.

	* buffer.c (list_buffers_1): Make desired_point a lisp object; set
	it to nil, unless we find the current buffer.
	(Flist_buffers): Don't try to set point in the buffer list unless
	list_buffers_1 actually returns an integer.  Don't use a full
	save_excursion; just save and restore the buffer.

	Separate parameter faces (those created and modified by the user)
	from the computed faces (the combinations created by
	compute_char_face), so that we don't waste global face id's.
	* xterm.h (struct x_display): Replace the fields faces and n_faces
	with fields param_faces, n_param_faces, computed_faces,
	n_computed_faces, and size_computed_faces.
	(FRAME_FACES, FRAME_N_FACES): Replaced by...
	(FRAME_COMPUTED_FACES, FRAME_N_COMPUTED_FACES, FRAME_PARAM_FACES,
	FRAME_N_PARAM_FACES): New macros.
	* xfaces.c: Doc fixes.
	(init_frame_faces): Call new_computed_face to create entries for
	the default and mode line faces.  Use the FRAME...PARAM_FACES
	macros.
	(free_frame_faces): Use the FRAME...PARAM_FACES and
	FRAME...COMPUTED_FACES macros.  Don't use the copy flag; all
	parameter faces have real X resources, and all computed faces just
	have copies.  Free both the parameter and computed face arrays.
	(new_computed_face): New function.
	(intern_computed_face): Renamed from intern_frame_face; callers
	changed.  Call new_computed_face.
	(ensure_face_ready, compute_char_face, compute_glyph_face): Use the
	FRAME...PARAM_FACES macros.
	(recompute_basic_faces): Use the FRAME...PARAM_FACES and
	FRAME...COMPUTED_FACES macros.  Produce the computed faces by
	starting with the base faces and merging in the parameter faces.
	(Fset_face_attribute_internal): Use the FRAME...PARAM_FACES
	macros.  Just call recompute_basic_faces if the default or mode
	line faces have changed.
	* xfns.c (Fx_list_fonts): Use the FRAME...PARAM_FACES macros.
	* xterm.c (dumpglyphs): Use the FRAME...COMPUTED_FACES macros.
	* dispextern.h (struct face): Remove the copy member.  This is no
	longer necessary; all computed faces are copies, and no parameter
	faces are.

	* xfaces.c (face_vector, nfaces, nfaces_allocated): Make these
	static.

	* xdisp.c (redisplay_window): Remember to compute end relative to
	the start of the visible region, too.

Mon Jun 21 22:02:48 1993  Jim Blandy  (jimb@wookumz.gnu.ai.mit.edu)

	* xrdb.c (get_user_db): Remember to free the screen-local resource
	string after we've merged its data into db.

	* keyboard.c (make_lispy_event): Added detection of double-click
	and triple-click events.
	(parse_modifiers_uncached, apply_modifiers_uncached): Same.
	(read_key_sequence): Coerce double-clicks to clicks, and triple-clicks
	to double-clicks or clicks, by analogy with drag events.
	(double_click_time): Added variable.
	* termhooks.h: Added multi-click event modifier bits.

Mon Jun 21 15:37:06 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* textprop.c (Fremove_text_properties, Fadd_text_properties):
	Really do next_interval when skipping the first interval.

Sun Jun 20 16:01:51 1993  Jim Blandy  (jimb@wookumz.gnu.ai.mit.edu)

	* xfns.c (Fx_open_connection): Remember to block input while
	calling x_load_resources.
	* xrdb.c: Undo change of June 19th; it was a BLOCK_INPUT problem,
	not a server-specific bug.

	* alloc.c (Fgarbage_collect): If the minibuffer is active, don't
	display the "...done" message; allow the minibuffer to show again.

	* config.h.in (HAVE_LONG_FILE_NAMES): Add an #undef, for autoconf
	to chew on.  Re-arrange macros to reflect the ordering of the
	corresponding macros in configure.in, to facilitate this kind of
	checking.

Sat Jun 19 17:14:27 1993  Jim Blandy  (jimb@wookumz.gnu.ai.mit.edu)

	* version 19.15 released.

Sat Jun 19 16:24:58 1993  Jim Blandy  (jimb@wookumz.gnu.ai.mit.edu)

	* puresize.h (PURESIZE): Up this to 205000 for MULTI_FRAME Emaces,
	and 190000 for non-MULTI_FRAME Emaces.

	* xfaces.c (recompute_basic_faces): This shouldn't be declared static.

	* xrdb.c (get_user_db): Some NCD xterms seem to hang in
	XScreenResourceString.  Consult the ServerVendor and VendorRelease
	variables to see if we're talking to such a server.

	* xterm.c (XTread_socket): Never treat a modifier key as a
	non_ascii_keystroke.

        * emacs.c (Fkill_emacs): Pass third argument to shut_down_emacs.
	* lisp.h (shut_down_emacs): Doc fix.

Fri Jun 18 11:05:46 1993  Jim Blandy  (jimb@geech.gnu.ai.mit.edu)

	* frame.c (Fmake_frame_visible): Make this interactively callable;
	frames can accept input while iconified, so it makes sense to put
	this on a key.

	* xfaces.c: Add forward declaration for recompute_basic_faces.

	* fileio.c (Fset_visited_file_modtime): We're only passing two
	arguments to the file name handler; use call2, not call3.

        Changes for Irix 4.0, tested this time:
	* s/irix4-0.h: Get rid of our fake definitions for setpgrp and
	getpgrp.
	* callproc.c (Fcall_process): Go ahead and use the USG calling
	convention for setpgrp.
	* ymakefile (pre-crt0.o): Add rule for this.  Perhaps it will help
	separate-source-directory compilation.
	* emacs.c (shut_down_emacs): Some USG systems #define
	EMACS_HAVE_TTY_PGRP; call getpgrp as appropriate for such systems.
	* sysdep.c (sys_suspend): Call getpgrp as appropriate for USG and
	non-USG.

	* sysdep.c (rename): Make arguments const.  autoconf #defines
	const away on systems which don't have it; any system with
	prototypes will declare the arguments const (the ones to which I
	have access do); and systems without prototypes won't notice.

	* process.c [IRIX] (create_process): Don't put child in process
	group zero before opening the tty; Irix is like USG in this
	regard.

	* s/isc2-2.h, s/linux.h, s/usg5-4.h, m/alliant-2800.h, m/convex.h,
	m/pfa50.h: Remove #definition of HAVE_CLOSEDIR; autoconf figures
	this out.

	* xfns.c: Always #include "bitmaps/gray.xbm"; the bitmaps seem to
	be missing on some systems, and there's no point in having
	configure check; it should work fine to always use our copy.

	* minibuf.c (Fread_minibuffer): Add missing semicolon after
	CHECK_STRING macro.

Thu Jun 17 19:29:56 1993  Jim Blandy  (jimb@wookumz.gnu.ai.mit.edu)

	* Version 19.14 released.

Thu Jun 17 15:05:29 1993  Jim Blandy  (jimb@wookumz.gnu.ai.mit.edu)

	* m/iris4d.h (LIB_STANDARD): Do *not* include -lbsd.  We are
	now calling the BSD[sg]etpgrp functions directly, so this library
	is not needed; it just provides the BSD[sg]etpgrp functions under
	the [sg]etpgrp names.

	* callproc.c [IRIX] (child_setup): Don't call setpgrp this time.
	It's already been called up in Fcall_process, and create_process.

	* callproc.c (Fcall_process, child_setup): If IRIX is #defined,
	call setpgrp with arguments, even if USG is #defined.
	* process.c [IRIX] (create_process): Don't call setpgrp before
	opening the pty.  Call it after doing the TIOCNOTTY ioctl.

	* xfaces.c (compute_base_face): Initialize the face's stipple.
	Although we don't use this feature now, face_eql notices it.

	* xfaces.c (compute_base_face): Set cached_index to an invalid
	index, to avoid an unnecessary comparison.

	* keyboard.c (read_key_sequence): Don't confuse mock input with
	function-key-map expansion, and continue reading mock events when
	the current sequence is unbound.

	* keyboard.c (read_key_sequence): After providing a prefix symbol
	for a mouse event, modify the mouse event to indicate that that
	won't need to be done again, by putting the event's position
	symbol in a list.

	* keyboard.c (read_key_sequence): When returning mock input which
	has run off the end of the current maps, make sure the events get
	echoed, and make it into this-command-keys.

	* keyboard.c (read_key_sequence): When re-reading a previously
	read mouse click which requires a prefix symbol, make sure to set
	last_real_key_start appropriately, so we can properly drop
	button-down events.

Thu Jun 17 00:07:22 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* ymakefile (really-oldXMenu): Pass C_SWITCH_MACHINE down.

	* intervals.c (verify_interval_modification): Don't just test
	Qread_only prop; use INTERVAL_WRITABLE_P.

	* syntax.c (scan_lists, Fforward_comment): #if 0 the code
	to treat two-character comment enders with a special shortcut.

Wed Jun 16 22:16:40 1993  Jim Blandy  (jimb@wookumz.gnu.ai.mit.edu)

	* config.h.in (HAVE_CLOSEDIR): Add an #undef for autoconf to
	change.
	* sysdep.c (closedir): Only define this if autoconf can't find
	HAVE_CLOSEDIR.  If we're running under solaris (defined (sun) &&
	defined (USG5_4)), then don't free the buffer separately.

	* keyboard.c (read_key_sequence): If we add events to a key
	sequence that didn't come from the input stream (e.g. `mode-line'
	prefixing a mouse click, or an expansion from function-key-map),
	and end up with a sequence that runs off the end of the current
	maps, return the entire key sequence, not just the initial portion
	which was bound or unbound.

	* xdisp.c (redisplay_window): Do not subtract one from start
	before passing it to the set_vertical_scroll_bar_hook.

	* lisp.h (CHECK_LIST, CHECK_STRING, CHECK_CONS, CHECK_SYMBOL,
	CHECK_VECTOR, CHECK_BUFFER, CHECK_WINDOW, CHECK_LIVE_WINDOW,
	CHECK_PROCESS, CHECK_NUMBER, CHECK_NATNUM, CHECK_MARKER,
	CHECK_NUMBER_COERCE_MARKER, CHECK_FLOAT, CHECK_NUMBER_OR_FLOAT,
	CHECK_NUMBER_OR_FLOAT_COERCE_MARKER, CHECK_OVERLAY): Wrap a do
	... while (0) around these compound statements to make them
	syntactically equivalent to a single statement.

Wed Jun 16 18:37:24 1993  Roland McGrath  (roland@churchy.gnu.ai.mit.edu)

	* editfns.c (Finsert_buffer_substring): Doc fix.

Wed Jun 16 10:12:49 1993  Jim Blandy  (jimb@wookumz.gnu.ai.mit.edu)

	Don't let the 'B' interactive spec default to buffers viewed in
	any visible frame.
	* buffer.c (Fother_buffer): Pass Qt as the second argument
	to Fget_buffer_window.
	* window.c (window_loop): In GET_BUFFER_WINDOW case, ignore
	non-visible frames.
	(Fget_buffer_window): Change doc string to mention that passing Qt
	for the FRAME argument returns windows on visible frames only.

        Changes for correct pgrp behavior; approach suggested by Bob
	Glickstein <bobg@zindigo.z-code.com>:
	* m/iris4d.h (LIB_STANDARD): Do list -lbsd here.
	* s/irix4-0.h (getpgrp, setpgrp): #define these to call BSDgetpgrp
	and BSDsetpgrp.
	(GETPGRP_NO_ARG): Don't #define this.
	* emacs.c (main): Don't test GETPGRP_NO_ARG.
	* sysdep.c (sys_suspend): Don't test GETPGRP_NO_ARG.

	* Makefile.in (CPP): New variable, set by the top-level Makefile.

	* m/delta88k.h (HAVE_GETTIMEOFDAY): Don't #define this; autoconf
	takes care of that.
	(LIBS_SYSTEM): Don't attempt to #define this if we already have a
	definition of LIB_SYSTEM from s/usg5-4.h.

	* unexec.c [HPUX] (sbrk): This returns a void *.

	* window.c (check_frame_size): Allow minibuffer-only frames to be
	one line high.

	* frame.c (store_frame_param): Fix error message punctuation.

	* callproc.c [IRIX] (child_setup): Don't set the pgroup.

	* s/isc3-0.h (memmove): #define this to call safe_bcopy.

	* buffer.c (list_buffers_1): Return the desired point.
	(Flist_buffers): Put point there in the buffer summary.

        Bring mumbleclean targets into conformance with GNU coding standards.
	* Makefile.in (mostlyclean): New target.
	(clean): Just call mostlyclean.  Get rid of ../etc/DOC too.
	(distclean): Use clean to do most of the work.
	Get rid of ../etc/DOC-* too.
	(realclean): New target.

	* xdisp.c (redisplay_window): Do not subtract BEGV to compute
	the scroll bar handle's end.

Tue Jun 15 03:47:10 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* xmenu.c (xmenu_show): Store 0 in *ERROR at the beginning.

	* fileio.c (Finsert_file_contents): Two new args, BEG and END.

	* intervals.c (adjust_intervals_for_insertion): By default, copy
	properties from before the insertion.

Mon Jun 14 13:29:51 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* syntax.c (scan_sexps_forward): Set state.comstart to before the
	comment starter, not after.

	* xmenu.c (Fx_popup_menu): Call keymap_panes right in one-keymap case.

Mon Jun 14 11:06:35 1993  Jim Blandy  (jimb@wookumz.gnu.ai.mit.edu)

	* s/linux.h (LIBS_MACHINE, HAVE_SYSVIPC): Set the former to -lipc,
	and #define the latter.

	* xdisp.c (display_text_line): Use temporary variable.

Mon Jun 14 03:05:17 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* window.c (Fdelete_window): Handle deleting a parent of the
	selected window.

Sun Jun 13 04:10:08 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* fileio.c (Fset_visited_file_modtime): Don't give the handler
	the filename as an argument.

	* syntax.c (scan_lists, Fforward_comment): Pass 0 as commentstop arg
	to scan_sexps_forward.
	(scan_sexps_forward, char_quoted): Now static.
	(describe_syntax, describe_syntax_1): Now static.

	* undo.c (Fprimitive_undo): Rename arg to N to avoid conflict.

	* window.c (Fdelete_window): Mostly undo last change.
	Don't initialize `frame' in the declaration.

	* Make prefix keys work with keymap inheritance
	by creating an inheritance structure for each subkeymap
	that we create in the inheriting keymap.
	* keymap.c (access_keymap): New arg NOINHERIT.  All calls changed.
	(define_as_prefix): New function.
	(Fdefine_key): Use them.

Sat Jun 12 19:52:07 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* emacs.c (shut_down_emacs): New arg STUFF.  Stuff input here.
	(Fkill_emacs, fatal_error_signal): Pass new arg.
	* xterm.c (x_connection_closed): Pass new arg.

	* dired.c (Ffile_attributes): Give -1 as size if size won't fit.

	* intervals.c (set_point): When moving over invis chars,
	don't screw up at end of buffer.

	* eval.c (call5, call6): New functions.
	(call1, call2, call3, call4): Renumber the args.
	* lread.c (Fload): Use call5.
	* fileio.c (Fcopy_file): Pass all the args to the handler.
	(Fwrite_region): Use call6.
	(Frename_file): Look for handler for newname.
	(Fadd_name_to_file): Pass arg ok_if_already_exists to handler.
	(Fmake_symbolic_link): Likewise.
	(Ffile_newer_than_file_p): Check both file names for handler.

Sat Jun 12 13:35:37 1993  John Hughes  (john@moonlite.CalvaCom.fr)

	* term.c (term_get_fkeys): Use `prior', not `previous', for %8/kP.

Sat Jun 12 13:00:03 1993  Jim Blandy  (jimb@wookumz.gnu.ai.mit.edu)

	* sysdep.c (child_setup_tty): Remove duplicate settings for VQUIT
	and VINTR.

	* sysdep.c [ultrix] (init_sys_modes): Don't set LLITOUT; it
	disables the meta key.

	* frame.c (Fmouse_position, Fset_mouse_position): Doc fix.

	* xfns.c [! HAVE_X11R5] (Fx_rebind_key): Recognize that
	XK_Mode_switch and XK_Num_Lock are modifier keysyms too.

	* xterm.c (XTset_vertical_scroll_bar): Use double type for
	intermediate results in scaling.

Sat Jun 12 12:56:36 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* undo.c (syms_of_undo): Set up Qinhibit_read_only.
	(Fprimitive_undo): Sometimes bind inhibit-read-only to t.

	* minibuf.c (read_minibuf): Set and use mini_frame only if MULTI_FRAME.

	* xdisp.c (echo_area_display): Use XFASTINT on ->height.
	(copy_rope, copy_part_of_rope): Access *f as Lisp_Object.

	* window.c (Fdelete_window): Make `frame' a FRAME_PTR and use as such.

	* undo.c (record_delete): Always use XFASTINT on sbeg.
	(Fprimitive_undo): Add missing `else'.  Add USE_TEXT_PROPERTIES
	conditional for calling Fput_text_property.  Use XINT on high, low.

	* process.c (start_process_unwind): Use XINT.

	* syntax.c (Fset_syntax_table): Add XFASTINT.

Sat Jun 12 05:30:40 1993  Jim Blandy  (jimb@wookumz.gnu.ai.mit.edu)

	* xterm.c (x_error_quitter, x_io_error_quitter): Remove calls to
	abort.  We can always run Emacs with _Xdebug set to 1.

	* ymakefile (really-oldXMenu): Remember backslash to extend command.

	* keyboard.c (read_key_sequence): When we generate a prefix symbol
	for a mouse event, store the actual mouse event in
	unread_command_events, so we don't lose it if the symbol isn't
	bound to a prefix.

	* config.h.in (HAVE_XRMSETDATABASE, HAVE_RANDOM, HAVE_LIBXBSD):
	Add #undefs for these.
	Dyke out code requesting -lXbsd and HAVE_RANDOM for XFREE386.
	* xfns.c (Fx_open_connection): Test HAVE_XRMSETDATABASE instead of
	NO_XRM_SET_DATABASE; the latter isn't used any more.
	* m/delta88k, m/tekXD88.h, s/linux.h, s/usg5-4-2.h (HAVE_RANDOM):
	Dyke out these #definitions; to avoid conflict with autoconf.

	* ymakefile (really-oldXMenu): Explicitly pass CC, CFLAGS, and
	MAKE to the oldXMenu make.

	* window.c (Fprevious_window): Use FRAME_HAS_MINIBUF_P to decide
	if the frame has a minibuffer; FRAME_MINIBUF_WINDOW points to the
	surrogate on minibufferless frames, not nil.

Sat Jun 12 00:43:07 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* keyboard.c (read_char): Set c properly as a Lisp int.
	(command_loop_1): Delete spurious use of XINT on c, a char.

	* frame.c: Doc fixes.

	* data.c (cons_to_long): Declare top, bot as Lisp_Object.

	* floatfns.c (Fexpt): New local `val' for making integer to return.

	* keymap.c (Fcopy_keymap): Check Fkeymapp value with NILP.
	(get_keymap_1): Add missing semicolon.
	(describe_vector_princ): Align to column 16.

	* emacs.c (main) [GETPGRP_NO_ARG]: Really pass no arg to getpgrp.

Fri Jun 11 16:49:38 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* xterm.c (XTmouse_position): Don't set *f at all unless we win.

	* process.c (read_process_output): Don't deactivate the mark.
	Do restore Vdeactivate_mark, so that no one else deactivates it.

	* buffer.c (Fgenerate_new_buffer_name): GENTEMP is the value to
	compare against IGNORE.

Fri Jun 11 12:15:29 1993  Jim Blandy  (jimb@wookumz.gnu.ai.mit.edu)

        Interact properly with shells lacking job control (sh, rc, es...)
	* sysdep.c [BSD] (inherited_pgroup): New variable.
	(narrow_foreground_group, widen_foreground_group): New functions.
	(init_sys_modes): Call narrow_foreground_group.
	(reset_sys_modes): Call widen_foreground_group.
	* emacs.c [BSD] (inherited_pgroup): Add extern declaration.
	[BSD] (main): Set inherited_pgroup, and put ourselves in our own
	pgroup.

Fri Jun 11 11:41:04 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* xfns.c (syms_of_xfns): Don't set up Qicon.
	(Qicon): Declaration deleted.
	* frame.h (Qicon): Declared.

	* frame.c (Fmouse_position): Set up defaults before calling the hook.

Fri Jun 11 07:17:59 1993  Jim Blandy  (jimb@wookumz.gnu.ai.mit.edu)

	* xdisp.c (redisplay_window): Don't call try_window_id if the
	window isn't starting at the beginning of the line.

	* window.c (Fprevious_window): Typo.

Fri Jun 11 03:13:54 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* ymakefile (alloca.o): Delete allocatem.c, not allocax.c.

	* textprop.c (Fset_text_properties): No special case for props = nil.

	* xfns.c (Fx_list_fonts): If names is 0, just return nil.

Fri Jun 11 02:43:09 1993  Jim Blandy  (jimb@wookumz.gnu.ai.mit.edu)

	* xterm.c (x_new_font): If font_names is zero, that's all the
	indication we get that no matches were found.

	* s/isc3-0.h (LIB_X11_LIB): #undef this, to remove the value
	inherited from usg5-3.h; ISC doesn't have libX11_s.
	(LIBX11_SYSTEM): Link against the static -lc, not -lc_s.

Thu Jun 10 17:14:25 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* lread.c (Fload): Forward all 4 args to magic-name handler.

Thu Jun 10 03:25:20 1993  Shane Hartman  (shane@nugget.spr.com)

        * window.c (Fscroll_left): Make argument optional.
        (Fscroll_right): Ditto.

Thu Jun 10 01:18:09 1993  Jim Blandy  (jimb@wookumz.gnu.ai.mit.edu)

	* search.c (Flooking_at, Fstring_match, fast_string_match,
	search_buffer): Don't block input while calling searching and
	matching functions.  These functions may not call malloc under
	Emacs anyway, and we need to be able to check for C-g.

	* xrdb.c (get_user_db): Get the screen-specific database too.

	* syntax.c (scan_lists, Fforward_comment): Call scan_sexps_forward
	with the proper number of arguments.

	* sysdep.c: Remove clause for DGUX support of FASYNC; add clause
	to #undef FASYNC if BROKEN_FASYNC is #defined.

	* filelock.c: Test HAVE_LONG_FILE_NAMES, not SHORT_FILE_NAMES, to
	interface nicely with autoconf.
	* m/delta.h: Don't #define SHORT_FILE_NAMES; autoconf does this
	for us.

	* s/dgux.h: Changes from Paul M Reilly <pmr@rock.concert.net>:
	(BSD4_4, SVR4, HAVE_SETSID, HAVE_UNIX_DOMAIN): #define these.
	(FIRST_PTY_LETTER): This is 'r', not 'p'.
	(HAVE_TERMIO, SIGNALS_VIA_CHARACTERS): Don't #define these.
	(HAVE_TERMIOS): #define these instead.
	(XREBINDKEYSYM):  Don't #define.
	Test THIS_IS_YMAKEFILE instead of MAKING_MAKEFILE.
	(sigmask, sigpause): #undef these after #including <signal.h>.
	(LD_SWITCH_SYSTEM, START_FILES, LIBS_SYSTEM, LIB_GCC): #define
	these to avoid problems with /lib/crt0.o.
	(C_DEBUG_SWITCH, C_OPTIMIZE_SWITCH): #define these.

	* s/dgux.h (BROKEN_FASYNC): #define this.

	* fileio.c (Frename_file): Pass all arguments to the file name handler.
	* eval.c (call4): New function.

Wed Jun  9 00:36:00 1993  Jim Blandy  (jimb@wookumz.gnu.ai.mit.edu)

	* s/linux.h (SIGNALS_VIA_CHARACTERS): Don't #define this.

	* process.c (sigchld_handler): Add cast, to avoid warnings on Linux.
	(Fopen_network_stream): Cast the second argument to connect, to
	avoid warnings on any system that provides prototypes for connect.

	* xdisp.c (display_text_line): Handle case where line ends in a
	continuation character but we never actually displayed any buffer
	text (due to minibuffer prompt).

	* xterm.c (x_is_vendor_fkey): New function.
	(XTread_socket): Call it to recognize vendor-specific function keys.

	* s/dgux.h: Move #definition of SYSTEM_MALLOC outside of
	MAKING_MAKEFILE conditional.  No harm.

	* xfaces.c (init_frame_faces): Remove assumption that the selected
	frame must be an X frame whenever there is already an X frame.

Tue Jun  8 23:54:04 1993  Jim Blandy  (jimb@wookumz.gnu.ai.mit.edu)

	* alloc.c (emacs_blocked_malloc, emacs_blocked_realloc): Cast the
	return values of malloc and realloc, to placate compilers.

Tue Jun  8 12:24:22 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* window.c (Fprevious_window): When changing frames,
	use the new frame's minibuffer if any.

	* intervals.h (INTERVAL_WRITABLE_P): Fix backwards tests.

	* m/tekXD88.h: Rewrite by author.

Tue Jun  8 00:38:15 1993  Jim Blandy  (jimb@totoro.cs.oberlin.edu)

	* Version 19.13 released.

	* ymakefile (C_DEBUG_SWITCH, C_OPTIMIZE_SWITCH): Remove these;
	people shouldn't edit this file to choose optimization and
	debugging switches anyway.  ../configure will set CFLAGS to an
	appropriate default, which they will be able to override.
	* Makefile.in (xmakefile): Don't try to turn -g and -O in
	CFLAGS into C_DEBUG_SWITCH and C_OPTIMIZE_SWITCH.  CFLAGS should
	be the sole source of such switches, so that setting CFLAGS
	controls them completely.

Mon Jun  7 23:54:46 1993  Jim Blandy  (jimb@totoro.cs.oberlin.edu)

	* config.h.in (HAVE_LIBDNET): New macro, to be defined by
	../configure.
	* m/pmax.h (LIBS_MACHINE): Only put "-ldnet" here if HAVE_LIBDNET
	is #defined.

Mon Jun  7 00:10:09 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* fileio.c (syms_of_fileio): Set up Qset_visited_file_modtime.
	(Fset_visited_file_modtime): Use the proper operation.

	* sysdep.c (init_baud_rate) [HAVE_TERMIOS]: Use cfgetospeed.

	* systty.h: Add NO_TERMIO conditional.

	* textprop.c (Fadd_text_properties): Don't treat the initial
	interval specially, aside from splitting off the part starting
	where we want to start changing things.
	(Fremove_text_properties): Likewise.
	For ending interval, split it left as in Fadd_text_properties.
	(Fset_text_properties): Don't set starting interval if it goes
	past END.  Instead, split it left and set the left part.

	* keymap.c (Fdescribe_vector): Use current buf, not standard-output.
	(describe_vector_princ): Add newline at end.

	* keymap.c (store_in_keymap, access_keymap): Use CHAR_META
	when clearing excess high bits.

	* s/dgux.h (INTERRUPTIBLE_*): Fix spelling of macros.

	* s/hpux9.h (SYSTEM_MALLOC, GNU_MALLOC, REL_ALLOC): Definition and
	#undefs deleted.

	* keymap.c: Doc fix.

	* buffer.c (Fdelete_overlay): Do nothing if overlay already deleted.
	Bind inhibit-quit to t.
	(Fmove_overlay): Properly handle changing buffers, or no prev buffer.
	Bind inhibit-quit to t.

	* lread.c (syms_of_lread): Set up Qload.
	(Fload): Handle magic file names.

Mon Jun  7 17:07:28 1993  Shane Hartman  (shane@nugget.spr.com)

        * xterm.c (x_caught_error_message): Change type to char* from char*[].
        (X_CAUGHT_ERROR_MESSAGE_SIZE): New macro.
        (x_error_catcher): Corresponding changes.
        (x_catch_errors): Corresponding changes.
        (x_check_errors): Do not free x_caught_error_message.
        (x_uncatch_errors): Set x_caught_error_message to 0 after freeing it.

Sun Jun  6 18:38:55 1993  Paul Eggert  (eggert@twinsun.com)

	* uaf.h (uaf$v_thursday): Fix misspelling of "thursday".

	* floatfns.c (Fceiling): Fix spelling of "ceiling".

Sun Jun  6 13:41:08 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* ymakefile [__GNUC__ >= 2] (LIB_GCC): Delete spurious -L.

	* m/tekXD88.h (HAVE_RENAME): Deleted.

	* data.c (Ffset): Delete special check for t and nil.

	* xfaces.c (same_size_fonts): Compare only the width.

	* dispnew.c: Include lisp.h earlier (before termhooks.h).

	* editfns.c (Fcurrent_time_zone): Add alternative for !HAVE_TM_ZONE.
	* systime.h [HAVE_TZNAME]: Declare tzname if not macro.
	* config.h.in (HAVE_TZNAME): Add #undef.

Sun Jun  6 13:42:35 1993  Nobuyuki Hikichi  (hikichi@sra.co.jp)

	* m/news-risc.h (NO_MODE_T): Defined.
	(LINKER): Add #undef.

Sun Jun  6 02:44:47 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* keymap.c (access_keymap, store_in_keymap): Discard meaningless
	high bits of a character event.

Sat Jun  5 04:04:33 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* lisp.h: Don't declare malloc or realloc.

	* xfns.c [EMACS_BIT_MAPS]: Include gray.xbm from ./bitmaps.

	* xterm.c (x_new_font): Don't give up right away if XListFontsWithInfo
	finds no fonts--try XLoadQueryFont anyway.

	* xfns.c (Fx_open_connection): Make `data' unsigned char.

	* window.c (Fset_window_configuration): If a window is supposed
	to have a buffer, always give it one.

	* xmenu.c (Fx_popup_menu): Error if we don't get a window
	or a frame somehow.

	* puresize.h: Test MULTI_FRAME, not HAVE_X_WINDOWS.

	* frame.c (Frubber_band_rectangle): Deleted.
	(syms_of_frame): Don't defsubr it.

	* xselect.c (x_get_foreign_selection): Handle x_selection_timeout
	as milliseconds, not as seconds.
	(syms_of_xselect): Doc fix to match.

	* m/mips4.h (MIPS2): Comment out define.
	(LIB_STANDARD): Delete -lisode.

Fri Jun  4 03:06:37 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* syssignal.h [POSIX] [!__GNUC__] (sys_sigmask): Add declaration.

	* alloc.c (make_event_array): Ignore bits above CHAR_META.

	* frame.c [!MULTI_FRAME] (Fframep): New dummy definition.
	(syms_of_frame): Defsubr that.

	* buffer.c (syms_of_buffer): Set up Lisp var inhibit-read-only.
	* lisp.h (Vinhibit_read_only): Declared.
	* buffer.c (Fbarf_if_buffer_read_only): Check Vinhibit_read_only.
	* cmds.c (Fnewline): Use Fbarf_if_buffer_read_only.

	* intervals.h (INTERVAL_VISIBLE_P): Use textget.
	(INTERVAL_WRITABLE_P): Use textget.
	Check Vinhibit_read_only.

	* window.c (syms_of_window): Always defvar pop-up-frames
	and pop-up-frame-function.

	* process.c (read_process_output): Deactivate the mark.
	Save and restore Vdeactivate_mark.

	* xfns.c (x_set_menu_bar_lines_1): Adjust just the uppermost child
	in a vertical split.  Adjust the hight counter to the top.
	(x_set_menu_bar_lines): Don't change overall frame height.

Fri Jun  4 12:41:07 1993  Francesco Potorti`  (pot@cnuce.cnr.it)

	* filelock.c (MAKE_LOCK_PATH): If SHORT_FILE_NAMES allocates
	different space and calls fill_in_lock_short_file_name.
	(fill_in_lock_short_file_name): New function for 14-chars hashed
	file names. Replaces fill_in_lock_file_name if SHORT_FILE_NAMES.

Thu Jun  3 00:07:07 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* sysdep.c (wait_for_termination): Fix sigpause in POSIX_SIGNALS case.

	* xterm.c (x_catch_errors): Fill in missing array size in cast.

	* Makefile.in (xmakefile): Depend on ../config.status.

	* buffer.c (init_buffer): Init default-directory of minibuffer.

	* m/iris4d.h (LIB_STANDARD): Delete -lbsd.

	* keyboard.c (read_key_sequence): Reset fkey_map when we find
	something at the end of Vfunction_key_map.

	* m/ibmrt-aix.h (HAVE_FTIME): Defined.

	* emacs.c (syms_of_emacs): Doc fix.

	* keyboard.c (read_char_menu_prompt): Now static.  Add declaration.

	* dispnew.c (Fredraw_display): Redraw all visible frames.
	(redraw_garbaged_frames): New function.
	* xdisp.c (redisplay, echo_area_display): Use redraw_garbaged_frames.

	* dispnew.c (do_pending_window_change): No need to clear
	FRAME_NEW_HEIGHT/WIDTH.  Do test width != 0.

	* xterm.c (x_wm_set_size_hint): Handle XGetNormalHints returning 0.

	* xfns.c (x_set_frame_parameters): Process all parms in reverse order.

	* frame.h (FRAME_MINIBUF_WINDOW): Use minibuffer_window.

Wed Jun  2 16:12:30 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* sysdep.c (init_sys_modes): Disable VLNEXT char.
	Also VWERASE, VREPRINT, VDISCARD.

	* xfaces.c: Test XOS_NEEDS_TIME_H, not HPUX, for including time.h.
	* s/sol2.h, s/hpux.h (XOS_NEEDS_TIME_H): Defined.

Wed Jun 2 20:11:29 1993  Francesco Potorti`  (pot@cnuce.cnr.it)

	* ymakefile (alloca.o): Use temp names allocax.o, allocax.s

	* m/delta.h (MOTOROLA_DELTA): Defined.
	(HAVE_SYSVIPC, BAT68K, BAT_ALLOCA): Deleted--obsolete.
	(STACK_DIRECTION, HAVE_X_WINDOWS): Deleted--configure knows.
	(C_SWITCH_MACHINE): Set to -ga if using the Green Hills compiler.
	(LIB_STANDARD, LIB_MATH): Defined to the 68881 versions.
	(LIBS_SYSTEM): -lbsd brings sigblock and sigsetmask.
	(sigsetmask): Undefined--it is in -lbsd.
	(LDAV_SYMBOL): Undefined--we have no such thing.
	(KERNEL_FILE): Defined to "/sysV68".
	(BSTRING, HAVE_SELECT, HAVE_UNISTD_H, HAVE_TIMEVAL): Defined.
	(SIGNALS_VIA_CHARACTERS): Defined.
	(memmove): Defined as memcpy--we have no memmove.
	(SIGIO, INTERRUPT_INPUT): Undefined--not yet tested.
	(SHORT_FILE_NAMES, CLASH_DETECTION): Defined.

Wed Jun  2 02:06:21 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* Version 19.12 released.

	* term.c (term_get_fkeys): Use correct names for F10 and up.
	Use the key sequence, not the termcap cap name, in Fdefine_key.

	* intervals.c (copy_intervals): Don't adjust total_length at the end.
	Set lengths of subintervals properly.
	(balance_intervals): Balance left as well as right.

Tue Jun  1 22:07:46 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* keymap.c (syms_of_keymap): Add missing 2nd arg to Fcons.

Tue Jun  1 00:27:03 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* x/esix5-4.h: Redone by Joe Kelsey.

	* xterm.c (x_new_font): Take out last change.

	* s/386bsd.h (BSD4_2): Defined.

	* fileio.c (Fwrite_region): Don't fsync if autosaving.

	* s/irix4-0.h (GETPGRP_NO_ARG): Defined.
	* emacs.c (shut_down_emacs): Handle GETPGRP_NO_ARG.
	* sysdep.c (sys_suspend): Handle GETPGRP_NO_ARG.

	* fileio.c [HPUX9]: Don't include errnet.h.

	* hftctl.c (hft_alrm): Don't return a value.
	Always declare to return void.

	* floatfns.c [!FLOAT_CHECK_ERRNO] (IN_FLOAT): New definition.
	(Flog): Fix argument of `log'.

	* m/pmax.h (KERNEL_FILE): New override definition.

	* keyboard.c (read_key_sequence) [!USE_TEXT_PROPERTIES]: Fix typo.
	(menu_bar_items) [!USE_TEXT_PROPERTIES]: Likewise.

	* s/isc3-0.h: #undef C_SWITCH_SYSTEM.

	* xselect.c (Fx_store_cut_buffer_internal): Handle empty string right.

	* xfaces.c (init_frame_faces): Don't look at selected_frame
	unless it is an X frame.

	* xfns.c (x_window): Use Vxrdb_name for res_name field.
	Delete the shortname stuff.

	* m/pmax.h (LIBS_MACHINE): Defined.

	* Version 19.11 released.

Tue Jun  1 00:07:11 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* xfns.c (x_set_menu_bar_lines): Use FRAME_NEW_HEIGHT and ..._WIDTH.

	* m/sparc.h [__GNUC__ >= 2]: Don't include alloca.h.

	* xterm.c (x_new_font): If XListFontsWithInfo finds nothing,
	try to load the font anyway.

	* ymakefile (emacs): Don't run inc-vers if ../lisp is read-only.
	(C_SWITCH_SITE_1): New make variable.
	(really-oldXMenu): Pass C_SWITCH_X_SITE_1 as C_SWITCH_X_SITE.
	Use C_SWITCH_SITE_1 to pass C_SWITCH_SITE.

	* s/386bsd.h: New file.

Mon May 31 14:04:22 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* fns.c (internal_equal): Don't let ints be equal to floats.

	* print.c (float_to_string): Skip `-' like digits when ensuring
	result looks like a float.

	* data.c (Frem): Fix result sign properly.

	* xrdb.c [__bsdi__]: ALternate decls of getpwuid and getpwnam.

	* emacs.c (main) [BSD]: Delete the setpgrp (both times).

	* m/ibmrs6000.h (NLIST_STRUCT): Defined.

	* ymakefile (GETLOADAVG_OBJ): New macro.
	(obj): Use that.

	* s/bsd386.h: New file.

	* term.c (term_get_fkeys): If not initialized, init Vfunction_key_map.

	* m/ibmrs6000.h: Delete ! __GNUC__ conditional.
	(LD_SWITCH_MACHINE): Defined.
	(ORDINARY_LINK): Defined unconditionally.

	* dispnew.c (update_frame): Make preempt_count positive.
	Defend against negative baud_rate.
	* scroll.c (calculate_scrolling): Defend against negative baud_rate.

	* mem-limits.h [__bsdi__]: Define BSD4_2.

	* xfns.c (x_window): In XSetClassHint, use a shortened version
	of the frame name.

	* s/hpux8.h (C_SWITCH_SYSTEM): Fix typo in X11R5 dirname.

	* xterm.c (XTread_socket, case KeyPress) [HPUX]: Test IsModifiedKey.

	* keyboard.c (kbd_buffer_get_event):
	Shorten the first MULTI_FRAME conditional.

	* s/usg5-4-2.h (HAVE_VFORK): Deleted.

Mon May 31 10:07:48 1993  James Clark  (jjc@jclark.com)

	* xselect.c (x_reply_selection_request): Call XFlushQueue.

	* window.c (Fset_window_buffer): Set window's force_start to Qnil.

Mon May 31 01:33:06 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* syntax.c (Fforward_comment): Set point to where scan stops,
	thus moving acros whitespace.  When moving fwd, treat Sendcomment
	as whitespace; likewise for Scomment when moving back.
	(scan_sexps_forward): New arg COMMENTSTOP.
	(Fparse_partial_sexp): Likewise.

	* xfns.c (Fx_create_frame): Use bitmapIcon, not iconType.

Sun May 30 20:04:19 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* data.c (float_arith_driver): Detect division by zero in advance.
	(arith_driver, Frem): Likewise.

	* xfns.c (Fx_list_fonts): Handle 0 for FRAME_FACES (f) [face_id]->font.

	* print.c (Fwith_output_to_temp_buffer): Doc fix.

	* sysdep.c (wait_for_termination): Delete LINUX conditionals.

	* s/linux.h (HAVE_TCATTR): Deleted.
	(BSD): Don't define.
	(read, write, open, close): Defined.
	(INTERRUPTIBLE_OPEN, INTERRUPTIBLE_CLOSE, INTERRUPTIBLE_IO): Defined.
	(C_SWITCH_SYSTEM): Defined.

	* xterm.c: Include systty.h; don't mess with FIONREAD.
	Don't include termio.h dorectly.

	* intervals.c (interval_deletion_adjustment): Delete unreachable abort.

	* fns.c (Fyes_or_no_p): Delete unreachable UNGCPRO.

	* keyboard.c (lispy_function_keys): Add `remove' key.

Sun May 30 19:24:09 1993  Roland McGrath  (roland@churchy.gnu.ai.mit.edu)

	* buffer.c (Fgenerate_new_buffer_name): Doc fix.

Sun May 30 19:10:09 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* Makefile.in (clean): Delete libXMenu11.a.

Sun May 30 17:48:11 1993  Jim Blandy  (jimb@wookumz.gnu.ai.mit.edu)

	* m/mips.h (KERNEL_FILE): Set this to "/unix".
	* m/mips4.h (MIPS2): Go ahead and define this.
	(C_DEBUG_SWITCH): Add -DMips and -g3, and up Olimit to 2000.

Sun May 30 16:51:56 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* emacs.c (main) [AIX _I386]: Don't handle SIGIOINT.

	* lisp.h (UCHAR): Don't define if _UCHAR_T.

	* m/ibmps2-aix.h (HAVE_GETTIMEOFDAY): Deleted.
	(HAVE_SETSID, HAVE_TERMIOS): Defined.
	(HAVE_TERMIO): Add #undef.
	(SIGNALS_VIA_CHARACTERS): Defined.
	(C_DEBUG_SWITCH): Make definition empty.
	(LIBS_DEBUG): Defined.
	(BROKEN_TIOCGWINSZ, LIB_X11_LIB): Add #undef.

	* sysdep.c (child_setup_tty) [AIX SIGNALS_VIA_CHARACTERS]: Install
	something usefull in the VQUIT and VINTR.
	(emacs_set_tty): Try only 10 times to call tcsetattr.
	Don't use memcmp to test what it did.

	* systty.h [HAVE_TERMIOS _AIX _I386]: Include termios before termio.

	* dispnew.c (buffer_posn_from_coords): Since COL is already
	window-relative, don't subtract window_left.

Sun May 30 15:49:17 1993  Jim Blandy  (jimb@wookumz.gnu.ai.mit.edu)

	* xfaces.c (unload_color): Don't #include <X11/Intrinsic.h>,
	<X11/StringDefs.h>, or <X11/Xmu/Drawing.h>.  Just write out
	"unsigned long" instead of using the "Pixel" typedef; it's in the
	protocol, so it's not likely to change.

	* hftctl.c (hft_alrm): Declare and define this to return void, not
	int; the AIX #include files have prototypes for it.

	* s/aix3-2.h (LIBS_SYSTEM): Remove -lIM and -liconv from here...
	* m/ibmrs6000.h (LIBS_MACHINE): They're already here.  Doc fix.

	* Makefile.in (SUBMAKEFLAGS): Remember to propagate MAKE.

Sun May 30 14:18:26 1993  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* s/sunos4-1-3.h: Delete the #undef of SYSTEM_MALLOC.

	* systty.h [IRIX4]: Include unistd.h.

	* s/irix4-0.h (IRIX4): Defined.
	(IRIS_UTIME): #undef this.

	* xfns.c (Fx_open_connection) [NO_XRM_SET_DATABASE]:
	Don't call XrmsSetDatabase.

	* xfaces.c: Fix HPUX conditional syntax.

	* s/hpux8.h (random, srandom): Defined.

	* s/usg5-4-2.h: Don't specify s/ dir in #include.
	* s/usg5-4-2.h (PTY_TTY_NAME_SPRINTF): Defined.
	(HAVE_SYSV_SIGPAUSE): #undef this.

	* sysdep.c (wait_for_termination): Add POSIX_SIGNALS alternative.

Sun May 30 13:01:54 1993  Jim Blandy  (jimb@wookumz.gnu.ai.mit.edu)

	* xfaces.c (init_frame_faces): We have to make sure that face ID's
	are valid on all frames or no frames; make sure F has allocated
	faces for any face valid on the selected frame.

	* s/hpux9.h: New file; don't use the GNU allocator.  Hope we fix
	this soon.

See ChangeLog.3 for earlier changes.
