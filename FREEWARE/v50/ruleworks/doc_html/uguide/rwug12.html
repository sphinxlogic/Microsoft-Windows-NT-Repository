<HTML>
<HEAD>
<TITLE>RuleWorks</TITLE>
</HEAD>
<BODY>

<FONT FACE="Arial" SIZE=6 color="navy"><P ALIGN="RIGHT">RuleWorks</P></FONT>

<B><I><FONT FACE="HELVETICA" SIZE=6 color="RED"><P ALIGN="RIGHT">
Portability and Compatibility Issues</P></B></I></FONT>

<P>This chapter provides information on differences between platforms.  It includes:</P>

<UL>
<LI>File specifications</LI>
<LI>Input Source and Output Destination</LI>
<LI>Hardware and Operating System Restrictions</LI>
<LI>Internationalization Issues</LI>
<LI>RuleWorks and OPS5 Compatibility Issues</LI></UL>

<P>&nbsp;</P>
<B><FONT FACE="Helvetica" SIZE=5>
<P>File Specifications<A NAME="portable_filespec_sec"></A></P>
</B></FONT><FONT SIZE=2><P>The restrictions on file names vary according to operating system.  The following characteristics are typical of file names on various platforms, but are restricted when using RuleWorks:</P>
</FONT><B><FONT FACE="Helvetica" SIZE=4><P>
</B></FONT><FONT SIZE=2><P>Brackets ([]) signify an index into a compound attribute.  The comment character for RuleWorks is a semicolon (;).  Therefore, if the file specification you supply includes any of these characters, you must enclose it in vertical bars ( </FONT><FONT FACE="Courier" SIZE=2> |  | </FONT><FONT SIZE=2>).</P>

<P>The following command illustrates VMS-style file specifications:</P><DIR>
<DIR>
<DIR>

</FONT><FONT FACE="Courier" SIZE=1><P>@ |USER$1:[SMITH.WORK]INITIALIZE-MEMORY.WM|</P></DIR>
</DIR>
</DIR>

</FONT><B><FONT FACE="Helvetica" SIZE=4><P>
</B></FONT><FONT SIZE=2><P>If your file specification needs to be passed to the operating system in lowercase letters, you must enclose it in vertical bars ( </FONT><FONT FACE="Courier" SIZE=2> |  | </FONT><FONT SIZE=2>).</P>

<P>The following command illustrates UNIX-style file specifications:</P><DIR>
<DIR>
<DIR>

</FONT><FONT FACE="Courier" SIZE=1><P>@ |usr/users/smith/work/initialize-memory|</P></DIR>
</DIR>
</DIR>

</FONT><B><FONT FACE="Helvetica" SIZE=4><P>
</B></FONT><FONT SIZE=2><P>If your file specification contains any of the following characters, you must enclose the file specification in vertical bars ( </FONT><FONT FACE="Courier" SIZE=2> |  | </FONT><FONT SIZE=2>):  caret (^), tilde (~), number sign (#), percent sign (%), ampersand (&amp;), parentheses (()), and braces ({ }).</P>

<P>The following command illustrates MS-DOS-style file specifications:</P><DIR>
<DIR>
<DIR>

</FONT><FONT FACE="Courier" SIZE=1><P>@ |C:\smith\work\init%mem.com|</P></DIR>
</DIR>
</DIR>

</FONT><B><FONT FACE="Helvetica" SIZE=5><P>
<P>&nbsp;</P>
<P>Input Source and Output Destination <A NAME="portable_io_sec_"></A></P>
</B></FONT><FONT SIZE=2><P>If you do not use the DEFAULT command or action to specify otherwise, RuleWorks uses standard input and standard output (SYS$INPUT and SYS$OUTPUT on VMS systems).</P>

<P>&nbsp;</P>
<P>&nbsp;</P>
</FONT><B><FONT FACE="Helvetica" SIZE=5><P>Hardware and Operating System Restrictions<A NAME="hardware_app_">
</B></FONT><FONT SIZE=2><P>   On VMS systems, you cannot write more than 252 atoms at a time.</P>

<P>&nbsp;</P>
<P>&nbsp;</P>
</FONT><B><FONT FACE="Helvetica" SIZE=5><P>Internationalization Issues
</B></FONT><FONT SIZE=2><P>On VMS systems, RuleWorks collates symbols according to the Digital Multinational Character Set.</P>
<I><P>This does not follow the I18N Guidelines. Please use the specified NCS routines.</P>
</I>
<P>On MS-DOS, RuleWorks does not change the active code page (see your DOS manual for the Chcp command). On Windows NT, RuleWorks does not change the Internationalization setting.</P>
</FONT><FONT FACE="Times" SIZE=3><P>&nbsp;</P>
</FONT><B><FONT FACE="Helvetica" SIZE=5><P>Compatibility Issues<A NAME="compat_app_"></A>
</B></FONT><FONT SIZE=2><P>There are two major differences and numerous minor differences between RuleWorks and OPS5:</P>

<UL>
</FONT><FONT FACE="NewCenturySchlbk" SIZE=2><LI>The first major difference is that RuleWorks, 
makes no attempt to be 100% compatible with the public domain OPS5. 
Constructs like LITERALIZE, LITVAL, and VECTOR-ATTRIBUTE are not available in RuleWorks.</LI>
<LI>The second major difference is that the public domain OPS5 provides
none of the  modularity features that RuleWorks provides, although most of the other integration features were provided.</LI></UL>

<P>&nbsp;</P><DIR>
<DIR>
<DIR>

<P>These modularity features are covered briefly in Chapter 12. See Chapter 5 for more details.</P>
<P>&nbsp;</P></DIR>
</DIR>
</DIR>


<UL>
<LI>The minor differences include several match extensions, optional data typing on attributes, some new actions and functions, and other changes.</LI></UL>

<P>&nbsp;</P>
</FONT><B><FONT FACE="Helvetica" SIZE=4><P>Constructs Obsolete in RuleWorks<A NAME="compat_obsolete_sec_"></A> </P>
</B></FONT><FONT SIZE=2><P>None of the features described as obsolescent in the OPS5 <I>Compatibility and Migration guide </I>is implemented in RuleWorks. Constructs that were obsolescent in OPS5 and are obsolete in RuleWorks include:</P><DIR>
<DIR>
<DIR>

</FONT><FONT FACE="NewCenturySchlbk" SIZE=2><P><FONT FACE="Symbol">&#183;</FONT>
&#9;All of the OPS$... API routines</P>
<P><FONT FACE="Symbol">&#183;</FONT>
&#9;CE variables</P>
<P><FONT FACE="Symbol">&#183;</FONT>
&#9;Value disjunctions or variables in the class position in a CE</P>
<P><FONT FACE="Symbol">&#183;</FONT>
&#9;LITERAL, LITVAL, and LITERALIZE</P>
<P><FONT FACE="Symbol">&#183;</FONT>
&#9;SUBSTR and VECTOR-ATTRIBUTE</P>
<P><FONT FACE="Symbol">&#183;</FONT>
&#9;EXTERNAL declaration</P>
<P><FONT FACE="Symbol">&#183;</FONT>
&#9;CALL action and command</P>
<P><FONT FACE="Symbol">&#183;</FONT>
&#9;CBIND action</P>
<P><FONT FACE="Symbol">&#183;</FONT>
&#9;HALT action</P>
<P><FONT FACE="Symbol">&#183;</FONT>
&#9;COMPUTE function</P>
<P><FONT FACE="Symbol">&#183;</FONT>
&#9;ACCEPT function</P>
<P><FONT FACE="Symbol">&#183;</FONT>
&#9;ACCEPTLINE function</P></DIR>
</DIR>
</DIR>

</FONT><B><FONT FACE="Helvetica" SIZE=4><P>Features Added to RuleWorks<A NAME="compat_change_sec_"></A> </P>
</B></FONT><FONT SIZE=2><P>The following differences between RuleWorks and OPS5 are side-effects of the new modularity features:</P><DIR>
<DIR>
<DIR>

</FONT><FONT FACE="NewCenturySchlbk" SIZE=2><P><FONT FACE="Symbol">&#183;</FONT>
&#9;An ENTRY-BLOCK (or DECLARATION-BLOCK, or RULE-BLOCK) construct and an END-BLOCK construct are now required as wrappers around all other constructs.</P>
<P><FONT FACE="Symbol">&#183;</FONT>
&#9;There is a new compiler command with a completely new set of compiler qualifiers.</P>
<P><FONT FACE="Symbol">&#183;</FONT>
&#9;There is now no negated refraction. The new refraction semantics are simply: "Within an invocation of an entry-block, once an instantiation has fired, that specific instantiation will never fire again."</P>
<P><FONT FACE="Symbol">&#183;</FONT>
&#9;MEA is now the default conflict resolution strategy.</P>
<P><FONT FACE="Symbol">&#183;</FONT>
&#9;The conflict resolution strategy can only be set at compile time as an ENTRY-BLOCK clause, so there is now no STRATEGY command. An entry block checks when it starts up that each rule block it activates has the same strategy as it does.</P>
<P><FONT FACE="Symbol">&#183;</FONT>
&#9;There is no RUN action, where in OPS5 it is allowed only in the STARTUP.  By default, an entry block always starts running.</P>
<P><FONT FACE="Symbol">&#183;</FONT>
&#9;The appearance of the command interpreter can now be controlled by the programmer using the Debug compiler command qualifier, the DEBUG action, and the rul_debug API routine. This is unlike OPS5 where source code changes had to be made to control the interpreter's appearance.</P>
<P><FONT FACE="Symbol">&#183;</FONT>
&#9;Because the same entry block can now be invoked multiple times recursively, when a rule instantiation is fired, it is not actually removed from the conflict set, even though it ceases to be visible there. If you are watching CS changes, be warned that you may see a fired instantiation leaving the conflict set long after it ceased to be visible via the CS command.</P>
<P><FONT FACE="Symbol">&#183;</FONT>
&#9;There is no ^C handler in the interpreter, as this could interfere with a user-supplied handler.</P>
<P><FONT FACE="Symbol">&#183;</FONT>
&#9;Direct instances of the class $ROOT cannot be created in RuleWorks because of the data modularity.</P>
<P><FONT FACE="Symbol">&#183;</FONT>
&#9;The name MAIN (or |main|), when used as an entry block name without an ACCEPTS clause or a RETURNS clause for the ENTRY-BLOCK creates a C  compliant entry point named "main" by automatically adding a return  type of long.</P>
<P><FONT FACE="Symbol">&#183;</FONT>
&#9; RETURN is now a command as well as an action.</P>
<P><FONT FACE="Symbol">&#183;</FONT>
&#9;The extra-name argument to all the API routines that accept class names is now used. If supplied the extra-name should be the name of the block where the class was declared. This allows independent rule subprograms to each have a class defined that happen to have the same class name.</P>
<P><FONT FACE="Symbol">&#183;</FONT>
&#9; There is no RESTART command.</P></DIR>
</DIR>
</DIR>

</FONT><B><FONT FACE="Helvetica" SIZE=4><P>Minor Changes in RuleWorks<A NAME="compat_minor_sec_"></A></P>
</B></FONT><FONT SIZE=2><P>This section covers differences between RuleWorks and OPS5 that were not described as obsolescent in OPS5, and are not due to the new RuleWorks modularity features.</P>
</FONT><B><I><P>Match Extensions<A NAME="compat_minor_match_sec_"></A></P>
</B></I><FONT SIZE=2><P>Several new matching features have been added, including:</P><DIR>
<DIR>
<DIR>

</FONT><FONT FACE="NewCenturySchlbk" SIZE=2><P><FONT FACE="Symbol">&#183;</FONT>
&#9;Variables and other value expressions are now evaluated within a value  disjunctions, including variables bound in other condition elements.</P>
<P><FONT FACE="Symbol">&#183;</FONT>
&#9;Relational predicates (&gt;, &lt;, &gt;=, &lt;=, =) can compare integers versus floats, and symbols versus symbols using localizable lexicographic ordering.</P>
<P><FONT FACE="Symbol">&#183;</FONT>
&#9;New similarity predicate, ~=, that for numbers compares integers and floats for equality within a 1% margin, and for symbols uses the SOUNDEX algorithm to compare phonetic (in English) similarity.</P>
<P><FONT FACE="Symbol">&#183;</FONT>
&#9;New dissimilarity predicate, -~=, that matches when the similarity test fails.</P>
<P><FONT FACE="Symbol">&#183;</FONT>
&#9;Comparisons of compound attributes and a COMPOUND function are now supported.</P>
<P><FONT FACE="Symbol">&#183;</FONT>
&#9;The containment and non-containment predicates can now be applied to scalar attributes, as long as the argument to the predicate is a compound value (e.g. ^name [+]). In addition, You can now use the containment and non-containment predicates in conjunction with a scalar predicate.  This allows you to specify the test to be performed between a scalar value or attribute and each element of a compound attribute or value.  Previously, the containment tests were always for identity.</P></DIR>
</DIR>
</DIR>

</FONT><B><I><P>Optional Attribute Data Type Restrictions<A NAME="compat_minor_data_sec_"></A></P>
</B></I><FONT SIZE=2><P>Optional attribute data types allow you to restrict the domain of an attribute to a specific type of value.  The set of supported domain restrictions are: INTEGER, SYMBOL, FLOAT, OPAQUE, and INSTANCE-ID. If the INSTANCE-ID domain is specified, then a specific class may optionally be identified by stating: INSTANCE-ID OF &lt;class&gt;.</P>
<P>For example:</P><DIR>
<DIR>
<DIR>

</FONT><FONT FACE="Courier" SIZE=1><P>(OBJECT-CLASS job-category</P>
<P>             ^category-name SYMBOL</P>
<P>             ^max-salary FLOAT</P>
<P>             ^min-salary FLOAT</P>
<P>             ^employees COMPOUND INSTANCE-ID OF employee</P>
<P>             ^salaries  COMPOUND FLOAT)</P>
</FONT><FONT SIZE=2></DIR>
</DIR>
</DIR>

<P>You are not required to supply attribute domain restrictions. If you do, however, the compiler (and if necessary, the run-time system) rigorously enforces those restrictions.</P>

<P>The PPCLASS command shows any domain restrictions along with the class's attributes.</P>
</FONT><B><I><P>New RHS Actions<A NAME="compat_minor_actions_sec_"></A></P>
</B></I><FONT SIZE=2><P>The following RHS actions are new in RuleWorks</P><DIR>
<DIR>
<DIR>

</FONT><FONT FACE="NewCenturySchlbk" SIZE=2><P><FONT FACE="Symbol">&#183;</FONT>
&#9;The IF...THEN...ELSE... and WHILE...DO... actions provide conditional control over other RHS actions in rules or ON- statements.</P>
<P><FONT FACE="Symbol">&#183;</FONT>
&#9;The REMOVE-EVERY action provides a means to delete objects by class.</P></DIR>
</DIR>
</DIR>

</FONT><B><I><P>New Functions<A NAME="compat_minor_functions_sec_"></A></P>
</B></I><FONT SIZE=2><P>The following functions are new in RuleWorks</P><DIR>
<DIR>
<DIR>

</FONT><FONT FACE="NewCenturySchlbk" SIZE=2><P><FONT FACE="Symbol">&#183;</FONT>
&#9;The EVERY function (for RHS only) collects all instances of a class. Accepts a class name, returns a compound of INSTANCE-IDs.</P>
<P><FONT FACE="Symbol">&#183;</FONT>
&#9;The GET function (for RHS only) can retrieve arbitrary attribute values from arbitrary instances. (NOTE: GET can be used with unmatched objects. Unmatched objects are objects that were not in the firing instantiation. For example, a variable bound to the ^foo attribute, if it was an instance identifier, would be an unmatched object.)</P>
<P><FONT FACE="Symbol">&#183;</FONT>
&#9;The new GENINT function returns a system-generated INTEGER.  The GENATOM function changed to take an optional argument that specifies a prefix for the generated symbol. The default prefix is still G:.</P>
<P><FONT FACE="Symbol">&#183;</FONT>
&#9;The IS-OPEN function checks whether a file stream is open. It accepts a file-id; returns OUT or IN if open, NIL if not.</P>
<P><FONT FACE="Symbol">&#183;</FONT>
&#9;The MAX and MIN functions find the largest or smallest value among their arguments.</P>
<P><FONT FACE="Symbol">&#183;</FONT>
&#9;The SUBCOMPOUND function (and the new SUBSYMBOL) can be used on the LHS.</P>
<P><FONT FACE="Symbol">&#183;</FONT>
&#9;The SUBSYMBOL function extracts a segment of a symbol.</P>
<P><FONT FACE="Symbol">&#183;</FONT>
&#9;The SYMBOL-LENGTH function counts the characters in a symbol.  Accepts a symbolic value, returns an integer.</P></DIR>
</DIR>
</DIR>

</FONT><B><FONT FACE="Helvetica" SIZE=4><P>Miscellaneous Changes<A NAME="compat_minor_misc_sec_"></A></P><DIR>
<DIR>
<DIR>

</B></FONT><FONT FACE="NewCenturySchlbk" SIZE=2><P><FONT FACE="Symbol">&#183;</FONT>
&#9;As a result of the introduction of the new semantics for the relational predicates, the predicate, = (now called the equality predicate), is no longer equivalent to the implied identity predicate, and it cannot bind an unbound variable.</P>
<P><FONT FACE="Symbol">&#183;</FONT>
&#9;The implied predicate is now identity, not equality. The identity predicate can bind a variable.</P>
<P><FONT FACE="Symbol">&#183;</FONT>
&#9;Definition of equality for symbols has changed: it is no longer case-sensitive.</P>
<P><FONT FACE="Symbol">&#183;</FONT>
&#9;Containment predicate has changed: you can now test whether a scalar value is contained by a compound, as well as whether a compound value contains a scalar.</P>
<P><FONT FACE="Symbol">&#183;</FONT>
&#9;Variables inside disjunctions of values are evaluated in RuleWorks.</P>
<P><FONT FACE="Symbol">&#183;</FONT>
&#9;First argument to COPY, MAKE, MODIFY and SPECIALIZE actions is no longer required to be a variable bound to a ^$ID attribute on the LHS.  Can be bound to a different attribute or the result of a GET function, but must evaluate to an INSTANCE-ID of an object class that is visible to the active entry block.</P>
<P><FONT FACE="Symbol">&#183;</FONT>
&#9;External routine names are not allowed to be the same as actions or construct types.</P>
<P><FONT FACE="Symbol">&#183;</FONT>
&#9;External routines can accept a dynamically-size array.</P>
<P><FONT FACE="Symbol">&#183;</FONT>
&#9;Rules or classes can not have names that are predicate operators or non-symbolic values.</P>
<P><FONT FACE="Symbol">&#183;</FONT>
&#9;The name of the WATCH command has been changed to TRACE.</P>
<P><FONT FACE="Symbol">&#183;</FONT>
&#9;The output from PPWM, WM, and TRACE WM now shows the readforms of all attribute values, instead of the printforms. The output from WRITE still shows the printforms.</P>
<P>The syntax for many of the debugging commands has changed.  Using the old syntax now generates a syntax error but also usage and example messages.</P>
<P><FONT FACE="Symbol">&#183;</FONT>
&#9;The behavior of the EXIT command has changed since OPS5.  Previously, if the OPS5 routine was not your main program, EXIT would return control to the calling program. In RuleWorks, EXIT always returns to the operating system.</P>
<P><FONT FACE="Symbol">&#183;</FONT>
&#9;Unmatched objects can now be acted upon by the REMOVE, COPY, MODIFY, and SPECIALIZE actions. The compiler gives an informational message (and generates extra run-time checking code) whenever it is unable to verify that the instance argument passed to one of these actions is indeed a valid instance identifier of an existing object.</P>
<P><FONT FACE="Symbol">&#183;</FONT>
&#9;Two new special atoms; one for each of the new types: the null Instance-id, #0, and the null Opaque value, %x0 (equivalent to C's NULL).</P></DIR>
</DIR>
</DIR>
</FONT></BODY>
</HTML>
